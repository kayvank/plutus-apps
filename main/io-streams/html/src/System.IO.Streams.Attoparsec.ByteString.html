<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | This module provides support for parsing values from ByteString</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- 'InputStream's using @attoparsec@. /Since: 1.4.0.0./</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System.IO.Streams.Attoparsec.ByteString</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Parsing</span></span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="System.IO.Streams.Attoparsec.ByteString.html#parseFromStream"><span class="hs-identifier">parseFromStream</span></a></span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.IO.Streams.Attoparsec.ByteString.html#parserToInputStream"><span class="hs-identifier">parserToInputStream</span></a></span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.Attoparsec.html#ParseException"><span class="hs-identifier">ParseException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../attoparsec/html/src"><span class="hs-identifier">Data.Attoparsec.ByteString.Char8</span></a></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="../../../../attoparsec/html/src"><span class="hs-identifier">Parser</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>                       </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="System.IO.Streams.Internal.html"><span class="hs-identifier">System.IO.Streams.Internal</span></a></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="System.IO.Streams.Internal.html#InputStream"><span class="hs-identifier">InputStream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.html"><span class="hs-identifier">System.IO.Streams.Internal</span></a></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Streams</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="System.IO.Streams.Internal.Attoparsec.html"><span class="hs-identifier">System.IO.Streams.Internal.Attoparsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.IO.Streams.Internal.Attoparsec.html#ParseData"><span class="hs-identifier">ParseData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.Attoparsec.html#ParseException"><span class="hs-identifier">ParseException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.Attoparsec.html#parseFromStreamInternal"><span class="hs-identifier">parseFromStreamInternal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- | Supplies an @attoparsec@ 'Parser' with an 'InputStream', returning the</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- final parsed value or throwing a 'ParseException' if parsing fails.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- 'parseFromStream' consumes only as much input as necessary to satisfy the</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- 'Parser': any unconsumed input is pushed back onto the 'InputStream'.</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- If the 'Parser' exhausts the 'InputStream', the end-of-stream signal is sent</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- to attoparsec.</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- ghci&gt; import &quot;Data.Attoparsec.ByteString.Char8&quot;</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- ghci&gt; is &lt;- 'System.IO.Streams.fromList' [\&quot;12345xxx\&quot; :: 'ByteString']</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- ghci&gt; 'parseFromStream' ('Data.Attoparsec.ByteString.Char8.takeWhile' 'Data.Attoparsec.ByteString.Char8.isDigit') is</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- \&quot;12345\&quot;</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- ghci&gt; 'System.IO.Streams.read' is</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- Just \&quot;xxx\&quot;</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-39"></span><span id="local-6989586621679082472"><span class="annot"><a href="System.IO.Streams.Attoparsec.ByteString.html#parseFromStream"><span class="hs-identifier hs-type">parseFromStream</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../attoparsec/html/src"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082472"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-40"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.html#InputStream"><span class="hs-identifier hs-type">InputStream</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-41"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082472"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-42"></span><span id="parseFromStream"><span class="annot"><span class="annottext">parseFromStream :: Parser r -&gt; InputStream ByteString -&gt; IO r
</span><a href="System.IO.Streams.Attoparsec.ByteString.html#parseFromStream"><span class="hs-identifier hs-var hs-var">parseFromStream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Parser r -&gt; ByteString -&gt; IResult ByteString r)
-&gt; (IResult ByteString r -&gt; ByteString -&gt; IResult ByteString r)
-&gt; Parser r
-&gt; InputStream ByteString
-&gt; IO r
forall i r.
ParseData i =&gt;
(Parser i r -&gt; i -&gt; IResult i r)
-&gt; (IResult i r -&gt; i -&gt; IResult i r)
-&gt; Parser i r
-&gt; InputStream i
-&gt; IO r
</span><a href="System.IO.Streams.Internal.Attoparsec.html#parseFromStreamInternal"><span class="hs-identifier hs-var">parseFromStreamInternal</span></a></span><span> </span><span class="annot"><span class="annottext">Parser r -&gt; ByteString -&gt; IResult ByteString r
forall i a. ParseData i =&gt; Parser i a -&gt; i -&gt; IResult i a
</span><a href="System.IO.Streams.Internal.Attoparsec.html#parse"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">IResult ByteString r -&gt; ByteString -&gt; IResult ByteString r
forall i r. ParseData i =&gt; IResult i r -&gt; i -&gt; IResult i r
</span><a href="System.IO.Streams.Internal.Attoparsec.html#feed"><span class="hs-identifier hs-var">feed</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | Given a 'Parser' yielding values of type @'Maybe' r@, transforms an</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- 'InputStream' over byte strings to an 'InputStream' yielding values of type</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- @r@.</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- If the parser yields @Just x@, then @x@ will be passed along downstream, and</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- if the parser yields @Nothing@, that will be interpreted as end-of-stream.</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- Upon a parse error, 'parserToInputStream' will throw a 'ParseException'.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- ghci&gt; import &quot;Control.Applicative&quot;</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- ghci&gt; import &quot;Data.Attoparsec.ByteString.Char8&quot;</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- ghci&gt; is &lt;- 'System.IO.Streams.fromList' [\&quot;1 2 3 4 5\&quot; :: 'ByteString']</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- ghci&gt; let parser = ('Data.Attoparsec.ByteString.Char8.endOfInput' &gt;&gt; 'Control.Applicative.pure' 'Nothing') \&lt;|\&gt; (Just \&lt;$\&gt; ('Data.Attoparsec.ByteString.Char8.skipWhile' 'Data.Attoparsec.ByteString.Char8.isSpace' *&gt; 'Data.Attoparsec.ByteString.Char8.decimal'))</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- ghci&gt; 'parserToInputStream' parser is &gt;&gt;= 'System.IO.Streams.toList'</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- [1,2,3,4,5]</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- ghci&gt; is' \&lt;- 'System.IO.Streams.fromList' [\&quot;1 2xx3 4 5\&quot; :: 'ByteString'] &gt;&gt;= 'parserToInputStream' parser</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- ghci&gt; 'read' is'</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- Just 1</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- ghci&gt; 'read' is'</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Just 2</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- ghci&gt; 'read' is'</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- *** Exception: Parse exception: Failed reading: takeWhile1</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-71"></span><span id="local-6989586621679082465"><span class="annot"><a href="System.IO.Streams.Attoparsec.ByteString.html#parserToInputStream"><span class="hs-identifier hs-type">parserToInputStream</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../attoparsec/html/src"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082465"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.IO.Streams.Internal.html#InputStream"><span class="hs-identifier hs-type">InputStream</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-73"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.IO.Streams.Internal.html#InputStream"><span class="hs-identifier hs-type">InputStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679082465"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-74"></span><span id="parserToInputStream"><span class="annot"><span class="annottext">parserToInputStream :: Parser (Maybe r) -&gt; InputStream ByteString -&gt; IO (InputStream r)
</span><a href="System.IO.Streams.Attoparsec.ByteString.html#parserToInputStream"><span class="hs-identifier hs-var hs-var">parserToInputStream</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Maybe r) -&gt; IO (InputStream r)
forall a. IO (Maybe a) -&gt; IO (InputStream a)
</span><a href="System.IO.Streams.Internal.html#makeInputStream"><span class="hs-identifier hs-var">Streams.makeInputStream</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe r) -&gt; IO (InputStream r))
-&gt; (InputStream ByteString -&gt; IO (Maybe r))
-&gt; InputStream ByteString
-&gt; IO (InputStream r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((InputStream ByteString -&gt; IO (Maybe r))
 -&gt; InputStream ByteString -&gt; IO (InputStream r))
-&gt; (Parser (Maybe r) -&gt; InputStream ByteString -&gt; IO (Maybe r))
-&gt; Parser (Maybe r)
-&gt; InputStream ByteString
-&gt; IO (InputStream r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Maybe r) -&gt; InputStream ByteString -&gt; IO (Maybe r)
forall r. Parser r -&gt; InputStream ByteString -&gt; IO r
</span><a href="System.IO.Streams.Attoparsec.ByteString.html#parseFromStream"><span class="hs-identifier hs-var">parseFromStream</span></a></span><span>
</span><span id="line-75"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="System.IO.Streams.Attoparsec.ByteString.html#parserToInputStream"><span class="hs-pragma hs-type">parserToInputStream</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-76"></span></pre></body></html>