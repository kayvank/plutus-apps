<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Module providing (almost) full support for Postgres query and data</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- manipulation statements. These functions shadow the functions in</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- &quot;Database.Beam.Query&quot; and provide a strict superset of functionality. They</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- map 1-to-1 with the underlying Postgres support.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Beam.Postgres.Full</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Additional @SELECT@ features</span></span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** @SELECT@ Locking clause</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier">PgWithLocking</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier">PgLockedTables</span></a></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingStrength"><span class="hs-identifier">PgSelectLockingStrength</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingOptions"><span class="hs-identifier">PgSelectLockingOptions</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockingAllTablesFor_"><span class="hs-identifier">lockingAllTablesFor_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockingFor_"><span class="hs-identifier">lockingFor_</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#locked_"><span class="hs-identifier">locked_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockAll_"><span class="hs-identifier">lockAll_</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#withLocks_"><span class="hs-identifier">withLocks_</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Lateral joins</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lateral_"><span class="hs-identifier">lateral_</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @INSERT@ and @INSERT RETURNING@</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#insert"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#insertReturning"><span class="hs-identifier">insertReturning</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#insertDefaults"><span class="hs-identifier">insertDefaults</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgInsertReturningList"><span class="hs-identifier">runPgInsertReturningList</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier">PgInsertReturning</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Specifying conflict actions</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier">PgInsertOnConflict</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#onConflictDefault"><span class="hs-identifier">onConflictDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#onConflict"><span class="hs-identifier">onConflict</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#conflictingConstraint"><span class="hs-identifier">conflictingConstraint</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">BeamHasInsertOnConflict</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">onConflictUpdateAll</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">onConflictUpdateInstead</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @UPDATE RETURNING@</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier">PgUpdateReturning</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgUpdateReturningList"><span class="hs-identifier">runPgUpdateReturningList</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#updateReturning"><span class="hs-identifier">updateReturning</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="hs-comment">-- * @DELETE RETURNING@</span></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier">PgDeleteReturning</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgDeleteReturningList"><span class="hs-identifier">runPgDeleteReturningList</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#deleteReturning"><span class="hs-identifier">deleteReturning</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Generalized @RETURNING@</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturning"><span class="hs-identifier">PgReturning</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">insert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">insertValues</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Query.Internal</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL.BeamExtensions</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Schema.Tables</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Postgres.Types.html"><span class="hs-identifier">Database.Beam.Postgres.Types</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html"><span class="hs-identifier">Database.Beam.Postgres.Syntax</span></a></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">Control.Monad.Free.Church</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span class="hs-cpp">
#if !MIN_VERSION_base(4, 11, 0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Semigroup</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- * @SELECT@</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | An explicit lock against some tables. You can create a value of this type using the 'locked_'</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- function. You can combine these values monoidally to combine multiple locks for use with the</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- 'withLocks_' function.</span><span>
</span><span id="line-78"></span><span class="hs-keyword">newtype</span><span> </span><span id="PgLockedTables"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-var">PgLockedTables</span></a></span></span><span> </span><span id="local-6989586621679189107"><span class="annot"><a href="#local-6989586621679189107"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PgLockedTables"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-var">PgLockedTables</span></a></span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188862"><span id="local-6989586621679188864"><span id="local-6989586621679188866"><span class="annot"><span class="annottext">b -&gt; PgLockedTables s -&gt; PgLockedTables s
NonEmpty (PgLockedTables s) -&gt; PgLockedTables s
PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
(PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s)
-&gt; (NonEmpty (PgLockedTables s) -&gt; PgLockedTables s)
-&gt; (forall b.
    Integral b =&gt;
    b -&gt; PgLockedTables s -&gt; PgLockedTables s)
-&gt; Semigroup (PgLockedTables s)
forall b. Integral b =&gt; b -&gt; PgLockedTables s -&gt; PgLockedTables s
forall s. NonEmpty (PgLockedTables s) -&gt; PgLockedTables s
forall s. PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
forall s b. Integral b =&gt; b -&gt; PgLockedTables s -&gt; PgLockedTables s
stimes :: b -&gt; PgLockedTables s -&gt; PgLockedTables s
$cstimes :: forall s b. Integral b =&gt; b -&gt; PgLockedTables s -&gt; PgLockedTables s
sconcat :: NonEmpty (PgLockedTables s) -&gt; PgLockedTables s
$csconcat :: forall s. NonEmpty (PgLockedTables s) -&gt; PgLockedTables s
&lt;&gt; :: PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
$c&lt;&gt; :: forall s. PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188854"><span id="local-6989586621679188856"><span id="local-6989586621679188858"><span class="annot"><span class="annottext">Semigroup (PgLockedTables s)
PgLockedTables s
Semigroup (PgLockedTables s)
-&gt; PgLockedTables s
-&gt; (PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s)
-&gt; ([PgLockedTables s] -&gt; PgLockedTables s)
-&gt; Monoid (PgLockedTables s)
[PgLockedTables s] -&gt; PgLockedTables s
PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
forall s. Semigroup (PgLockedTables s)
forall s. PgLockedTables s
forall a.
Semigroup a -&gt; a -&gt; (a -&gt; a -&gt; a) -&gt; ([a] -&gt; a) -&gt; Monoid a
forall s. [PgLockedTables s] -&gt; PgLockedTables s
forall s. PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
mconcat :: [PgLockedTables s] -&gt; PgLockedTables s
$cmconcat :: forall s. [PgLockedTables s] -&gt; PgLockedTables s
mappend :: PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
$cmappend :: forall s. PgLockedTables s -&gt; PgLockedTables s -&gt; PgLockedTables s
mempty :: PgLockedTables s
$cmempty :: forall s. PgLockedTables s
$cp1Monoid :: forall s. Semigroup (PgLockedTables s)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monoid</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Combines the result of a query along with a set of locked tables. Used as a</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- return value for the 'lockingFor_' function.</span><span>
</span><span id="line-83"></span><span class="hs-keyword">data</span><span> </span><span id="PgWithLocking"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span></span><span> </span><span id="local-6989586621679189181"><span class="annot"><a href="#local-6989586621679189181"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679189180"><span class="annot"><a href="#local-6989586621679189180"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PgWithLocking"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-type">PgLockedTables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189181"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189180"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-84"></span><span id="local-6989586621679188847"><span id="local-6989586621679188848"><span id="local-6989586621679188849"><span id="local-6989586621679188850"><span id="local-6989586621679188851"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ProjectibleWithPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188851"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188850"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188849"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188848"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ProjectibleWithPredicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188851"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188850"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188849"><span class="hs-identifier hs-type">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188847"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188848"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679188843"><span class="annot"><span class="annottext">project' :: Proxy c
-&gt; Proxy (be, res)
-&gt; (forall context.
    c context =&gt;
    Proxy context -&gt; Proxy be -&gt; res -&gt; m res)
-&gt; PgWithLocking s a
-&gt; m (PgWithLocking s a)
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">project'</span></a></span></span><span> </span><span id="local-6989586621679188841"><span class="annot"><span class="annottext">Proxy c
</span><a href="#local-6989586621679188841"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679188840"><span class="annot"><span class="annottext">Proxy (be, res)
</span><a href="#local-6989586621679188840"><span class="hs-identifier hs-var">be</span></a></span></span><span> </span><span id="local-6989586621679188839"><span class="annot"><span class="annottext">forall context.
c context =&gt;
Proxy context -&gt; Proxy be -&gt; res -&gt; m res
</span><a href="#local-6989586621679188839"><span class="hs-identifier hs-var">mutateM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span id="local-6989586621679188838"><span class="annot"><span class="annottext">PgLockedTables s
</span><a href="#local-6989586621679188838"><span class="hs-identifier hs-var">tbls</span></a></span></span><span> </span><span id="local-6989586621679188837"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188837"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">PgLockedTables s -&gt; a -&gt; PgWithLocking s a
forall s a. PgLockedTables s -&gt; a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span><span> </span><span class="annot"><span class="annottext">PgLockedTables s
</span><a href="#local-6989586621679188838"><span class="hs-identifier hs-var">tbls</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PgWithLocking s a) -&gt; m a -&gt; m (PgWithLocking s a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy c
-&gt; Proxy (be, res)
-&gt; (forall context.
    c context =&gt;
    Proxy context -&gt; Proxy be -&gt; res -&gt; m res)
-&gt; a
-&gt; m a
forall (contextPredicate :: * -&gt; Constraint) be res a
       (m :: * -&gt; *).
(ProjectibleWithPredicate contextPredicate be res a, Monad m) =&gt;
Proxy contextPredicate
-&gt; Proxy (be, res)
-&gt; (forall context.
    contextPredicate context =&gt;
    Proxy context -&gt; Proxy be -&gt; res -&gt; m res)
-&gt; a
-&gt; m a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project'</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy c
</span><a href="#local-6989586621679188841"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (be, res)
</span><a href="#local-6989586621679188840"><span class="hs-identifier hs-var">be</span></a></span><span> </span><span class="annot"><span class="annottext">forall context.
c context =&gt;
Proxy context -&gt; Proxy be -&gt; res -&gt; m res
</span><a href="#local-6989586621679188839"><span class="hs-identifier hs-var">mutateM</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188837"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679188835"><span class="annot"><span class="annottext">projectSkeleton' :: Proxy c
-&gt; Proxy (be, res)
-&gt; (forall context.
    c context =&gt;
    Proxy context -&gt; Proxy be -&gt; m res)
-&gt; m (PgWithLocking s a)
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">projectSkeleton'</span></a></span></span><span> </span><span id="local-6989586621679188833"><span class="annot"><span class="annottext">Proxy c
</span><a href="#local-6989586621679188833"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span id="local-6989586621679188832"><span class="annot"><span class="annottext">Proxy (be, res)
</span><a href="#local-6989586621679188832"><span class="hs-identifier hs-var">be</span></a></span></span><span> </span><span id="local-6989586621679188831"><span class="annot"><span class="annottext">forall context. c context =&gt; Proxy context -&gt; Proxy be -&gt; m res
</span><a href="#local-6989586621679188831"><span class="hs-identifier hs-var">mkM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">PgLockedTables s -&gt; a -&gt; PgWithLocking s a
forall s a. PgLockedTables s -&gt; a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span><span> </span><span class="annot"><span class="annottext">PgLockedTables s
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PgWithLocking s a) -&gt; m a -&gt; m (PgWithLocking s a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy c
-&gt; Proxy (be, res)
-&gt; (forall context.
    c context =&gt;
    Proxy context -&gt; Proxy be -&gt; m res)
-&gt; m a
forall (contextPredicate :: * -&gt; Constraint) be res a
       (m :: * -&gt; *).
(ProjectibleWithPredicate contextPredicate be res a, Monad m) =&gt;
Proxy contextPredicate
-&gt; Proxy (be, res)
-&gt; (forall context.
    contextPredicate context =&gt;
    Proxy context -&gt; Proxy be -&gt; m res)
-&gt; m a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">projectSkeleton'</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy c
</span><a href="#local-6989586621679188833"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy (be, res)
</span><a href="#local-6989586621679188832"><span class="hs-identifier hs-var">be</span></a></span><span> </span><span class="annot"><span class="annottext">forall context. c context =&gt; Proxy context -&gt; Proxy be -&gt; m res
</span><a href="#local-6989586621679188831"><span class="hs-identifier hs-var">mkM</span></a></span></span></span></span></span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Use with 'lockingFor_' to lock all tables mentioned in the query</span><span>
</span><span id="line-92"></span><span id="local-6989586621679189077"><span id="local-6989586621679189078"><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockAll_"><span class="hs-identifier hs-type">lockAll_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679189078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189077"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189078"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-93"></span><span id="lockAll_"><span class="annot"><span class="annottext">lockAll_ :: a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#lockAll_"><span class="hs-identifier hs-var hs-var">lockAll_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgLockedTables s -&gt; a -&gt; PgWithLocking s a
forall s a. PgLockedTables s -&gt; a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span><span> </span><span class="annot"><span class="annottext">PgLockedTables s
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Return and lock the given tables. Typically used as an infix operator. See the</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &lt;https://haskell-beam.github.io/beam/user-guide/backends/beam-postgres/ the user guide&gt; for usage</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- examples</span><span>
</span><span id="line-98"></span><span id="local-6989586621679188829"><span id="local-6989586621679188830"><span class="annot"><a href="Database.Beam.Postgres.Full.html#withLocks_"><span class="hs-identifier hs-type">withLocks_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679188830"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-type">PgLockedTables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188829"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188829"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188830"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-99"></span><span id="withLocks_"><span class="annot"><span class="annottext">withLocks_ :: a -&gt; PgLockedTables s -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#withLocks_"><span class="hs-identifier hs-var hs-var">withLocks_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PgLockedTables s -&gt; a -&gt; PgWithLocking s a)
-&gt; a -&gt; PgLockedTables s -&gt; PgWithLocking s a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">PgLockedTables s -&gt; a -&gt; PgWithLocking s a
forall s a. PgLockedTables s -&gt; a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-var">PgWithLocking</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Join with a table while locking it explicitly. Provides a 'PgLockedTables' value that can be</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- used with 'withLocks_' to explicitly lock a table during a @SELECT@ statement</span><span>
</span><span id="line-103"></span><span id="local-6989586621679188825"><span id="local-6989586621679188826"><span id="local-6989586621679188827"><span class="annot"><a href="Database.Beam.Postgres.Full.html#locked_"><span class="hs-identifier hs-type">locked_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Beamable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188827"><span class="hs-identifier hs-type">tbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Database</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188826"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188826"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188827"><span class="hs-identifier hs-type">tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188826"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188825"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-type">PgLockedTables</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188825"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679188827"><span class="hs-identifier hs-type">tbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188825"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-106"></span><span id="locked_"><span class="annot"><span class="annottext">locked_ :: DatabaseEntity Postgres db (TableEntity tbl)
-&gt; Q Postgres db s (PgLockedTables s, tbl (QExpr Postgres s))
</span><a href="Database.Beam.Postgres.Full.html#locked_"><span class="hs-identifier hs-var hs-var">locked_</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span id="local-6989586621679188823"><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl)
</span><a href="#local-6989586621679188823"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679188822"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188822"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188821"><span class="annot"><span class="annottext">tbl (QExpr Postgres s)
</span><a href="#local-6989586621679188821"><span class="hs-identifier hs-var">joined</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">QM Postgres db s (Text, tbl (QExpr Postgres s))
-&gt; Q Postgres db s (Text, tbl (QExpr Postgres s))
forall be (db :: (* -&gt; *) -&gt; *) s a. QM be db s a -&gt; Q be db s a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QF Postgres db s (Text, tbl (QExpr Postgres s))
-&gt; QM Postgres db s (Text, tbl (QExpr Postgres s))
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; Text -&gt; BeamSqlBackendFromSyntax Postgres)
-&gt; (Text -&gt; tbl (QExpr Postgres s))
-&gt; (tbl (QExpr Postgres s)
    -&gt; Maybe
         (WithExprContext (BeamSqlBackendExpressionSyntax Postgres)))
-&gt; ((Text, tbl (QExpr Postgres s))
    -&gt; (Text, tbl (QExpr Postgres s)))
-&gt; QF Postgres db s (Text, tbl (QExpr Postgres s))
forall be r next (db :: (* -&gt; *) -&gt; *) s.
Projectible be r =&gt;
(Text -&gt; Text -&gt; BeamSqlBackendFromSyntax be)
-&gt; (Text -&gt; r)
-&gt; (r
    -&gt; Maybe (WithExprContext (BeamSqlBackendExpressionSyntax be)))
-&gt; ((Text, r) -&gt; next)
-&gt; QF be db s next
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QAll</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sql92FromTableSourceSyntax PgFromSyntax
-&gt; Maybe (Text, Maybe [Text]) -&gt; PgFromSyntax
forall from.
IsSql92FromSyntax from =&gt;
Sql92FromTableSourceSyntax from
-&gt; Maybe (Text, Maybe [Text]) -&gt; from
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fromTable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92TableSourceTableNameSyntax PgTableSourceSyntax
-&gt; PgTableSourceSyntax
forall tblSource.
IsSql92TableSourceSyntax tblSource =&gt;
Sql92TableSourceTableNameSyntax tblSource -&gt; tblSource
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">tableNamed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; PgTableNameSyntax
forall tblName.
IsSql92TableNameSyntax tblName =&gt;
Maybe Text -&gt; Text -&gt; tblName
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl) -&gt; Maybe Text
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; Maybe Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableSchema</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl)
</span><a href="#local-6989586621679188823"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl) -&gt; Text
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableCurrentName</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl)
</span><a href="#local-6989586621679188823"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Text, Maybe [Text]) -&gt; PgFromSyntax)
-&gt; (Text -&gt; Maybe (Text, Maybe [Text])) -&gt; Text -&gt; PgFromSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span>
</span><span id="line-108"></span><span>                                        </span><span class="annot"><span class="annottext">(Text, Maybe [Text]) -&gt; Maybe (Text, Maybe [Text])
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">((Text, Maybe [Text]) -&gt; Maybe (Text, Maybe [Text]))
-&gt; (Text -&gt; (Text, Maybe [Text]))
-&gt; Text
-&gt; Maybe (Text, Maybe [Text])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Maybe [Text]
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>                                 </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableSettings tbl -&gt; Text -&gt; tbl (QExpr Postgres s)
forall be (table :: (* -&gt; *) -&gt; *) ctxt s.
(BeamSqlBackend be, Beamable table) =&gt;
TableSettings table -&gt; Text -&gt; table (QGenExpr ctxt be s)
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">tableFieldsToExpressions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl)
-&gt; TableSettings tbl
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; TableSettings tbl
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity tbl)
</span><a href="#local-6989586621679188823"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>                                 </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">tbl (QExpr Postgres s)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (WithExprContext (BeamSqlBackendExpressionSyntax Postgres))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text, tbl (QExpr Postgres s)) -&gt; (Text, tbl (QExpr Postgres s))
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">(PgLockedTables s, tbl (QExpr Postgres s))
-&gt; Q Postgres db s (PgLockedTables s, tbl (QExpr Postgres s))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; PgLockedTables s
forall s. [Text] -&gt; PgLockedTables s
</span><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-var">PgLockedTables</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188822"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres s)
</span><a href="#local-6989586621679188821"><span class="hs-identifier hs-var">joined</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Lock some tables during the execution of a query. This is rather complicated, and there are</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- several usage examples in</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &lt;https://haskell-beam.github.io/beam/user-guide/backends/beam-postgres/ the user guide&gt;</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- The Postgres locking clause is rather complex, and beam currently does not check several</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- pre-conditions. It is assumed you kinda know what you're doing.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- Things which postgres doesn't like, but beam will do</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- * Using aggregates within a query that has a locking clause</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- * Using @UNION@, @INTERSECT@, or @EXCEPT@</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">--   See &lt;https://www.postgresql.org/docs/10/static/sql-select.html#SQL-FOR-UPDATE-SHARE here&gt; for</span><span>
</span><span id="line-126"></span><span class="hs-comment">--   more details.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- This function accepts a locking strength (@UPDATE@, @SHARE@, @KEY SHARE@, etc), an optional</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- locking option (@NOWAIT@ or @SKIP LOCKED@), and a query whose rows to lock. The query should</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- return its result wrapped in 'PgWithLocking', via the `withLocks_` or `lockAll_` function.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- If you want to use the most common behavior (lock all rows in every table mentioned), the</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- 'lockingAllTablesFor_' function may be what you're after.</span><span>
</span><span id="line-134"></span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockingFor_"><span class="hs-identifier hs-type">lockingFor_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679189080"><span class="annot"><a href="#local-6989586621679189080"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679189082"><span class="annot"><a href="#local-6989586621679189082"><span class="hs-identifier hs-type">db</span></a></span></span><span> </span><span id="local-6989586621679189079"><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-135"></span><span>             </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Database</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189082"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ThreadRewritable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189080"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingStrength"><span class="hs-identifier hs-type">PgSelectLockingStrength</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingOptions"><span class="hs-identifier hs-type">PgSelectLockingOptions</span></a></span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189082"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189082"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">WithRewrittenThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189080"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span id="lockingFor_"><span class="annot"><span class="annottext">lockingFor_ :: PgSelectLockingStrength
-&gt; Maybe PgSelectLockingOptions
-&gt; Q Postgres db (QNested s) (PgWithLocking (QNested s) a)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s a)
</span><a href="Database.Beam.Postgres.Full.html#lockingFor_"><span class="hs-identifier hs-var hs-var">lockingFor_</span></a></span></span><span> </span><span id="local-6989586621679188808"><span class="annot"><span class="annottext">PgSelectLockingStrength
</span><a href="#local-6989586621679188808"><span class="hs-identifier hs-var">lockStrength</span></a></span></span><span> </span><span id="local-6989586621679188807"><span class="annot"><span class="annottext">Maybe PgSelectLockingOptions
</span><a href="#local-6989586621679188807"><span class="hs-identifier hs-var">mLockOptions</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span id="local-6989586621679188806"><span class="annot"><span class="annottext">QM Postgres db (QNested s) (PgWithLocking (QNested s) a)
</span><a href="#local-6989586621679188806"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">QM Postgres db s (WithRewrittenThread (QNested s) s a)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s a)
forall be (db :: (* -&gt; *) -&gt; *) s a. QM be db s a -&gt; Q be db s a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QF Postgres db s (WithRewrittenThread (QNested s) s a)
-&gt; QM Postgres db s (WithRewrittenThread (QNested s) s a)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgWithLocking (QNested s) a
 -&gt; BeamSqlBackendSelectTableSyntax Postgres
 -&gt; [BeamSqlBackendOrderingSyntax Postgres]
 -&gt; Maybe Integer
 -&gt; Maybe Integer
 -&gt; BeamSqlBackendSelectSyntax Postgres)
-&gt; QM Postgres db (QNested s) (PgWithLocking (QNested s) a)
-&gt; (PgWithLocking (QNested s) a
    -&gt; WithRewrittenThread (QNested s) s a)
-&gt; QF Postgres db s (WithRewrittenThread (QNested s) s a)
forall be r (db :: (* -&gt; *) -&gt; *) s next.
Projectible be r =&gt;
(r
 -&gt; BeamSqlBackendSelectTableSyntax be
 -&gt; [BeamSqlBackendOrderingSyntax be]
 -&gt; Maybe Integer
 -&gt; Maybe Integer
 -&gt; BeamSqlBackendSelectSyntax be)
-&gt; QM be db (QNested s) r -&gt; (r -&gt; next) -&gt; QF be db s next
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QForceSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgLockedTables"><span class="hs-identifier hs-type">PgLockedTables</span></a></span><span> </span><span id="local-6989586621679188804"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679188804"><span class="hs-identifier hs-var">tblNms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188803"><span class="annot"><span class="annottext">BeamSqlBackendSelectTableSyntax Postgres
</span><a href="#local-6989586621679188803"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span id="local-6989586621679188802"><span class="annot"><span class="annottext">[BeamSqlBackendOrderingSyntax Postgres]
</span><a href="#local-6989586621679188802"><span class="hs-identifier hs-var">ords</span></a></span></span><span> </span><span id="local-6989586621679188801"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679188801"><span class="hs-identifier hs-var">limit</span></a></span></span><span> </span><span id="local-6989586621679188800"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679188800"><span class="hs-identifier hs-var">offset</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679188799"><span class="annot"><span class="annottext">locking :: PgSelectLockingClauseSyntax
</span><a href="#local-6989586621679188799"><span class="hs-identifier hs-var hs-var">locking</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgSelectLockingStrength
-&gt; [Text]
-&gt; Maybe PgSelectLockingOptions
-&gt; PgSelectLockingClauseSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingClauseSyntax"><span class="hs-identifier hs-var">PgSelectLockingClauseSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSelectLockingStrength
</span><a href="#local-6989586621679188808"><span class="hs-identifier hs-var">lockStrength</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679188804"><span class="hs-identifier hs-var">tblNms</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PgSelectLockingOptions
</span><a href="#local-6989586621679188807"><span class="hs-identifier hs-var">mLockOptions</span></a></span><span>
</span><span id="line-143"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PgSelectTableSyntax
-&gt; [PgOrderingSyntax]
-&gt; Maybe Integer
-&gt; Maybe Integer
-&gt; Maybe PgSelectLockingClauseSyntax
-&gt; PgSelectSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSelectStmt"><span class="hs-identifier hs-var">pgSelectStmt</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSelectTableSyntax Postgres
PgSelectTableSyntax
</span><a href="#local-6989586621679188803"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">[BeamSqlBackendOrderingSyntax Postgres]
[PgOrderingSyntax]
</span><a href="#local-6989586621679188802"><span class="hs-identifier hs-var">ords</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679188801"><span class="hs-identifier hs-var">limit</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679188800"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgSelectLockingClauseSyntax -&gt; Maybe PgSelectLockingClauseSyntax
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">PgSelectLockingClauseSyntax
</span><a href="#local-6989586621679188799"><span class="hs-identifier hs-var">locking</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>                         </span><span class="annot"><span class="annottext">QM Postgres db (QNested s) (PgWithLocking (QNested s) a)
</span><a href="#local-6989586621679188806"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgWithLocking"><span class="hs-identifier hs-type">PgWithLocking</span></a></span><span> </span><span class="annot"><span class="annottext">PgLockedTables (QNested s)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188796"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188796"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Proxy s -&gt; a -&gt; WithRewrittenThread (QNested s) s a
forall s a s'.
ThreadRewritable s a =&gt;
Proxy s' -&gt; a -&gt; WithRewrittenThread s s' a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">rewriteThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy s
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679189079"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188796"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Like 'lockingFor_', but does not require an explicit set of locked tables. This produces an</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- empty @FOR .. OF@ clause.</span><span>
</span><span id="line-148"></span><span id="local-6989586621679188791"><span id="local-6989586621679188792"><span id="local-6989586621679188793"><span class="annot"><a href="Database.Beam.Postgres.Full.html#lockingAllTablesFor_"><span class="hs-identifier hs-type">lockingAllTablesFor_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Database</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188793"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ThreadRewritable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188791"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188792"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingStrength"><span class="hs-identifier hs-type">PgSelectLockingStrength</span></a></span><span>
</span><span id="line-150"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSelectLockingOptions"><span class="hs-identifier hs-type">PgSelectLockingOptions</span></a></span><span>
</span><span id="line-151"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188793"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188791"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188792"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-152"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188793"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188791"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">WithRewrittenThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188791"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188791"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188792"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-153"></span><span id="lockingAllTablesFor_"><span class="annot"><span class="annottext">lockingAllTablesFor_ :: PgSelectLockingStrength
-&gt; Maybe PgSelectLockingOptions
-&gt; Q Postgres db (QNested s) a
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s a)
</span><a href="Database.Beam.Postgres.Full.html#lockingAllTablesFor_"><span class="hs-identifier hs-var hs-var">lockingAllTablesFor_</span></a></span></span><span> </span><span id="local-6989586621679188790"><span class="annot"><span class="annottext">PgSelectLockingStrength
</span><a href="#local-6989586621679188790"><span class="hs-identifier hs-var">lockStrength</span></a></span></span><span> </span><span id="local-6989586621679188789"><span class="annot"><span class="annottext">Maybe PgSelectLockingOptions
</span><a href="#local-6989586621679188789"><span class="hs-identifier hs-var">mLockOptions</span></a></span></span><span> </span><span id="local-6989586621679188788"><span class="annot"><span class="annottext">Q Postgres db (QNested s) a
</span><a href="#local-6989586621679188788"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>  </span><span class="annot"><span class="annottext">PgSelectLockingStrength
-&gt; Maybe PgSelectLockingOptions
-&gt; Q Postgres db (QNested s) (PgWithLocking (QNested s) a)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s a)
forall a (db :: (* -&gt; *) -&gt; *) s.
(Database Postgres db, Projectible Postgres a,
 ThreadRewritable (QNested s) a) =&gt;
PgSelectLockingStrength
-&gt; Maybe PgSelectLockingOptions
-&gt; Q Postgres db (QNested s) (PgWithLocking (QNested s) a)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s a)
</span><a href="Database.Beam.Postgres.Full.html#lockingFor_"><span class="hs-identifier hs-var">lockingFor_</span></a></span><span> </span><span class="annot"><span class="annottext">PgSelectLockingStrength
</span><a href="#local-6989586621679188790"><span class="hs-identifier hs-var">lockStrength</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe PgSelectLockingOptions
</span><a href="#local-6989586621679188789"><span class="hs-identifier hs-var">mLockOptions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; PgWithLocking (QNested s) a
forall a s. a -&gt; PgWithLocking s a
</span><a href="Database.Beam.Postgres.Full.html#lockAll_"><span class="hs-identifier hs-var">lockAll_</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; PgWithLocking (QNested s) a)
-&gt; Q Postgres db (QNested s) a
-&gt; Q Postgres db (QNested s) (PgWithLocking (QNested s) a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Q Postgres db (QNested s) a
</span><a href="#local-6989586621679188788"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- * @INSERT@</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | The Postgres @DEFAULT VALUES@ clause for the @INSERT@ command.</span><span>
</span><span id="line-159"></span><span id="local-6989586621679188787"><span class="annot"><a href="Database.Beam.Postgres.Full.html#insertDefaults"><span class="hs-identifier hs-type">insertDefaults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsertValues</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188787"><span class="hs-identifier hs-type">tbl</span></a></span></span><span>
</span><span id="line-160"></span><span id="insertDefaults"><span class="annot"><span class="annottext">insertDefaults :: SqlInsertValues Postgres tbl
</span><a href="Database.Beam.Postgres.Full.html#insertDefaults"><span class="hs-identifier hs-var hs-var">insertDefaults</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendInsertValuesSyntax Postgres
-&gt; SqlInsertValues Postgres tbl
forall be proj.
BeamSqlBackendInsertValuesSyntax be -&gt; SqlInsertValues be proj
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlInsertValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertValuesSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertValuesSyntax"><span class="hs-identifier hs-var">PgInsertValuesSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DEFAULT VALUES&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | A @beam-postgres@-specific version of 'Database.Beam.Query.insert', which</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- provides fuller support for the much richer Postgres @INSERT@ syntax. This</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- allows you to specify @ON CONFLICT@ actions. For even more complete support,</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- see 'insertReturning'.</span><span>
</span><span id="line-166"></span><span id="local-6989586621679188903"><span id="local-6989586621679188904"><span id="local-6989586621679188905"><span class="annot"><a href="Database.Beam.Postgres.Full.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188905"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188904"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsertValues</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188904"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188903"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO arbitrary projectibles</span><span>
</span><span id="line-168"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-type">PgInsertOnConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188904"><span class="hs-identifier hs-type">table</span></a></span><span>
</span><span id="line-169"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsert</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188904"><span class="hs-identifier hs-type">table</span></a></span></span></span></span><span>
</span><span id="line-170"></span><span id="insert"><span class="annot"><span class="annottext">insert :: DatabaseEntity Postgres db (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; SqlInsert Postgres table
</span><a href="Database.Beam.Postgres.Full.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679188783"><span class="annot"><span class="annottext">tbl :: DatabaseEntity Postgres db (TableEntity table)
</span><a href="#local-6989586621679188783"><span class="hs-identifier hs-var">tbl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span id="local-6989586621679188782"><span class="annot"><span class="annottext">dt :: DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188782"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseTable</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188780"><span class="annot"><span class="annottext">SqlInsertValues Postgres (table (QExpr Postgres s))
</span><a href="#local-6989586621679188780"><span class="hs-identifier hs-var">values</span></a></span></span><span> </span><span id="local-6989586621679188779"><span class="annot"><span class="annottext">PgInsertOnConflict table
</span><a href="#local-6989586621679188779"><span class="hs-identifier hs-var">onConflict_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres db (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; Maybe
     (table (QExpr Postgres PostgresInaccessible)
      -&gt; QExpr Postgres PostgresInaccessible Int)
-&gt; PgInsertReturning
     (QExprToIdentity (QExpr Postgres PostgresInaccessible Int))
forall a (be :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
Projectible Postgres a =&gt;
DatabaseEntity Postgres be (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgInsertReturning (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#insertReturning"><span class="hs-identifier hs-var">insertReturning</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres db (TableEntity table)
</span><a href="#local-6989586621679188783"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">SqlInsertValues Postgres (table (QExpr Postgres s))
</span><a href="#local-6989586621679188780"><span class="hs-identifier hs-var">values</span></a></span><span> </span><span class="annot"><span class="annottext">PgInsertOnConflict table
</span><a href="#local-6989586621679188779"><span class="hs-identifier hs-var">onConflict_</span></a></span><span>
</span><span id="line-172"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679188778"><span class="annot"><span class="annottext">forall a. Maybe a
forall (table :: (* -&gt; *) -&gt; *).
Maybe
  (table (QExpr Postgres PostgresInaccessible)
   -&gt; QExpr Postgres PostgresInaccessible Int)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188778"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span> </span><span id="local-6989586621679188776"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188776"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">TableSettings table
-&gt; BeamSqlBackendInsertSyntax Postgres -&gt; SqlInsert Postgres table
forall be (table :: (* -&gt; *) -&gt; *).
TableSettings table
-&gt; BeamSqlBackendInsertSyntax be -&gt; SqlInsert be table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlInsert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
-&gt; TableSettings table
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; TableSettings tbl
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188782"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertSyntax"><span class="hs-identifier hs-var">PgInsertSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188776"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">PgInsertReturning
  (QExprToIdentity (QExpr Postgres PostgresInaccessible Int))
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">SqlInsert Postgres table
forall be (table :: (* -&gt; *) -&gt; *). SqlInsert be table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlInsertNoRows</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | The most general kind of @INSERT@ that postgres can perform</span><span>
</span><span id="line-179"></span><span class="hs-keyword">data</span><span> </span><span id="PgInsertReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-var">PgInsertReturning</span></a></span></span><span> </span><span id="local-6989586621679189047"><span class="annot"><a href="#local-6989586621679189047"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PgInsertReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-var">PgInsertReturning</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PgInsertReturningEmpty"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | The full Postgres @INSERT@ syntax, supporting conflict actions and the</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- @RETURNING CLAUSE@. See 'PgInsertOnConflict' for how to specify a conflict</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- action or provide 'onConflictDefault' to preserve the behavior without any</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- @ON CONFLICT@ clause. The last argument takes a newly inserted row and</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- returns the expression to be returned as part of the @RETURNING@ clause. For</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- a backend-agnostic version of this functionality see</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- 'MonadBeamInsertReturning'. Use 'runInsertReturning' to get the results.</span><span>
</span><span id="line-190"></span><span id="local-6989586621679189057"><span id="local-6989586621679189058"><span id="local-6989586621679189059"><span id="local-6989586621679189060"><span class="annot"><a href="Database.Beam.Postgres.Full.html#insertReturning"><span class="hs-identifier hs-type">insertReturning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189060"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-191"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189059"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189058"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsertValues</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679189058"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189057"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-type">PgInsertOnConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189058"><span class="hs-identifier hs-type">table</span></a></span><span>
</span><span id="line-194"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679189058"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679189060"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExprToIdentity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189060"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span id="insertReturning"><span class="annot"><span class="annottext">insertReturning :: DatabaseEntity Postgres be (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgInsertReturning (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#insertReturning"><span class="hs-identifier hs-var hs-var">insertReturning</span></a></span></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres be (TableEntity table)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SqlInsertValues Postgres (table (QExpr Postgres s))
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlInsertValuesEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">PgInsertOnConflict table
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgInsertReturning (QExprToIdentity a)
forall a. PgInsertReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span><span>
</span><span id="line-198"></span><span class="annot"><a href="Database.Beam.Postgres.Full.html#insertReturning"><span class="hs-identifier hs-var">insertReturning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span id="local-6989586621679188770"><span class="annot"><span class="annottext">tbl :: DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">tbl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseTable</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsertValues</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgInsertValuesSyntax"><span class="hs-identifier hs-type">PgInsertValuesSyntax</span></a></span><span> </span><span id="local-6989586621679188769"><span class="annot"><a href="#local-6989586621679188769"><span class="hs-identifier hs-var">insertValues_</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-type">PgInsertOnConflict</span></a></span><span> </span><span id="local-6989586621679188767"><span class="annot"><span class="annottext">table (QField QInternal) -&gt; PgInsertOnConflictSyntax
</span><a href="#local-6989586621679188767"><span class="hs-identifier hs-var">mkOnConflict</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                </span><span id="local-6989586621679188766"><span class="annot"><span class="annottext">Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
</span><a href="#local-6989586621679188766"><span class="hs-identifier hs-var">mMkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgInsertReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-var">PgInsertReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgInsertReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;INSERT INTO &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgTableNameSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgTableName"><span class="hs-identifier hs-var hs-var">fromPgTableName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Text -&gt; Text -&gt; PgTableNameSyntax
forall tblName.
IsSql92TableNameSyntax tblName =&gt;
Maybe Text -&gt; Text -&gt; tblName
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">tableName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table) -&gt; Maybe Text
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; Maybe Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableSchema</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table) -&gt; Text
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableCurrentName</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall a. Columnar' (TableField table) a -&gt; PgSyntax)
-&gt; table (TableField table) -&gt; [PgSyntax]
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) b.
Beamable table =&gt;
(forall a. Columnar' f a -&gt; b) -&gt; table f -&gt; [b]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">allBeamValues</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188761"><span class="annot"><span class="annottext">Columnar (TableField table) a
</span><a href="#local-6989586621679188761"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgQuotedIdentifier"><span class="hs-identifier hs-var">pgQuotedIdentifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableField table a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField table) a
TableField table a
</span><a href="#local-6989586621679188761"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">table (TableField table)
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var">tblSettings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;) &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188769"><span class="hs-identifier hs-var">insertValues_</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgInsertOnConflictSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgInsertOnConflict"><span class="hs-identifier hs-var hs-var">fromPgInsertOnConflict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QField QInternal) -&gt; PgInsertOnConflictSyntax
</span><a href="#local-6989586621679188767"><span class="hs-identifier hs-var">mkOnConflict</span></a></span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188756"><span class="hs-identifier hs-var">tblFields</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">(</span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
</span><a href="#local-6989586621679188766"><span class="hs-identifier hs-var">mMkProjection</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>     </span><span class="annot"><span class="annottext">Maybe (table (QExpr Postgres PostgresInaccessible) -&gt; a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgSyntax
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-208"></span><span>     </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679188755"><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188755"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>         </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-210"></span><span>         </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188755"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188752"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>     </span><span id="local-6989586621679188752"><span class="annot"><span class="annottext">tblQ :: table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188752"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField table) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; table (TableField table)
-&gt; table (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188750"><span class="annot"><span class="annottext">Columnar (TableField table) a
</span><a href="#local-6989586621679188750"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableField table a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField table) a
TableField table a
</span><a href="#local-6989586621679188750"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">table (TableField table)
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-213"></span><span>     </span><span id="local-6989586621679188756"><span class="annot"><span class="annottext">tblFields :: table (QField QInternal)
</span><a href="#local-6989586621679188756"><span class="hs-identifier hs-var hs-var">tblFields</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField table) a -&gt; Columnar' (QField QInternal) a)
-&gt; table (TableField table) -&gt; table (QField QInternal)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188746"><span class="annot"><span class="annottext">Columnar (TableField table) a
</span><a href="#local-6989586621679188746"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QField QInternal) a -&gt; Columnar' (QField QInternal) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Text -&gt; Text -&gt; QField QInternal a
forall s ty. Bool -&gt; Text -&gt; Text -&gt; QField s ty
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QField</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table) -&gt; Text
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableCurrentName</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableField table a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField table) a
TableField table a
</span><a href="#local-6989586621679188746"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">table (TableField table)
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>     </span><span id="local-6989586621679188758"><span class="annot"><span class="annottext">tblSettings :: table (TableField table)
</span><a href="#local-6989586621679188758"><span class="hs-identifier hs-var hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
-&gt; table (TableField table)
forall be (tbl :: (* -&gt; *) -&gt; *).
DatabaseEntityDescriptor be (TableEntity tbl) -&gt; TableSettings tbl
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">dbTableSettings</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntityDescriptor Postgres (TableEntity table)
</span><a href="#local-6989586621679188770"><span class="hs-identifier hs-var">tbl</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679188742"><span id="local-6989586621679188743"><span id="local-6989586621679188744"><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgInsertReturningList"><span class="hs-identifier hs-type">runPgInsertReturningList</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188744"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188743"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-219"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188744"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span>
</span><span id="line-220"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188744"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188742"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-221"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188742"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188743"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679188742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-224"></span><span id="runPgInsertReturningList"><span class="annot"><span class="annottext">runPgInsertReturningList :: PgInsertReturning a -&gt; m [a]
</span><a href="Database.Beam.Postgres.Full.html#runPgInsertReturningList"><span class="hs-identifier hs-var hs-var">runPgInsertReturningList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">PgInsertReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span> </span><span id="local-6989586621679188741"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188741"><span class="hs-identifier hs-var">syntax</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m [a]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamSqlBackendSyntax be -&gt; m [a])
-&gt; BeamSqlBackendSyntax be -&gt; m [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188741"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- ** @ON CONFLICT@ clause</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | What to do when an @INSERT@ statement inserts a row into the table @tbl@</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- that violates a constraint.</span><span>
</span><span id="line-232"></span><span class="hs-keyword">newtype</span><span> </span><span id="PgInsertOnConflict"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-var">PgInsertOnConflict</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188987"><span class="annot"><a href="#local-6989586621679188987"><span class="hs-identifier hs-type">tbl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>    </span><span id="PgInsertOnConflict"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-var">PgInsertOnConflict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188987"><span class="hs-identifier hs-type">tbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QInternal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictSyntax"><span class="hs-identifier hs-type">PgInsertOnConflictSyntax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Postgres @LATERAL JOIN@ support</span><span>
</span><span id="line-236"></span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- Allows the use of variables introduced on the left side of a @JOIN@ to be used on the right hand</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- side.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- Because of the default scoping rules, we can't use the typical monadic bind (@&gt;&gt;=@) operator to</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- create this join.</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Instead, 'lateral_'  takes two  arguments. The first  is the  left hand side  of the  @JOIN@. The</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- second is a function that  takes the result of the first join and  uses those variables to create</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- the right hand side.</span><span>
</span><span id="line-246"></span><span class="hs-comment">--</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- For example, to join table A with a subquery that returns the first three rows in B which matches</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- a column in A, ordered by another column in B:</span><span>
</span><span id="line-249"></span><span class="hs-comment">--</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- &gt; lateral_ (_tableA database) $ \tblA -&gt;</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- &gt;   limit_ 3 $</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- &gt;   ordering_ (\(_, b) -&gt; asc_ (_bField2 b)) $ do</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- &gt;     b &lt;- _tableB database</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- &gt;     guard_ (_bField1 b ==. _aField1 a)</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &gt;     pure (a, b0</span><span>
</span><span id="line-256"></span><span class="annot"><a href="Database.Beam.Postgres.Full.html#lateral_"><span class="hs-identifier hs-type">lateral_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188737"><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679188736"><span class="annot"><a href="#local-6989586621679188736"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679188735"><span class="annot"><a href="#local-6989586621679188735"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679188734"><span class="annot"><a href="#local-6989586621679188734"><span class="hs-identifier hs-type">db</span></a></span></span><span>
</span><span id="line-257"></span><span>          </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ThreadRewritable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188736"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ThreadRewritable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188735"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188735"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">WithRewrittenThread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188736"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188734"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188735"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188734"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">WithRewrittenThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188735"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span id="lateral_"><span class="annot"><span class="annottext">lateral_ :: a
-&gt; (WithRewrittenThread s (QNested s) a
    -&gt; Q Postgres db (QNested s) b)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s b)
</span><a href="Database.Beam.Postgres.Full.html#lateral_"><span class="hs-identifier hs-var hs-var">lateral_</span></a></span></span><span> </span><span id="local-6989586621679188733"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188733"><span class="hs-identifier hs-var">using</span></a></span></span><span> </span><span id="local-6989586621679188732"><span class="annot"><span class="annottext">WithRewrittenThread s (QNested s) a -&gt; Q Postgres db (QNested s) b
</span><a href="#local-6989586621679188732"><span class="hs-identifier hs-var">mkSubquery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Q</span></a></span><span> </span><span id="local-6989586621679188731"><span class="annot"><span class="annottext">QM Postgres db (QNested s) b
</span><a href="#local-6989586621679188731"><span class="hs-identifier hs-var">subquery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WithRewrittenThread s (QNested s) a -&gt; Q Postgres db (QNested s) b
</span><a href="#local-6989586621679188732"><span class="hs-identifier hs-var">mkSubquery</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (QNested s) -&gt; a -&gt; WithRewrittenThread s (QNested s) a
forall s a s'.
ThreadRewritable s a =&gt;
Proxy s' -&gt; a -&gt; WithRewrittenThread s s' a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">rewriteThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy (QNested s)
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QNested</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679188733"><span class="hs-identifier hs-var">using</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">QM Postgres db s (WithRewrittenThread (QNested s) s b)
-&gt; Q Postgres db s (WithRewrittenThread (QNested s) s b)
forall be (db :: (* -&gt; *) -&gt; *) s a. QM be db s a -&gt; Q be db s a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Q</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QF Postgres db s (WithRewrittenThread (QNested s) s b)
-&gt; QM Postgres db s (WithRewrittenThread (QNested s) s b)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QM Postgres db (QNested s) b
-&gt; Text
-&gt; (BeamSqlBackendFromSyntax Postgres
    -&gt; BeamSqlBackendFromSyntax Postgres
    -&gt; Maybe (BeamSqlBackendExpressionSyntax Postgres)
    -&gt; BeamSqlBackendFromSyntax Postgres)
-&gt; (b
    -&gt; Maybe
         (WithExprContext (BeamSqlBackendExpressionSyntax Postgres)))
-&gt; (b -&gt; WithRewrittenThread (QNested s) s b)
-&gt; QF Postgres db s (WithRewrittenThread (QNested s) s b)
forall be r (db :: (* -&gt; *) -&gt; *) s next.
Projectible be r =&gt;
QM be db (QNested s) r
-&gt; Text
-&gt; (BeamSqlBackendFromSyntax be
    -&gt; BeamSqlBackendFromSyntax be
    -&gt; Maybe (BeamSqlBackendExpressionSyntax be)
    -&gt; BeamSqlBackendFromSyntax be)
-&gt; (r
    -&gt; Maybe (WithExprContext (BeamSqlBackendExpressionSyntax be)))
-&gt; (r -&gt; next)
-&gt; QF be db s next
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QArbitraryJoin</span></a></span><span> </span><span class="annot"><span class="annottext">QM Postgres db (QNested s) b
</span><a href="#local-6989586621679188731"><span class="hs-identifier hs-var">subquery</span></a></span><span>
</span><span id="line-263"></span><span>                           </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;lat_&quot;</span></span><span>
</span><span id="line-264"></span><span>                           </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679188729"><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
</span><a href="#local-6989586621679188729"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679188728"><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
</span><a href="#local-6989586621679188728"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679188727"><span class="annot"><span class="annottext">Maybe (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188727"><span class="hs-identifier hs-var">on'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>                              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188727"><span class="hs-identifier hs-var">on'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-266"></span><span>                                </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>                                  </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgFromSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgFromSyntax"><span class="hs-identifier hs-var">PgFromSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgFromSyntax) -&gt; PgSyntax -&gt; PgFromSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-268"></span><span>                                  </span><span class="annot"><span class="annottext">PgFromSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFrom"><span class="hs-identifier hs-var hs-var">fromPgFrom</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
PgFromSyntax
</span><a href="#local-6989586621679188729"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; CROSS JOIN LATERAL &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgFromSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFrom"><span class="hs-identifier hs-var hs-var">fromPgFrom</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
PgFromSyntax
</span><a href="#local-6989586621679188728"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-269"></span><span>                                </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679188724"><span class="annot"><span class="annottext">BeamSqlBackendExpressionSyntax Postgres
</span><a href="#local-6989586621679188724"><span class="hs-identifier hs-var">on''</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>                                  </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgFromSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgFromSyntax"><span class="hs-identifier hs-var">PgFromSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgFromSyntax) -&gt; PgSyntax -&gt; PgFromSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-271"></span><span>                                  </span><span class="annot"><span class="annottext">PgFromSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFrom"><span class="hs-identifier hs-var hs-var">fromPgFrom</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
PgFromSyntax
</span><a href="#local-6989586621679188729"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; JOIN LATERAL &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgFromSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFrom"><span class="hs-identifier hs-var hs-var">fromPgFrom</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendFromSyntax Postgres
PgFromSyntax
</span><a href="#local-6989586621679188728"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; ON &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendExpressionSyntax Postgres
PgExpressionSyntax
</span><a href="#local-6989586621679188724"><span class="hs-identifier hs-var">on''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>                           </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (WithExprContext (BeamSqlBackendExpressionSyntax Postgres))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy s -&gt; b -&gt; WithRewrittenThread (QNested s) s b
forall s a s'.
ThreadRewritable s a =&gt;
Proxy s' -&gt; a -&gt; WithRewrittenThread s s' a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">rewriteThread</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy s
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679188737"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | By default, Postgres will throw an error when a conflict is detected. This</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- preserves that functionality.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679188723"><span class="annot"><a href="Database.Beam.Postgres.Full.html#onConflictDefault"><span class="hs-identifier hs-type">onConflictDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-type">PgInsertOnConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188723"><span class="hs-identifier hs-type">tbl</span></a></span></span><span>
</span><span id="line-278"></span><span id="onConflictDefault"><span class="annot"><span class="annottext">onConflictDefault :: PgInsertOnConflict tbl
</span><a href="Database.Beam.Postgres.Full.html#onConflictDefault"><span class="hs-identifier hs-var hs-var">onConflictDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
-&gt; PgInsertOnConflict tbl
forall (tbl :: (* -&gt; *) -&gt; *).
(tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
-&gt; PgInsertOnConflict tbl
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-var">PgInsertOnConflict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">tbl (QField QInternal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | Tells postgres what to do on an @INSERT@ conflict. The first argument is</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- the type of conflict to provide an action for. For example, to only provide</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- an action for certain fields, use 'conflictingFields'. Or to only provide an</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- action over certain fields where a particular condition is met, use</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- 'conflictingFields'. If you have a particular constraint violation in mind,</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- use 'conflictingConstraint'. To perform an action on any conflict, use</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- 'anyConflict'.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- See the</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- &lt;https://www.postgresql.org/docs/current/static/sql-insert.html Postgres documentation&gt;.</span><span>
</span><span id="line-290"></span><span id="local-6989586621679188902"><span class="annot"><a href="Database.Beam.Postgres.Full.html#onConflict"><span class="hs-identifier hs-type">onConflict</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Beamable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188902"><span class="hs-identifier hs-type">tbl</span></a></span><span>
</span><span id="line-291"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlConflictTarget</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188902"><span class="hs-identifier hs-type">tbl</span></a></span><span>
</span><span id="line-292"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlConflictAction</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188902"><span class="hs-identifier hs-type">tbl</span></a></span><span>
</span><span id="line-293"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-type">PgInsertOnConflict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188902"><span class="hs-identifier hs-type">tbl</span></a></span></span><span>
</span><span id="line-294"></span><span id="onConflict"><span class="annot"><span class="annottext">onConflict :: SqlConflictTarget Postgres tbl
-&gt; SqlConflictAction Postgres tbl -&gt; PgInsertOnConflict tbl
</span><a href="Database.Beam.Postgres.Full.html#onConflict"><span class="hs-identifier hs-var hs-var">onConflict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-type">PgInsertOnConflictTarget</span></a></span><span> </span><span id="local-6989586621679188720"><span class="annot"><a href="#local-6989586621679188720"><span class="hs-identifier hs-var">tgt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgConflictAction"><span class="hs-identifier hs-type">PgConflictAction</span></a></span><span> </span><span id="local-6989586621679188718"><span class="annot"><a href="#local-6989586621679188718"><span class="hs-identifier hs-var">update_</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><span class="annottext">(tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
-&gt; PgInsertOnConflict tbl
forall (tbl :: (* -&gt; *) -&gt; *).
(tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
-&gt; PgInsertOnConflict tbl
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflict"><span class="hs-identifier hs-var">PgInsertOnConflict</span></a></span><span> </span><span class="annot"><span class="annottext">((tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
 -&gt; PgInsertOnConflict tbl)
-&gt; (tbl (QField QInternal) -&gt; PgInsertOnConflictSyntax)
-&gt; PgInsertOnConflict tbl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188717"><span class="annot"><span class="annottext">tbl (QField QInternal)
</span><a href="#local-6989586621679188717"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679188716"><span class="annot"><span class="annottext">exprTbl :: tbl (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188716"><span class="hs-identifier hs-var hs-var">exprTbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QField QInternal) a
 -&gt; Columnar' (QExpr Postgres QInternal) a)
-&gt; tbl (QField QInternal) -&gt; tbl (QExpr Postgres QInternal)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188715"><span class="annot"><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>                                 </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres QInternal) a
-&gt; Columnar' (QExpr Postgres QInternal) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres QInternal a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188715"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                              </span><span class="annot"><span class="annottext">tbl (QField QInternal)
</span><a href="#local-6989586621679188717"><span class="hs-identifier hs-var">tbl</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertOnConflictSyntax)
-&gt; PgSyntax -&gt; PgInsertOnConflictSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-300"></span><span>     </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;ON CONFLICT &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgInsertOnConflictTargetSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgInsertOnConflictTarget"><span class="hs-identifier hs-var hs-var">fromPgInsertOnConflictTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tbl (QExpr Postgres QInternal) -&gt; PgInsertOnConflictTargetSyntax
</span><a href="#local-6989586621679188720"><span class="hs-identifier hs-var">tgt</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188716"><span class="hs-identifier hs-var">exprTbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                         </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgConflictActionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgConflictAction"><span class="hs-identifier hs-var hs-var">fromPgConflictAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tbl (QField QInternal) -&gt; PgConflictActionSyntax
</span><a href="#local-6989586621679188718"><span class="hs-identifier hs-var">update_</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QField QInternal)
</span><a href="#local-6989586621679188717"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Perform the action only if the given named constraint is violated</span><span>
</span><span id="line-304"></span><span id="local-6989586621679188712"><span class="annot"><a href="Database.Beam.Postgres.Full.html#conflictingConstraint"><span class="hs-identifier hs-type">conflictingConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">T.Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlConflictTarget</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188712"><span class="hs-identifier hs-type">tbl</span></a></span></span><span>
</span><span id="line-305"></span><span id="conflictingConstraint"><span class="annot"><span class="annottext">conflictingConstraint :: Text -&gt; SqlConflictTarget Postgres tbl
</span><a href="Database.Beam.Postgres.Full.html#conflictingConstraint"><span class="hs-identifier hs-var hs-var">conflictingConstraint</span></a></span></span><span> </span><span id="local-6989586621679188711"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188711"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><span class="annottext">(tbl (QExpr Postgres QInternal) -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres tbl
forall (table :: (* -&gt; *) -&gt; *).
(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-var">PgInsertOnConflictTarget</span></a></span><span> </span><span class="annot"><span class="annottext">((tbl (QExpr Postgres QInternal) -&gt; PgInsertOnConflictTargetSyntax)
 -&gt; SqlConflictTarget Postgres tbl)
-&gt; (tbl (QExpr Postgres QInternal)
    -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres tbl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">tbl (QExpr Postgres QInternal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>  </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictTargetSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictTargetSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictTargetSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertOnConflictTargetSyntax)
-&gt; PgSyntax -&gt; PgInsertOnConflictTargetSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;ON CONSTRAINT &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgQuotedIdentifier"><span class="hs-identifier hs-var">pgQuotedIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188711"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- * @UPDATE@</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">-- | The most general kind of @UPDATE@ that postgres can perform</span><span>
</span><span id="line-313"></span><span class="hs-comment">--</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- You can build this from a 'SqlUpdate' by using 'returning'</span><span>
</span><span id="line-315"></span><span class="hs-comment">--</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- &gt; update tbl where `returning` projection</span><span>
</span><span id="line-317"></span><span class="hs-comment">--</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- Run the result with 'runPgUpdateReturningList'</span><span>
</span><span id="line-319"></span><span class="hs-keyword">data</span><span> </span><span id="PgUpdateReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-var">PgUpdateReturning</span></a></span></span><span> </span><span id="local-6989586621679188964"><span class="annot"><a href="#local-6989586621679188964"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PgUpdateReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-var">PgUpdateReturning</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PgUpdateReturningEmpty"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturningEmpty"><span class="hs-identifier hs-var">PgUpdateReturningEmpty</span></a></span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | Postgres @UPDATE ... RETURNING@ statement support. The last</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- argument takes the newly inserted row and returns the values to be</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- returned. Use 'runUpdateReturning' to get the results.</span><span>
</span><span id="line-326"></span><span id="local-6989586621679188705"><span id="local-6989586621679188706"><span id="local-6989586621679188707"><span class="annot"><a href="Database.Beam.Postgres.Full.html#updateReturning"><span class="hs-identifier hs-type">updateReturning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188707"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-327"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188706"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188705"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188976"><span class="annot"><a href="#local-6989586621679188976"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679188705"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188976"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QAssignment</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188976"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188974"><span class="annot"><a href="#local-6989586621679188974"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679188705"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188974"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188974"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188705"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-type">PgUpdateReturning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExprToIdentity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188707"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-332"></span><span id="updateReturning"><span class="annot"><span class="annottext">updateReturning :: DatabaseEntity Postgres be (TableEntity table)
-&gt; (forall s. table (QField s) -&gt; QAssignment Postgres s)
-&gt; (forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool)
-&gt; (table (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgUpdateReturning (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#updateReturning"><span class="hs-identifier hs-var hs-var">updateReturning</span></a></span></span><span> </span><span id="local-6989586621679188704"><span class="annot"><span class="annottext">table :: DatabaseEntity Postgres be (TableEntity table)
</span><a href="#local-6989586621679188704"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseTable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">dbTableSettings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679188703"><span class="annot"><a href="#local-6989586621679188703"><span class="hs-identifier hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>                </span><span id="local-6989586621679188702"><span class="annot"><span class="annottext">forall s. table (QField s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188702"><span class="hs-identifier hs-var">mkAssignments</span></a></span></span><span>
</span><span id="line-334"></span><span>                </span><span id="local-6989586621679188701"><span class="annot"><span class="annottext">forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188701"><span class="hs-identifier hs-var">mkWhere</span></a></span></span><span>
</span><span id="line-335"></span><span>                </span><span id="local-6989586621679188700"><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188700"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres be (TableEntity table)
-&gt; (forall s. table (QField s) -&gt; QAssignment Postgres s)
-&gt; (forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool)
-&gt; SqlUpdate Postgres table
forall be (table :: (* -&gt; *) -&gt; *) (db :: (* -&gt; *) -&gt; *).
(BeamSqlBackend be, Beamable table) =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. table (QField s) -&gt; QAssignment be s)
-&gt; (forall s. table (QExpr be s) -&gt; QExpr be s Bool)
-&gt; SqlUpdate be table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres be (TableEntity table)
</span><a href="#local-6989586621679188704"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. table (QField s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188702"><span class="hs-identifier hs-var">mkAssignments</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188701"><span class="hs-identifier hs-var">mkWhere</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">TableSettings table
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188697"><span class="annot"><span class="annottext">BeamSqlBackendUpdateSyntax Postgres
</span><a href="#local-6989586621679188697"><span class="hs-identifier hs-var">pgUpdate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgUpdateReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-var">PgUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">PgUpdateSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgUpdate"><span class="hs-identifier hs-var hs-var">fromPgUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendUpdateSyntax Postgres
PgUpdateSyntax
</span><a href="#local-6989586621679188697"><span class="hs-identifier hs-var">pgUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-341"></span><span>      </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188700"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188695"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">SqlUpdate Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlIdentityUpdate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgUpdateReturning (QExprToIdentity a)
forall a. PgUpdateReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturningEmpty"><span class="hs-identifier hs-var">PgUpdateReturningEmpty</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679188695"><span class="annot"><span class="annottext">tblQ :: table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188695"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField table) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; TableSettings table
-&gt; table (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188693"><span class="annot"><span class="annottext">Columnar (TableField table) a
</span><a href="#local-6989586621679188693"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableField table a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField table) a
TableField table a
</span><a href="#local-6989586621679188693"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableSettings table
</span><a href="#local-6989586621679188703"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span id="local-6989586621679188690"><span id="local-6989586621679188691"><span id="local-6989586621679188692"><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgUpdateReturningList"><span class="hs-identifier hs-type">runPgUpdateReturningList</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188692"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188691"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-349"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188692"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span>
</span><span id="line-350"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188692"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188690"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-351"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-type">PgUpdateReturning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188690"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188691"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679188690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-354"></span><span id="runPgUpdateReturningList"><span class="annot"><span class="annottext">runPgUpdateReturningList :: PgUpdateReturning a -&gt; m [a]
</span><a href="Database.Beam.Postgres.Full.html#runPgUpdateReturningList"><span class="hs-identifier hs-var hs-var">runPgUpdateReturningList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-355"></span><span>  </span><span class="annot"><span class="annottext">PgUpdateReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturningEmpty"><span class="hs-identifier hs-var">PgUpdateReturningEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-type">PgUpdateReturning</span></a></span><span> </span><span id="local-6989586621679188689"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188689"><span class="hs-identifier hs-var">syntax</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m [a]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamSqlBackendSyntax be -&gt; m [a])
-&gt; BeamSqlBackendSyntax be -&gt; m [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188689"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- * @DELETE@</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | The most general kind of @DELETE@ that postgres can perform</span><span>
</span><span id="line-361"></span><span class="hs-comment">--</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- You can build this from a 'SqlDelete' by using 'returning'</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- &gt; delete tbl where `returning` projection</span><span>
</span><span id="line-365"></span><span class="hs-comment">--</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- Run the result with 'runPgDeleteReturningList'</span><span>
</span><span id="line-367"></span><span class="hs-keyword">newtype</span><span> </span><span id="PgDeleteReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-var">PgDeleteReturning</span></a></span></span><span> </span><span id="local-6989586621679188953"><span class="annot"><a href="#local-6989586621679188953"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PgDeleteReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-var">PgDeleteReturning</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- | Postgres @DELETE ... RETURNING@ statement support. The last</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- argument takes the newly inserted row and returns the values to be</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- returned. Use 'runDeleteReturning' to get the results.</span><span>
</span><span id="line-372"></span><span id="local-6989586621679188685"><span id="local-6989586621679188686"><span id="local-6989586621679188687"><span class="annot"><a href="Database.Beam.Postgres.Full.html#deleteReturning"><span class="hs-identifier hs-type">deleteReturning</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188687"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188686"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">TableEntity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188685"><span class="hs-identifier hs-type">table</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679188956"><span class="annot"><a href="#local-6989586621679188956"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679188685"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188956"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188956"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188685"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188687"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-type">PgDeleteReturning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExprToIdentity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188687"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-377"></span><span id="deleteReturning"><span class="annot"><span class="annottext">deleteReturning :: DatabaseEntity Postgres be (TableEntity table)
-&gt; (forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool)
-&gt; (table (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgDeleteReturning (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#deleteReturning"><span class="hs-identifier hs-var hs-var">deleteReturning</span></a></span></span><span> </span><span id="local-6989586621679188684"><span class="annot"><span class="annottext">table :: DatabaseEntity Postgres be (TableEntity table)
</span><a href="#local-6989586621679188684"><span class="hs-identifier hs-var">table</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseEntity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">DatabaseTable</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">dbTableSettings</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679188683"><span class="annot"><a href="#local-6989586621679188683"><span class="hs-identifier hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>                </span><span id="local-6989586621679188682"><span class="annot"><span class="annottext">forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188682"><span class="hs-identifier hs-var">mkWhere</span></a></span></span><span>
</span><span id="line-379"></span><span>                </span><span id="local-6989586621679188681"><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188681"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgDeleteReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-var">PgDeleteReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">PgDeleteSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgDelete"><span class="hs-identifier hs-var hs-var">fromPgDelete</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendDeleteSyntax Postgres
PgDeleteSyntax
</span><a href="#local-6989586621679188679"><span class="hs-identifier hs-var">pgDelete</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188681"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188678"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlDelete</span></a></span><span> </span><span class="annot"><span class="annottext">TableSettings table
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188679"><span class="annot"><span class="annottext">BeamSqlBackendDeleteSyntax Postgres
</span><a href="#local-6989586621679188679"><span class="hs-identifier hs-var">pgDelete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres be (TableEntity table)
-&gt; (forall s.
    (forall s'. table (QExpr Postgres s')) -&gt; QExpr Postgres s Bool)
-&gt; SqlDelete Postgres table
forall be (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *).
BeamSqlBackend be =&gt;
DatabaseEntity be db (TableEntity table)
-&gt; (forall s. (forall s'. table (QExpr be s')) -&gt; QExpr be s Bool)
-&gt; SqlDelete be table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres be (TableEntity table)
</span><a href="#local-6989586621679188684"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s.
  (forall s'. table (QExpr Postgres s')) -&gt; QExpr Postgres s Bool)
 -&gt; SqlDelete Postgres table)
-&gt; (forall s.
    (forall s'. table (QExpr Postgres s')) -&gt; QExpr Postgres s Bool)
-&gt; SqlDelete Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188675"><span class="annot"><span class="annottext">forall s'. table (QExpr Postgres s')
</span><a href="#local-6989586621679188675"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188682"><span class="hs-identifier hs-var">mkWhere</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres s)
forall s'. table (QExpr Postgres s')
</span><a href="#local-6989586621679188675"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span id="local-6989586621679188678"><span class="annot"><span class="annottext">tblQ :: table (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188678"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField table) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; TableSettings table
-&gt; table (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188674"><span class="annot"><span class="annottext">Columnar (TableField table) a
</span><a href="#local-6989586621679188674"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableField table a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField table) a
TableField table a
</span><a href="#local-6989586621679188674"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableSettings table
</span><a href="#local-6989586621679188683"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span id="local-6989586621679188671"><span id="local-6989586621679188672"><span id="local-6989586621679188673"><span class="annot"><a href="Database.Beam.Postgres.Full.html#runPgDeleteReturningList"><span class="hs-identifier hs-type">runPgDeleteReturningList</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeam</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188673"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188672"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-390"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188673"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span>
</span><span id="line-391"></span><span>     </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188673"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188671"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-392"></span><span>     </span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-type">PgDeleteReturning</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188671"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188672"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679188671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-395"></span><span id="runPgDeleteReturningList"><span class="annot"><span class="annottext">runPgDeleteReturningList :: PgDeleteReturning a -&gt; m [a]
</span><a href="Database.Beam.Postgres.Full.html#runPgDeleteReturningList"><span class="hs-identifier hs-var hs-var">runPgDeleteReturningList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-type">PgDeleteReturning</span></a></span><span> </span><span id="local-6989586621679188670"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188670"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m [a]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamSqlBackendSyntax be -&gt; m [a])
-&gt; BeamSqlBackendSyntax be -&gt; m [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188670"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- * General @RETURNING@ support</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">class</span><span> </span><span id="PgReturning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturning"><span class="hs-identifier hs-var">PgReturning</span></a></span></span><span> </span><span id="local-6989586621679188935"><span class="annot"><a href="#local-6989586621679188935"><span class="hs-identifier hs-type">cmd</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PgReturningType"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturningType"><span class="hs-identifier hs-var">PgReturningType</span></a></span></span><span> </span><span id="local-6989586621679188935"><span class="annot"><a href="#local-6989586621679188935"><span class="hs-identifier hs-type">cmd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679188938"><span id="local-6989586621679188939"><span id="returning"><span class="annot"><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-identifier hs-type">returning</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Beamable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188939"><span class="hs-identifier hs-type">tbl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Projectible</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188938"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188935"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188939"><span class="hs-identifier hs-type">tbl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188939"><span class="hs-identifier hs-type">tbl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679188938"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturningType"><span class="hs-identifier hs-type">PgReturningType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188935"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExprToIdentity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679188938"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturning"><span class="hs-identifier hs-type">PgReturning</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsert</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PgReturningType"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturningType"><span class="hs-identifier hs-var">PgReturningType</span></a></span></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsert</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679188666"><span class="annot"><span class="annottext">returning :: SqlInsert Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType SqlInsert (QExprToIdentity a)
</span><a href="#local-6989586621679188666"><span class="hs-identifier hs-var hs-var hs-var hs-var">returning</span></a></span></span><span> </span><span class="annot"><span class="annottext">SqlInsert Postgres tbl
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlInsertNoRows</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgReturningType SqlInsert (QExprToIdentity a)
forall a. PgInsertReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span><span>
</span><span id="line-410"></span><span>  </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-identifier hs-var">returning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlInsert</span></a></span><span> </span><span id="local-6989586621679188665"><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188665"><span class="hs-identifier hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgInsertSyntax"><span class="hs-identifier hs-type">PgInsertSyntax</span></a></span><span> </span><span id="local-6989586621679188664"><span class="annot"><a href="#local-6989586621679188664"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188663"><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188663"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-411"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgInsertReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-var">PgInsertReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgInsertReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188664"><span class="hs-identifier hs-var">syntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188663"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188662"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>      </span><span id="local-6989586621679188662"><span class="annot"><span class="annottext">tblQ :: tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188662"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField tbl) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; TableSettings tbl -&gt; tbl (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188661"><span class="annot"><span class="annottext">Columnar (TableField tbl) a
</span><a href="#local-6989586621679188661"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; PgExpressionSyntax)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; PgExpressionSyntax)
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; (TableField tbl a -&gt; Text -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; Text
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax -&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="annot"><span class="annottext">(PgFieldNameSyntax -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgFieldNameSyntax)
-&gt; TableField tbl a
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PgFieldNameSyntax)
-&gt; (TableField tbl a -&gt; Text)
-&gt; TableField tbl a
-&gt; PgFieldNameSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TableField tbl a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(TableField tbl a
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField tbl) a
TableField tbl a
</span><a href="#local-6989586621679188661"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188665"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturning"><span class="hs-identifier hs-type">PgReturning</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlUpdate</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PgReturningType"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturningType"><span class="hs-identifier hs-var">PgReturningType</span></a></span></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-type">PgUpdateReturning</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679188659"><span class="annot"><span class="annottext">returning :: SqlUpdate Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType SqlUpdate (QExprToIdentity a)
</span><a href="#local-6989586621679188659"><span class="hs-identifier hs-var hs-var hs-var hs-var">returning</span></a></span></span><span> </span><span class="annot"><span class="annottext">SqlUpdate Postgres tbl
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlIdentityUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgReturningType SqlUpdate (QExprToIdentity a)
forall a. PgUpdateReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturningEmpty"><span class="hs-identifier hs-var">PgUpdateReturningEmpty</span></a></span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-identifier hs-var">returning</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlUpdate</span></a></span><span> </span><span id="local-6989586621679188658"><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188658"><span class="hs-identifier hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgUpdateSyntax"><span class="hs-identifier hs-type">PgUpdateSyntax</span></a></span><span> </span><span id="local-6989586621679188656"><span class="annot"><a href="#local-6989586621679188656"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188655"><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188655"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgUpdateReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-var">PgUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgUpdateReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188656"><span class="hs-identifier hs-var">syntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188655"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188654"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>      </span><span id="local-6989586621679188654"><span class="annot"><span class="annottext">tblQ :: tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188654"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField tbl) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; TableSettings tbl -&gt; tbl (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188653"><span class="annot"><span class="annottext">Columnar (TableField tbl) a
</span><a href="#local-6989586621679188653"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; PgExpressionSyntax)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; PgExpressionSyntax)
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; (TableField tbl a -&gt; Text -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; Text
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax -&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="annot"><span class="annottext">(PgFieldNameSyntax -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgFieldNameSyntax)
-&gt; TableField tbl a
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PgFieldNameSyntax)
-&gt; (TableField tbl a -&gt; Text)
-&gt; TableField tbl a
-&gt; PgFieldNameSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TableField tbl a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(TableField tbl a
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField tbl) a
TableField tbl a
</span><a href="#local-6989586621679188653"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188658"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturning"><span class="hs-identifier hs-type">PgReturning</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlDelete</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-431"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="PgReturningType"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgReturningType"><span class="hs-identifier hs-var">PgReturningType</span></a></span></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlDelete</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-type">PgDeleteReturning</span></a></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span>  </span><span id="local-6989586621679188651"><span class="annot"><span class="annottext">returning :: SqlDelete Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType SqlDelete (QExprToIdentity a)
</span><a href="#local-6989586621679188651"><span class="hs-identifier hs-var hs-var hs-var hs-var">returning</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">SqlDelete</span></a></span><span> </span><span id="local-6989586621679188650"><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188650"><span class="hs-identifier hs-var">tblSettings</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgDeleteSyntax"><span class="hs-identifier hs-type">PgDeleteSyntax</span></a></span><span> </span><span id="local-6989586621679188648"><span class="annot"><a href="#local-6989586621679188648"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679188647"><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188647"><span class="hs-identifier hs-var">mkProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a)
forall a. PgSyntax -&gt; PgDeleteReturning a
</span><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-var">PgDeleteReturning</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a))
-&gt; PgSyntax -&gt; PgDeleteReturning (QExprToIdentity a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188648"><span class="hs-identifier hs-var">syntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; RETURNING &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible) -&gt; a
</span><a href="#local-6989586621679188647"><span class="hs-identifier hs-var">mkProjection</span></a></span><span> </span><span class="annot"><span class="annottext">tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188646"><span class="hs-identifier hs-var">tblQ</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>      </span><span id="local-6989586621679188646"><span class="annot"><span class="annottext">tblQ :: tbl (QExpr Postgres PostgresInaccessible)
</span><a href="#local-6989586621679188646"><span class="hs-identifier hs-var hs-var">tblQ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (TableField tbl) a
 -&gt; Columnar' (QExpr Postgres PostgresInaccessible) a)
-&gt; TableSettings tbl -&gt; tbl (QExpr Postgres PostgresInaccessible)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span id="local-6989586621679188645"><span class="annot"><span class="annottext">Columnar (TableField tbl) a
</span><a href="#local-6989586621679188645"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres PostgresInaccessible) a
-&gt; Columnar' (QExpr Postgres PostgresInaccessible) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; PgExpressionSyntax)
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; PgExpressionSyntax)
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; (TableField tbl a -&gt; Text -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; Text -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgExpressionSyntax)
-&gt; TableField tbl a
-&gt; Text
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax -&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="annot"><span class="annottext">(PgFieldNameSyntax -&gt; PgExpressionSyntax)
-&gt; (TableField tbl a -&gt; PgFieldNameSyntax)
-&gt; TableField tbl a
-&gt; PgExpressionSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">unqualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PgFieldNameSyntax)
-&gt; (TableField tbl a -&gt; Text)
-&gt; TableField tbl a
-&gt; PgFieldNameSyntax
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TableField tbl a -&gt; Text
forall (table :: (* -&gt; *) -&gt; *) ty. TableField table ty -&gt; Text
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var">_fieldName</span></a></span><span> </span><span class="annot"><span class="annottext">(TableField tbl a
 -&gt; QGenExpr QValueContext Postgres PostgresInaccessible a)
-&gt; TableField tbl a
-&gt; QGenExpr QValueContext Postgres PostgresInaccessible a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Columnar (TableField tbl) a
TableField tbl a
</span><a href="#local-6989586621679188645"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TableSettings tbl
</span><a href="#local-6989586621679188650"><span class="hs-identifier hs-var">tblSettings</span></a></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamHasInsertOnConflict</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="SqlConflictTarget"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlConflictTarget</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span id="local-6989586621679188979"><span class="annot"><a href="#local-6989586621679188979"><span class="hs-identifier hs-type hs-type">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-443"></span><span>    </span><span id="PgInsertOnConflictTarget"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-var">PgInsertOnConflictTarget</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188979"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QInternal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictTargetSyntax"><span class="hs-identifier hs-type">PgInsertOnConflictTargetSyntax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-keyword">newtype</span><span> </span><span id="SqlConflictAction"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">SqlConflictAction</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span id="local-6989586621679188899"><span class="annot"><a href="#local-6989586621679188899"><span class="hs-identifier hs-type hs-type">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>    </span><span id="PgConflictAction"><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgConflictAction"><span class="hs-identifier hs-var">PgConflictAction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679188899"><span class="hs-identifier hs-type">table</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QInternal</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgConflictActionSyntax"><span class="hs-identifier hs-type">PgConflictActionSyntax</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621679188635"><span class="annot"><span class="annottext">insertOnConflict :: DatabaseEntity Postgres db (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; SqlConflictTarget Postgres table
-&gt; SqlConflictAction Postgres table
-&gt; SqlInsert Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">insertOnConflict</span></a></span></span><span> </span><span id="local-6989586621679188633"><span class="annot"><span class="annottext">DatabaseEntity Postgres db (TableEntity table)
</span><a href="#local-6989586621679188633"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span id="local-6989586621679188632"><span class="annot"><span class="annottext">SqlInsertValues Postgres (table (QExpr Postgres s))
</span><a href="#local-6989586621679188632"><span class="hs-identifier hs-var">vs</span></a></span></span><span> </span><span id="local-6989586621679188631"><span class="annot"><span class="annottext">SqlConflictTarget Postgres table
</span><a href="#local-6989586621679188631"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span id="local-6989586621679188630"><span class="annot"><span class="annottext">SqlConflictAction Postgres table
</span><a href="#local-6989586621679188630"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres db (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; SqlInsert Postgres table
forall (db :: (* -&gt; *) -&gt; *) (table :: (* -&gt; *) -&gt; *) s.
DatabaseEntity Postgres db (TableEntity table)
-&gt; SqlInsertValues Postgres (table (QExpr Postgres s))
-&gt; PgInsertOnConflict table
-&gt; SqlInsert Postgres table
</span><a href="Database.Beam.Postgres.Full.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseEntity Postgres db (TableEntity table)
</span><a href="#local-6989586621679188633"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">SqlInsertValues Postgres (table (QExpr Postgres s))
</span><a href="#local-6989586621679188632"><span class="hs-identifier hs-var">vs</span></a></span><span> </span><span class="annot"><span class="annottext">(PgInsertOnConflict table -&gt; SqlInsert Postgres table)
-&gt; PgInsertOnConflict table -&gt; SqlInsert Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SqlConflictTarget Postgres table
-&gt; SqlConflictAction Postgres table -&gt; PgInsertOnConflict table
forall (tbl :: (* -&gt; *) -&gt; *).
Beamable tbl =&gt;
SqlConflictTarget Postgres tbl
-&gt; SqlConflictAction Postgres tbl -&gt; PgInsertOnConflict tbl
</span><a href="Database.Beam.Postgres.Full.html#onConflict"><span class="hs-identifier hs-var">onConflict</span></a></span><span> </span><span class="annot"><span class="annottext">SqlConflictTarget Postgres table
</span><a href="#local-6989586621679188631"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">SqlConflictAction Postgres table
</span><a href="#local-6989586621679188630"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-comment">-- | Perform the conflict action when any constraint or index conflict occurs.</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-comment">-- Syntactically, this is the @ON CONFLICT@ clause, without any /conflict target/.</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679188629"><span class="annot"><span class="annottext">anyConflict :: SqlConflictTarget Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">anyConflict</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-var">PgInsertOnConflictTarget</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictTargetSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictTargetSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictTargetSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-comment">-- | The Postgres @DO NOTHING@ action</span><span>
</span><span id="line-454"></span><span>  </span><span id="local-6989586621679188627"><span class="annot"><span class="annottext">onConflictDoNothing :: SqlConflictAction Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">onConflictDoNothing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgConflictAction"><span class="hs-identifier hs-var">PgConflictAction</span></a></span><span> </span><span class="annot"><span class="annottext">((table (QField QInternal) -&gt; PgConflictActionSyntax)
 -&gt; SqlConflictAction Postgres table)
-&gt; (table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">table (QField QInternal)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgConflictActionSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgConflictActionSyntax"><span class="hs-identifier hs-var">PgConflictActionSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DO NOTHING&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-comment">-- | The Postgres @DO UPDATE SET@ action, without the @WHERE@ clause. The</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-comment">-- argument takes an updatable row (like the one used in 'update') and the</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-comment">-- conflicting row. Use 'current_' on the first argument to get the current</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-comment">-- value of the row in the database.</span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621679188624"><span class="annot"><span class="annottext">onConflictUpdateSet :: (forall s.
 table (QField s)
 -&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s)
-&gt; SqlConflictAction Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">onConflictUpdateSet</span></a></span></span><span> </span><span id="local-6989586621679188622"><span class="annot"><span class="annottext">forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188622"><span class="hs-identifier hs-var">mkAssignments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgConflictAction"><span class="hs-identifier hs-var">PgConflictAction</span></a></span><span> </span><span class="annot"><span class="annottext">((table (QField QInternal) -&gt; PgConflictActionSyntax)
 -&gt; SqlConflictAction Postgres table)
-&gt; (table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188621"><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188621"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QAssignment</span></a></span><span> </span><span id="local-6989586621679188619"><span class="annot"><span class="annottext">[(BeamSqlBackendFieldNameSyntax Postgres,
  BeamSqlBackendExpressionSyntax Postgres)]
</span><a href="#local-6989586621679188619"><span class="hs-identifier hs-var">assignments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
-&gt; table (QExpr Postgres QInternal)
-&gt; QAssignment Postgres QInternal
forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188622"><span class="hs-identifier hs-var">mkAssignments</span></a></span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188621"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188618"><span class="hs-identifier hs-var">tblExcluded</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621679188618"><span class="annot"><span class="annottext">tblExcluded :: table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188618"><span class="hs-identifier hs-var hs-var">tblExcluded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QField QInternal) a
 -&gt; Columnar' (QExpr Postgres QInternal) a)
-&gt; table (QField QInternal) -&gt; table (QExpr Postgres QInternal)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188617"><span class="annot"><a href="#local-6989586621679188617"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres QInternal) a
-&gt; Columnar' (QExpr Postgres QInternal) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres QInternal a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">qualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;excluded&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188617"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188621"><span class="hs-identifier hs-var">tbl</span></a></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>        </span><span id="local-6989586621679188615"><span class="annot"><span class="annottext">assignmentSyntaxes :: [PgSyntax]
</span><a href="#local-6989586621679188615"><span class="hs-identifier hs-var hs-var">assignmentSyntaxes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFieldName"><span class="hs-identifier hs-var hs-var">fromPgFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax
</span><a href="#local-6989586621679188613"><span class="hs-identifier hs-var">fieldNm</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgParens"><span class="hs-identifier hs-var">pgParens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax
</span><a href="#local-6989586621679188611"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188613"><span class="annot"><span class="annottext">PgFieldNameSyntax
</span><a href="#local-6989586621679188613"><span class="hs-identifier hs-var">fieldNm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188611"><span class="annot"><span class="annottext">PgExpressionSyntax
</span><a href="#local-6989586621679188611"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(BeamSqlBackendFieldNameSyntax Postgres,
  BeamSqlBackendExpressionSyntax Postgres)]
[(PgFieldNameSyntax, PgExpressionSyntax)]
</span><a href="#local-6989586621679188619"><span class="hs-identifier hs-var">assignments</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgConflictActionSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgConflictActionSyntax"><span class="hs-identifier hs-var">PgConflictActionSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgConflictActionSyntax)
-&gt; PgSyntax -&gt; PgConflictActionSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-469"></span><span>       </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DO UPDATE SET &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PgSyntax]
</span><a href="#local-6989586621679188615"><span class="hs-identifier hs-var">assignmentSyntaxes</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>  </span><span class="hs-comment">-- | The Postgres @DO UPDATE SET@ action, with the @WHERE@ clause. This is like</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-comment">-- 'onConflictUpdateSet', but only rows satisfying the given condition are</span><span>
</span><span id="line-473"></span><span>  </span><span class="hs-comment">-- updated. Sometimes this results in more efficient locking. See the Postgres</span><span>
</span><span id="line-474"></span><span>  </span><span class="hs-comment">-- &lt;https://www.postgresql.org/docs/current/static/sql-insert.html manual&gt; for</span><span>
</span><span id="line-475"></span><span>  </span><span class="hs-comment">-- more information.</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679188610"><span class="annot"><span class="annottext">onConflictUpdateSetWhere :: (forall s.
 table (QField s)
 -&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s)
-&gt; (forall s.
    table (QField s)
    -&gt; table (QExpr Postgres s) -&gt; QExpr Postgres s Bool)
-&gt; SqlConflictAction Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">onConflictUpdateSetWhere</span></a></span></span><span> </span><span id="local-6989586621679188608"><span class="annot"><span class="annottext">forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188608"><span class="hs-identifier hs-var">mkAssignments</span></a></span></span><span> </span><span id="local-6989586621679188607"><span class="annot"><span class="annottext">forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188607"><span class="hs-identifier hs-var">where_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><span class="annottext">(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgConflictAction"><span class="hs-identifier hs-var">PgConflictAction</span></a></span><span> </span><span class="annot"><span class="annottext">((table (QField QInternal) -&gt; PgConflictActionSyntax)
 -&gt; SqlConflictAction Postgres table)
-&gt; (table (QField QInternal) -&gt; PgConflictActionSyntax)
-&gt; SqlConflictAction Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188606"><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188606"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QAssignment</span></a></span><span> </span><span id="local-6989586621679188605"><span class="annot"><span class="annottext">[(BeamSqlBackendFieldNameSyntax Postgres,
  BeamSqlBackendExpressionSyntax Postgres)]
</span><a href="#local-6989586621679188605"><span class="hs-identifier hs-var">assignments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
-&gt; table (QExpr Postgres QInternal)
-&gt; QAssignment Postgres QInternal
forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QAssignment Postgres s
</span><a href="#local-6989586621679188608"><span class="hs-identifier hs-var">mkAssignments</span></a></span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188606"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188604"><span class="hs-identifier hs-var">tblExcluded</span></a></span><span>
</span><span id="line-479"></span><span>        </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span id="local-6989586621679188603"><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188603"><span class="hs-identifier hs-var">where_'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
-&gt; table (QExpr Postgres QInternal)
-&gt; QGenExpr QValueContext Postgres QInternal Bool
forall s.
table (QField s)
-&gt; table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188607"><span class="hs-identifier hs-var">where_</span></a></span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188606"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188604"><span class="hs-identifier hs-var">tblExcluded</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span id="local-6989586621679188604"><span class="annot"><span class="annottext">tblExcluded :: table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188604"><span class="hs-identifier hs-var hs-var">tblExcluded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QField QInternal) a
 -&gt; Columnar' (QExpr Postgres QInternal) a)
-&gt; table (QField QInternal) -&gt; table (QExpr Postgres QInternal)
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QField</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679188602"><span class="annot"><a href="#local-6989586621679188602"><span class="hs-identifier hs-var">nm</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres QInternal) a
-&gt; Columnar' (QExpr Postgres QInternal) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres QInternal a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Sql92ExpressionFieldNameSyntax PgExpressionSyntax
-&gt; PgExpressionSyntax
forall expr.
IsSql92ExpressionSyntax expr =&gt;
Sql92ExpressionFieldNameSyntax expr -&gt; expr
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fieldE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; PgFieldNameSyntax
forall fn. IsSql92FieldNameSyntax fn =&gt; Text -&gt; Text -&gt; fn
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">qualifiedField</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;excluded&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679188602"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">table (QField QInternal)
</span><a href="#local-6989586621679188606"><span class="hs-identifier hs-var">tbl</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span>        </span><span id="local-6989586621679188601"><span class="annot"><span class="annottext">assignmentSyntaxes :: [PgSyntax]
</span><a href="#local-6989586621679188601"><span class="hs-identifier hs-var hs-var">assignmentSyntaxes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-483"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgFieldName"><span class="hs-identifier hs-var hs-var">fromPgFieldName</span></a></span><span> </span><span class="annot"><span class="annottext">PgFieldNameSyntax
</span><a href="#local-6989586621679188600"><span class="hs-identifier hs-var">fieldNm</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgParens"><span class="hs-identifier hs-var">pgParens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax
</span><a href="#local-6989586621679188599"><span class="hs-identifier hs-var">expr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679188600"><span class="annot"><span class="annottext">PgFieldNameSyntax
</span><a href="#local-6989586621679188600"><span class="hs-identifier hs-var">fieldNm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679188599"><span class="annot"><span class="annottext">PgExpressionSyntax
</span><a href="#local-6989586621679188599"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(BeamSqlBackendFieldNameSyntax Postgres,
  BeamSqlBackendExpressionSyntax Postgres)]
[(PgFieldNameSyntax, PgExpressionSyntax)]
</span><a href="#local-6989586621679188605"><span class="hs-identifier hs-var">assignments</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgConflictActionSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgConflictActionSyntax"><span class="hs-identifier hs-var">PgConflictActionSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgConflictActionSyntax)
-&gt; PgSyntax -&gt; PgConflictActionSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-486"></span><span>       </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;DO UPDATE SET &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PgSyntax]
</span><a href="#local-6989586621679188601"><span class="hs-identifier hs-var">assignmentSyntaxes</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; WHERE &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188603"><span class="hs-identifier hs-var">where_'</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-comment">-- | Perform the conflict action only when these fields conflict. The first</span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-comment">-- argument gets the current row as a table of expressions. Return the conflict</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-comment">-- key. For more information, see the @beam-postgres@ manual.</span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621679188598"><span class="annot"><span class="annottext">conflictingFields :: (table (QExpr Postgres QInternal) -&gt; proj)
-&gt; SqlConflictTarget Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">conflictingFields</span></a></span></span><span> </span><span id="local-6989586621679188596"><span class="annot"><span class="annottext">table (QExpr Postgres QInternal) -&gt; proj
</span><a href="#local-6989586621679188596"><span class="hs-identifier hs-var">makeProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><span class="annottext">(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-var">PgInsertOnConflictTarget</span></a></span><span> </span><span class="annot"><span class="annottext">((table (QExpr Postgres QInternal)
  -&gt; PgInsertOnConflictTargetSyntax)
 -&gt; SqlConflictTarget Postgres table)
-&gt; (table (QExpr Postgres QInternal)
    -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188595"><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188595"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictTargetSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictTargetSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictTargetSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertOnConflictTargetSyntax)
-&gt; PgSyntax -&gt; PgInsertOnConflictTargetSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgParens"><span class="hs-identifier hs-var">pgParens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PgSyntax] -&gt; PgSyntax) -&gt; [PgSyntax] -&gt; PgSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-495"></span><span>              </span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="annot"><span class="annottext">([PgExpressionSyntax] -&gt; [PgSyntax])
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-496"></span><span>              </span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; proj
-&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal) -&gt; proj
</span><a href="#local-6989586621679188596"><span class="hs-identifier hs-var">makeProjection</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188595"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-comment">-- | Like 'conflictingFields', but only perform the action if the condition</span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-comment">-- given in the second argument is met. See the postgres</span><span>
</span><span id="line-501"></span><span>  </span><span class="hs-comment">-- &lt;https://www.postgresql.org/docs/current/static/sql-insert.html manual&gt; for</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-comment">-- more information.</span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621679188594"><span class="annot"><span class="annottext">conflictingFieldsWhere :: (table (QExpr Postgres QInternal) -&gt; proj)
-&gt; (forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool)
-&gt; SqlConflictTarget Postgres table
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">conflictingFieldsWhere</span></a></span></span><span> </span><span id="local-6989586621679188592"><span class="annot"><span class="annottext">table (QExpr Postgres QInternal) -&gt; proj
</span><a href="#local-6989586621679188592"><span class="hs-identifier hs-var">makeProjection</span></a></span></span><span> </span><span id="local-6989586621679188591"><span class="annot"><span class="annottext">forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188591"><span class="hs-identifier hs-var">makeWhere</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
forall (table :: (* -&gt; *) -&gt; *).
(table (QExpr Postgres QInternal)
 -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
</span><a href="Database.Beam.Postgres.Full.html#PgInsertOnConflictTarget"><span class="hs-identifier hs-var">PgInsertOnConflictTarget</span></a></span><span> </span><span class="annot"><span class="annottext">((table (QExpr Postgres QInternal)
  -&gt; PgInsertOnConflictTargetSyntax)
 -&gt; SqlConflictTarget Postgres table)
-&gt; (table (QExpr Postgres QInternal)
    -&gt; PgInsertOnConflictTargetSyntax)
-&gt; SqlConflictTarget Postgres table
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679188590"><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188590"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgInsertOnConflictTargetSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgInsertOnConflictTargetSyntax"><span class="hs-identifier hs-var">PgInsertOnConflictTargetSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">(PgSyntax -&gt; PgInsertOnConflictTargetSyntax)
-&gt; PgSyntax -&gt; PgInsertOnConflictTargetSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgParens"><span class="hs-identifier hs-var">pgParens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgSyntax -&gt; [PgSyntax] -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgSepBy"><span class="hs-identifier hs-var">pgSepBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;, &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([PgSyntax] -&gt; PgSyntax) -&gt; [PgSyntax] -&gt; PgSyntax
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-507"></span><span>              </span><span class="annot"><span class="annottext">(PgExpressionSyntax -&gt; PgSyntax)
-&gt; [PgExpressionSyntax] -&gt; [PgSyntax]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">PgExpressionSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#fromPgExpression"><span class="hs-identifier hs-var hs-var">fromPgExpression</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
-&gt; proj
-&gt; WithExprContext [BeamSqlBackendExpressionSyntax Postgres]
forall be a.
Projectible be a =&gt;
Proxy be
-&gt; a -&gt; WithExprContext [BeamSqlBackendExpressionSyntax be]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal) -&gt; proj
</span><a href="#local-6989586621679188592"><span class="hs-identifier hs-var">makeProjection</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188590"><span class="hs-identifier hs-var">tbl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; WHERE &quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#pgParens"><span class="hs-identifier hs-var">pgParens</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span id="local-6989586621679188589"><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188589"><span class="hs-identifier hs-var">mkE</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
-&gt; QGenExpr QValueContext Postgres QInternal Bool
forall s. table (QExpr Postgres s) -&gt; QExpr Postgres s Bool
</span><a href="#local-6989586621679188591"><span class="hs-identifier hs-var">makeWhere</span></a></span><span> </span><span class="annot"><span class="annottext">table (QExpr Postgres QInternal)
</span><a href="#local-6989586621679188590"><span class="hs-identifier hs-var">tbl</span></a></span><span>
</span><span id="line-511"></span><span>                  </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgExpressionSyntax"><span class="hs-identifier hs-type">PgExpressionSyntax</span></a></span><span> </span><span id="local-6989586621679188587"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188587"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WithExprContext (BeamSqlBackendExpressionSyntax Postgres)
</span><a href="#local-6989586621679188589"><span class="hs-identifier hs-var">mkE</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;t&quot;</span></span><span>
</span><span id="line-512"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679188587"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgSyntax -&gt; PgSyntax -&gt; PgSyntax
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; PgSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#emit"><span class="hs-identifier hs-var">emit</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-514"></span></pre></body></html>