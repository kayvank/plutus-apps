<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Beam.Postgres.Connection</span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier">Pg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier">PgF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#liftIOWithHandle"><span class="hs-identifier">liftIOWithHandle</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runBeamPostgres"><span class="hs-identifier">runBeamPostgres</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runBeamPostgresDebug"><span class="hs-identifier">runBeamPostgresDebug</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier">pgRenderSyntax</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier">runPgRowReader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier">getFields</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#withPgDebug"><span class="hs-identifier">withPgDebug</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#postgresUriSyntax"><span class="hs-identifier">postgresUriSyntax</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">SomeException</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">throwIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../transformers-base/html/src"><span class="hs-identifier">Control.Monad.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers-base/html/src"><span class="hs-identifier">MonadBase</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">Control.Monad.Free.Church</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../monad-control/html/src"><span class="hs-identifier">Control.Monad.Trans.Control</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../monad-control/html/src"><span class="hs-identifier">MonadBaseControl</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">runDelete</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">runUpdate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">runInsert</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">insert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL.BeamExtensions</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL.Row</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">FromBackendRowF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">FromBackendRowM</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">BeamRowReadError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">ColumnParseError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.URI</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Schema.Tables</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html"><span class="hs-identifier">Database.Beam.Postgres.Syntax</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Postgres.Full.html"><span class="hs-identifier">Database.Beam.Postgres.Full</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Postgres.Types.html"><span class="hs-identifier">Database.Beam.Postgres.Types</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">Database.PostgreSQL.LibPQ</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span> </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">Connection</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">escapeStringConn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">escapeIdentifier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">escapeByteaConn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier">exec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple.FromField</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Field</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">RowParser</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">escapeStringConn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">escapeIdentifier</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">escapeByteaConn</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">exec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">throwResultError</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PgI</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple.Ok</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Database.PostgreSQL.Simple.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pg</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier">Query</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.State</span></a></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.Fail</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Fail</span></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Builder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">toLazyByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">byteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">listToMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">decodeUtf8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">cast</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if !MIN_VERSION_base(4, 11, 0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Semigroup</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Foreign.C.Types</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">Network.URI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">uriToString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="PgStream"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-var">PgStream</span></a></span></span><span> </span><span id="local-6989586621679190397"><span class="annot"><a href="#local-6989586621679190397"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PgStreamDone"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span></span><span>     </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="PgStreamContinue"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-var">PgStreamContinue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190397"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | 'BeamURIOpeners' for the standard @postgresql:@ URI scheme. See the</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- postgres documentation for more details on the formatting. See documentation</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- for 'BeamURIOpeners' for more information on how to use this with beam</span><span>
</span><span id="line-84"></span><span id="local-6989586621679190180"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#postgresUriSyntax"><span class="hs-identifier hs-type">postgresUriSyntax</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679190180"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span>
</span><span id="line-85"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamURIOpeners</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190180"><span class="hs-identifier hs-type">c</span></a></span></span><span>
</span><span id="line-86"></span><span id="postgresUriSyntax"><span class="annot"><span class="annottext">postgresUriSyntax :: c Postgres Connection Pg -&gt; BeamURIOpeners c
</span><a href="Database.Beam.Postgres.Connection.html#postgresUriSyntax"><span class="hs-identifier hs-var hs-var">postgresUriSyntax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="annottext">(forall a. Connection -&gt; Pg a -&gt; IO a)
-&gt; String
-&gt; (URI -&gt; IO (Connection, IO ()))
-&gt; c Postgres Connection Pg
-&gt; BeamURIOpeners c
forall hdl (m :: * -&gt; *) (c :: * -&gt; * -&gt; (* -&gt; *) -&gt; *) be.
(forall a. hdl -&gt; m a -&gt; IO a)
-&gt; String
-&gt; (URI -&gt; IO (hdl, IO ()))
-&gt; c be hdl m
-&gt; BeamURIOpeners c
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">mkUriOpener</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Connection -&gt; Pg a -&gt; IO a
</span><a href="Database.Beam.Postgres.Connection.html#runBeamPostgres"><span class="hs-identifier hs-var">runBeamPostgres</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;postgresql:&quot;</span></span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679190178"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679190178"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190177"><span class="annot"><span class="annottext">pgConnStr :: ByteString
</span><a href="#local-6989586621679190177"><span class="hs-identifier hs-var hs-var">pgConnStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; URI -&gt; String -&gt; String
</span><a href="../../../../network-uri/html/src"><span class="hs-identifier hs-var">uriToString</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621679190178"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>            </span><span id="local-6989586621679190175"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190175"><span class="hs-identifier hs-var">hdl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO Connection
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.connectPostgreSQL</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190177"><span class="hs-identifier hs-var">pgConnStr</span></a></span><span>
</span><span id="line-91"></span><span>            </span><span class="annot"><span class="annottext">(Connection, IO ()) -&gt; IO (Connection, IO ())
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190175"><span class="hs-identifier hs-var">hdl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO ()
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.close</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190175"><span class="hs-identifier hs-var">hdl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- * Syntax rendering</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier hs-type">pgRenderSyntax</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-97"></span><span id="pgRenderSyntax"><span class="annot"><span class="annottext">pgRenderSyntax :: Connection -&gt; PgSyntax -&gt; IO ByteString
</span><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier hs-var hs-var">pgRenderSyntax</span></a></span></span><span> </span><span id="local-6989586621679190172"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190172"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span> </span><span id="local-6989586621679190170"><span class="annot"><span class="annottext">PgSyntaxM ()
</span><a href="#local-6989586621679190170"><span class="hs-identifier hs-var">mkQuery</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="#local-6989586621679190169"><span class="hs-identifier hs-var">renderBuilder</span></a></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; ByteString) -&gt; IO Builder -&gt; IO ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntaxM ()
-&gt; (() -&gt; Builder -&gt; IO Builder)
-&gt; (PgSyntaxF (Builder -&gt; IO Builder) -&gt; Builder -&gt; IO Builder)
-&gt; Builder
-&gt; IO Builder
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntaxM ()
</span><a href="#local-6989586621679190170"><span class="hs-identifier hs-var">mkQuery</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Builder -&gt; IO Builder
forall (f :: * -&gt; *) p a. Applicative f =&gt; p -&gt; a -&gt; f a
</span><a href="#local-6989586621679190166"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntaxF (Builder -&gt; IO Builder) -&gt; Builder -&gt; IO Builder
</span><a href="#local-6989586621679190165"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679190169"><span class="annot"><span class="annottext">renderBuilder :: Builder -&gt; ByteString
</span><a href="#local-6989586621679190169"><span class="hs-identifier hs-var hs-var">renderBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (Builder -&gt; ByteString) -&gt; Builder -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">toLazyByteString</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679190165"><span class="annot"><span class="annottext">step :: PgSyntaxF (Builder -&gt; IO Builder) -&gt; Builder -&gt; IO Builder
</span><a href="#local-6989586621679190165"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#EmitBuilder"><span class="hs-identifier hs-type">EmitBuilder</span></a></span><span> </span><span id="local-6989586621679190161"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190161"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679190160"><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190160"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190159"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190159"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190160"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190159"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190161"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><a href="#local-6989586621679190165"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#EmitByteString"><span class="hs-identifier hs-type">EmitByteString</span></a></span><span> </span><span id="local-6989586621679190157"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190157"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679190156"><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190156"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190155"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190155"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190156"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190155"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190157"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><a href="#local-6989586621679190165"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#EscapeString"><span class="hs-identifier hs-type">EscapeString</span></a></span><span> </span><span id="local-6989586621679190153"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190153"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679190152"><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190152"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190151"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190151"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>      </span><span id="local-6989586621679190150"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190150"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either ByteString ByteString) -&gt; IO ByteString
forall (m :: * -&gt; *) a b.
(MonadFail m, Show a) =&gt;
String -&gt; m (Either a b) -&gt; m b
</span><a href="#local-6989586621679190149"><span class="hs-identifier hs-var">wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EscapeString&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; ByteString -&gt; IO (Either ByteString ByteString)
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.escapeStringConn</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190172"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190153"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190152"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190151"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190150"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="#local-6989586621679190165"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#EscapeBytea"><span class="hs-identifier hs-type">EscapeBytea</span></a></span><span> </span><span id="local-6989586621679190147"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190147"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679190146"><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190146"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190145"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190145"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-108"></span><span>      </span><span id="local-6989586621679190144"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190144"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either ByteString ByteString) -&gt; IO ByteString
forall (m :: * -&gt; *) a b.
(MonadFail m, Show a) =&gt;
String -&gt; m (Either a b) -&gt; m b
</span><a href="#local-6989586621679190149"><span class="hs-identifier hs-var">wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EscapeBytea&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; ByteString -&gt; IO (Either ByteString ByteString)
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.escapeByteaConn</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190172"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190147"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190146"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190145"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190144"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="#local-6989586621679190165"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#EscapeIdentifier"><span class="hs-identifier hs-type">EscapeIdentifier</span></a></span><span> </span><span id="local-6989586621679190142"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190142"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679190141"><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190141"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190140"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190140"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-111"></span><span>      </span><span id="local-6989586621679190139"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190139"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either ByteString ByteString) -&gt; IO ByteString
forall (m :: * -&gt; *) a b.
(MonadFail m, Show a) =&gt;
String -&gt; m (Either a b) -&gt; m b
</span><a href="#local-6989586621679190149"><span class="hs-identifier hs-var">wrapError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;EscapeIdentifier&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; ByteString -&gt; IO (Either ByteString ByteString)
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.escapeIdentifier</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190172"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190142"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="annot"><span class="annottext">Builder -&gt; IO Builder
</span><a href="#local-6989586621679190141"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621679190140"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Builder
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">byteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190139"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679190166"><span class="annot"><span class="annottext">finish :: p -&gt; a -&gt; f a
</span><a href="#local-6989586621679190166"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span id="local-6989586621679190149"><span class="annot"><span class="annottext">wrapError :: String -&gt; m (Either a b) -&gt; m b
</span><a href="#local-6989586621679190149"><span class="hs-identifier hs-var hs-var">wrapError</span></a></span></span><span> </span><span id="local-6989586621679190138"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190138"><span class="hs-identifier hs-var">step'</span></a></span></span><span> </span><span id="local-6989586621679190137"><span class="annot"><span class="annottext">m (Either a b)
</span><a href="#local-6989586621679190137"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-117"></span><span>      </span><span id="local-6989586621679190136"><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679190136"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either a b)
</span><a href="#local-6989586621679190137"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either a b
</span><a href="#local-6989586621679190136"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679190135"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190135"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190135"><span class="hs-identifier hs-var">res'</span></a></span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679190134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190134"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; m b
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190138"><span class="hs-identifier hs-var">step'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190134"><span class="hs-identifier hs-var">res'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- * Run row readers</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier hs-type">getFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Field</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span id="getFields"><span class="annot"><span class="annottext">getFields :: Result -&gt; IO [Field]
</span><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier hs-var hs-var">getFields</span></a></span></span><span> </span><span id="local-6989586621679190132"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Col</span></a></span><span> </span><span id="local-6989586621679190130"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190130"><span class="hs-identifier hs-var">colCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO Column
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.nfields</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190128"><span class="annot"><span class="annottext">getField :: CInt -&gt; IO Field
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var hs-var">getField</span></a></span></span><span> </span><span id="local-6989586621679190127"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">Result -&gt; Column -&gt; Oid -&gt; Field
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.Field</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Column
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.Col</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Oid -&gt; Field) -&gt; IO Oid -&gt; IO Field
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Result -&gt; Column -&gt; IO Oid
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.ftype</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190132"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Column
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.Col</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190127"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="annottext">(CInt -&gt; IO Field) -&gt; [CInt] -&gt; IO [Field]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; IO Field
</span><a href="#local-6989586621679190128"><span class="hs-identifier hs-var">getField</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190130"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; CInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679190375"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier hs-type">runPgRowReader</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Field</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRowM</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190375"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-135"></span><span id="runPgRowReader"><span class="annot"><span class="annottext">runPgRowReader :: Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres a
-&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier hs-var hs-var">runPgRowReader</span></a></span></span><span> </span><span id="local-6989586621679190123"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190123"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679190122"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679190122"><span class="hs-identifier hs-var">rowIdx</span></a></span></span><span> </span><span id="local-6989586621679190121"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190121"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621679190120"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190120"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRowM</span></a></span><span> </span><span id="local-6989586621679190118"><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190118"><span class="hs-identifier hs-var">readRow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="annottext">Result -&gt; IO Column
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.nfields</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190121"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">IO Column
-&gt; (Column -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Col</span></a></span><span> </span><span id="local-6989586621679190117"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190117"><span class="hs-identifier hs-var">colCount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
-&gt; (a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a))
-&gt; (FromBackendRowF
      Postgres
      (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a))
    -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a))
-&gt; CInt
-&gt; CInt
-&gt; [Field]
-&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190118"><span class="hs-identifier hs-var">readRow</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) b p p p a.
Applicative f =&gt;
b -&gt; p -&gt; p -&gt; p -&gt; f (Either a b)
</span><a href="#local-6989586621679190116"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">FromBackendRowF
  Postgres
  (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a))
-&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError a)
forall x.
FromBackendRowF
  Postgres
  (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x))
-&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190117"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190120"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="#local-6989586621679190115"><span class="hs-identifier hs-type">step</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190472"><span class="annot"><a href="#local-6989586621679190472"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRowF</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Field</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190472"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Field</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190472"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679190115"><span class="annot"><span class="annottext">step :: FromBackendRowF
  Postgres
  (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x))
-&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190115"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ParseOneField</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190113"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190113"><span class="hs-identifier hs-var">curCol</span></a></span></span><span> </span><span id="local-6989586621679190112"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190112"><span class="hs-identifier hs-var">colCount</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError x -&gt; IO (Either BeamRowReadError x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError x
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190113"><span class="hs-identifier hs-var">curCol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnNotEnoughColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190112"><span class="hs-identifier hs-var">colCount</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ParseOneField</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190109"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190109"><span class="hs-identifier hs-var">curCol</span></a></span></span><span> </span><span id="local-6989586621679190108"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190108"><span class="hs-identifier hs-var">colCount</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><span class="hs-identifier">_</span></span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190109"><span class="hs-identifier hs-var">curCol</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190108"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError x -&gt; IO (Either BeamRowReadError x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError x
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190109"><span class="hs-identifier hs-var">curCol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnNotEnoughColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190108"><span class="hs-identifier hs-var">colCount</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">ParseOneField</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190107"><span id="local-6989586621679190106"><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190106"><span class="hs-identifier hs-var">next'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679190107"><span class="hs-identifier hs-type">next</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190105"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190105"><span class="hs-identifier hs-var">curCol</span></a></span></span><span> </span><span id="local-6989586621679190104"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190104"><span class="hs-identifier hs-var">colCount</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679190103"><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621679190103"><span class="hs-identifier hs-var">field</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679190102"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190102"><span class="hs-identifier hs-var">remainingFields</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679190101"><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679190101"><span class="hs-identifier hs-var">fieldValue</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Row -&gt; Column -&gt; IO (Maybe ByteString)
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.getvalue'</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679190121"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679190122"><span class="hs-identifier hs-var">rowIdx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Column
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.Col</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190105"><span class="hs-identifier hs-var">curCol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>         </span><span id="local-6989586621679190099"><span class="annot"><span class="annottext">Ok a
</span><a href="#local-6989586621679190099"><span class="hs-identifier hs-var">res'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Conversion a -&gt; Connection -&gt; IO (Ok a)
forall a. Conversion a -&gt; Connection -&gt; IO (Ok a)
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var hs-var">Pg.runConversion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldParser a
forall a. FromField a =&gt; FieldParser a
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.fromField</span></a></span><span> </span><span class="annot"><span class="annottext">Field
</span><a href="#local-6989586621679190103"><span class="hs-identifier hs-var">field</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
</span><a href="#local-6989586621679190101"><span class="hs-identifier hs-var">fieldValue</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190123"><span class="hs-identifier hs-var">conn</span></a></span><span>
</span><span id="line-148"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ok a
</span><a href="#local-6989586621679190099"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>           </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Errors</span></a></span><span> </span><span id="local-6989586621679190095"><span class="annot"><span class="annottext">[SomeException]
</span><a href="#local-6989586621679190095"><span class="hs-identifier hs-var">errs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>             </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190094"><span class="annot"><span class="annottext">err :: ColumnParseError
</span><a href="#local-6989586621679190094"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ColumnParseError -&gt; Maybe ColumnParseError -&gt; ColumnParseError
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Column parse failed with unknown exception&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe ColumnParseError -&gt; ColumnParseError)
-&gt; Maybe ColumnParseError -&gt; ColumnParseError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-151"></span><span>                       </span><span class="annot"><span class="annottext">[ColumnParseError] -&gt; Maybe ColumnParseError
forall a. [a] -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">listToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">([ColumnParseError] -&gt; Maybe ColumnParseError)
-&gt; [ColumnParseError] -&gt; Maybe ColumnParseError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-152"></span><span>                       </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span> </span><span id="local-6989586621679190091"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679190091"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SomeException]
</span><a href="#local-6989586621679190095"><span class="hs-identifier hs-var">errs</span></a></span><span>
</span><span id="line-153"></span><span>                          </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679190090"><span class="annot"><span class="annottext">ResultError
</span><a href="#local-6989586621679190090"><span class="hs-identifier hs-var">pgErr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe ResultError -&gt; [Maybe ResultError]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">e -&gt; Maybe ResultError
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679190091"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ResultError
</span><a href="#local-6989586621679190090"><span class="hs-identifier hs-var">pgErr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>                            </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.ConversionFailed</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errSQLType :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errSQLType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190087"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190087"><span class="hs-identifier hs-var">sql</span></a></span></span><span>
</span><span id="line-156"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errHaskellType :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errHaskellType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190085"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190085"><span class="hs-identifier hs-var">hs</span></a></span></span><span>
</span><span id="line-157"></span><span>                                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errMessage :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errMessage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190083"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190083"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>                              </span><span class="annot"><span class="annottext">ColumnParseError -&gt; [ColumnParseError]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnTypeMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190085"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190087"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190083"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                            </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Incompatible</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">errSQLType :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errSQLType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190080"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190080"><span class="hs-identifier hs-var">sql</span></a></span></span><span>
</span><span id="line-160"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errHaskellType :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errHaskellType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190079"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190079"><span class="hs-identifier hs-var">hs</span></a></span></span><span>
</span><span id="line-161"></span><span>                                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">errMessage :: ResultError -&gt; String
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.errMessage</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679190078"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190078"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>                              </span><span class="annot"><span class="annottext">ColumnParseError -&gt; [ColumnParseError]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnTypeMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190079"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190080"><span class="hs-identifier hs-var">sql</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679190078"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>                            </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.UnexpectedNull</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>                              </span><span class="annot"><span class="annottext">ColumnParseError -&gt; [ColumnParseError]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnUnexpectedNull</span></a></span><span>
</span><span id="line-165"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError x -&gt; IO (Either BeamRowReadError x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError x
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190105"><span class="hs-identifier hs-var">curCol</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ColumnParseError
</span><a href="#local-6989586621679190094"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>           </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Ok</span></a></span><span> </span><span id="local-6989586621679190074"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190074"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190106"><span class="hs-identifier hs-var">next'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190074"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190105"><span class="hs-identifier hs-var">curCol</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; CInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190104"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190102"><span class="hs-identifier hs-var">remainingFields</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Alt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRowM</span></a></span><span> </span><span id="local-6989586621679190071"><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190071"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRowM</span></a></span><span> </span><span id="local-6989586621679190070"><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190070"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190069"><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190069"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679190068"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190068"><span class="hs-identifier hs-var">curCol</span></a></span></span><span> </span><span id="local-6989586621679190067"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190067"><span class="hs-identifier hs-var">colCount</span></a></span></span><span> </span><span id="local-6989586621679190066"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190066"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679190065"><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
</span><a href="#local-6989586621679190065"><span class="hs-identifier hs-var">aRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
-&gt; (a
    -&gt; CInt
    -&gt; CInt
    -&gt; [Field]
    -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; (FromBackendRowF
      Postgres
      (CInt
       -&gt; CInt
       -&gt; [Field]
       -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
    -&gt; CInt
    -&gt; CInt
    -&gt; [Field]
    -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; CInt
-&gt; CInt
-&gt; [Field]
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190071"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679190064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190064"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679190063"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190063"><span class="hs-identifier hs-var">curCol'</span></a></span></span><span> </span><span id="local-6989586621679190062"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190062"><span class="hs-identifier hs-var">colCount'</span></a></span></span><span> </span><span id="local-6989586621679190061"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190061"><span class="hs-identifier hs-var">cols'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
-&gt; Either BeamRowReadError (IO (Either BeamRowReadError x))
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190069"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190064"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190063"><span class="hs-identifier hs-var">curCol'</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190062"><span class="hs-identifier hs-var">colCount'</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190061"><span class="hs-identifier hs-var">cols'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FromBackendRowF
  Postgres
  (CInt
   -&gt; CInt
   -&gt; [Field]
   -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; CInt
-&gt; CInt
-&gt; [Field]
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall x.
FromBackendRowF
  Postgres
  (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x))
-&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190068"><span class="hs-identifier hs-var">curCol</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190067"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190066"><span class="hs-identifier hs-var">cols</span></a></span><span>
</span><span id="line-170"></span><span>         </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
</span><a href="#local-6989586621679190065"><span class="hs-identifier hs-var">aRes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-171"></span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679190060"><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190060"><span class="hs-identifier hs-var">next'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190060"><span class="hs-identifier hs-var">next'</span></a></span><span>
</span><span id="line-172"></span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679190059"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190059"><span class="hs-identifier hs-var">aErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>             </span><span id="local-6989586621679190058"><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
</span><a href="#local-6989586621679190058"><span class="hs-identifier hs-var">bRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
-&gt; (a
    -&gt; CInt
    -&gt; CInt
    -&gt; [Field]
    -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; (FromBackendRowF
      Postgres
      (CInt
       -&gt; CInt
       -&gt; [Field]
       -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
    -&gt; CInt
    -&gt; CInt
    -&gt; [Field]
    -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; CInt
-&gt; CInt
-&gt; [Field]
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F (FromBackendRowF Postgres) a
</span><a href="#local-6989586621679190070"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679190057"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190057"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679190056"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190056"><span class="hs-identifier hs-var">curCol'</span></a></span></span><span> </span><span id="local-6989586621679190055"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190055"><span class="hs-identifier hs-var">colCount'</span></a></span></span><span> </span><span id="local-6989586621679190054"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190054"><span class="hs-identifier hs-var">cols'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
-&gt; Either BeamRowReadError (IO (Either BeamRowReadError x))
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190069"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190057"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190056"><span class="hs-identifier hs-var">curCol'</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190055"><span class="hs-identifier hs-var">colCount'</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190054"><span class="hs-identifier hs-var">cols'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FromBackendRowF
  Postgres
  (CInt
   -&gt; CInt
   -&gt; [Field]
   -&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x))))
-&gt; CInt
-&gt; CInt
-&gt; [Field]
-&gt; IO (Either BeamRowReadError (IO (Either BeamRowReadError x)))
forall x.
FromBackendRowF
  Postgres
  (CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x))
-&gt; CInt -&gt; CInt -&gt; [Field] -&gt; IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190068"><span class="hs-identifier hs-var">curCol</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679190067"><span class="hs-identifier hs-var">colCount</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679190066"><span class="hs-identifier hs-var">cols</span></a></span><span>
</span><span id="line-174"></span><span>             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError (IO (Either BeamRowReadError x))
</span><a href="#local-6989586621679190058"><span class="hs-identifier hs-var">bRes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>               </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679190053"><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190053"><span class="hs-identifier hs-var">next'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
</span><a href="#local-6989586621679190053"><span class="hs-identifier hs-var">next'</span></a></span><span>
</span><span id="line-176"></span><span>               </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError x -&gt; IO (Either BeamRowReadError x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError x
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190059"><span class="hs-identifier hs-var">aErr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="#local-6989586621679190115"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FailParseWith</span></a></span><span> </span><span id="local-6989586621679190051"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190051"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>      </span><span class="annot"><span class="annottext">Either BeamRowReadError x -&gt; IO (Either BeamRowReadError x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError x
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190051"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span id="local-6989586621679190116"><span class="annot"><span class="annottext">finish :: b -&gt; p -&gt; p -&gt; p -&gt; f (Either a b)
</span><a href="#local-6989586621679190116"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span id="local-6989586621679190050"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190050"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; f (Either a b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190050"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span id="local-6989586621679190286"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#withPgDebug"><span class="hs-identifier hs-type">withPgDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190286"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190286"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-184"></span><span id="withPgDebug"><span class="annot"><span class="annottext">withPgDebug :: (String -&gt; IO ())
-&gt; Connection -&gt; Pg a -&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#withPgDebug"><span class="hs-identifier hs-var hs-var">withPgDebug</span></a></span></span><span> </span><span id="local-6989586621679190049"><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span id="local-6989586621679190048"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span id="local-6989586621679190046"><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679190046"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190045"><span class="annot"><span class="annottext">finish :: b -&gt; f (Either a b)
</span><a href="#local-6989586621679190045"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span id="local-6989586621679190044"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190044"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; f (Either a b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; Either a b
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679190044"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>      </span><span id="local-6989586621679190043"><span class="annot"><span class="annottext">step :: PgF (IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190043"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-type">PgLiftIO</span></a></span><span> </span><span id="local-6989586621679190041"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679190041"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span id="local-6989586621679190040"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190040"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679190041"><span class="hs-identifier hs-var">io</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190040"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-type">PgLiftWithHandle</span></a></span><span> </span><span id="local-6989586621679190038"><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679190038"><span class="hs-identifier hs-var">withConn</span></a></span></span><span> </span><span id="local-6989586621679190037"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190037"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679190038"><span class="hs-identifier hs-var">withConn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190037"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-188"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679190035"><span class="annot"><span class="annottext">Maybe x -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190035"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190035"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-189"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#CursorBatching"><span class="hs-identifier hs-var">CursorBatching</span></a></span><span>
</span><span id="line-190"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeQuery"><span class="hs-identifier hs-var">PgCommandTypeQuery</span></a></span><span> </span><span id="local-6989586621679190030"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679190030"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679190028"><span id="local-6989586621679190029"><span id="local-6989586621679190027"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679190027"><span class="hs-identifier hs-var">mkProcess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190029"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190028"><span class="hs-identifier hs-type">a'</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                           </span><span id="local-6989586621679190026"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190026"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679190025"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190025"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; PgSyntax -&gt; IO ByteString
</span><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier hs-var">pgRenderSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679190030"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-194"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span id="local-6989586621679190024"><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679190024"><span class="hs-identifier hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679190027"><span class="hs-identifier hs-var">mkProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F PgF (Maybe x) -&gt; Pg (Maybe x)
forall a. F PgF a -&gt; Pg a
</span><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-var">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgF (Maybe x) -&gt; F PgF (Maybe x)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe x -&gt; Maybe x) -&gt; PgF (Maybe x)
forall x next.
FromBackendRow Postgres x =&gt;
(Maybe x -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-var">PgFetchNext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190025"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>           </span><span id="local-6989586621679190021"><span class="annot"><span class="annottext">PgStream a
</span><a href="#local-6989586621679190021"><span class="hs-identifier hs-var">action'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">F PgF a
-&gt; (a -&gt; Maybe Row -&gt; IO (PgStream a))
-&gt; (PgF (Maybe Row -&gt; IO (PgStream a))
    -&gt; Maybe Row -&gt; IO (PgStream a))
-&gt; Maybe Row
-&gt; IO (PgStream a)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679190024"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe Row -&gt; IO (PgStream a)
forall a. a -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190020"><span class="hs-identifier hs-var">finishProcess</span></a></span><span> </span><span class="annot"><span class="annottext">PgF (Maybe Row -&gt; IO (PgStream a)) -&gt; Maybe Row -&gt; IO (PgStream a)
forall a.
PgF (Maybe Row -&gt; IO (PgStream a)) -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190019"><span class="hs-identifier hs-var">stepProcess</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Row
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-197"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PgStream a
</span><a href="#local-6989586621679190021"><span class="hs-identifier hs-var">action'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>             </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-type">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679190018"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190018"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO Int64
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Query
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.Query</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190025"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO Int64
-&gt; IO (Either BeamRowReadError a) -&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190026"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190018"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-199"></span><span>             </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-type">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679190015"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190015"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190015"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>             </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-type">PgStreamContinue</span></a></span><span> </span><span id="local-6989586621679190014"><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190014"><span class="hs-identifier hs-var">nextStream</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679190013"><span class="annot"><span class="annottext">finishUp :: PgStream a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190013"><span class="hs-identifier hs-var hs-var">finishUp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-type">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679190012"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190012"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190026"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679190012"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-202"></span><span>                   </span><span class="annot"><a href="#local-6989586621679190013"><span class="hs-identifier hs-var">finishUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-type">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679190011"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190011"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679190011"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>                   </span><span class="annot"><a href="#local-6989586621679190013"><span class="hs-identifier hs-var">finishUp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-type">PgStreamContinue</span></a></span><span> </span><span id="local-6989586621679190010"><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190010"><span class="hs-identifier hs-var">next'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190010"><span class="hs-identifier hs-var">next'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Row
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">IO (PgStream a)
-&gt; (PgStream a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190013"><span class="hs-identifier hs-var">finishUp</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>                   </span><span id="local-6989586621679190009"><span class="annot"><span class="annottext">columnCount :: Column
</span><a href="#local-6989586621679190009"><span class="hs-identifier hs-var hs-var">columnCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Column
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Column) -&gt; Int -&gt; Column
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy Postgres -&gt; Proxy x -&gt; Int
forall be a. FromBackendRow be a =&gt; Proxy be -&gt; Proxy a -&gt; Int
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">valuesNeeded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Postgres
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy x
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679190029"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">RowParser Row
-&gt; Connection
-&gt; Query
-&gt; PgStream a
-&gt; (PgStream a -&gt; Row -&gt; IO (PgStream a))
-&gt; IO (PgStream a)
forall r a.
RowParser r -&gt; Connection -&gt; Query -&gt; a -&gt; (a -&gt; r -&gt; IO a) -&gt; IO a
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.foldWith_</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT Row (StateT Column Conversion) Row -&gt; RowParser Row
forall a. ReaderT Row (StateT Column Conversion) a -&gt; RowParser a
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.RP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Column -&gt; ReaderT Row (StateT Column Conversion) ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">Column
</span><a href="#local-6989586621679190009"><span class="hs-identifier hs-var">columnCount</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT Row (StateT Column Conversion) ()
-&gt; ReaderT Row (StateT Column Conversion) Row
-&gt; ReaderT Row (StateT Column Conversion) Row
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ReaderT Row (StateT Column Conversion) Row
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../../../../mtl/html/src"><span class="hs-identifier hs-var">ask</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Query
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.Query</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679190025"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
forall a. (Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-var">PgStreamContinue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190014"><span class="hs-identifier hs-var">nextStream</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; Row -&gt; IO (PgStream a)
forall a. PgStream a -&gt; Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190002"><span class="hs-identifier hs-var">runConsumer</span></a></span><span> </span><span class="annot"><span class="annottext">IO (PgStream a)
-&gt; (PgStream a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190013"><span class="hs-identifier hs-var">finishUp</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#AtOnce"><span class="hs-identifier hs-var">AtOnce</span></a></span><span>
</span><span id="line-208"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeQuery"><span class="hs-identifier hs-var">PgCommandTypeQuery</span></a></span><span> </span><span id="local-6989586621679190000"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679190000"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                           </span><span class="hs-special">(</span><span id="local-6989586621679189998"><span id="local-6989586621679189999"><span id="local-6989586621679189997"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189997"><span class="hs-identifier hs-var">mkProcess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189999"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189998"><span class="hs-identifier hs-type">a'</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                           </span><span id="local-6989586621679189996"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189996"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>        </span><span class="annot"><span class="annottext">ByteString
-&gt; PgSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall x a' a.
FromBackendRow Postgres x =&gt;
ByteString
-&gt; PgSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a')
-&gt; (a' -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189995"><span class="hs-identifier hs-var">renderExecReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;No tuples returned to Postgres query&quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679190000"><span class="hs-identifier hs-var">syntax</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189997"><span class="hs-identifier hs-var">mkProcess</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189996"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span id="local-6989586621679189993"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189993"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189992"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189992"><span class="hs-identifier hs-var">mkProcess</span></a></span></span><span> </span><span id="local-6989586621679189991"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189991"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><span class="annottext">ByteString
-&gt; PgSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall x a' a.
FromBackendRow Postgres x =&gt;
ByteString
-&gt; PgSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a')
-&gt; (a' -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189995"><span class="hs-identifier hs-var">renderExecReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;No tuples returned to Postgres update/insert returning&quot;</span></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189993"><span class="hs-identifier hs-var">syntax</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189992"><span class="hs-identifier hs-var">mkProcess</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189991"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-214"></span><span>      </span><span class="annot"><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679189990"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189990"><span class="hs-identifier hs-var">syntax</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189989"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189989"><span class="hs-identifier hs-var">mkProcess</span></a></span></span><span> </span><span id="local-6989586621679189988"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189988"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679189987"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189987"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; PgSyntax -&gt; IO ByteString
</span><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier hs-var">pgRenderSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189990"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-216"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189987"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>           </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO Int64
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Query
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.Query</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189987"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span id="local-6989586621679189986"><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679189986"><span class="hs-identifier hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189989"><span class="hs-identifier hs-var">mkProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F PgF (Maybe x) -&gt; Pg (Maybe x)
forall a. F PgF a -&gt; Pg a
</span><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-var">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgF (Maybe x) -&gt; F PgF (Maybe x)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe x -&gt; Maybe x) -&gt; PgF (Maybe x)
forall x next.
FromBackendRow Postgres x =&gt;
(Maybe x -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-var">PgFetchNext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>           </span><span class="annot"><span class="annottext">F PgF a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; (PgF (IO (Either BeamRowReadError a))
    -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679189986"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189988"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">PgF (IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall a.
PgF (IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189985"><span class="hs-identifier hs-var">stepReturningNone</span></a></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621679189983"><span id="local-6989586621679189984"><span class="annot"><a href="#local-6989586621679189995"><span class="hs-identifier hs-type">renderExecReturningList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189984"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgSyntax"><span class="hs-identifier hs-type">PgSyntax</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189984"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189983"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span></span></span><span>
</span><span id="line-223"></span><span>      </span><span id="local-6989586621679189995"><span class="annot"><span class="annottext">renderExecReturningList :: ByteString
-&gt; PgSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a')
-&gt; (a' -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189995"><span class="hs-identifier hs-var hs-var">renderExecReturningList</span></a></span></span><span> </span><span id="local-6989586621679189982"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189982"><span class="hs-identifier hs-var">errMsg</span></a></span></span><span> </span><span id="local-6989586621679189981"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189981"><span class="hs-identifier hs-var">syntax</span></a></span></span><span> </span><span id="local-6989586621679189980"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a'
</span><a href="#local-6989586621679189980"><span class="hs-identifier hs-var">mkProcess</span></a></span></span><span> </span><span id="local-6989586621679189979"><span class="annot"><span class="annottext">a' -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189979"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679189978"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189978"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; PgSyntax -&gt; IO ByteString
</span><a href="Database.Beam.Postgres.Connection.html#pgRenderSyntax"><span class="hs-identifier hs-var">pgRenderSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189981"><span class="hs-identifier hs-var">syntax</span></a></span><span>
</span><span id="line-225"></span><span>           </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.unpack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">decodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189978"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>           </span><span id="local-6989586621679189977"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189977"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ByteString -&gt; IO Result
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.exec</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189978"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-228"></span><span>           </span><span id="local-6989586621679189976"><span class="annot"><span class="annottext">ExecStatus
</span><a href="#local-6989586621679189976"><span class="hs-identifier hs-var">sts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO ExecStatus
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.resultStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189977"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-229"></span><span>           </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExecStatus
</span><a href="#local-6989586621679189976"><span class="hs-identifier hs-var">sts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-230"></span><span>             </span><span class="annot"><span class="annottext">ExecStatus
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.TuplesOk</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span id="local-6989586621679189973"><span class="annot"><span class="annottext">F PgF a'
</span><a href="#local-6989586621679189973"><span class="hs-identifier hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a'
</span><a href="#local-6989586621679189980"><span class="hs-identifier hs-var">mkProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">F PgF (Maybe x) -&gt; Pg (Maybe x)
forall a. F PgF a -&gt; Pg a
</span><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-var">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgF (Maybe x) -&gt; F PgF (Maybe x)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe x -&gt; Maybe x) -&gt; PgF (Maybe x)
forall x next.
FromBackendRow Postgres x =&gt;
(Maybe x -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-var">PgFetchNext</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>               </span><span class="annot"><span class="annottext">F PgF a'
-&gt; (a' -&gt; CInt -&gt; IO (Either BeamRowReadError a))
-&gt; (PgF (CInt -&gt; IO (Either BeamRowReadError a))
    -&gt; CInt -&gt; IO (Either BeamRowReadError a))
-&gt; CInt
-&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F PgF a'
</span><a href="#local-6989586621679189973"><span class="hs-identifier hs-var">process</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679189972"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679189972"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO ()
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.unsafeFreeResult</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189977"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
-&gt; IO (Either BeamRowReadError a) -&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a' -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189979"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679189972"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
-&gt; PgF (CInt -&gt; IO (Either BeamRowReadError a))
-&gt; CInt
-&gt; IO (Either BeamRowReadError a)
forall a.
Result
-&gt; PgF (CInt -&gt; IO (Either BeamRowReadError a))
-&gt; CInt
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189970"><span class="hs-identifier hs-var">stepReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189977"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-233"></span><span>             </span><span class="annot"><span class="annottext">ExecStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString
-&gt; Result -&gt; ExecStatus -&gt; IO (Either BeamRowReadError a)
forall a. ByteString -&gt; Result -&gt; ExecStatus -&gt; IO a
</span><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-var">Pg.throwResultError</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679189982"><span class="hs-identifier hs-var">errMsg</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189977"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">ExecStatus
</span><a href="#local-6989586621679189976"><span class="hs-identifier hs-var">sts</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><a href="#local-6989586621679189985"><span class="hs-identifier hs-type">stepReturningNone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190386"><span class="annot"><a href="#local-6989586621679190386"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190386"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190386"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>      </span><span id="local-6989586621679189985"><span class="annot"><span class="annottext">stepReturningNone :: PgF (IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189985"><span class="hs-identifier hs-var hs-var">stepReturningNone</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-type">PgLiftIO</span></a></span><span> </span><span id="local-6989586621679189969"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189969"><span class="hs-identifier hs-var">action'</span></a></span></span><span> </span><span id="local-6989586621679189968"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189968"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189969"><span class="hs-identifier hs-var">action'</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189968"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679189985"><span class="hs-identifier hs-var">stepReturningNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-type">PgLiftWithHandle</span></a></span><span> </span><span id="local-6989586621679189967"><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679189967"><span class="hs-identifier hs-var">withConn</span></a></span></span><span> </span><span id="local-6989586621679189966"><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189966"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679189967"><span class="hs-identifier hs-var">withConn</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679190049"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189966"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><a href="#local-6989586621679189985"><span class="hs-identifier hs-var">stepReturningNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679189965"><span class="annot"><span class="annottext">Maybe x -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189965"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189965"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><a href="#local-6989586621679189985"><span class="hs-identifier hs-var">stepReturningNone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nested queries not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="#local-6989586621679189970"><span class="hs-identifier hs-type">stepReturningList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190384"><span class="annot"><a href="#local-6989586621679190384"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Result</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190384"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamRowReadError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190384"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>      </span><span id="local-6989586621679189970"><span class="annot"><span class="annottext">stepReturningList :: Result
-&gt; PgF (CInt -&gt; IO (Either BeamRowReadError a))
-&gt; CInt
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189970"><span class="hs-identifier hs-var hs-var">stepReturningList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Result
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-type">PgLiftIO</span></a></span><span> </span><span id="local-6989586621679189964"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189964"><span class="hs-identifier hs-var">action'</span></a></span></span><span> </span><span id="local-6989586621679189963"><span class="annot"><span class="annottext">a -&gt; CInt -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189963"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189962"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189962"><span class="hs-identifier hs-var">rowIdx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189964"><span class="hs-identifier hs-var">action'</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679189961"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189961"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; CInt -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189963"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189961"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189962"><span class="hs-identifier hs-var">rowIdx</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><a href="#local-6989586621679189970"><span class="hs-identifier hs-var">stepReturningList</span></a></span><span> </span><span id="local-6989586621679189960"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189960"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679189959"><span class="annot"><span class="annottext">Maybe x -&gt; CInt -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189959"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189958"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189958"><span class="hs-identifier hs-var">rowIdx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679189957"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189957"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO [Field]
</span><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189960"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-245"></span><span>           </span><span class="annot"><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-type">Pg.Row</span></a></span><span> </span><span id="local-6989586621679189955"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189955"><span class="hs-identifier hs-var">rowCount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO Row
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.ntuples</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189960"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-246"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189958"><span class="hs-identifier hs-var">rowIdx</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189955"><span class="hs-identifier hs-var">rowCount</span></a></span><span>
</span><span id="line-247"></span><span>             </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; CInt -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189959"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189958"><span class="hs-identifier hs-var">rowIdx</span></a></span><span>
</span><span id="line-248"></span><span>             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres x
-&gt; IO (Either BeamRowReadError x)
forall a.
Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres a
-&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier hs-var">runPgRowReader</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt -&gt; Row
</span><a href="../../../../postgresql-libpq/html/src"><span class="hs-identifier hs-var">Pg.Row</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189958"><span class="hs-identifier hs-var">rowIdx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189960"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189957"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">FromBackendRowM Postgres x
forall be a. FromBackendRow be a =&gt; FromBackendRowM be a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fromBackendRow</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
-&gt; (Either BeamRowReadError x -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-249"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679189952"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189952"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189952"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>                    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679189951"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189951"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; CInt -&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679189959"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189951"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679189958"><span class="hs-identifier hs-var">rowIdx</span></a></span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; CInt
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="#local-6989586621679189970"><span class="hs-identifier hs-var">stepReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nested queries not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="#local-6989586621679189970"><span class="hs-identifier hs-var">stepReturningList</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-type">PgLiftWithHandle</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nested queries not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><a href="#local-6989586621679190020"><span class="hs-identifier hs-type">finishProcess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190419"><span class="annot"><a href="#local-6989586621679190419"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679190419"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190419"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>      </span><span id="local-6989586621679190020"><span class="annot"><span class="annottext">finishProcess :: a -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190020"><span class="hs-identifier hs-var hs-var">finishProcess</span></a></span></span><span> </span><span id="local-6989586621679189950"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189950"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; PgStream a
forall a. Either BeamRowReadError a -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either BeamRowReadError a
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189950"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="#local-6989586621679190019"><span class="hs-identifier hs-type">stepProcess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190418"><span class="annot"><a href="#local-6989586621679190418"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190418"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span id="local-6989586621679190019"><span class="annot"><span class="annottext">stepProcess :: PgF (Maybe Row -&gt; IO (PgStream a)) -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190019"><span class="hs-identifier hs-var hs-var">stepProcess</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-type">PgLiftIO</span></a></span><span> </span><span id="local-6989586621679189949"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189949"><span class="hs-identifier hs-var">action'</span></a></span></span><span> </span><span id="local-6989586621679189948"><span class="annot"><span class="annottext">a -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189948"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189947"><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679189947"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189949"><span class="hs-identifier hs-var">action'</span></a></span><span> </span><span class="annot"><span class="annottext">IO a -&gt; (a -&gt; IO (PgStream a)) -&gt; IO (PgStream a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe Row -&gt; IO (PgStream a))
-&gt; Maybe Row -&gt; a -&gt; IO (PgStream a)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189948"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679189947"><span class="hs-identifier hs-var">row</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><a href="#local-6989586621679190019"><span class="hs-identifier hs-var">stepProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679189945"><span class="annot"><span class="annottext">Maybe x -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189945"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PgStream a -&gt; IO (PgStream a))
-&gt; ((Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a)
-&gt; (Maybe Row -&gt; IO (PgStream a))
-&gt; IO (PgStream a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
forall a. (Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-var">PgStreamContinue</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe Row -&gt; IO (PgStream a)) -&gt; IO (PgStream a))
-&gt; (Maybe Row -&gt; IO (PgStream a)) -&gt; IO (PgStream a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679189944"><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679189944"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><a href="#local-6989586621679189944"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>          </span><span class="annot"><span class="annottext">Maybe Row
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189945"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Row
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-263"></span><span>          </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span id="local-6989586621679189942"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189942"><span class="hs-identifier hs-var">rowIdx</span></a></span></span><span> </span><span id="local-6989586621679189941"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189941"><span class="hs-identifier hs-var">res'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>            </span><span class="annot"><span class="annottext">Result -&gt; IO [Field]
</span><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189941"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="annot"><span class="annottext">IO [Field] -&gt; ([Field] -&gt; IO (PgStream a)) -&gt; IO (PgStream a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679189940"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189940"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><span class="annottext">Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres x
-&gt; IO (Either BeamRowReadError x)
forall a.
Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres a
-&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier hs-var">runPgRowReader</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189942"><span class="hs-identifier hs-var">rowIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189941"><span class="hs-identifier hs-var">res'</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189940"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">FromBackendRowM Postgres x
forall be a. FromBackendRow be a =&gt; FromBackendRowM be a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fromBackendRow</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
-&gt; (Either BeamRowReadError x -&gt; IO (PgStream a))
-&gt; IO (PgStream a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-266"></span><span>              </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679189939"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189939"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; PgStream a
forall a. Either BeamRowReadError a -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189939"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>              </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679189938"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189938"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189945"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189938"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Row
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="#local-6989586621679190019"><span class="hs-identifier hs-var">stepProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679189937"><span class="annot"><span class="annottext">Maybe x -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189937"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span id="local-6989586621679189936"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189936"><span class="hs-identifier hs-var">rowIdx</span></a></span></span><span> </span><span id="local-6989586621679189935"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189935"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">Result -&gt; IO [Field]
</span><a href="Database.Beam.Postgres.Connection.html#getFields"><span class="hs-identifier hs-var">getFields</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189935"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">IO [Field] -&gt; ([Field] -&gt; IO (PgStream a)) -&gt; IO (PgStream a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679189934"><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189934"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres x
-&gt; IO (Either BeamRowReadError x)
forall a.
Connection
-&gt; Row
-&gt; Result
-&gt; [Field]
-&gt; FromBackendRowM Postgres a
-&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#runPgRowReader"><span class="hs-identifier hs-var">runPgRowReader</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679190048"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189936"><span class="hs-identifier hs-var">rowIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679189935"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">[Field]
</span><a href="#local-6989586621679189934"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">FromBackendRowM Postgres x
forall be a. FromBackendRow be a =&gt; FromBackendRowM be a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">fromBackendRow</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError x)
-&gt; (Either BeamRowReadError x -&gt; IO (PgStream a))
-&gt; IO (PgStream a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-271"></span><span>          </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679189933"><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189933"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; PgStream a
forall a. Either BeamRowReadError a -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError
</span><a href="#local-6989586621679189933"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>          </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679189932"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189932"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
forall a. (Maybe Row -&gt; IO (PgStream a)) -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-var">PgStreamContinue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189937"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; Maybe x
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679189932"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><a href="#local-6989586621679190019"><span class="hs-identifier hs-var">stepProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; PgStream a
forall a. Either BeamRowReadError a -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nested queries not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="#local-6989586621679190019"><span class="hs-identifier hs-var">stepProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-type">PgLiftWithHandle</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe Row -&gt; IO (PgStream a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Row
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either BeamRowReadError a -&gt; PgStream a
forall a. Either BeamRowReadError a -&gt; PgStream a
</span><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-var">PgStreamDone</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamRowReadError -&gt; Either BeamRowReadError a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ColumnParseError -&gt; BeamRowReadError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">BeamRowReadError</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ColumnParseError
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">ColumnErrorInternal</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Nested queries not allowed&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="#local-6989586621679190002"><span class="hs-identifier hs-type">runConsumer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679190396"><span class="annot"><a href="#local-6989586621679190396"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190396"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">PgI.Row</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStream"><span class="hs-identifier hs-type">PgStream</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190396"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621679190002"><span class="annot"><span class="annottext">runConsumer :: PgStream a -&gt; Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679190002"><span class="hs-identifier hs-var hs-var">runConsumer</span></a></span></span><span> </span><span id="local-6989586621679189931"><span class="annot"><span class="annottext">s :: PgStream a
</span><a href="#local-6989586621679189931"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamDone"><span class="hs-identifier hs-type">PgStreamDone</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Row
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgStream a -&gt; IO (PgStream a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">PgStream a
</span><a href="#local-6989586621679189931"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="#local-6989586621679190002"><span class="hs-identifier hs-var">runConsumer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgStreamContinue"><span class="hs-identifier hs-type">PgStreamContinue</span></a></span><span> </span><span id="local-6989586621679189930"><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189930"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679189929"><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189929"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Row -&gt; IO (PgStream a)
</span><a href="#local-6989586621679189930"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Row -&gt; Maybe Row
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Row
</span><a href="#local-6989586621679189929"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">F PgF a
-&gt; (a -&gt; IO (Either BeamRowReadError a))
-&gt; (PgF (IO (Either BeamRowReadError a))
    -&gt; IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">F PgF a
</span><a href="#local-6989586621679190046"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO (Either BeamRowReadError a)
forall (f :: * -&gt; *) b a. Applicative f =&gt; b -&gt; f (Either a b)
</span><a href="#local-6989586621679190045"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">PgF (IO (Either BeamRowReadError a))
-&gt; IO (Either BeamRowReadError a)
</span><a href="#local-6989586621679190043"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-280"></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- * Beam Monad class</span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-keyword">data</span><span> </span><span id="PgF"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-var">PgF</span></a></span></span><span> </span><span id="local-6989586621679189928"><span class="annot"><a href="#local-6989586621679189928"><span class="hs-identifier hs-type">next</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679189927"><span id="local-6989586621679190353"><span id="PgLiftIO"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-var">PgLiftIO</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189927"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679189927"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679190353"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190353"><span class="hs-identifier hs-type">next</span></a></span></span></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679189925"><span id="local-6989586621679189926"><span id="local-6989586621679190348"><span id="PgRunReturning"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189926"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#FetchMode"><span class="hs-identifier hs-type">FetchMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-type">PgCommandSyntax</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189926"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189925"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679189925"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679190348"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190348"><span class="hs-identifier hs-type">next</span></a></span></span></span></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679189924"><span id="local-6989586621679190423"><span id="PgFetchNext"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-var">PgFetchNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">FromBackendRow</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189924"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189924"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679190423"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190423"><span class="hs-identifier hs-type">next</span></a></span></span></span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679189923"><span id="local-6989586621679190344"><span id="PgLiftWithHandle"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-var">PgLiftWithHandle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189923"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679189923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679190344"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190344"><span class="hs-identifier hs-type">next</span></a></span></span></span><span>
</span><span id="line-292"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679189920"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679189918"><span class="annot"><span class="annottext">fmap :: (a -&gt; b) -&gt; PgF a -&gt; PgF b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fmap</span></a></span></span><span> </span><span id="local-6989586621679189917"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679189917"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-type">PgLiftIO</span></a></span><span> </span><span id="local-6989586621679189916"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189916"><span class="hs-identifier hs-var">io</span></a></span></span><span> </span><span id="local-6989586621679189915"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189915"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO a -&gt; (a -&gt; b) -&gt; PgF b
forall a next. IO a -&gt; (a -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-var">PgLiftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189916"><span class="hs-identifier hs-var">io</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; PgF b) -&gt; (a -&gt; b) -&gt; PgF b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679189917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189915"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-type">PgRunReturning</span></a></span><span> </span><span id="local-6989586621679189914"><span class="annot"><span class="annottext">FetchMode
</span><a href="#local-6989586621679189914"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span id="local-6989586621679189913"><span class="annot"><span class="annottext">PgCommandSyntax
</span><a href="#local-6989586621679189913"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679189912"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189912"><span class="hs-identifier hs-var">consume</span></a></span></span><span> </span><span id="local-6989586621679189911"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189911"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FetchMode
-&gt; PgCommandSyntax -&gt; (Pg (Maybe x) -&gt; Pg a) -&gt; (a -&gt; b) -&gt; PgF b
forall x a next.
FromBackendRow Postgres x =&gt;
FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; next)
-&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="#local-6989586621679189914"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandSyntax
</span><a href="#local-6989586621679189913"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189912"><span class="hs-identifier hs-var">consume</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; PgF b) -&gt; (a -&gt; b) -&gt; PgF b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679189917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189911"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-type">PgFetchNext</span></a></span><span> </span><span id="local-6989586621679189910"><span class="annot"><span class="annottext">Maybe x -&gt; a
</span><a href="#local-6989586621679189910"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Maybe x -&gt; b) -&gt; PgF b
forall x next.
FromBackendRow Postgres x =&gt;
(Maybe x -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgFetchNext"><span class="hs-identifier hs-var">PgFetchNext</span></a></span><span> </span><span class="annot"><span class="annottext">((Maybe x -&gt; b) -&gt; PgF b) -&gt; (Maybe x -&gt; b) -&gt; PgF b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679189917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (Maybe x -&gt; a) -&gt; Maybe x -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; a
</span><a href="#local-6989586621679189910"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-type">PgLiftWithHandle</span></a></span><span> </span><span id="local-6989586621679189909"><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679189909"><span class="hs-identifier hs-var">withConn</span></a></span></span><span> </span><span id="local-6989586621679189908"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189908"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; Connection -&gt; IO a) -&gt; (a -&gt; b) -&gt; PgF b
forall a next.
((String -&gt; IO ()) -&gt; Connection -&gt; IO a)
-&gt; (a -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-var">PgLiftWithHandle</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; IO a
</span><a href="#local-6989586621679189909"><span class="hs-identifier hs-var">withConn</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; b) -&gt; PgF b) -&gt; (a -&gt; b) -&gt; PgF b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679189917"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (a -&gt; a) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679189908"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | How to fetch results.</span><span>
</span><span id="line-300"></span><span class="hs-keyword">data</span><span> </span><span id="FetchMode"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#FetchMode"><span class="hs-identifier hs-var">FetchMode</span></a></span></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="CursorBatching"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#CursorBatching"><span class="hs-identifier hs-var">CursorBatching</span></a></span></span><span> </span><span class="hs-comment">-- ^ Fetch in batches of ~256 rows via cursor for SELECT.</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="AtOnce"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#AtOnce"><span class="hs-identifier hs-var">AtOnce</span></a></span></span><span>         </span><span class="hs-comment">-- ^ Fetch all rows at once.</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | 'MonadBeam' in which we can run Postgres commands. See the documentation</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- for 'MonadBeam' on examples of how to use.</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- @beam-postgres@ also provides functions that let you run queries without</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- 'MonadBeam'. These functions may be more efficient and offer a conduit</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- API. See &quot;Database.Beam.Postgres.Conduit&quot; for more information.</span><span>
</span><span id="line-310"></span><span class="hs-keyword">newtype</span><span> </span><span id="Pg"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-var">Pg</span></a></span></span><span> </span><span id="local-6989586621679190430"><span class="annot"><a href="#local-6989586621679190430"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Pg"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-var">Pg</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runPg"><span class="annot"><span class="annottext">Pg a -&gt; F PgF a
</span><a href="Database.Beam.Postgres.Connection.html#runPg"><span class="hs-identifier hs-var hs-var">runPg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679189900"><span id="local-6989586621679189902"><span id="local-6989586621679189904"><span class="annot"><span class="annottext">Applicative Pg
a -&gt; Pg a
Applicative Pg
-&gt; (forall a b. Pg a -&gt; (a -&gt; Pg b) -&gt; Pg b)
-&gt; (forall a b. Pg a -&gt; Pg b -&gt; Pg b)
-&gt; (forall a. a -&gt; Pg a)
-&gt; Monad Pg
Pg a -&gt; (a -&gt; Pg b) -&gt; Pg b
Pg a -&gt; Pg b -&gt; Pg b
forall a. a -&gt; Pg a
forall a b. Pg a -&gt; Pg b -&gt; Pg b
forall a b. Pg a -&gt; (a -&gt; Pg b) -&gt; Pg b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: a -&gt; Pg a
$creturn :: forall a. a -&gt; Pg a
&gt;&gt; :: Pg a -&gt; Pg b -&gt; Pg b
$c&gt;&gt; :: forall a b. Pg a -&gt; Pg b -&gt; Pg b
&gt;&gt;= :: Pg a -&gt; (a -&gt; Pg b) -&gt; Pg b
$c&gt;&gt;= :: forall a b. Pg a -&gt; (a -&gt; Pg b) -&gt; Pg b
$cp1Monad :: Applicative Pg
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679189888"><span id="local-6989586621679189890"><span id="local-6989586621679189892"><span id="local-6989586621679189894"><span id="local-6989586621679189896"><span class="annot"><span class="annottext">Functor Pg
a -&gt; Pg a
Functor Pg
-&gt; (forall a. a -&gt; Pg a)
-&gt; (forall a b. Pg (a -&gt; b) -&gt; Pg a -&gt; Pg b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; Pg a -&gt; Pg b -&gt; Pg c)
-&gt; (forall a b. Pg a -&gt; Pg b -&gt; Pg b)
-&gt; (forall a b. Pg a -&gt; Pg b -&gt; Pg a)
-&gt; Applicative Pg
Pg a -&gt; Pg b -&gt; Pg b
Pg a -&gt; Pg b -&gt; Pg a
Pg (a -&gt; b) -&gt; Pg a -&gt; Pg b
(a -&gt; b -&gt; c) -&gt; Pg a -&gt; Pg b -&gt; Pg c
forall a. a -&gt; Pg a
forall a b. Pg a -&gt; Pg b -&gt; Pg a
forall a b. Pg a -&gt; Pg b -&gt; Pg b
forall a b. Pg (a -&gt; b) -&gt; Pg a -&gt; Pg b
forall a b c. (a -&gt; b -&gt; c) -&gt; Pg a -&gt; Pg b -&gt; Pg c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: Pg a -&gt; Pg b -&gt; Pg a
$c&lt;* :: forall a b. Pg a -&gt; Pg b -&gt; Pg a
*&gt; :: Pg a -&gt; Pg b -&gt; Pg b
$c*&gt; :: forall a b. Pg a -&gt; Pg b -&gt; Pg b
liftA2 :: (a -&gt; b -&gt; c) -&gt; Pg a -&gt; Pg b -&gt; Pg c
$cliftA2 :: forall a b c. (a -&gt; b -&gt; c) -&gt; Pg a -&gt; Pg b -&gt; Pg c
&lt;*&gt; :: Pg (a -&gt; b) -&gt; Pg a -&gt; Pg b
$c&lt;*&gt; :: forall a b. Pg (a -&gt; b) -&gt; Pg a -&gt; Pg b
pure :: a -&gt; Pg a
$cpure :: forall a. a -&gt; Pg a
$cp1Applicative :: Functor Pg
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></a></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679189883"><span id="local-6989586621679189885"><span class="annot"><span class="annottext">a -&gt; Pg b -&gt; Pg a
(a -&gt; b) -&gt; Pg a -&gt; Pg b
(forall a b. (a -&gt; b) -&gt; Pg a -&gt; Pg b)
-&gt; (forall a b. a -&gt; Pg b -&gt; Pg a) -&gt; Functor Pg
forall a b. a -&gt; Pg b -&gt; Pg a
forall a b. (a -&gt; b) -&gt; Pg a -&gt; Pg b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Pg b -&gt; Pg a
$c&lt;$ :: forall a b. a -&gt; Pg b -&gt; Pg a
fmap :: (a -&gt; b) -&gt; Pg a -&gt; Pg b
$cfmap :: forall a b. (a -&gt; b) -&gt; Pg a -&gt; Pg b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679189880"><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">MonadFree</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#PgF"><span class="hs-identifier hs-type">PgF</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fail.MonadFail</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621679189875"><span class="annot"><span class="annottext">fail :: String -&gt; Pg a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fail</span></a></span></span><span> </span><span id="local-6989586621679189874"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679189874"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">IO a -&gt; Pg a
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Fail.fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO a) -&gt; String -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Internal Error with: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679189874"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679189869"><span class="annot"><span class="annottext">liftIO :: IO a -&gt; Pg a
</span><a href="#local-6989586621679189869"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftIO</span></a></span></span><span> </span><span id="local-6989586621679189868"><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189868"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgF a -&gt; Pg a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO a -&gt; (a -&gt; a) -&gt; PgF a
forall a next. IO a -&gt; (a -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgLiftIO"><span class="hs-identifier hs-var">PgLiftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679189868"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../transformers-base/html/src"><span class="hs-identifier hs-type">MonadBase</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679189861"><span class="annot"><span class="annottext">liftBase :: IO &#945; -&gt; Pg &#945;
</span><a href="../../../../transformers-base/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO &#945; -&gt; Pg &#945;
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../monad-control/html/src"><span class="hs-identifier hs-type">MonadBaseControl</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="StM"><span class="annot"><a href="../../../../monad-control/html/src"><span class="hs-identifier hs-var">StM</span></a></span></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span id="local-6989586621679189855"><span class="annot"><a href="#local-6989586621679189855"><span class="hs-identifier hs-type hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679189855"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span>    </span><span id="local-6989586621679189854"><span class="annot"><span class="annottext">liftBaseWith :: (RunInBase Pg IO -&gt; IO a) -&gt; Pg a
</span><a href="../../../../monad-control/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftBaseWith</span></a></span></span><span> </span><span id="local-6989586621679189852"><span class="annot"><span class="annottext">RunInBase Pg IO -&gt; IO a
</span><a href="#local-6989586621679189852"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="annottext">PgF a -&gt; Pg a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; Connection -&gt; IO a) -&gt; (a -&gt; a) -&gt; PgF a
forall a next.
((String -&gt; IO ()) -&gt; Connection -&gt; IO a)
-&gt; (a -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-var">PgLiftWithHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679189851"><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679189851"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span id="local-6989586621679189850"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679189850"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RunInBase Pg IO -&gt; IO a
</span><a href="#local-6989586621679189852"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; Pg a -&gt; IO a
forall a. (String -&gt; IO ()) -&gt; Connection -&gt; Pg a -&gt; IO a
</span><a href="Database.Beam.Postgres.Connection.html#runBeamPostgresDebug"><span class="hs-identifier hs-var">runBeamPostgresDebug</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679189851"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679189850"><span class="hs-identifier hs-var">conn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621679189849"><span class="annot"><span class="annottext">restoreM :: StM Pg a -&gt; Pg a
</span><a href="../../../../monad-control/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">restoreM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StM Pg a -&gt; Pg a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span id="local-6989586621679189847"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#liftIOWithHandle"><span class="hs-identifier hs-type">liftIOWithHandle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189847"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189847"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-331"></span><span id="liftIOWithHandle"><span class="annot"><span class="annottext">liftIOWithHandle :: (Connection -&gt; IO a) -&gt; Pg a
</span><a href="Database.Beam.Postgres.Connection.html#liftIOWithHandle"><span class="hs-identifier hs-var hs-var">liftIOWithHandle</span></a></span></span><span> </span><span id="local-6989586621679189846"><span class="annot"><span class="annottext">Connection -&gt; IO a
</span><a href="#local-6989586621679189846"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PgF a -&gt; Pg a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; Connection -&gt; IO a) -&gt; (a -&gt; a) -&gt; PgF a
forall a next.
((String -&gt; IO ()) -&gt; Connection -&gt; IO a)
-&gt; (a -&gt; next) -&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgLiftWithHandle"><span class="hs-identifier hs-var">PgLiftWithHandle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; IO a
</span><a href="#local-6989586621679189846"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span id="local-6989586621679190290"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runBeamPostgresDebug"><span class="hs-identifier hs-type">runBeamPostgresDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190290"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679190290"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-334"></span><span id="runBeamPostgresDebug"><span class="annot"><span class="annottext">runBeamPostgresDebug :: (String -&gt; IO ()) -&gt; Connection -&gt; Pg a -&gt; IO a
</span><a href="Database.Beam.Postgres.Connection.html#runBeamPostgresDebug"><span class="hs-identifier hs-var hs-var">runBeamPostgresDebug</span></a></span></span><span> </span><span id="local-6989586621679189845"><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679189845"><span class="hs-identifier hs-var">dbg</span></a></span></span><span> </span><span id="local-6989586621679189844"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679189844"><span class="hs-identifier hs-var">conn</span></a></span></span><span> </span><span id="local-6989586621679189843"><span class="annot"><span class="annottext">Pg a
</span><a href="#local-6989586621679189843"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; IO ())
-&gt; Connection -&gt; Pg a -&gt; IO (Either BeamRowReadError a)
forall a.
(String -&gt; IO ())
-&gt; Connection -&gt; Pg a -&gt; IO (Either BeamRowReadError a)
</span><a href="Database.Beam.Postgres.Connection.html#withPgDebug"><span class="hs-identifier hs-var">withPgDebug</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><a href="#local-6989586621679189845"><span class="hs-identifier hs-var">dbg</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679189844"><span class="hs-identifier hs-var">conn</span></a></span><span> </span><span class="annot"><span class="annottext">Pg a
</span><a href="#local-6989586621679189843"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either BeamRowReadError a)
-&gt; (Either BeamRowReadError a -&gt; IO a) -&gt; IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(BeamRowReadError -&gt; IO a)
-&gt; (a -&gt; IO a) -&gt; Either BeamRowReadError a -&gt; IO a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">BeamRowReadError -&gt; IO a
forall e a. Exception e =&gt; e -&gt; IO a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621679189841"><span class="annot"><a href="Database.Beam.Postgres.Connection.html#runBeamPostgres"><span class="hs-identifier hs-type">runBeamPostgres</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../postgresql-simple/html/src"><span class="hs-identifier hs-type">Pg.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189841"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679189841"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-338"></span><span id="runBeamPostgres"><span class="annot"><span class="annottext">runBeamPostgres :: Connection -&gt; Pg a -&gt; IO a
</span><a href="Database.Beam.Postgres.Connection.html#runBeamPostgres"><span class="hs-identifier hs-var hs-var">runBeamPostgres</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; Connection -&gt; Pg a -&gt; IO a
forall a. (String -&gt; IO ()) -&gt; Connection -&gt; Pg a -&gt; IO a
</span><a href="Database.Beam.Postgres.Connection.html#runBeamPostgresDebug"><span class="hs-identifier hs-var">runBeamPostgresDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679189836"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeam</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679189831"><span class="annot"><span class="annottext">runReturningMany :: BeamSqlBackendSyntax Postgres -&gt; (Pg (Maybe x) -&gt; Pg a) -&gt; Pg a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runReturningMany</span></a></span></span><span> </span><span id="local-6989586621679189829"><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
</span><a href="#local-6989586621679189829"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679189828"><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189828"><span class="hs-identifier hs-var">consume</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">PgF a -&gt; Pg a
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FetchMode
-&gt; PgCommandSyntax -&gt; (Pg (Maybe x) -&gt; Pg a) -&gt; (a -&gt; a) -&gt; PgF a
forall x a next.
FromBackendRow Postgres x =&gt;
FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; next)
-&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#CursorBatching"><span class="hs-identifier hs-var">CursorBatching</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
PgCommandSyntax
</span><a href="#local-6989586621679189829"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg a
</span><a href="#local-6989586621679189828"><span class="hs-identifier hs-var">consume</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621679189827"><span class="annot"><span class="annottext">runReturningOne :: BeamSqlBackendSyntax Postgres -&gt; Pg (Maybe x)
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runReturningOne</span></a></span></span><span> </span><span id="local-6989586621679189825"><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
</span><a href="#local-6989586621679189825"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">PgF (Maybe x) -&gt; Pg (Maybe x)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg (Maybe x))
-&gt; (Maybe x -&gt; Maybe x)
-&gt; PgF (Maybe x)
forall x a next.
FromBackendRow Postgres x =&gt;
FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; next)
-&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#AtOnce"><span class="hs-identifier hs-var">AtOnce</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
PgCommandSyntax
</span><a href="#local-6989586621679189825"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg (Maybe x)
forall (m :: * -&gt; *) a. Monad m =&gt; m (Maybe a) -&gt; m (Maybe a)
</span><a href="#local-6989586621679189824"><span class="hs-identifier hs-var">consume</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679189824"><span class="annot"><span class="annottext">consume :: m (Maybe a) -&gt; m (Maybe a)
</span><a href="#local-6989586621679189824"><span class="hs-identifier hs-var hs-var">consume</span></a></span></span><span> </span><span id="local-6989586621679189823"><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679189823"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-348"></span><span>          </span><span id="local-6989586621679189822"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189822"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679189823"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189822"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679189821"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189821"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>              </span><span id="local-6989586621679189820"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189820"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679189823"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-353"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189820"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>                </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189821"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>                </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>    </span><span id="local-6989586621679189819"><span class="annot"><span class="annottext">runReturningFirst :: BeamSqlBackendSyntax Postgres -&gt; Pg (Maybe x)
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runReturningFirst</span></a></span></span><span> </span><span id="local-6989586621679189817"><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
</span><a href="#local-6989586621679189817"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">PgF (Maybe x) -&gt; Pg (Maybe x)
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg (Maybe x))
-&gt; (Maybe x -&gt; Maybe x)
-&gt; PgF (Maybe x)
forall x a next.
FromBackendRow Postgres x =&gt;
FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; next)
-&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#AtOnce"><span class="hs-identifier hs-var">AtOnce</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
PgCommandSyntax
</span><a href="#local-6989586621679189817"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg (Maybe x)
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe x -&gt; Maybe x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679189816"><span class="annot"><span class="annottext">runReturningList :: BeamSqlBackendSyntax Postgres -&gt; Pg [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runReturningList</span></a></span></span><span> </span><span id="local-6989586621679189814"><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
</span><a href="#local-6989586621679189814"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">PgF [x] -&gt; Pg [x]
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg [x])
-&gt; ([x] -&gt; [x])
-&gt; PgF [x]
forall x a next.
FromBackendRow Postgres x =&gt;
FetchMode
-&gt; PgCommandSyntax
-&gt; (Pg (Maybe x) -&gt; Pg a)
-&gt; (a -&gt; next)
-&gt; PgF next
</span><a href="Database.Beam.Postgres.Connection.html#PgRunReturning"><span class="hs-identifier hs-var">PgRunReturning</span></a></span><span> </span><span class="annot"><span class="annottext">FetchMode
</span><a href="Database.Beam.Postgres.Connection.html#AtOnce"><span class="hs-identifier hs-var">AtOnce</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres
PgCommandSyntax
</span><a href="#local-6989586621679189814"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Pg (Maybe x) -&gt; Pg [x]
forall (m :: * -&gt; *) a. Monad m =&gt; m (Maybe a) -&gt; m [a]
</span><a href="#local-6989586621679189813"><span class="hs-identifier hs-var">consume</span></a></span><span> </span><span class="annot"><span class="annottext">[x] -&gt; [x]
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621679189813"><span class="annot"><span class="annottext">consume :: m (Maybe a) -&gt; m [a]
</span><a href="#local-6989586621679189813"><span class="hs-identifier hs-var hs-var">consume</span></a></span></span><span> </span><span id="local-6989586621679189812"><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679189812"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679189811"><span class="annot"><span class="annottext">collectM :: ([a] -&gt; [a]) -&gt; m [a]
</span><a href="#local-6989586621679189811"><span class="hs-identifier hs-var hs-var">collectM</span></a></span></span><span> </span><span id="local-6989586621679189810"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679189810"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-365"></span><span>                </span><span id="local-6989586621679189809"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189809"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe a)
</span><a href="#local-6989586621679189812"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-366"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679189809"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-367"></span><span>                  </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679189810"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>                  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679189808"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189808"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a]
</span><a href="#local-6989586621679189811"><span class="hs-identifier hs-var">collectM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679189810"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679189808"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>          </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a]
</span><a href="#local-6989586621679189811"><span class="hs-identifier hs-var">collectM</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeamInsertReturning</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621679189804"><span class="annot"><span class="annottext">runInsertReturningList :: SqlInsert Postgres table -&gt; Pg [table Identity]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runInsertReturningList</span></a></span></span><span> </span><span id="local-6989586621679189802"><span class="annot"><span class="annottext">SqlInsert Postgres table
</span><a href="#local-6989586621679189802"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679189801"><span class="annot"><span class="annottext">insertReturningCmd' :: PgReturningType
  SqlInsert (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="#local-6989586621679189801"><span class="hs-identifier hs-var hs-var">insertReturningCmd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlInsert Postgres table
</span><a href="#local-6989586621679189802"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">SqlInsert Postgres table
-&gt; (table (QExpr Postgres PostgresInaccessible)
    -&gt; table (QExpr Postgres ()))
-&gt; PgReturningType
     SqlInsert (QExprToIdentity (table (QExpr Postgres ())))
forall (cmd :: * -&gt; ((* -&gt; *) -&gt; *) -&gt; *) (tbl :: (* -&gt; *) -&gt; *) a.
(PgReturning cmd, Beamable tbl, Projectible Postgres a) =&gt;
cmd Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType cmd (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-operator hs-var">`returning`</span></a></span><span>
</span><span id="line-374"></span><span>              </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QExpr Postgres PostgresInaccessible) a
 -&gt; Columnar' (QExpr Postgres ()) a)
-&gt; table (QExpr Postgres PostgresInaccessible)
-&gt; table (QExpr Postgres ())
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679189798"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span id="local-6989586621679189795"><span class="annot"><a href="#local-6989586621679189795"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189798"><span class="hs-identifier hs-type">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>                </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres ()) a -&gt; Columnar' (QExpr Postgres ()) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres () a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BeamSqlBackendExpressionSyntax Postgres
</span><a href="#local-6989586621679189795"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189798"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-comment">-- Make savepoint</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PgReturningType
  SqlInsert (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="#local-6989586621679189801"><span class="hs-identifier hs-var">insertReturningCmd'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><span class="annottext">PgReturningType
  SqlInsert (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="Database.Beam.Postgres.Full.html#PgInsertReturningEmpty"><span class="hs-identifier hs-var">PgInsertReturningEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-380"></span><span>            </span><span class="annot"><span class="annottext">[table Identity] -&gt; Pg [table Identity]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgInsertReturning"><span class="hs-identifier hs-type">PgInsertReturning</span></a></span><span> </span><span id="local-6989586621679189792"><span class="annot"><a href="#local-6989586621679189792"><span class="hs-identifier hs-var">insertReturningCmd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-382"></span><span>            </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres -&gt; Pg [table Identity]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189792"><span class="hs-identifier hs-var">insertReturningCmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeamUpdateReturning</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-385"></span><span>    </span><span id="local-6989586621679189788"><span class="annot"><span class="annottext">runUpdateReturningList :: SqlUpdate Postgres table -&gt; Pg [table Identity]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runUpdateReturningList</span></a></span></span><span> </span><span id="local-6989586621679189786"><span class="annot"><span class="annottext">SqlUpdate Postgres table
</span><a href="#local-6989586621679189786"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679189785"><span class="annot"><span class="annottext">updateReturningCmd' :: PgReturningType
  SqlUpdate (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="#local-6989586621679189785"><span class="hs-identifier hs-var hs-var">updateReturningCmd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlUpdate Postgres table
</span><a href="#local-6989586621679189786"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">SqlUpdate Postgres table
-&gt; (table (QExpr Postgres PostgresInaccessible)
    -&gt; table (QExpr Postgres ()))
-&gt; PgReturningType
     SqlUpdate (QExprToIdentity (table (QExpr Postgres ())))
forall (cmd :: * -&gt; ((* -&gt; *) -&gt; *) -&gt; *) (tbl :: (* -&gt; *) -&gt; *) a.
(PgReturning cmd, Beamable tbl, Projectible Postgres a) =&gt;
cmd Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType cmd (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-operator hs-var">`returning`</span></a></span><span>
</span><span id="line-387"></span><span>              </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QExpr Postgres PostgresInaccessible) a
 -&gt; Columnar' (QExpr Postgres ()) a)
-&gt; table (QExpr Postgres PostgresInaccessible)
-&gt; table (QExpr Postgres ())
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679189784"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span id="local-6989586621679189783"><span class="annot"><a href="#local-6989586621679189783"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189784"><span class="hs-identifier hs-type">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-388"></span><span>                </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres ()) a -&gt; Columnar' (QExpr Postgres ()) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres () a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BeamSqlBackendExpressionSyntax Postgres
</span><a href="#local-6989586621679189783"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189784"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PgReturningType
  SqlUpdate (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="#local-6989586621679189785"><span class="hs-identifier hs-var">updateReturningCmd'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-391"></span><span>          </span><span class="annot"><span class="annottext">PgReturningType
  SqlUpdate (QExprToIdentity (table (QExpr Postgres ())))
</span><a href="Database.Beam.Postgres.Full.html#PgUpdateReturningEmpty"><span class="hs-identifier hs-var">PgUpdateReturningEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-392"></span><span>            </span><span class="annot"><span class="annottext">[table Identity] -&gt; Pg [table Identity]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-393"></span><span>          </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgUpdateReturning"><span class="hs-identifier hs-type">PgUpdateReturning</span></a></span><span> </span><span id="local-6989586621679189780"><span class="annot"><a href="#local-6989586621679189780"><span class="hs-identifier hs-var">updateReturningCmd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>            </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres -&gt; Pg [table Identity]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189780"><span class="hs-identifier hs-var">updateReturningCmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">MonadBeamDeleteReturning</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Connection.html#Pg"><span class="hs-identifier hs-type">Pg</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679189776"><span class="annot"><span class="annottext">runDeleteReturningList :: SqlDelete Postgres table -&gt; Pg [table Identity]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">runDeleteReturningList</span></a></span></span><span> </span><span id="local-6989586621679189774"><span class="annot"><span class="annottext">SqlDelete Postgres table
</span><a href="#local-6989586621679189774"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Full.html#PgDeleteReturning"><span class="hs-identifier hs-type">PgDeleteReturning</span></a></span><span> </span><span id="local-6989586621679189772"><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189772"><span class="hs-identifier hs-var">deleteReturningCmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SqlDelete Postgres table
</span><a href="#local-6989586621679189774"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">SqlDelete Postgres table
-&gt; (table (QExpr Postgres PostgresInaccessible)
    -&gt; table (QExpr Postgres ()))
-&gt; PgReturningType
     SqlDelete (QExprToIdentity (table (QExpr Postgres ())))
forall (cmd :: * -&gt; ((* -&gt; *) -&gt; *) -&gt; *) (tbl :: (* -&gt; *) -&gt; *) a.
(PgReturning cmd, Beamable tbl, Projectible Postgres a) =&gt;
cmd Postgres tbl
-&gt; (tbl (QExpr Postgres PostgresInaccessible) -&gt; a)
-&gt; PgReturningType cmd (QExprToIdentity a)
</span><a href="Database.Beam.Postgres.Full.html#returning"><span class="hs-operator hs-var">`returning`</span></a></span><span>
</span><span id="line-399"></span><span>              </span><span class="annot"><span class="annottext">(forall a.
 Columnar' (QExpr Postgres PostgresInaccessible) a
 -&gt; Columnar' (QExpr Postgres ()) a)
-&gt; table (QExpr Postgres PostgresInaccessible)
-&gt; table (QExpr Postgres ())
forall (table :: (* -&gt; *) -&gt; *) (f :: * -&gt; *) (g :: * -&gt; *).
Beamable table =&gt;
(forall a. Columnar' f a -&gt; Columnar' g a) -&gt; table f -&gt; table g
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">changeBeamRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679189771"><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span id="local-6989586621679189770"><span class="annot"><a href="#local-6989586621679189770"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Syntax.html#PostgresInaccessible"><span class="hs-identifier hs-type">PostgresInaccessible</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189771"><span class="hs-identifier hs-type">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>                </span><span class="annot"><span class="annottext">Columnar (QExpr Postgres ()) a -&gt; Columnar' (QExpr Postgres ()) a
forall (f :: * -&gt; *) a. Columnar f a -&gt; Columnar' f a
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Text -&gt; BeamSqlBackendExpressionSyntax Postgres)
-&gt; QGenExpr QValueContext Postgres () a
forall context be s t.
(Text -&gt; BeamSqlBackendExpressionSyntax be)
-&gt; QGenExpr context be s t
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">QExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; BeamSqlBackendExpressionSyntax Postgres
</span><a href="#local-6989586621679189770"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">Columnar'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">QExpr</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Postgres.Types.html#Postgres"><span class="hs-identifier hs-type">Postgres</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679189771"><span class="hs-identifier hs-type">ty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax Postgres -&gt; Pg [table Identity]
forall be (m :: * -&gt; *) x.
(MonadBeam be m, FromBackendRow be x) =&gt;
BeamSqlBackendSyntax be -&gt; m [x]
</span><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-var">runReturningList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PgCommandType -&gt; PgSyntax -&gt; PgCommandSyntax
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandSyntax"><span class="hs-identifier hs-var">PgCommandSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">PgCommandType
</span><a href="Database.Beam.Postgres.Syntax.html#PgCommandTypeDataUpdateReturning"><span class="hs-identifier hs-var">PgCommandTypeDataUpdateReturning</span></a></span><span> </span><span class="annot"><span class="annottext">PgSyntax
</span><a href="#local-6989586621679189772"><span class="hs-identifier hs-var">deleteReturningCmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span></pre></body></html>