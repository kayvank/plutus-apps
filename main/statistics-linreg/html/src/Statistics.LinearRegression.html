<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Statistics.LinearRegression</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Simple linear regression functions</span></span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegression"><span class="hs-identifier">linearRegression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionRSqr"><span class="hs-identifier">linearRegressionRSqr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionTLS"><span class="hs-identifier">linearRegressionTLS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Related functions</span></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#correl"><span class="hs-identifier">correl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#covar"><span class="hs-identifier">covar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Estimated errors and distribution parameters</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionMSE"><span class="hs-identifier">linearRegressionMSE</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionDistributions"><span class="hs-identifier">linearRegressionDistributions</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Robust linear regression</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#robustFit"><span class="hs-identifier">robustFit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#nonRandomRobustFit"><span class="hs-identifier">nonRandomRobustFit</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#robustFitRSqr"><span class="hs-identifier">robustFitRSqr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Related types</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier">EstimationParameters</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#ErrorFunction"><span class="hs-identifier">ErrorFunction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#Estimator"><span class="hs-identifier">Estimator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier">EstimatedRelation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Provided values</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#defaultEstimationParameters"><span class="hs-identifier">defaultEstimationParameters</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier">linearRegressionError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionTLSError"><span class="hs-identifier">linearRegressionTLSError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Helper functions</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Statistics.LinearRegression.html#converge"><span class="hs-identifier">converge</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * References</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- $references</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier">Data.Vector.Generic</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier">Data.Vector.Unboxed</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">U</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier">Data.Vector.Generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier">Vector</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../safe/html/src"><span class="hs-identifier">Safe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../safe/html/src"><span class="hs-identifier">at</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier">System.Random</span></a></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../random-shuffle/html/src"><span class="hs-identifier">System.Random.Shuffle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../random-shuffle/html/src"><span class="hs-identifier">shuffleM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">Control.Monad.Random.Class</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">Control.Monad.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">evalRand</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">minimumBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sortBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier">Statistics.Sample</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier">Statistics.Distribution</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">D</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier">Statistics.Distribution.Transform</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier">Statistics.Distribution.StudentT</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ST</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">--- * Simple linear regression</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Covariance of two samples</span><span>
</span><span id="line-54"></span><span id="local-6989586621679081481"><span class="annot"><a href="Statistics.LinearRegression.html#covar"><span class="hs-identifier hs-type">covar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081481"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081481"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081481"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-55"></span><span id="covar"><span class="annot"><span class="annottext">covar :: v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar"><span class="hs-identifier hs-var hs-var">covar</span></a></span></span><span> </span><span id="local-6989586621679081319"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081319"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081318"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081318"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
forall (v :: * -&gt; *).
Vector v Double =&gt;
Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-identifier hs-var">covar'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081316"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081315"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081314"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081319"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081318"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081314"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679081314"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081319"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-58"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081316"><span class="annot"><span class="annottext">m1 :: Double
</span><a href="#local-6989586621679081316"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.mean</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081319"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-59"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081315"><span class="annot"><span class="annottext">m2 :: Double
</span><a href="#local-6989586621679081315"><span class="hs-identifier hs-var hs-var">m2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.mean</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081318"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-60"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#covar"><span class="hs-pragma hs-type">covar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- internal function that avoids duplicate calculation of means and lengths where possible</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Note: trying to make the calculation even more efficient by subtracting m1*m1*n instead of individual subtractions increased errors, probably due to rounding issues.</span><span>
</span><span id="line-64"></span><span id="local-6989586621679081504"><span class="annot"><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-identifier hs-type">covar'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081504"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081504"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081504"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-65"></span><span id="covar%27"><span class="annot"><span class="annottext">covar' :: Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-identifier hs-var hs-var">covar'</span></a></span></span><span> </span><span id="local-6989586621679081311"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081311"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679081310"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081310"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span id="local-6989586621679081309"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081309"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679081308"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081308"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081307"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081307"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. (Vector v a, Num a) =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.sum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; v Double -&gt; v Double -&gt; v Double
forall (v :: * -&gt; *) a b c.
(Vector v a, Vector v b, Vector v c) =&gt;
(a -&gt; b -&gt; c) -&gt; v a -&gt; v b -&gt; v c
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">(*)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; v Double -&gt; v Double
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; v a -&gt; v b
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">subtract</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081311"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081308"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; v Double -&gt; v Double
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; v a -&gt; v b
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">subtract</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081310"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081307"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081309"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-pragma hs-type">covar'</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Pearson's product-moment correlation coefficient</span><span>
</span><span id="line-69"></span><span id="local-6989586621679081300"><span class="annot"><a href="Statistics.LinearRegression.html#correl"><span class="hs-identifier hs-type">correl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081300"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-70"></span><span id="correl"><span class="annot"><span class="annottext">correl :: v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#correl"><span class="hs-identifier hs-var hs-var">correl</span></a></span></span><span> </span><span id="local-6989586621679081299"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081299"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081298"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679081297"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679081297"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; v Double -&gt; Double
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar"><span class="hs-identifier hs-var">covar</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081299"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-71"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679081296"><span class="annot"><span class="annottext">sx :: Double
</span><a href="#local-6989586621679081296"><span class="hs-identifier hs-var hs-var">sx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.stdDev</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081299"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-72"></span><span>                   </span><span class="hs-glyph">!</span><span id="local-6989586621679081294"><span class="annot"><span class="annottext">sy :: Double
</span><a href="#local-6989586621679081294"><span class="hs-identifier hs-var hs-var">sy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.stdDev</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081298"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-73"></span><span>               </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081297"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081296"><span class="hs-identifier hs-var">sx</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081294"><span class="hs-identifier hs-var">sy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#correl"><span class="hs-pragma hs-type">correl</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Simple linear regression between 2 samples.</span><span>
</span><span id="line-77"></span><span class="hs-comment">--   Takes two vectors Y={yi} and X={xi} and returns</span><span>
</span><span id="line-78"></span><span class="hs-comment">--   (alpha, beta, r*r) such that Y = alpha + beta*X</span><span>
</span><span id="line-79"></span><span class="hs-comment">--   and where r is the Pearson product-moment correlation</span><span>
</span><span id="line-80"></span><span class="hs-comment">--   coefficient</span><span>
</span><span id="line-81"></span><span id="local-6989586621679081477"><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionRSqr"><span class="hs-identifier hs-type">linearRegressionRSqr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081477"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-82"></span><span id="linearRegressionRSqr"><span class="annot"><span class="annottext">linearRegressionRSqr :: v Double -&gt; v Double -&gt; (Double, Double, Double)
</span><a href="Statistics.LinearRegression.html#linearRegressionRSqr"><span class="hs-identifier hs-var hs-var">linearRegressionRSqr</span></a></span></span><span> </span><span id="local-6989586621679081293"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081292"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081292"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081291"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081290"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081289"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-84"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081288"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679081288"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
forall (v :: * -&gt; *).
Vector v Double =&gt;
Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-identifier hs-var">covar'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081287"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081286"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081285"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081292"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-85"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081289"><span class="annot"><span class="annottext">r2 :: Double
</span><a href="#local-6989586621679081289"><span class="hs-identifier hs-var hs-var">r2</span></a></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081288"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081288"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081284"><span class="hs-identifier hs-var">v1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081283"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>          </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679081287"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081287"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081284"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081284"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; (Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; (Double, Double)
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.meanVarianceUnb</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span>
</span><span id="line-87"></span><span>          </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679081286"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081286"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081283"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081283"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; (Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; (Double, Double)
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.meanVarianceUnb</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081292"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-88"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081285"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679081285"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081293"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-89"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081290"><span class="annot"><span class="annottext">beta :: Double
</span><a href="#local-6989586621679081290"><span class="hs-identifier hs-var hs-var">beta</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081288"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081284"><span class="hs-identifier hs-var">v1</span></a></span><span>
</span><span id="line-90"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081291"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679081291"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081286"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081290"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081287"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-91"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionRSqr"><span class="hs-pragma hs-type">linearRegressionRSqr</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-92"></span><span>          </span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | Simple linear regression between 2 samples.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--   Takes two vectors Y={yi} and X={xi} and returns</span><span>
</span><span id="line-95"></span><span class="hs-comment">--   (alpha, beta) such that Y = alpha + beta*X          </span><span>
</span><span id="line-96"></span><span id="local-6989586621679081455"><span class="annot"><a href="Statistics.LinearRegression.html#linearRegression"><span class="hs-identifier hs-type">linearRegression</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081455"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081455"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081455"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-97"></span><span id="linearRegression"><span class="annot"><span class="annottext">linearRegression :: v Double -&gt; v Double -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#linearRegression"><span class="hs-identifier hs-var hs-var">linearRegression</span></a></span></span><span> </span><span id="local-6989586621679081281"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081281"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081280"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081280"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081279"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081278"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679081279"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081279"><span class="hs-identifier hs-var">alpha</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679081278"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081278"><span class="hs-identifier hs-var">beta</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; v Double -&gt; (Double, Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; v Double -&gt; (Double, Double, Double)
</span><a href="Statistics.LinearRegression.html#linearRegressionRSqr"><span class="hs-identifier hs-var">linearRegressionRSqr</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081281"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081280"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-100"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegression"><span class="hs-pragma hs-type">linearRegression</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | The error (or residual) mean square of a sample w.r.t. an estimated regression line.</span><span>
</span><span id="line-103"></span><span class="hs-comment">--   This serves as an estimate for the variance of the sampled data.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--   Accepts the regression parameters (alpha,beta) and the sample vectors X and Y.</span><span>
</span><span id="line-105"></span><span id="local-6989586621679081465"><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionMSE"><span class="hs-identifier hs-type">linearRegressionMSE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081465"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081465"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081465"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081465"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span></span><span>
</span><span id="line-106"></span><span id="linearRegressionMSE"><span class="annot"><span class="annottext">linearRegressionMSE :: (Double, Double) -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#linearRegressionMSE"><span class="hs-identifier hs-var hs-var">linearRegressionMSE</span></a></span></span><span> </span><span id="local-6989586621679081277"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081277"><span class="hs-identifier hs-var">ab</span></a></span></span><span> </span><span id="local-6989586621679081276"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081276"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081275"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081275"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. (Vector v a, Num a) =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.sum</span></a></span><span> </span><span class="annot"><span class="annottext">(v Double -&gt; Double)
-&gt; (v Double -&gt; v Double) -&gt; v Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Double) -&gt; v (Double, Double) -&gt; v Double
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; v a -&gt; v b
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorFunction
</span><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier hs-var">linearRegressionError</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081277"><span class="hs-identifier hs-var">ab</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(v (Double, Double) -&gt; v Double)
-&gt; (v Double -&gt; v (Double, Double)) -&gt; v Double -&gt; v Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; v Double -&gt; v (Double, Double)
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b, Vector v (a, b)) =&gt;
v a -&gt; v b -&gt; v (a, b)
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.zip</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081276"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">(v Double -&gt; Double) -&gt; v Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081275"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081272"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081272"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679081272"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081276"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | The estimated distributions of the regression parameters (alpha and beta) assuming normal, identical distributions of Y, the sampled data.</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- These can serve to get confidence intervals for the regression parameters.</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- Accepts the regression parameters (alpha,beta) and the sample vectors X and Y.</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- The distributions are StudnetT distributions centered at the estimated (alpha,beta) respectively, with parameter numbers n-2 (where n is the initial sample size) and with standard deviations that are extracted from the sampled data based on its MSE. See chapter 2 of reference [3] for details.</span><span>
</span><span id="line-114"></span><span id="local-6989586621679081271"><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionDistributions"><span class="hs-identifier hs-type">linearRegressionDistributions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081271"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081271"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081271"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081271"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">T.LinearTransform</span></a></span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">ST.StudentT</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">T.LinearTransform</span></a></span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">ST.StudentT</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-115"></span><span id="linearRegressionDistributions"><span class="annot"><span class="annottext">linearRegressionDistributions :: (Double, Double)
-&gt; v Double
-&gt; v Double
-&gt; (LinearTransform StudentT, LinearTransform StudentT)
</span><a href="Statistics.LinearRegression.html#linearRegressionDistributions"><span class="hs-identifier hs-var hs-var">linearRegressionDistributions</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081270"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081270"><span class="hs-identifier hs-var">alpha</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081269"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081269"><span class="hs-identifier hs-var">beta</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679081268"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081267"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081267"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; LinearTransform StudentT
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">ST.studentTUnstandardized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081270"><span class="hs-identifier hs-var">alpha</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081264"><span class="hs-identifier hs-var">va</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; LinearTransform StudentT
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">ST.studentTUnstandardized</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081269"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081263"><span class="hs-identifier hs-var">vb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081265"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081262"><span class="annot"><span class="annottext">mse :: Double
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var hs-var">mse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; v Double -&gt; v Double -&gt; Double
forall (v :: * -&gt; *).
(Vector v Double, Vector v (Double, Double)) =&gt;
(Double, Double) -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#linearRegressionMSE"><span class="hs-identifier hs-var">linearRegressionMSE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081270"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081269"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081267"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081263"><span class="annot"><span class="annottext">vb :: Double
</span><a href="#local-6989586621679081263"><span class="hs-identifier hs-var hs-var">vb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">mse</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081261"><span class="hs-identifier hs-var">xv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081260"><span class="annot"><span class="annottext">mx :: Double
</span><a href="#local-6989586621679081260"><span class="hs-identifier hs-var hs-var">mx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *). Vector v Double =&gt; v Double -&gt; Double
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.mean</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081264"><span class="annot"><span class="annottext">va :: Double
</span><a href="#local-6989586621679081264"><span class="hs-identifier hs-var hs-var">va</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081262"><span class="hs-identifier hs-var">mse</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081265"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081260"><span class="hs-identifier hs-var">mx</span></a></span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081261"><span class="hs-identifier hs-var">xv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679081261"><span class="annot"><span class="annottext">xv :: Double
</span><a href="#local-6989586621679081261"><span class="hs-identifier hs-var hs-var">xv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. (Vector v a, Num a) =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.sum</span></a></span><span> </span><span class="annot"><span class="annottext">(v Double -&gt; Double)
-&gt; (v Double -&gt; v Double) -&gt; v Double -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; v Double -&gt; v Double
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b) =&gt;
(a -&gt; b) -&gt; v a -&gt; v b
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081257"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081257"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081257"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081260"><span class="hs-identifier hs-var">mx</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(v Double -&gt; Double) -&gt; v Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081268"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Total Least Squares (TLS) linear regression.</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Assumes x-axis values (and not just y-axis values) are random variables and that both variables have similar distributions.</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- interface is the same as 'linearRegression'.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679081256"><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionTLS"><span class="hs-identifier hs-type">linearRegressionTLS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081256"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-128"></span><span id="linearRegressionTLS"><span class="annot"><span class="annottext">linearRegressionTLS :: v Double -&gt; v Double -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#linearRegressionTLS"><span class="hs-identifier hs-var hs-var">linearRegressionTLS</span></a></span></span><span> </span><span id="local-6989586621679081255"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081254"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081254"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081253"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081252"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081251"><span class="annot"><span class="annottext">c :: Double
</span><a href="#local-6989586621679081251"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
forall (v :: * -&gt; *).
Vector v Double =&gt;
Double -&gt; Double -&gt; Double -&gt; v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#covar%27"><span class="hs-identifier hs-var">covar'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081250"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081249"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081254"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-131"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081247"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679081247"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081246"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081245"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081251"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679081250"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081250"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081246"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081246"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; (Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; (Double, Double)
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.meanVarianceUnb</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span id="local-6989586621679081249"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081249"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081245"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081245"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; (Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; (Double, Double)
</span><a href="../../../../statistics/html/src"><span class="hs-identifier hs-var">S.meanVarianceUnb</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081254"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081248"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679081248"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; Int -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081255"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081244"><span class="annot"><span class="annottext">betas :: [Double]
</span><a href="#local-6989586621679081244"><span class="hs-identifier hs-var hs-var">betas</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081247"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081247"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081247"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081247"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081252"><span class="annot"><span class="annottext">beta :: Double
</span><a href="#local-6989586621679081252"><span class="hs-identifier hs-var hs-var">beta</span></a></span></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081251"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081244"><span class="hs-identifier hs-var">betas</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minimum</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081244"><span class="hs-identifier hs-var">betas</span></a></span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-glyph">!</span><span id="local-6989586621679081253"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679081253"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081249"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081252"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081250"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-138"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionTLS"><span class="hs-pragma hs-type">linearRegressionTLS</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | An estimated linear relation between 2 samples is (alpha,beta) such that Y = alpha + beta*X.</span><span>
</span><span id="line-141"></span><span class="hs-keyword">type</span><span> </span><span id="EstimatedRelation"><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-var">EstimatedRelation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | An 'Estimator' is a function that generates an estimated linear regression based on 2 samples. This module provides two estimator functions:</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- 'linearRegression' and 'linearRegressionTLS'</span><span>
</span><span id="line-145"></span><span class="hs-keyword">type</span><span> </span><span id="Estimator"><span class="annot"><a href="Statistics.LinearRegression.html#Estimator"><span class="hs-identifier hs-var">Estimator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">S.Sample</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../statistics/html/src"><span class="hs-identifier hs-type">S.Sample</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | An 'ErrorFunction' is a function that computes the error of a given point from an estimate. This module provides two error functions correspoinding to the two 'Estimator' functions it defines:</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- </span><span>
</span><span id="line-149"></span><span class="hs-comment">-- * Vertical distance squared via 'linearRegressionError' that should be used with 'linearRegression'</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- </span><span>
</span><span id="line-151"></span><span class="hs-comment">-- * Total distance squared vie 'linearRegressionTLSError' that should be used with 'linearRegressionTLS'</span><span>
</span><span id="line-152"></span><span class="hs-keyword">type</span><span> </span><span id="ErrorFunction"><span class="annot"><a href="Statistics.LinearRegression.html#ErrorFunction"><span class="hs-identifier hs-var">ErrorFunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | The robust fit algorithm used has various parameters that can be specified using the 'EstimationParameters' record.</span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="EstimationParameters"><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-var">EstimationParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EstimationParameters"><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-var">EstimationParameters</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-comment">-- | Maximal fraction of outliers expected in the sample (default 0.25)</span><span>
</span><span id="line-157"></span><span>    </span><span id="outlierFraction"><span class="annot"><span class="annottext">EstimationParameters -&gt; Double
</span><a href="Statistics.LinearRegression.html#outlierFraction"><span class="hs-identifier hs-var hs-var">outlierFraction</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- | Number of concentration steps to take for initial evaluation of a solution (default 3)</span><span>
</span><span id="line-159"></span><span>    </span><span id="shortIterationSteps"><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#shortIterationSteps"><span class="hs-identifier hs-var hs-var">shortIterationSteps</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- | Maximal number of sampled subsets (pairs of points) to use as starting points (default 500)</span><span>
</span><span id="line-161"></span><span>    </span><span id="maxSubsetsNum"><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#maxSubsetsNum"><span class="hs-identifier hs-var hs-var">maxSubsetsNum</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">-- | If the initial sample is large, and thus gets subdivided, this is the number of candidate-estimations to take from each subgroup, on which complete convergence will be executed (default 10)</span><span>
</span><span id="line-163"></span><span>    </span><span id="groupSubsets"><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#groupSubsets"><span class="hs-identifier hs-var hs-var">groupSubsets</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- | Maximal size of sample that can be analyzed without any sub-division (default 600)</span><span>
</span><span id="line-165"></span><span>    </span><span id="mediumSetSize"><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#mediumSetSize"><span class="hs-identifier hs-var hs-var">mediumSetSize</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">-- | Maximal size of sample that does not require two-step sub-division (see reference article) (default 1500)</span><span>
</span><span id="line-167"></span><span>    </span><span id="largeSetSize"><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#largeSetSize"><span class="hs-identifier hs-var hs-var">largeSetSize</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">-- | Estimator function to use (default linearRegression)</span><span>
</span><span id="line-169"></span><span>    </span><span id="estimator"><span class="annot"><span class="annottext">EstimationParameters -&gt; Estimator
</span><a href="Statistics.LinearRegression.html#estimator"><span class="hs-identifier hs-var hs-var">estimator</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#Estimator"><span class="hs-identifier hs-type">Estimator</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- | ErrorFunction to use (default linearRegressionError)</span><span>
</span><span id="line-171"></span><span>    </span><span id="errorFunction"><span class="annot"><span class="annottext">EstimationParameters -&gt; ErrorFunction
</span><a href="Statistics.LinearRegression.html#errorFunction"><span class="hs-identifier hs-var hs-var">errorFunction</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#ErrorFunction"><span class="hs-identifier hs-type">ErrorFunction</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Default set of parameters to use (see reference for details).</span><span>
</span><span id="line-175"></span><span id="defaultEstimationParameters"><span class="annot"><span class="annottext">defaultEstimationParameters :: EstimationParameters
</span><a href="Statistics.LinearRegression.html#defaultEstimationParameters"><span class="hs-identifier hs-var hs-var">defaultEstimationParameters</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EstimationParameters :: Double
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Estimator
-&gt; ErrorFunction
-&gt; EstimationParameters
</span><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">outlierFraction :: Double
</span><a href="Statistics.LinearRegression.html#outlierFraction"><span class="hs-identifier hs-var">outlierFraction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.25</span></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">shortIterationSteps :: Int
</span><a href="Statistics.LinearRegression.html#shortIterationSteps"><span class="hs-identifier hs-var">shortIterationSteps</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">maxSubsetsNum :: Int
</span><a href="Statistics.LinearRegression.html#maxSubsetsNum"><span class="hs-identifier hs-var">maxSubsetsNum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">500</span></span><span class="hs-special">,</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="annottext">groupSubsets :: Int
</span><a href="Statistics.LinearRegression.html#groupSubsets"><span class="hs-identifier hs-var">groupSubsets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">mediumSetSize :: Int
</span><a href="Statistics.LinearRegression.html#mediumSetSize"><span class="hs-identifier hs-var">mediumSetSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">600</span></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">largeSetSize :: Int
</span><a href="Statistics.LinearRegression.html#largeSetSize"><span class="hs-identifier hs-var">largeSetSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1500</span></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">estimator :: Estimator
</span><a href="Statistics.LinearRegression.html#estimator"><span class="hs-identifier hs-var">estimator</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Estimator
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; v Double -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#linearRegression"><span class="hs-identifier hs-var">linearRegression</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">errorFunction :: ErrorFunction
</span><a href="Statistics.LinearRegression.html#errorFunction"><span class="hs-identifier hs-var">errorFunction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorFunction
</span><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier hs-var">linearRegressionError</span></a></span><span>
</span><span id="line-184"></span><span class="hs-special">}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | linearRegression error function is the square of the /vertical/ distance of a point from the line.</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier hs-type">linearRegressionError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#ErrorFunction"><span class="hs-identifier hs-type">ErrorFunction</span></a></span><span>
</span><span id="line-188"></span><span id="linearRegressionError"><span class="annot"><span class="annottext">linearRegressionError :: ErrorFunction
</span><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier hs-var hs-var">linearRegressionError</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081229"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">alpha</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081228"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081228"><span class="hs-identifier hs-var">beta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081227"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081227"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081226"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081226"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081226"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081228"><span class="hs-identifier hs-var">beta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081227"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081229"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | linearRegressionTLS error function is the square of the /total/ distance of a point from the line.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="Statistics.LinearRegression.html#linearRegressionTLSError"><span class="hs-identifier hs-type">linearRegressionTLSError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#ErrorFunction"><span class="hs-identifier hs-type">ErrorFunction</span></a></span><span>
</span><span id="line-192"></span><span id="linearRegressionTLSError"><span class="annot"><span class="annottext">linearRegressionTLSError :: ErrorFunction
</span><a href="Statistics.LinearRegression.html#linearRegressionTLSError"><span class="hs-identifier hs-var hs-var">linearRegressionTLSError</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081225"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081225"><span class="hs-identifier hs-var">alpha</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081224"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081224"><span class="hs-identifier hs-var">beta</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081223"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081223"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081222"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081222"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081221"><span class="hs-identifier hs-var">ey</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081224"><span class="hs-identifier hs-var">beta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679081221"><span class="annot"><span class="annottext">ey :: Double
</span><a href="#local-6989586621679081221"><span class="hs-identifier hs-var hs-var">ey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ErrorFunction
</span><a href="Statistics.LinearRegression.html#linearRegressionError"><span class="hs-identifier hs-var">linearRegressionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081225"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081224"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081223"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081222"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Helper function to calculate the minimal expected size of uncontaminated data based on the maximal fraction of outliers.</span><span>
</span><span id="line-197"></span><span id="local-6989586621679081449"><span class="annot"><a href="Statistics.LinearRegression.html#setSize"><span class="hs-identifier hs-type">setSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081449"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081449"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-198"></span><span id="setSize"><span class="annot"><span class="annottext">setSize :: EstimationParameters -&gt; v Double -&gt; Int
</span><a href="Statistics.LinearRegression.html#setSize"><span class="hs-identifier hs-var hs-var">setSize</span></a></span></span><span> </span><span id="local-6989586621679081219"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081219"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081218"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081218"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081216"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (Double -&gt; Int) -&gt; Double -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">round</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">EstimationParameters -&gt; Double
</span><a href="Statistics.LinearRegression.html#outlierFraction"><span class="hs-identifier hs-var hs-var">outlierFraction</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081219"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081216"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621679081216"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679081216"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081218"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Helper function that, given an initial estimated relation and the error of the perivous estimation, performs a &quot;concentration&quot; step, generating a new estimate based on a fraction of points laying closest to the previous estimate and estimates the error of the previous estimate based on the same fraction.</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- The result is an estimate that is at least as good as the previous one.</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- The reason the error is calculated for the previous parameters is calculation optimization.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679081426"><span class="annot"><a href="Statistics.LinearRegression.html#concentrationStep"><span class="hs-identifier hs-type">concentrationStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081426"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081426"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081426"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-206"></span><span id="concentrationStep"><span class="annot"><span class="annottext">concentrationStep :: EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
</span><a href="Statistics.LinearRegression.html#concentrationStep"><span class="hs-identifier hs-var hs-var">concentrationStep</span></a></span></span><span> </span><span id="local-6989586621679081212"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081212"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081211"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081211"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081210"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081210"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081209"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081209"><span class="hs-identifier hs-var">prev</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679081208"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081208"><span class="hs-identifier hs-var">prev_err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081207"><span class="hs-identifier hs-var">new_estimate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081206"><span class="hs-identifier hs-var">new_err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>        </span><span id="local-6989586621679081205"><span class="annot"><span class="annottext">set_size :: Int
</span><a href="#local-6989586621679081205"><span class="hs-identifier hs-var hs-var">set_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; v Double -&gt; Int
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters -&gt; v Double -&gt; Int
</span><a href="Statistics.LinearRegression.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081212"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081211"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span id="local-6989586621679081204"><span class="annot"><span class="annottext">xyerrors :: [((Double, Double), Double)]
</span><a href="#local-6989586621679081204"><span class="hs-identifier hs-var hs-var">xyerrors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; ((Double, Double), Double))
-&gt; [(Double, Double)] -&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679081203"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081203"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081203"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">EstimationParameters -&gt; ErrorFunction
</span><a href="Statistics.LinearRegression.html#errorFunction"><span class="hs-identifier hs-var hs-var">errorFunction</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081212"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081209"><span class="hs-identifier hs-var">prev</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081203"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; [((Double, Double), Double)])
-&gt; [(Double, Double)] -&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081211"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081210"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679081201"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679081201"><span class="hs-identifier hs-var">xys</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081200"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081200"><span class="hs-identifier hs-var">errors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; ([(Double, Double)], [Double])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ([(Double, Double)], [Double]))
-&gt; ([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), Double)]
-&gt; ([(Double, Double)], [Double])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081205"><span class="hs-identifier hs-var">set_size</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; ([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), Double)]
-&gt; [((Double, Double), Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double)
 -&gt; ((Double, Double), Double) -&gt; Ordering)
-&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Ordering)
-&gt; (((Double, Double), Double) -&gt; Double)
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ([(Double, Double)], [Double]))
-&gt; [((Double, Double), Double)] -&gt; ([(Double, Double)], [Double])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), Double)]
</span><a href="#local-6989586621679081204"><span class="hs-identifier hs-var">xyerrors</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679081196"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081196"><span class="hs-identifier hs-var">good_xs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081195"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081195"><span class="hs-identifier hs-var">good_ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; ([Double], [Double])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679081201"><span class="hs-identifier hs-var">xys</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679081207"><span class="annot"><span class="annottext">new_estimate :: (Double, Double)
</span><a href="#local-6989586621679081207"><span class="hs-identifier hs-var hs-var">new_estimate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; Estimator
</span><a href="Statistics.LinearRegression.html#estimator"><span class="hs-identifier hs-var hs-var">estimator</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081212"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Vector Double
forall (v :: * -&gt; *) a. Vector v a =&gt; [a] -&gt; v a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081196"><span class="hs-identifier hs-var">good_xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Vector Double
forall (v :: * -&gt; *) a. Vector v a =&gt; [a] -&gt; v a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081195"><span class="hs-identifier hs-var">good_ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621679081206"><span class="annot"><span class="annottext">new_err :: Double
</span><a href="#local-6989586621679081206"><span class="hs-identifier hs-var hs-var">new_err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081200"><span class="hs-identifier hs-var">errors</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Infinite set of consecutive concentration steps.</span><span>
</span><span id="line-216"></span><span id="local-6989586621679081420"><span class="annot"><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-type">concentration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081420"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081420"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081420"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-217"></span><span id="concentration"><span class="annot"><span class="annottext">concentration :: EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
</span><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-var hs-var">concentration</span></a></span></span><span> </span><span id="local-6989586621679081191"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081191"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081190"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081190"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081189"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081189"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span id="local-6989586621679081188"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081188"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">tail</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double) -&gt; ((Double, Double), Double))
-&gt; ((Double, Double), Double) -&gt; [((Double, Double), Double)]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">iterate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
</span><a href="Statistics.LinearRegression.html#concentrationStep"><span class="hs-identifier hs-var">concentrationStep</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081191"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081190"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081189"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081188"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">,</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Calculate the optimal (local minimum) estimate based on an initial estimate.</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- The local minimum may not be the global (a.k.a. best) estimate but starting from enough different initial estimates should yield the global optimum eventually.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679081185"><span class="annot"><a href="Statistics.LinearRegression.html#converge"><span class="hs-identifier hs-type">converge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081185"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span></span><span>
</span><span id="line-222"></span><span id="converge"><span class="annot"><span class="annottext">converge :: EstimationParameters
-&gt; v Double -&gt; v Double -&gt; (Double, Double) -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#converge"><span class="hs-identifier hs-var hs-var">converge</span></a></span></span><span> </span><span id="local-6989586621679081184"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081184"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081183"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081183"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081182"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081182"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; (Double, Double)
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double) -&gt; (Double, Double))
-&gt; ((Double, Double) -&gt; ((Double, Double), Double))
-&gt; (Double, Double)
-&gt; (Double, Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; ((Double, Double), Double)
forall a b. Ord a =&gt; [(b, a)] -&gt; (b, a)
</span><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var">findConvergencePoint</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ((Double, Double), Double))
-&gt; ((Double, Double) -&gt; [((Double, Double), Double)])
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
</span><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-var">concentration</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081184"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081183"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081182"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | The convergence point is defined as the point the error estimate of which is equal to the next estimate's error.</span><span>
</span><span id="line-225"></span><span id="local-6989586621679081421"><span id="local-6989586621679081422"><span class="annot"><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-type">findConvergencePoint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081422"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081421"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679081422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081421"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679081422"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-226"></span><span id="findConvergencePoint"><span class="annot"><span class="annottext">findConvergencePoint :: [(b, a)] -&gt; (b, a)
</span><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var hs-var">findConvergencePoint</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081180"><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081180"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679081179"><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081179"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679081178"><span class="annot"><span class="annottext">[(b, a)]
</span><a href="#local-6989586621679081178"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(b, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081180"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(b, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081179"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081180"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-comment">-- rounding issues my cause an actual increase in error resulting in an infinite loop so the actual stop condition is when the errors stop decreasing</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(b, a)] -&gt; (b, a)
forall a b. Ord a =&gt; [(b, a)] -&gt; (b, a)
</span><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var">findConvergencePoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b, a)
</span><a href="#local-6989586621679081179"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">(b, a) -&gt; [(b, a)] -&gt; [(b, a)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(b, a)]
</span><a href="#local-6989586621679081178"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span class="annot"><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var">findConvergencePoint</span></a></span><span> </span><span id="local-6989586621679081176"><span class="annot"><span class="annottext">[(b, a)]
</span><a href="#local-6989586621679081176"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (b, a)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Too short a list for conversion (size &lt; 2)&quot;</span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Many times there is no need for full concentration as bad initial estimates can be discovered after only a few concentration steps.</span><span>
</span><span id="line-232"></span><span id="local-6989586621679081355"><span class="annot"><a href="Statistics.LinearRegression.html#concentrateNSteps"><span class="hs-identifier hs-type">concentrateNSteps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081355"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-233"></span><span id="concentrateNSteps"><span class="annot"><span class="annottext">concentrateNSteps :: EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
</span><a href="Statistics.LinearRegression.html#concentrateNSteps"><span class="hs-identifier hs-var hs-var">concentrateNSteps</span></a></span></span><span> </span><span id="local-6989586621679081173"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081173"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081172"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081172"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081171"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081171"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span id="local-6989586621679081170"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081170"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
</span><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-var">concentration</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081173"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081172"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081171"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081170"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; Int -&gt; ((Double, Double), Double)
forall a. [a] -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#shortIterationSteps"><span class="hs-identifier hs-var hs-var">shortIterationSteps</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081173"><span class="hs-identifier hs-var">ep</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Finding a robust fit linear estimate between two samples. The procedure requires randomization and is based on the procedure described in the reference.</span><span>
</span><span id="line-236"></span><span id="local-6989586621679081388"><span id="local-6989586621679081389"><span class="annot"><a href="Statistics.LinearRegression.html#robustFit"><span class="hs-identifier hs-type">robustFit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081389"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081388"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081388"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081388"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081389"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span></span></span><span>
</span><span id="line-237"></span><span id="robustFit"><span class="annot"><span class="annottext">robustFit :: EstimationParameters -&gt; v Double -&gt; v Double -&gt; m (Double, Double)
</span><a href="Statistics.LinearRegression.html#robustFit"><span class="hs-identifier hs-var hs-var">robustFit</span></a></span></span><span> </span><span id="local-6989586621679081168"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081167"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081166"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081165"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679081165"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-239"></span><span class="hs-comment">-- For optimal performance the exact procedure executed depends on the set size.</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081165"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-242"></span><span>            </span><span class="annot"><span class="annottext">[Char] -&gt; m (Double, Double)
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;cannot fit an input of size &lt; 2&quot;</span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081165"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; m (Double, Double)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; m (Double, Double))
-&gt; (Double, Double) -&gt; m (Double, Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), (Double, Double)) -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#lineParams"><span class="hs-identifier hs-var">lineParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.head</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.head</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.last</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">v Double -&gt; Double
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.last</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span>
</span><span id="line-246"></span><span>                </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; (Double, Double))
-&gt; m [(Double, Double)] -&gt; m (Double, Double)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double -&gt; v Double -&gt; [(Double, Double)] -&gt; (Double, Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double -&gt; v Double -&gt; [(Double, Double)] -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#candidatesToWinner"><span class="hs-identifier hs-var">candidatesToWinner</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m [(Double, Double)] -&gt; m (Double, Double))
-&gt; m [(Double, Double)] -&gt; m (Double, Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081165"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#mediumSetSize"><span class="hs-identifier hs-var hs-var">mediumSetSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span>
</span><span id="line-247"></span><span>                    </span><span class="hs-keyword">then</span><span>
</span><span id="line-248"></span><span>                         </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; Maybe Int -&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters
-&gt; Maybe Int -&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#singleGroupFitCandidates"><span class="hs-identifier hs-var">singleGroupFitCandidates</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-249"></span><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081165"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#largeSetSize"><span class="hs-identifier hs-var hs-var">largeSetSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span>
</span><span id="line-250"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters
-&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#largeGroupFitCandidates"><span class="hs-identifier hs-var">largeGroupFitCandidates</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-251"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-252"></span><span>                            </span><span class="hs-special">(</span><span id="local-6989586621679081157"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081157"><span class="hs-identifier hs-var">nxs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081156"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081156"><span class="hs-identifier hs-var">nys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; ([Double], [Double]))
-&gt; m [(Double, Double)] -&gt; m ([Double], [Double])
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; ([Double], [Double])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">(m [(Double, Double)] -&gt; m ([Double], [Double]))
-&gt; m [(Double, Double)] -&gt; m ([Double], [Double])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Int -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) a. MonadRandom m =&gt; [a] -&gt; Int -&gt; m [a]
</span><a href="Statistics.LinearRegression.html#randomSubset"><span class="hs-identifier hs-var">randomSubset</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081167"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081166"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#largeSetSize"><span class="hs-identifier hs-var hs-var">largeSetSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>                            </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; Vector Double -&gt; Vector Double -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters
-&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#largeGroupFitCandidates"><span class="hs-identifier hs-var">largeGroupFitCandidates</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081168"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Vector Double
forall a. Unbox a =&gt; [a] -&gt; Vector a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">U.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081157"><span class="hs-identifier hs-var">nxs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Double] -&gt; Vector Double
forall (v :: * -&gt; *) a. Vector v a =&gt; [a] -&gt; v a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679081156"><span class="hs-identifier hs-var">nys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | Robust fit yielding also the R-square value of the \&quot;clean\&quot; dataset.</span><span>
</span><span id="line-256"></span><span id="local-6989586621679081152"><span id="local-6989586621679081153"><span class="annot"><a href="Statistics.LinearRegression.html#robustFitRSqr"><span class="hs-identifier hs-type">robustFitRSqr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081153"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081152"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081153"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-257"></span><span id="robustFitRSqr"><span class="annot"><span class="annottext">robustFitRSqr :: EstimationParameters
-&gt; v Double -&gt; v Double -&gt; m ((Double, Double), Double)
</span><a href="Statistics.LinearRegression.html#robustFitRSqr"><span class="hs-identifier hs-var hs-var">robustFitRSqr</span></a></span></span><span> </span><span id="local-6989586621679081151"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081150"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081149"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081149"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679081148"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081148"><span class="hs-identifier hs-var">er</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; v Double -&gt; v Double -&gt; m (Double, Double)
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters -&gt; v Double -&gt; v Double -&gt; m (Double, Double)
</span><a href="Statistics.LinearRegression.html#robustFit"><span class="hs-identifier hs-var">robustFit</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081149"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081147"><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679081147"><span class="hs-identifier hs-var">good_xs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081146"><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679081146"><span class="hs-identifier hs-var">good_ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector (Double, Double) -&gt; (Vector Double, Vector Double)
forall a b.
(Unbox a, Unbox b) =&gt;
Vector (a, b) -&gt; (Vector a, Vector b)
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">U.unzip</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Double, Double) -&gt; (Vector Double, Vector Double))
-&gt; (v (Double, Double) -&gt; Vector (Double, Double))
-&gt; v (Double, Double)
-&gt; (Vector Double, Vector Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Vector (Double, Double)
forall (v :: * -&gt; *) a. Vector v a =&gt; [a] -&gt; v a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; Vector (Double, Double))
-&gt; (v (Double, Double) -&gt; [(Double, Double)])
-&gt; v (Double, Double)
-&gt; Vector (Double, Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Double, Double)] -&gt; [(Double, Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; v Double -&gt; Int
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters -&gt; v Double -&gt; Int
</span><a href="Statistics.LinearRegression.html#setSize"><span class="hs-identifier hs-var">setSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; [(Double, Double)])
-&gt; (v (Double, Double) -&gt; [(Double, Double)])
-&gt; v (Double, Double)
-&gt; [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; (Double, Double) -&gt; Ordering)
-&gt; [(Double, Double)] -&gt; [(Double, Double)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Ordering)
-&gt; ((Double, Double) -&gt; Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; ErrorFunction
</span><a href="Statistics.LinearRegression.html#errorFunction"><span class="hs-identifier hs-var hs-var">errorFunction</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081151"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081148"><span class="hs-identifier hs-var">er</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; [(Double, Double)])
-&gt; (v (Double, Double) -&gt; [(Double, Double)])
-&gt; v (Double, Double)
-&gt; [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">v (Double, Double) -&gt; [(Double, Double)]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(v (Double, Double) -&gt; (Vector Double, Vector Double))
-&gt; v (Double, Double) -&gt; (Vector Double, Vector Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">v Double -&gt; v Double -&gt; v (Double, Double)
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b, Vector v (a, b)) =&gt;
v a -&gt; v b -&gt; v (a, b)
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.zip</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081150"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081149"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; m ((Double, Double), Double)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679081148"><span class="hs-identifier hs-var">er</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Vector Double -&gt; Vector Double -&gt; Double
forall (v :: * -&gt; *).
Vector v Double =&gt;
v Double -&gt; v Double -&gt; Double
</span><a href="Statistics.LinearRegression.html#correl"><span class="hs-identifier hs-var">correl</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679081147"><span class="hs-identifier hs-var">good_xs</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679081146"><span class="hs-identifier hs-var">good_ys</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Integer -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | A wrapper that executes 'robustFit' using a default random generator (meaning it is only pseudo-random)</span><span>
</span><span id="line-263"></span><span id="local-6989586621679081144"><span class="annot"><a href="Statistics.LinearRegression.html#nonRandomRobustFit"><span class="hs-identifier hs-type">nonRandomRobustFit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081144"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081144"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081144"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span></span><span>
</span><span id="line-264"></span><span id="nonRandomRobustFit"><span class="annot"><span class="annottext">nonRandomRobustFit :: EstimationParameters -&gt; v Double -&gt; v Double -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#nonRandomRobustFit"><span class="hs-identifier hs-var hs-var">nonRandomRobustFit</span></a></span></span><span> </span><span id="local-6989586621679081143"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081143"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081142"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081142"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081141"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081141"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand StdGen (Double, Double) -&gt; StdGen -&gt; (Double, Double)
forall g a. Rand g a -&gt; g -&gt; a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">evalRand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double -&gt; v Double -&gt; Rand StdGen (Double, Double)
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters -&gt; v Double -&gt; v Double -&gt; m (Double, Double)
</span><a href="Statistics.LinearRegression.html#robustFit"><span class="hs-identifier hs-var">robustFit</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081143"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081142"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081141"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; StdGen
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">mkStdGen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Given a set of initial estimates converge them all and find the optimal one.</span><span>
</span><span id="line-267"></span><span id="local-6989586621679081401"><span class="annot"><a href="Statistics.LinearRegression.html#candidatesToWinner"><span class="hs-identifier hs-type">candidatesToWinner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081401"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span></span><span>
</span><span id="line-268"></span><span id="candidatesToWinner"><span class="annot"><span class="annottext">candidatesToWinner :: EstimationParameters
-&gt; v Double -&gt; v Double -&gt; [(Double, Double)] -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#candidatesToWinner"><span class="hs-identifier hs-var hs-var">candidatesToWinner</span></a></span></span><span> </span><span id="local-6989586621679081139"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081138"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081138"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081137"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081137"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; (Double, Double)
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double) -&gt; (Double, Double))
-&gt; ([(Double, Double)] -&gt; ((Double, Double), Double))
-&gt; [(Double, Double)]
-&gt; (Double, Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double)
 -&gt; ((Double, Double), Double) -&gt; Ordering)
-&gt; [((Double, Double), Double)] -&gt; ((Double, Double), Double)
forall (t :: * -&gt; *) a.
Foldable t =&gt;
(a -&gt; a -&gt; Ordering) -&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minimumBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Ordering)
-&gt; (((Double, Double), Double) -&gt; Double)
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ((Double, Double), Double))
-&gt; ([(Double, Double)] -&gt; [((Double, Double), Double)])
-&gt; [(Double, Double)]
-&gt; ((Double, Double), Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; ((Double, Double), Double))
-&gt; [(Double, Double)] -&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; ((Double, Double), Double)
forall a b. Ord a =&gt; [(b, a)] -&gt; (b, a)
</span><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var">findConvergencePoint</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ((Double, Double), Double))
-&gt; ((Double, Double) -&gt; [((Double, Double), Double)])
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
</span><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-var">concentration</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081139"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081138"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081137"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | for a large initial sample - subdivide it, then get candidates from each subgroup. Perform full convergence on all the candidates and return the best ones.</span><span>
</span><span id="line-271"></span><span id="local-6989586621679081396"><span id="local-6989586621679081397"><span class="annot"><a href="Statistics.LinearRegression.html#largeGroupFitCandidates"><span class="hs-identifier hs-type">largeGroupFitCandidates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081397"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081396"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081396"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081396"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081397"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-272"></span><span id="largeGroupFitCandidates"><span class="annot"><span class="annottext">largeGroupFitCandidates :: EstimationParameters
-&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#largeGroupFitCandidates"><span class="hs-identifier hs-var hs-var">largeGroupFitCandidates</span></a></span></span><span> </span><span id="local-6989586621679081136"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081135"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081135"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081134"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081134"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081133"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679081133"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v Double -&gt; Int
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; Int
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.length</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081135"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081132"><span class="annot"><span class="annottext">sub_groups_num :: Int
</span><a href="#local-6989586621679081132"><span class="hs-identifier hs-var hs-var">sub_groups_num</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081133"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#mediumSetSize"><span class="hs-identifier hs-var hs-var">mediumSetSize</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081131"><span class="annot"><span class="annottext">sub_groups_size :: Int
</span><a href="#local-6989586621679081131"><span class="hs-identifier hs-var hs-var">sub_groups_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081133"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081132"><span class="hs-identifier hs-var">sub_groups_num</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621679081130"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679081130"><span class="hs-identifier hs-var">shuffled</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) a. MonadRandom m =&gt; [a] -&gt; m [a]
</span><a href="../../../../random-shuffle/html/src"><span class="hs-identifier hs-var">shuffleM</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; m [(Double, Double)])
-&gt; [(Double, Double)] -&gt; m [(Double, Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081135"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081134"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081129"><span class="annot"><span class="annottext">sub_groups :: [(Vector Double, Vector Double)]
</span><a href="#local-6989586621679081129"><span class="hs-identifier hs-var hs-var">sub_groups</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; (Vector Double, Vector Double))
-&gt; [[(Double, Double)]] -&gt; [(Vector Double, Vector Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector (Double, Double) -&gt; (Vector Double, Vector Double)
forall (v :: * -&gt; *) a b.
(Vector v a, Vector v b, Vector v (a, b)) =&gt;
v (a, b) -&gt; (v a, v b)
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.unzip</span></a></span><span> </span><span class="annot"><span class="annottext">(Vector (Double, Double) -&gt; (Vector Double, Vector Double))
-&gt; ([(Double, Double)] -&gt; Vector (Double, Double))
-&gt; [(Double, Double)]
-&gt; (Vector Double, Vector Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; Vector (Double, Double)
forall a. Unbox a =&gt; [a] -&gt; Vector a
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">U.fromList</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[(Double, Double)]] -&gt; [(Vector Double, Vector Double)])
-&gt; [[(Double, Double)]] -&gt; [(Vector Double, Vector Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(Double, Double)] -&gt; [[(Double, Double)]]
forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="Statistics.LinearRegression.html#splitTo"><span class="hs-identifier hs-var">splitTo</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081131"><span class="hs-identifier hs-var">sub_groups_size</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679081130"><span class="hs-identifier hs-var">shuffled</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081126"><span class="annot"><span class="annottext">sub_groups_candidates :: Int
</span><a href="#local-6989586621679081126"><span class="hs-identifier hs-var hs-var">sub_groups_candidates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#maxSubsetsNum"><span class="hs-identifier hs-var hs-var">maxSubsetsNum</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081132"><span class="hs-identifier hs-var">sub_groups_num</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621679081125"><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679081125"><span class="hs-identifier hs-var">candidates_list</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Vector Double, Vector Double) -&gt; m [(Double, Double)])
-&gt; [(Vector Double, Vector Double)] -&gt; m [[(Double, Double)]]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Vector Double -&gt; Vector Double -&gt; m [(Double, Double)])
-&gt; (Vector Double, Vector Double) -&gt; m [(Double, Double)]
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="Statistics.LinearRegression.html#applyTo"><span class="hs-identifier hs-var">applyTo</span></a></span><span> </span><span class="annot"><span class="annottext">((Vector Double -&gt; Vector Double -&gt; m [(Double, Double)])
 -&gt; (Vector Double, Vector Double) -&gt; m [(Double, Double)])
-&gt; (Vector Double -&gt; Vector Double -&gt; m [(Double, Double)])
-&gt; (Vector Double, Vector Double)
-&gt; m [(Double, Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; Maybe Int
-&gt; Vector Double
-&gt; Vector Double
-&gt; m [(Double, Double)]
forall (m :: * -&gt; *) (v :: * -&gt; *).
(MonadRandom m, Vector v Double) =&gt;
EstimationParameters
-&gt; Maybe Int -&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#singleGroupFitCandidates"><span class="hs-identifier hs-var">singleGroupFitCandidates</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081126"><span class="hs-identifier hs-var">sub_groups_candidates</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Vector Double, Vector Double)]
</span><a href="#local-6989586621679081129"><span class="hs-identifier hs-var">sub_groups</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081122"><span class="annot"><span class="annottext">candidates :: [(Double, Double)]
</span><a href="#local-6989586621679081122"><span class="hs-identifier hs-var hs-var">candidates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]] -&gt; [(Double, Double)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[(Double, Double)]]
</span><a href="#local-6989586621679081125"><span class="hs-identifier hs-var">candidates_list</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; m [(Double, Double)])
-&gt; ([(Double, Double)] -&gt; [(Double, Double)])
-&gt; [(Double, Double)]
-&gt; m [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double) -&gt; (Double, Double))
-&gt; [((Double, Double), Double)] -&gt; [(Double, Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; (Double, Double)
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [(Double, Double)])
-&gt; ([(Double, Double)] -&gt; [((Double, Double), Double)])
-&gt; [(Double, Double)]
-&gt; [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#groupSubsets"><span class="hs-identifier hs-var hs-var">groupSubsets</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; ([(Double, Double)] -&gt; [((Double, Double), Double)])
-&gt; [(Double, Double)]
-&gt; [((Double, Double), Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double)
 -&gt; ((Double, Double), Double) -&gt; Ordering)
-&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Ordering)
-&gt; (((Double, Double), Double) -&gt; Double)
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; ([(Double, Double)] -&gt; [((Double, Double), Double)])
-&gt; [(Double, Double)]
-&gt; [((Double, Double), Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; ((Double, Double), Double))
-&gt; [(Double, Double)] -&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[((Double, Double), Double)] -&gt; ((Double, Double), Double)
forall a b. Ord a =&gt; [(b, a)] -&gt; (b, a)
</span><a href="Statistics.LinearRegression.html#findConvergencePoint"><span class="hs-identifier hs-var">findConvergencePoint</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; ((Double, Double), Double))
-&gt; ((Double, Double) -&gt; [((Double, Double), Double)])
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; [((Double, Double), Double)]
</span><a href="Statistics.LinearRegression.html#concentration"><span class="hs-identifier hs-var">concentration</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081136"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081135"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081134"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; m [(Double, Double)])
-&gt; [(Double, Double)] -&gt; m [(Double, Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679081122"><span class="hs-identifier hs-var">candidates</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | For a single group (a group that will not be subdivided) pick an initial set of pairs of points, run a few steps on each, then return the most promising candidates.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679081398"><span id="local-6989586621679081400"><span class="annot"><a href="Statistics.LinearRegression.html#singleGroupFitCandidates"><span class="hs-identifier hs-type">singleGroupFitCandidates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081400"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../vector/html/src"><span class="hs-identifier hs-type">Vector</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081398"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimationParameters"><span class="hs-identifier hs-type">EstimationParameters</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081398"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081398"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081400"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-285"></span><span id="singleGroupFitCandidates"><span class="annot"><span class="annottext">singleGroupFitCandidates :: EstimationParameters
-&gt; Maybe Int -&gt; v Double -&gt; v Double -&gt; m [(Double, Double)]
</span><a href="Statistics.LinearRegression.html#singleGroupFitCandidates"><span class="hs-identifier hs-var hs-var">singleGroupFitCandidates</span></a></span></span><span> </span><span id="local-6989586621679081120"><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081120"><span class="hs-identifier hs-var">ep</span></a></span></span><span> </span><span id="local-6989586621679081119"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679081119"><span class="hs-identifier hs-var">m_subsets</span></a></span></span><span> </span><span id="local-6989586621679081118"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081118"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081117"><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081117"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081116"><span class="annot"><span class="annottext">all_pairs :: [((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var hs-var">all_pairs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; [((Double, Double), (Double, Double))]
forall a. [a] -&gt; [(a, a)]
</span><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; [((Double, Double), (Double, Double))])
-&gt; [(Double, Double)] -&gt; [((Double, Double), (Double, Double))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; [Double] -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081118"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v Double -&gt; [Double]
forall (v :: * -&gt; *) a. Vector v a =&gt; v a -&gt; [a]
</span><a href="../../../../vector/html/src"><span class="hs-identifier hs-var">G.toList</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081117"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679081114"><span class="annot"><span class="annottext">return_size :: Int
</span><a href="#local-6989586621679081114"><span class="hs-identifier hs-var hs-var">return_size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#maxSubsetsNum"><span class="hs-identifier hs-var hs-var">maxSubsetsNum</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081120"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679081119"><span class="hs-identifier hs-var">m_subsets</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621679081113"><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081113"><span class="hs-identifier hs-var">initial_sets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081114"><span class="hs-identifier hs-var">return_size</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var">all_pairs</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
-&gt; m [((Double, Double), (Double, Double))]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var">all_pairs</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
-&gt; Int -&gt; m [((Double, Double), (Double, Double))]
forall (m :: * -&gt; *) a. MonadRandom m =&gt; [a] -&gt; Int -&gt; m [a]
</span><a href="Statistics.LinearRegression.html#randomSubset"><span class="hs-identifier hs-var">randomSubset</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081116"><span class="hs-identifier hs-var">all_pairs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081114"><span class="hs-identifier hs-var">return_size</span></a></span><span> </span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; m [(Double, Double)]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; m [(Double, Double)])
-&gt; ([((Double, Double), (Double, Double))] -&gt; [(Double, Double)])
-&gt; [((Double, Double), (Double, Double))]
-&gt; m [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double) -&gt; (Double, Double))
-&gt; [((Double, Double), Double)] -&gt; [(Double, Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; (Double, Double)
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [(Double, Double)])
-&gt; ([((Double, Double), (Double, Double))]
    -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), (Double, Double))]
-&gt; [(Double, Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters -&gt; Int
</span><a href="Statistics.LinearRegression.html#groupSubsets"><span class="hs-identifier hs-var hs-var">groupSubsets</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081120"><span class="hs-identifier hs-var">ep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; ([((Double, Double), (Double, Double))]
    -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), (Double, Double))]
-&gt; [((Double, Double), Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), Double)
 -&gt; ((Double, Double), Double) -&gt; Ordering)
-&gt; [((Double, Double), Double)] -&gt; [((Double, Double), Double)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Ordering)
-&gt; (((Double, Double), Double) -&gt; Double)
-&gt; ((Double, Double), Double)
-&gt; ((Double, Double), Double)
-&gt; Ordering
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), Double) -&gt; Double
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), Double)] -&gt; [((Double, Double), Double)])
-&gt; ([((Double, Double), (Double, Double))]
    -&gt; [((Double, Double), Double)])
-&gt; [((Double, Double), (Double, Double))]
-&gt; [((Double, Double), Double)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(((Double, Double), (Double, Double))
 -&gt; ((Double, Double), Double))
-&gt; [((Double, Double), (Double, Double))]
-&gt; [((Double, Double), Double)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
forall (v :: * -&gt; *).
Vector v Double =&gt;
EstimationParameters
-&gt; v Double
-&gt; v Double
-&gt; (Double, Double)
-&gt; ((Double, Double), Double)
</span><a href="Statistics.LinearRegression.html#concentrateNSteps"><span class="hs-identifier hs-var">concentrateNSteps</span></a></span><span> </span><span class="annot"><span class="annottext">EstimationParameters
</span><a href="#local-6989586621679081120"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081118"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">v Double
</span><a href="#local-6989586621679081117"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; ((Double, Double), Double))
-&gt; (((Double, Double), (Double, Double)) -&gt; (Double, Double))
-&gt; ((Double, Double), (Double, Double))
-&gt; ((Double, Double), Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double), (Double, Double)) -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#lineParams"><span class="hs-identifier hs-var">lineParams</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([((Double, Double), (Double, Double))] -&gt; m [(Double, Double)])
-&gt; [((Double, Double), (Double, Double))] -&gt; m [(Double, Double)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[((Double, Double), (Double, Double))]
</span><a href="#local-6989586621679081113"><span class="hs-identifier hs-var">initial_sets</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Find the line passing between two points. This is the initial estimate to use given two random points.</span><span>
</span><span id="line-294"></span><span class="annot"><a href="Statistics.LinearRegression.html#lineParams"><span class="hs-identifier hs-type">lineParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Statistics.LinearRegression.html#EstimatedRelation"><span class="hs-identifier hs-type">EstimatedRelation</span></a></span><span>
</span><span id="line-295"></span><span id="lineParams"><span class="annot"><span class="annottext">lineParams :: ((Double, Double), (Double, Double)) -&gt; (Double, Double)
</span><a href="Statistics.LinearRegression.html#lineParams"><span class="hs-identifier hs-var hs-var">lineParams</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679081111"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081111"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081110"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081110"><span class="hs-identifier hs-var">y1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679081109"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081109"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081108"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081108"><span class="hs-identifier hs-var">y2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081107"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081106"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621679081106"><span class="annot"><span class="annottext">beta :: Double
</span><a href="#local-6989586621679081106"><span class="hs-identifier hs-var hs-var">beta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081108"><span class="hs-identifier hs-var">y2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081110"><span class="hs-identifier hs-var">y1</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081109"><span class="hs-identifier hs-var">x2</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081111"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span id="local-6989586621679081107"><span class="annot"><span class="annottext">alpha :: Double
</span><a href="#local-6989586621679081107"><span class="hs-identifier hs-var hs-var">alpha</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081110"><span class="hs-identifier hs-var">y1</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081106"><span class="hs-identifier hs-var">beta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679081111"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | A list of all possible two-element pairs from a list.</span><span>
</span><span id="line-301"></span><span id="local-6989586621679081358"><span class="annot"><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-type">allPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679081358"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081358"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679081358"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-302"></span><span id="allPairs"><span class="annot"><span class="annottext">allPairs :: [a] -&gt; [(a, a)]
</span><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var hs-var">allPairs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span class="annot"><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679081105"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081105"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-304"></span><span class="annot"><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679081104"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081104"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081103"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081103"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081104"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081103"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-305"></span><span class="annot"><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081102"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081102"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679081101"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679081101"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [(a, a)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679081101"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [(a, a)]) -&gt; (a -&gt; [a]) -&gt; a -&gt; [(a, a)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; [(a, a)]) -&gt; a -&gt; [(a, a)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081102"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a)] -&gt; [(a, a)] -&gt; [(a, a)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [(a, a)]
forall a. [a] -&gt; [(a, a)]
</span><a href="Statistics.LinearRegression.html#allPairs"><span class="hs-identifier hs-var">allPairs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679081101"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Get a random subset of a given size.</span><span>
</span><span id="line-308"></span><span id="local-6989586621679081394"><span id="local-6989586621679081395"><span class="annot"><a href="Statistics.LinearRegression.html#randomSubset"><span class="hs-identifier hs-type">randomSubset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679081395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679081394"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081395"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679081394"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-309"></span><span id="randomSubset"><span class="annot"><span class="annottext">randomSubset :: [a] -&gt; Int -&gt; m [a]
</span><a href="Statistics.LinearRegression.html#randomSubset"><span class="hs-identifier hs-var hs-var">randomSubset</span></a></span></span><span> </span><span id="local-6989586621679081099"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679081099"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679081098"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081098"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a] -&gt; m [a]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081098"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m [a] -&gt; m [a]) -&gt; m [a] -&gt; m [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; m [a]
forall (m :: * -&gt; *) a. MonadRandom m =&gt; [a] -&gt; m [a]
</span><a href="../../../../random-shuffle/html/src"><span class="hs-identifier hs-var">shuffleM</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679081099"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Split a list into sublists of length n.</span><span>
</span><span id="line-312"></span><span id="local-6989586621679081370"><span class="annot"><a href="Statistics.LinearRegression.html#splitTo"><span class="hs-identifier hs-type">splitTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679081370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679081370"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-313"></span><span id="splitTo"><span class="annot"><span class="annottext">splitTo :: Int -&gt; [a] -&gt; [[a]]
</span><a href="Statistics.LinearRegression.html#splitTo"><span class="hs-identifier hs-var hs-var">splitTo</span></a></span></span><span> </span><span id="local-6989586621679081097"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081097"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [[a]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081097"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; [[a]]) -&gt; ([a] -&gt; [[a]]) -&gt; [a] -&gt; [[a]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Bool) -&gt; [[a]] -&gt; [[a]]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([a] -&gt; Bool) -&gt; [a] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([[a]] -&gt; [[a]]) -&gt; ([a] -&gt; [[a]]) -&gt; [a] -&gt; [[a]]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [[a]]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">iterate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679081097"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span class="hs-comment">-- | Helper function to adjust parameter handling</span><span>
</span><span id="line-316"></span><span id="local-6989586621679081363"><span id="local-6989586621679081364"><span id="local-6989586621679081365"><span class="annot"><a href="Statistics.LinearRegression.html#applyTo"><span class="hs-identifier hs-type">applyTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081365"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679081364"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-glyph">-&gt;</span><span class="annot"><a href="#local-6989586621679081363"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679081365"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679081364"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679081363"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-317"></span><span id="applyTo"><span class="annot"><span class="annottext">applyTo :: (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="Statistics.LinearRegression.html#applyTo"><span class="hs-identifier hs-var hs-var">applyTo</span></a></span></span><span> </span><span id="local-6989586621679081092"><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679081091"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081091"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679081090"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081090"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679081092"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679081091"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679081090"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- $references</span><span>
</span><span id="line-320"></span><span class="hs-comment">--</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- * Two Dimensional Euclidean Regression (Stein) &lt;http://www.dspcsp.com/pubs/euclreg.pdf&gt;</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- * Computing LTS Regression For Large Data Sets (Rousseeuw and Driessen) &lt;http://agoras.ua.ac.be/abstract/Comlts99.htm&gt;</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">-- * Applied linear statistical models (Kutner et al.)</span><span>
</span><span id="line-326"></span></pre></body></html>