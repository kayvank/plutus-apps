<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Statistics.LinearRegression</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">statistics-linreg-0.3: Linear regression between two samples, based on the 'statistics' package.</span><ul class="links" id="page-menu"><li><a href="src/Statistics.LinearRegression.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell98</td></tr></table><p class="caption">Statistics.LinearRegression</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Simple linear regression functions</a></li><li><a href="#g:2">Related functions</a></li><li><a href="#g:3">Estimated errors and distribution parameters</a></li><li><a href="#g:4">Robust linear regression</a><ul><li><a href="#g:5">Related types</a></li><li><a href="#g:6">Provided values</a></li><li><a href="#g:7">Helper functions</a></li></ul></li><li><a href="#g:8">References</a></li></ul></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:linearRegression">linearRegression</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)</li><li class="src short"><a href="#v:linearRegressionRSqr">linearRegressionRSqr</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)</li><li class="src short"><a href="#v:linearRegressionTLS">linearRegressionTLS</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)</li><li class="src short"><a href="#v:correl">correl</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></li><li class="src short"><a href="#v:covar">covar</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></li><li class="src short"><a href="#v:linearRegressionMSE">linearRegressionMSE</a> :: (<a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></li><li class="src short"><a href="#v:linearRegressionDistributions">linearRegressionDistributions</a> :: (<a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../statistics/html/Statistics-Distribution-Transform.html#t:LinearTransform" title="Statistics.Distribution.Transform">LinearTransform</a> <a href="../../statistics/html/Statistics-Distribution-StudentT.html#t:StudentT" title="Statistics.Distribution.StudentT">StudentT</a>, <a href="../../statistics/html/Statistics-Distribution-Transform.html#t:LinearTransform" title="Statistics.Distribution.Transform">LinearTransform</a> <a href="../../statistics/html/Statistics-Distribution-StudentT.html#t:StudentT" title="Statistics.Distribution.StudentT">StudentT</a>)</li><li class="src short"><a href="#v:robustFit">robustFit</a> :: (<a href="../../MonadRandom/html/Control-Monad-Random-Class.html#t:MonadRandom" title="Control.Monad.Random.Class">MonadRandom</a> m, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; m <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a></li><li class="src short"><a href="#v:nonRandomRobustFit">nonRandomRobustFit</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a></li><li class="src short"><a href="#v:robustFitRSqr">robustFitRSqr</a> :: (<a href="../../MonadRandom/html/Control-Monad-Random-Class.html#t:MonadRandom" title="Control.Monad.Random.Class">MonadRandom</a> m, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; m (<a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)</li><li class="src short"><span class="keyword">data</span> <a href="#t:EstimationParameters">EstimationParameters</a> = <a href="#v:EstimationParameters">EstimationParameters</a> {<ul class="subs"><li><a href="#v:outlierFraction">outlierFraction</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></li><li><a href="#v:shortIterationSteps">shortIterationSteps</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:maxSubsetsNum">maxSubsetsNum</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:groupSubsets">groupSubsets</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:mediumSetSize">mediumSetSize</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:largeSetSize">largeSetSize</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></li><li><a href="#v:estimator">estimator</a> :: <a href="Statistics-LinearRegression.html#t:Estimator" title="Statistics.LinearRegression">Estimator</a></li><li><a href="#v:errorFunction">errorFunction</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a></li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:ErrorFunction">ErrorFunction</a> = <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:Estimator">Estimator</a> = <a href="../../statistics/html/Statistics-Sample.html#t:Sample" title="Statistics.Sample">Sample</a> -&gt; <a href="../../statistics/html/Statistics-Sample.html#t:Sample" title="Statistics.Sample">Sample</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a></li><li class="src short"><span class="keyword">type</span> <a href="#t:EstimatedRelation">EstimatedRelation</a> = (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)</li><li class="src short"><a href="#v:defaultEstimationParameters">defaultEstimationParameters</a> :: <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a></li><li class="src short"><a href="#v:linearRegressionError">linearRegressionError</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a></li><li class="src short"><a href="#v:linearRegressionTLSError">linearRegressionTLSError</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a></li><li class="src short"><a href="#v:converge">converge</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Simple linear regression functions</h1></a><div class="top"><p class="src"><a id="v:linearRegression" class="def">linearRegression</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) <a href="src/Statistics.LinearRegression.html#linearRegression" class="link">Source</a> <a href="#v:linearRegression" class="selflink">#</a></p><div class="doc"><p>Simple linear regression between 2 samples.
   Takes two vectors Y={yi} and X={xi} and returns
   (alpha, beta) such that Y = alpha + beta*X          </p></div></div><div class="top"><p class="src"><a id="v:linearRegressionRSqr" class="def">linearRegressionRSqr</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) <a href="src/Statistics.LinearRegression.html#linearRegressionRSqr" class="link">Source</a> <a href="#v:linearRegressionRSqr" class="selflink">#</a></p><div class="doc"><p>Simple linear regression between 2 samples.
   Takes two vectors Y={yi} and X={xi} and returns
   (alpha, beta, r*r) such that Y = alpha + beta*X
   and where r is the Pearson product-moment correlation
   coefficient</p></div></div><div class="top"><p class="src"><a id="v:linearRegressionTLS" class="def">linearRegressionTLS</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) <a href="src/Statistics.LinearRegression.html#linearRegressionTLS" class="link">Source</a> <a href="#v:linearRegressionTLS" class="selflink">#</a></p><div class="doc"><p>Total Least Squares (TLS) linear regression.
 Assumes x-axis values (and not just y-axis values) are random variables and that both variables have similar distributions.
 interface is the same as <code><a href="Statistics-LinearRegression.html#v:linearRegression" title="Statistics.LinearRegression">linearRegression</a></code>.</p></div></div><a href="#g:2" id="g:2"><h1>Related functions</h1></a><div class="top"><p class="src"><a id="v:correl" class="def">correl</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> <a href="src/Statistics.LinearRegression.html#correl" class="link">Source</a> <a href="#v:correl" class="selflink">#</a></p><div class="doc"><p>Pearson's product-moment correlation coefficient</p></div></div><div class="top"><p class="src"><a id="v:covar" class="def">covar</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> <a href="src/Statistics.LinearRegression.html#covar" class="link">Source</a> <a href="#v:covar" class="selflink">#</a></p><div class="doc"><p>Covariance of two samples</p></div></div><a href="#g:3" id="g:3"><h1>Estimated errors and distribution parameters</h1></a><div class="top"><p class="src"><a id="v:linearRegressionMSE" class="def">linearRegressionMSE</a> :: (<a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> <a href="src/Statistics.LinearRegression.html#linearRegressionMSE" class="link">Source</a> <a href="#v:linearRegressionMSE" class="selflink">#</a></p><div class="doc"><p>The error (or residual) mean square of a sample w.r.t. an estimated regression line.
   This serves as an estimate for the variance of the sampled data.
   Accepts the regression parameters (alpha,beta) and the sample vectors X and Y.</p></div></div><div class="top"><p class="src"><a id="v:linearRegressionDistributions" class="def">linearRegressionDistributions</a> :: (<a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; (<a href="../../statistics/html/Statistics-Distribution-Transform.html#t:LinearTransform" title="Statistics.Distribution.Transform">LinearTransform</a> <a href="../../statistics/html/Statistics-Distribution-StudentT.html#t:StudentT" title="Statistics.Distribution.StudentT">StudentT</a>, <a href="../../statistics/html/Statistics-Distribution-Transform.html#t:LinearTransform" title="Statistics.Distribution.Transform">LinearTransform</a> <a href="../../statistics/html/Statistics-Distribution-StudentT.html#t:StudentT" title="Statistics.Distribution.StudentT">StudentT</a>) <a href="src/Statistics.LinearRegression.html#linearRegressionDistributions" class="link">Source</a> <a href="#v:linearRegressionDistributions" class="selflink">#</a></p><div class="doc"><p>The estimated distributions of the regression parameters (alpha and beta) assuming normal, identical distributions of Y, the sampled data.
 These can serve to get confidence intervals for the regression parameters.
 Accepts the regression parameters (alpha,beta) and the sample vectors X and Y.
 The distributions are StudnetT distributions centered at the estimated (alpha,beta) respectively, with parameter numbers n-2 (where n is the initial sample size) and with standard deviations that are extracted from the sampled data based on its MSE. See chapter 2 of reference [3] for details.</p></div></div><a href="#g:4" id="g:4"><h1>Robust linear regression</h1></a><div class="top"><p class="src"><a id="v:robustFit" class="def">robustFit</a> :: (<a href="../../MonadRandom/html/Control-Monad-Random-Class.html#t:MonadRandom" title="Control.Monad.Random.Class">MonadRandom</a> m, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; m <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> <a href="src/Statistics.LinearRegression.html#robustFit" class="link">Source</a> <a href="#v:robustFit" class="selflink">#</a></p><div class="doc"><p>Finding a robust fit linear estimate between two samples. The procedure requires randomization and is based on the procedure described in the reference.</p></div></div><div class="top"><p class="src"><a id="v:nonRandomRobustFit" class="def">nonRandomRobustFit</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> <a href="src/Statistics.LinearRegression.html#nonRandomRobustFit" class="link">Source</a> <a href="#v:nonRandomRobustFit" class="selflink">#</a></p><div class="doc"><p>A wrapper that executes <code><a href="Statistics-LinearRegression.html#v:robustFit" title="Statistics.LinearRegression">robustFit</a></code> using a default random generator (meaning it is only pseudo-random)</p></div></div><div class="top"><p class="src"><a id="v:robustFitRSqr" class="def">robustFitRSqr</a> :: (<a href="../../MonadRandom/html/Control-Monad-Random-Class.html#t:MonadRandom" title="Control.Monad.Random.Class">MonadRandom</a> m, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>)) =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; m (<a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) <a href="src/Statistics.LinearRegression.html#robustFitRSqr" class="link">Source</a> <a href="#v:robustFitRSqr" class="selflink">#</a></p><div class="doc"><p>Robust fit yielding also the R-square value of the &quot;clean&quot; dataset.</p></div></div><a href="#g:5" id="g:5"><h2>Related types</h2></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EstimationParameters" class="def">EstimationParameters</a> <a href="src/Statistics.LinearRegression.html#EstimationParameters" class="link">Source</a> <a href="#t:EstimationParameters" class="selflink">#</a></p><div class="doc"><p>The robust fit algorithm used has various parameters that can be specified using the <code><a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a></code> record.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:EstimationParameters" class="def">EstimationParameters</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:outlierFraction" class="def">outlierFraction</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a></dfn><div class="doc"><p>Maximal fraction of outliers expected in the sample (default 0.25)</p></div></li><li><dfn class="src"><a id="v:shortIterationSteps" class="def">shortIterationSteps</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Number of concentration steps to take for initial evaluation of a solution (default 3)</p></div></li><li><dfn class="src"><a id="v:maxSubsetsNum" class="def">maxSubsetsNum</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Maximal number of sampled subsets (pairs of points) to use as starting points (default 500)</p></div></li><li><dfn class="src"><a id="v:groupSubsets" class="def">groupSubsets</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>If the initial sample is large, and thus gets subdivided, this is the number of candidate-estimations to take from each subgroup, on which complete convergence will be executed (default 10)</p></div></li><li><dfn class="src"><a id="v:mediumSetSize" class="def">mediumSetSize</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Maximal size of sample that can be analyzed without any sub-division (default 600)</p></div></li><li><dfn class="src"><a id="v:largeSetSize" class="def">largeSetSize</a> :: !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a></dfn><div class="doc"><p>Maximal size of sample that does not require two-step sub-division (see reference article) (default 1500)</p></div></li><li><dfn class="src"><a id="v:estimator" class="def">estimator</a> :: <a href="Statistics-LinearRegression.html#t:Estimator" title="Statistics.LinearRegression">Estimator</a></dfn><div class="doc"><p>Estimator function to use (default linearRegression)</p></div></li><li><dfn class="src"><a id="v:errorFunction" class="def">errorFunction</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a></dfn><div class="doc"><p>ErrorFunction to use (default linearRegressionError)</p></div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:ErrorFunction" class="def">ErrorFunction</a> = <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> -&gt; (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> <a href="src/Statistics.LinearRegression.html#ErrorFunction" class="link">Source</a> <a href="#t:ErrorFunction" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a></code> is a function that computes the error of a given point from an estimate. This module provides two error functions correspoinding to the two <code><a href="Statistics-LinearRegression.html#t:Estimator" title="Statistics.LinearRegression">Estimator</a></code> functions it defines:</p><ul><li>Vertical distance squared via <code><a href="Statistics-LinearRegression.html#v:linearRegressionError" title="Statistics.LinearRegression">linearRegressionError</a></code> that should be used with <code><a href="Statistics-LinearRegression.html#v:linearRegression" title="Statistics.LinearRegression">linearRegression</a></code></li><li>Total distance squared vie <code><a href="Statistics-LinearRegression.html#v:linearRegressionTLSError" title="Statistics.LinearRegression">linearRegressionTLSError</a></code> that should be used with <code><a href="Statistics-LinearRegression.html#v:linearRegressionTLS" title="Statistics.LinearRegression">linearRegressionTLS</a></code></li></ul></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Estimator" class="def">Estimator</a> = <a href="../../statistics/html/Statistics-Sample.html#t:Sample" title="Statistics.Sample">Sample</a> -&gt; <a href="../../statistics/html/Statistics-Sample.html#t:Sample" title="Statistics.Sample">Sample</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> <a href="src/Statistics.LinearRegression.html#Estimator" class="link">Source</a> <a href="#t:Estimator" class="selflink">#</a></p><div class="doc"><p>An <code><a href="Statistics-LinearRegression.html#t:Estimator" title="Statistics.LinearRegression">Estimator</a></code> is a function that generates an estimated linear regression based on 2 samples. This module provides two estimator functions:
 <code><a href="Statistics-LinearRegression.html#v:linearRegression" title="Statistics.LinearRegression">linearRegression</a></code> and <code><a href="Statistics-LinearRegression.html#v:linearRegressionTLS" title="Statistics.LinearRegression">linearRegressionTLS</a></code></p></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:EstimatedRelation" class="def">EstimatedRelation</a> = (<a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>, <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a>) <a href="src/Statistics.LinearRegression.html#EstimatedRelation" class="link">Source</a> <a href="#t:EstimatedRelation" class="selflink">#</a></p><div class="doc"><p>An estimated linear relation between 2 samples is (alpha,beta) such that Y = alpha + beta*X.</p></div></div><a href="#g:6" id="g:6"><h2>Provided values</h2></a><div class="top"><p class="src"><a id="v:defaultEstimationParameters" class="def">defaultEstimationParameters</a> :: <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> <a href="src/Statistics.LinearRegression.html#defaultEstimationParameters" class="link">Source</a> <a href="#v:defaultEstimationParameters" class="selflink">#</a></p><div class="doc"><p>Default set of parameters to use (see reference for details).</p></div></div><div class="top"><p class="src"><a id="v:linearRegressionError" class="def">linearRegressionError</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a> <a href="src/Statistics.LinearRegression.html#linearRegressionError" class="link">Source</a> <a href="#v:linearRegressionError" class="selflink">#</a></p><div class="doc"><p>linearRegression error function is the square of the <em>vertical</em> distance of a point from the line.</p></div></div><div class="top"><p class="src"><a id="v:linearRegressionTLSError" class="def">linearRegressionTLSError</a> :: <a href="Statistics-LinearRegression.html#t:ErrorFunction" title="Statistics.LinearRegression">ErrorFunction</a> <a href="src/Statistics.LinearRegression.html#linearRegressionTLSError" class="link">Source</a> <a href="#v:linearRegressionTLSError" class="selflink">#</a></p><div class="doc"><p>linearRegressionTLS error function is the square of the <em>total</em> distance of a point from the line.</p></div></div><a href="#g:7" id="g:7"><h2>Helper functions</h2></a><div class="top"><p class="src"><a id="v:converge" class="def">converge</a> :: <a href="../../vector/html/Data-Vector-Generic.html#t:Vector" title="Data.Vector.Generic">Vector</a> v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> =&gt; <a href="Statistics-LinearRegression.html#t:EstimationParameters" title="Statistics.LinearRegression">EstimationParameters</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; v <a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#t:Double" title="Prelude">Double</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> -&gt; <a href="Statistics-LinearRegression.html#t:EstimatedRelation" title="Statistics.LinearRegression">EstimatedRelation</a> <a href="src/Statistics.LinearRegression.html#converge" class="link">Source</a> <a href="#v:converge" class="selflink">#</a></p><div class="doc"><p>Calculate the optimal (local minimum) estimate based on an initial estimate.
 The local minimum may not be the global (a.k.a. best) estimate but starting from enough different initial estimates should yield the global optimum eventually.</p></div></div><a href="#g:8" id="g:8"><h1>References</h1></a><div class="doc"><ul><li>Two Dimensional Euclidean Regression (Stein) <a href="http://www.dspcsp.com/pubs/euclreg.pdf">http://www.dspcsp.com/pubs/euclreg.pdf</a></li><li>Computing LTS Regression For Large Data Sets (Rousseeuw and Driessen) <a href="http://agoras.ua.ac.be/abstract/Comlts99.htm">http://agoras.ua.ac.be/abstract/Comlts99.htm</a></li><li>Applied linear statistical models (Kutner et al.)</li></ul></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>