<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Utils.Roundtrip</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Utils.Roundtrip.html#jsonRoundtripAndGolden"><span class="hs-identifier">jsonRoundtripAndGolden</span></a></span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Utils.Roundtrip.html#httpApiDataRoundtrip"><span class="hs-identifier">httpApiDataRoundtrip</span></a></span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Char</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isAlphaNum</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">splitTyConApp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">tyConName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">typeRep</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">Test.Aeson.GenericSpecs</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">GoldenDirectoryOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">CustomDirectoryName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">Settings</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">defaultSettings</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">goldenDirectoryOption</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">randomMismatchOption</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">sampleSize</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">useModuleNameAsSubDirectory</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">Test.Aeson.Internal.GoldenSpecs</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">goldenSpecsWithNotePlain</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">Test.Aeson.Internal.RoundtripSpecs</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">roundtripSpecs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">Test.Aeson.Internal.Utils</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">RandomMismatchOption</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">RandomMismatchError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">TypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">TypeNameInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier">mkTypeNameInfo</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec/html/src"><span class="hs-identifier">Test.Hspec</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier">Spec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier">it</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier">runIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-expectations/html/src"><span class="hs-identifier">shouldBe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">Arbitrary</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">property</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../http-api-data/html/src"><span class="hs-identifier">Web.HttpApiData</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../http-api-data/html/src"><span class="hs-identifier">FromHttpApiData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-api-data/html/src"><span class="hs-identifier">ToHttpApiData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Golden tests files are generated automatically on first run. On later runs</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- we check that the format stays the same. The golden files should be tracked</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- in git.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- Example:</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- &gt;&gt;&gt; roundtripAndGolden $ Proxy @ Wallet</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- ...will compare @ToJSON@ of @Wallet@ against `Wallet.json`. It may either</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- match and succeed, or fail and write `Wallet.faulty.json` to disk with the</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- new format. Faulty golden files should /not/ be committed.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- The directory `test/data/Cardano/Wallet/Api` is used.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Test.Utils.Roundtrip.html#jsonRoundtripAndGolden"><span class="hs-identifier hs-type">jsonRoundtripAndGolden</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679139606"><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-61"></span><span id="jsonRoundtripAndGolden"><span class="annot"><span class="annottext">jsonRoundtripAndGolden :: FilePath -&gt; Proxy a -&gt; Spec
</span><a href="Test.Utils.Roundtrip.html#jsonRoundtripAndGolden"><span class="hs-identifier hs-var hs-var">jsonRoundtripAndGolden</span></a></span></span><span> </span><span id="local-6989586621679139605"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679139605"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679139604"><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679139604"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Proxy a -&gt; Spec
forall a.
(Typeable a, Arbitrary a, ToJSON a, FromJSON a) =&gt;
Proxy a -&gt; Spec
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">roundtripSpecs</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679139604"><span class="hs-identifier hs-var">proxy</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span id="local-6989586621679139603"><span class="annot"><span class="annottext">TypeNameInfo a
</span><a href="#local-6989586621679139603"><span class="hs-identifier hs-var">typeNameInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (TypeNameInfo a) -&gt; SpecM () (TypeNameInfo a)
forall r a. IO r -&gt; SpecM a r
</span><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-var">runIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO (TypeNameInfo a)
</span><a href="#local-6989586621679139602"><span class="hs-identifier hs-var">mkCompatibleTypeNameInfo</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><span class="annottext">Settings -&gt; TypeNameInfo a -&gt; Maybe FilePath -&gt; Spec
forall a.
(Arbitrary a, ToJSON a, FromJSON a) =&gt;
Settings -&gt; TypeNameInfo a -&gt; Maybe FilePath -&gt; Spec
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">goldenSpecsWithNotePlain</span></a></span><span> </span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679139601"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">TypeNameInfo a
</span><a href="#local-6989586621679139603"><span class="hs-identifier hs-var">typeNameInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- NOTE</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- We use a custom 'TypeNameInfo' instead of the default one provided by</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- @hspec-golden-aeson@ because the defaults generates names that are</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">-- invalid for Windows file-system.</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="#local-6989586621679139602"><span class="hs-identifier hs-type">mkCompatibleTypeNameInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-type">TypeNameInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span id="local-6989586621679139602"><span class="annot"><span class="annottext">mkCompatibleTypeNameInfo :: IO (TypeNameInfo a)
</span><a href="#local-6989586621679139602"><span class="hs-identifier hs-var hs-var">mkCompatibleTypeNameInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621679139600"><span class="annot"><span class="annottext">TypeNameInfo a
</span><a href="#local-6989586621679139600"><span class="hs-identifier hs-var">typeNameInfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Settings -&gt; Proxy a -&gt; IO (TypeNameInfo a)
forall a.
(Arbitrary a, Typeable a) =&gt;
Settings -&gt; Proxy a -&gt; IO (TypeNameInfo a)
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">mkTypeNameInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Settings
</span><a href="#local-6989586621679139601"><span class="hs-identifier hs-var">settings</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679139604"><span class="hs-identifier hs-var">proxy</span></a></span><span>
</span><span id="line-73"></span><span>        </span><span class="annot"><span class="annottext">TypeNameInfo a -&gt; IO (TypeNameInfo a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeNameInfo a -&gt; IO (TypeNameInfo a))
-&gt; TypeNameInfo a -&gt; IO (TypeNameInfo a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeNameInfo a
</span><a href="#local-6989586621679139600"><span class="hs-identifier hs-var">typeNameInfo</span></a></span><span>
</span><span id="line-74"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">typeNameTypeName :: TypeName
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">typeNameTypeName</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>                </span><span class="annot"><span class="annottext">TypeName -&gt; TypeName
</span><a href="#local-6989586621679139598"><span class="hs-identifier hs-var">mkValidForWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeNameInfo a -&gt; TypeName
forall a. TypeNameInfo a -&gt; TypeName
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var hs-var">typeNameTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeNameInfo a
</span><a href="#local-6989586621679139600"><span class="hs-identifier hs-var">typeNameInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><a href="#local-6989586621679139598"><span class="hs-identifier hs-type">mkValidForWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-type">TypeName</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span id="local-6989586621679139598"><span class="annot"><span class="annottext">mkValidForWindows :: TypeName -&gt; TypeName
</span><a href="#local-6989586621679139598"><span class="hs-identifier hs-var hs-var">mkValidForWindows</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span id="local-6989586621679139596"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679139596"><span class="hs-identifier hs-var">typeName</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; TypeName
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">TypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; FilePath -&gt; FilePath
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isAlphaNum</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679139596"><span class="hs-identifier hs-var">typeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="#local-6989586621679139601"><span class="hs-identifier hs-type">settings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-type">Settings</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621679139601"><span class="annot"><span class="annottext">settings :: Settings
</span><a href="#local-6989586621679139601"><span class="hs-identifier hs-var hs-var">settings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Settings
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">defaultSettings</span></a></span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">goldenDirectoryOption :: GoldenDirectoryOption
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">goldenDirectoryOption</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>            </span><span class="annot"><span class="annottext">FilePath -&gt; GoldenDirectoryOption
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">CustomDirectoryName</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679139605"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">useModuleNameAsSubDirectory :: Bool
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">useModuleNameAsSubDirectory</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sampleSize :: Int
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">sampleSize</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-89"></span><span>        </span><span class="hs-comment">-- Note that we fail the test if the random seed does not produce the</span><span>
</span><span id="line-90"></span><span>        </span><span class="hs-comment">-- same values as those within the golden file. It's important that</span><span>
</span><span id="line-91"></span><span>        </span><span class="hs-comment">-- we do fail, because otherwise we may inadvertently fail to cover</span><span>
</span><span id="line-92"></span><span>        </span><span class="hs-comment">-- new additions to types and their associated generators.</span><span>
</span><span id="line-93"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">randomMismatchOption :: RandomMismatchOption
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">randomMismatchOption</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RandomMismatchOption
</span><a href="../../../../hspec-golden-aeson/html/src"><span class="hs-identifier hs-var">RandomMismatchError</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- Perform roundtrip tests for FromHttpApiData &amp; ToHttpApiData instances</span><span>
</span><span id="line-97"></span><span class="annot"><a href="Test.Utils.Roundtrip.html#httpApiDataRoundtrip"><span class="hs-identifier hs-type">httpApiDataRoundtrip</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679139595"><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Arbitrary</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-api-data/html/src"><span class="hs-identifier hs-type">FromHttpApiData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-api-data/html/src"><span class="hs-identifier hs-type">ToHttpApiData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-type">Spec</span></a></span><span>
</span><span id="line-108"></span><span id="httpApiDataRoundtrip"><span class="annot"><span class="annottext">httpApiDataRoundtrip :: Proxy a -&gt; Spec
</span><a href="Test.Utils.Roundtrip.html#httpApiDataRoundtrip"><span class="hs-identifier hs-var hs-var">httpApiDataRoundtrip</span></a></span></span><span> </span><span id="local-6989586621679139594"><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679139594"><span class="hs-identifier hs-var">proxy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; Property -&gt; SpecWith (Arg Property)
forall a.
(HasCallStack, Example a) =&gt;
FilePath -&gt; a -&gt; SpecWith (Arg a)
</span><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;URL encoding of &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; FilePath
</span><a href="#local-6989586621679139593"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a -&gt; TypeRep
forall k (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy a
</span><a href="#local-6989586621679139594"><span class="hs-identifier hs-var">proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; SpecWith (Arg Property))
-&gt; Property -&gt; SpecWith (Arg Property)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Expectation) -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Expectation) -&gt; Property) -&gt; (a -&gt; Expectation) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679139592"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679139592"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679139595"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679139591"><span class="annot"><span class="annottext">bytes :: Text
</span><a href="#local-6989586621679139591"><span class="hs-identifier hs-var hs-var">bytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToHttpApiData a =&gt; a -&gt; Text
</span><a href="../../../../http-api-data/html/src"><span class="hs-identifier hs-var">toUrlPiece</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679139592"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679139589"><span class="annot"><span class="annottext">x' :: Either Text a
</span><a href="#local-6989586621679139589"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either Text a
forall a. FromHttpApiData a =&gt; Text -&gt; Either Text a
</span><a href="../../../../http-api-data/html/src"><span class="hs-identifier hs-var">parseUrlPiece</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679139591"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">Either Text a
</span><a href="#local-6989586621679139589"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">Either Text a -&gt; Either Text a -&gt; Expectation
forall a. (HasCallStack, Show a, Eq a) =&gt; a -&gt; a -&gt; Expectation
</span><a href="../../../../hspec-expectations/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either Text a
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679139592"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679139593"><span class="annot"><span class="annottext">cons :: TypeRep -&gt; FilePath
</span><a href="#local-6989586621679139593"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621679139587"><span class="annot"><span class="annottext">TypeRep
</span><a href="#local-6989586621679139587"><span class="hs-identifier hs-var">rep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-116"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679139586"><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621679139586"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679139585"><span class="annot"><span class="annottext">[TypeRep]
</span><a href="#local-6989586621679139585"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; (TyCon, [TypeRep])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">splitTyConApp</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep
</span><a href="#local-6989586621679139587"><span class="hs-identifier hs-var">rep</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-118"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TypeRep]
</span><a href="#local-6989586621679139585"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-119"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>                    </span><span class="annot"><span class="annottext">TyCon -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621679139586"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-121"></span><span>                </span><span id="local-6989586621679139584"><span class="annot"><span class="annottext">[TypeRep]
</span><a href="#local-6989586621679139584"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>                    </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;(&quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">tyConName</span></a></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><a href="#local-6989586621679139586"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[FilePath] -&gt; FilePath
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unwords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep -&gt; FilePath
</span><a href="#local-6989586621679139593"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep -&gt; FilePath) -&gt; [TypeRep] -&gt; [FilePath]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TypeRep]
</span><a href="#local-6989586621679139584"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-123"></span></pre></body></html>