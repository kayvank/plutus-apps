<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns      #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell   #-}</span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Cardano.Binary.Drop</span><span>
</span><span id="line-5"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#tests"><span class="hs-identifier">tests</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Int32</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog.Gen</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog.Range</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#tests"><span class="hs-identifier hs-type">tests</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-20"></span><span id="tests"><span class="annot"><span class="annottext">tests :: IO Bool
</span><a href="Test.Cardano.Binary.Drop.html#tests"><span class="hs-identifier hs-var hs-var">tests</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Group -&gt; IO Bool
forall (m :: * -&gt; *). MonadIO m =&gt; Group -&gt; m Bool
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">checkParallel</span></a></span><span> </span><span class="hs-special">$$(</span><span class="annot"><span class="annottext">String
[(PropertyName, Property)]
Property
String -&gt; PropertyName
String -&gt; GroupName
GroupName -&gt; [(PropertyName, Property)] -&gt; Group
prop_dropTriple :: Property
prop_dropTuple :: Property
prop_dropMap :: Property
</span><a href="Test.Cardano.Binary.Drop.html#prop_dropTriple"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">discover</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Properties testing whether dropping elements actully removes it or not</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#genInt32"><span class="hs-identifier hs-type">genInt32</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Int32</span></a></span><span>
</span><span id="line-26"></span><span id="genInt32"><span class="annot"><span class="annottext">genInt32 :: Gen Int32
</span><a href="Test.Cardano.Binary.Drop.html#genInt32"><span class="hs-identifier hs-var hs-var">genInt32</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Int32 -&gt; Gen Int32
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int32 -&gt; m Int32
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.int32</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int32
forall a. (Bounded a, Integral a) =&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.exponentialBounded</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#genBytes"><span class="hs-identifier hs-type">genBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-29"></span><span id="genBytes"><span class="annot"><span class="annottext">genBytes :: Gen ByteString
</span><a href="Test.Cardano.Binary.Drop.html#genBytes"><span class="hs-identifier hs-var hs-var">genBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; Gen ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.bytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#genWord8"><span class="hs-identifier hs-type">genWord8</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-32"></span><span id="genWord8"><span class="annot"><span class="annottext">genWord8 :: Gen Word8
</span><a href="Test.Cardano.Binary.Drop.html#genWord8"><span class="hs-identifier hs-var hs-var">genWord8</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Word8 -&gt; Gen Word8
forall (m :: * -&gt; *). MonadGen m =&gt; Range Word8 -&gt; m Word8
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.word8</span></a></span><span> </span><span class="annot"><span class="annottext">Range Word8
forall a. (Bounded a, Integral a) =&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.exponentialBounded</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#genWord64"><span class="hs-identifier hs-type">genWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-35"></span><span id="genWord64"><span class="annot"><span class="annottext">genWord64 :: Gen Word64
</span><a href="Test.Cardano.Binary.Drop.html#genWord64"><span class="hs-identifier hs-var hs-var">genWord64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Word64 -&gt; Gen Word64
forall (m :: * -&gt; *). MonadGen m =&gt; Range Word64 -&gt; m Word64
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.word64</span></a></span><span> </span><span class="annot"><span class="annottext">Range Word64
forall a. (Bounded a, Integral a) =&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.exponentialBounded</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#prop_dropMap"><span class="hs-identifier hs-type">prop_dropMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-38"></span><span id="prop_dropMap"><span class="annot"><span class="annottext">prop_dropMap :: Property
</span><a href="Test.Cardano.Binary.Drop.html#prop_dropMap"><span class="hs-identifier hs-var hs-var">prop_dropMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-39"></span><span>  </span><span id="local-6989586621679154414"><span class="annot"><span class="annottext">Map Int32 [Word8]
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Map Int32 [Word8]) -&gt; PropertyT IO (Map Int32 [Word8])
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Map Int32 [Word8]) -&gt; PropertyT IO (Map Int32 [Word8]))
-&gt; Gen (Map Int32 [Word8]) -&gt; PropertyT IO (Map Int32 [Word8])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int
-&gt; GenT Identity (Int32, [Word8]) -&gt; Gen (Map Int32 [Word8])
forall (m :: * -&gt; *) k v.
(MonadGen m, Ord k) =&gt;
Range Int -&gt; m (k, v) -&gt; m (Map k v)
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.constant</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; [Word8] -&gt; (Int32, [Word8]))
-&gt; Gen Int32 -&gt; GenT Identity ([Word8] -&gt; (Int32, [Word8]))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int32
</span><a href="Test.Cardano.Binary.Drop.html#genInt32"><span class="hs-identifier hs-var">genInt32</span></a></span><span>
</span><span id="line-41"></span><span>           </span><span class="annot"><span class="annottext">GenT Identity ([Word8] -&gt; (Int32, [Word8]))
-&gt; GenT Identity [Word8] -&gt; GenT Identity (Int32, [Word8])
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; Gen Word8 -&gt; GenT Identity [Word8]
forall (m :: * -&gt; *) a. MonadGen m =&gt; Range Int -&gt; m a -&gt; m [a]
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.constant</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen Word8
</span><a href="Test.Cardano.Binary.Drop.html#genWord8"><span class="hs-identifier hs-var">genWord8</span></a></span><span>
</span><span id="line-42"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154408"><span class="annot"><span class="annottext">encodedBs :: LByteString
</span><a href="#local-6989586621679154408"><span class="hs-identifier hs-var hs-var">encodedBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Int32 [Word8] -&gt; LByteString
forall a. ToCBOR a =&gt; a -&gt; LByteString
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">serialize</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int32 [Word8]
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="annottext">LByteString -&gt; Either DecoderError (Map Int32 [Word8])
forall a. FromCBOR a =&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFull</span></a></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154408"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError (Map Int32 [Word8])
-&gt; Either DecoderError (Map Int32 [Word8]) -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int32 [Word8] -&gt; Either DecoderError (Map Int32 [Word8])
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Map Int32 [Word8]
</span><a href="#local-6989586621679154414"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">Text
-&gt; (forall s. Decoder s ())
-&gt; LByteString
-&gt; Either DecoderError ()
forall a.
Text
-&gt; (forall s. Decoder s a) -&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFullDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop Test Failed&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropMap</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropInt32</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropList</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropWord8</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154408"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError () -&gt; Either DecoderError () -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either DecoderError ()
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#prop_dropTuple"><span class="hs-identifier hs-type">prop_dropTuple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-48"></span><span id="prop_dropTuple"><span class="annot"><span class="annottext">prop_dropTuple :: Property
</span><a href="Test.Cardano.Binary.Drop.html#prop_dropTuple"><span class="hs-identifier hs-var hs-var">prop_dropTuple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679154399"><span class="annot"><span class="annottext">Set Int32
</span><a href="#local-6989586621679154399"><span class="hs-identifier hs-var">set</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679154398"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154398"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Set Int32, ByteString) -&gt; PropertyT IO (Set Int32, ByteString)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Set Int32, ByteString)
 -&gt; PropertyT IO (Set Int32, ByteString))
-&gt; Gen (Set Int32, ByteString)
-&gt; PropertyT IO (Set Int32, ByteString)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Set Int32 -&gt; ByteString -&gt; (Set Int32, ByteString))
-&gt; GenT Identity (Set Int32)
-&gt; GenT Identity (ByteString -&gt; (Set Int32, ByteString))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; Gen Int32 -&gt; GenT Identity (Set Int32)
forall (m :: * -&gt; *) a.
(MonadGen m, Ord a) =&gt;
Range Int -&gt; m a -&gt; m (Set a)
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.constant</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Gen Int32
</span><a href="Test.Cardano.Binary.Drop.html#genInt32"><span class="hs-identifier hs-var">genInt32</span></a></span><span>
</span><span id="line-50"></span><span>                            </span><span class="annot"><span class="annottext">GenT Identity (ByteString -&gt; (Set Int32, ByteString))
-&gt; Gen ByteString -&gt; Gen (Set Int32, ByteString)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen ByteString
</span><a href="Test.Cardano.Binary.Drop.html#genBytes"><span class="hs-identifier hs-var">genBytes</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154396"><span class="annot"><span class="annottext">encodedBs :: LByteString
</span><a href="#local-6989586621679154396"><span class="hs-identifier hs-var hs-var">encodedBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set Int32, ByteString) -&gt; LByteString
forall a. ToCBOR a =&gt; a -&gt; LByteString
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">serialize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int32
</span><a href="#local-6989586621679154399"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154398"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="annottext">LByteString -&gt; Either DecoderError (Set Int32, ByteString)
forall a. FromCBOR a =&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFull</span></a></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154396"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError (Set Int32, ByteString)
-&gt; Either DecoderError (Set Int32, ByteString) -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">(Set Int32, ByteString)
-&gt; Either DecoderError (Set Int32, ByteString)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int32
</span><a href="#local-6989586621679154399"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679154398"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><span class="annottext">Text
-&gt; (forall s. Decoder s ())
-&gt; LByteString
-&gt; Either DecoderError ()
forall a.
Text
-&gt; (forall s. Decoder s a) -&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFullDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop Test Failed&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropTuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropSet</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropInt32</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropBytes</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154396"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError () -&gt; Either DecoderError () -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either DecoderError ()
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="annot"><a href="Test.Cardano.Binary.Drop.html#prop_dropTriple"><span class="hs-identifier hs-type">prop_dropTriple</span></a></span><span> </span><span class="hs-glyph">::</span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Property</span></a></span><span>
</span><span id="line-56"></span><span id="prop_dropTriple"><span class="annot"><span class="annottext">prop_dropTriple :: Property
</span><a href="Test.Cardano.Binary.Drop.html#prop_dropTriple"><span class="hs-identifier hs-var hs-var">prop_dropTriple</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; PropertyT IO () -&gt; Property
PropertyT IO () -&gt; Property
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">property</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyT IO () -&gt; Property) -&gt; PropertyT IO () -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679154392"><span class="annot"><span class="annottext">(Int32, Word8, Word64)
</span><a href="#local-6989586621679154392"><span class="hs-identifier hs-var">tri</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen (Int32, Word8, Word64) -&gt; PropertyT IO (Int32, Word8, Word64)
forall (m :: * -&gt; *) a.
(Monad m, Show a, HasCallStack) =&gt;
Gen a -&gt; PropertyT m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">forAll</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen (Int32, Word8, Word64) -&gt; PropertyT IO (Int32, Word8, Word64))
-&gt; Gen (Int32, Word8, Word64)
-&gt; PropertyT IO (Int32, Word8, Word64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int32 -&gt; Word8 -&gt; Word64 -&gt; (Int32, Word8, Word64))
-&gt; Gen Int32
-&gt; GenT Identity (Word8 -&gt; Word64 -&gt; (Int32, Word8, Word64))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int32
</span><a href="Test.Cardano.Binary.Drop.html#genInt32"><span class="hs-identifier hs-var">genInt32</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (Word8 -&gt; Word64 -&gt; (Int32, Word8, Word64))
-&gt; Gen Word8 -&gt; GenT Identity (Word64 -&gt; (Int32, Word8, Word64))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Word8
</span><a href="Test.Cardano.Binary.Drop.html#genWord8"><span class="hs-identifier hs-var">genWord8</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (Word64 -&gt; (Int32, Word8, Word64))
-&gt; Gen Word64 -&gt; Gen (Int32, Word8, Word64)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Word64
</span><a href="Test.Cardano.Binary.Drop.html#genWord64"><span class="hs-identifier hs-var">genWord64</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679154391"><span class="annot"><span class="annottext">encodedBs :: LByteString
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var hs-var">encodedBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int32, Word8, Word64) -&gt; LByteString
forall a. ToCBOR a =&gt; a -&gt; LByteString
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">serialize</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32, Word8, Word64)
</span><a href="#local-6989586621679154392"><span class="hs-identifier hs-var">tri</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="annottext">LByteString -&gt; Either DecoderError (Int32, Word8, Word64)
forall a. FromCBOR a =&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFull</span></a></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError (Int32, Word8, Word64)
-&gt; Either DecoderError (Int32, Word8, Word64) -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32, Word8, Word64)
-&gt; Either DecoderError (Int32, Word8, Word64)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(Int32, Word8, Word64)
</span><a href="#local-6989586621679154392"><span class="hs-identifier hs-var">tri</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="annottext">Text
-&gt; (forall s. Decoder s ())
-&gt; LByteString
-&gt; Either DecoderError ()
forall a.
Text
-&gt; (forall s. Decoder s a) -&gt; LByteString -&gt; Either DecoderError a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeFullDecoder</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop Test Failed&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s -&gt; Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s -&gt; Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropTriple</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropInt32</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropWord8</span></a></span><span> </span><span class="annot"><span class="annottext">Dropper s
forall s. Decoder s ()
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropWord64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679154391"><span class="hs-identifier hs-var">encodedBs</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError () -&gt; Either DecoderError () -&gt; PropertyT IO ()
forall (m :: * -&gt; *) a.
(MonadTest m, Eq a, Show a, HasCallStack) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-operator hs-var">===</span></a></span><span> </span><span class="annot"><span class="annottext">() -&gt; Either DecoderError ()
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span></pre></body></html>