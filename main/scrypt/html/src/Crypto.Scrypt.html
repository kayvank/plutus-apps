<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ForeignFunctionInterface, OverloadedStrings,
    RecordWildCards, NamedFieldPuns #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |Scrypt is a sequential memory-hard key derivation function. This module</span><span>
</span><span id="line-5"></span><span class="hs-comment">--  provides low-level bindings to the 'scrypt' key derivation function as</span><span>
</span><span id="line-6"></span><span class="hs-comment">--  well as a higher-level password-storage API. It is based on a fast C</span><span>
</span><span id="line-7"></span><span class="hs-comment">--  implementation of scrypt, written by Colin Percival. For further</span><span>
</span><span id="line-8"></span><span class="hs-comment">--  information see &lt;http://www.tarsnap.com/scrypt.html&gt;.</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Crypto.Scrypt</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parameters to the @scrypt@ function</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- $params</span></span><span>
</span><span id="line-13"></span><span>     </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier">ScryptParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#scryptParams"><span class="hs-identifier">scryptParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#scryptParamsLen"><span class="hs-identifier">scryptParamsLen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier">defaultParams</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Password Storage</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><span class="hs-comment">-- $password-storage</span></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier">EncryptedPass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#encryptPassIO"><span class="hs-identifier">encryptPassIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#encryptPassIO%27"><span class="hs-identifier">encryptPassIO'</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#newSalt"><span class="hs-identifier">newSalt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#encryptPass"><span class="hs-identifier">encryptPass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#encryptPass%27"><span class="hs-identifier">encryptPass'</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#verifyPass"><span class="hs-identifier">verifyPass</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#verifyPass%27"><span class="hs-identifier">verifyPass'</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Low-level bindings to the @scrypt@ key derivation function</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- $low-level</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier">Pass</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier">Salt</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier">PassHash</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier">scrypt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#scrypt%27"><span class="hs-identifier">scrypt'</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier">Data.ByteString.Base64</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base64</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Foreign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Ptr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word32</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">allocaBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">castPtr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Foreign.C</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../entropy/html/src"><span class="hs-identifier">System.Entropy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../entropy/html/src"><span class="hs-identifier">getEntropy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">System.IO.Unsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unsafePerformIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">newtype</span><span> </span><span id="Pass"><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span id="Pass"><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-var">Pass</span></a></span></span><span>     </span><span class="hs-special">{</span><span> </span><span id="getPass"><span class="annot"><span class="annottext">Pass -&gt; ByteString
</span><a href="Crypto.Scrypt.html#getPass"><span class="hs-identifier hs-var hs-var">getPass</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034945"><span id="local-6989586621679034947"><span id="local-6989586621679034949"><span class="annot"><span class="annottext">Int -&gt; Pass -&gt; ShowS
[Pass] -&gt; ShowS
Pass -&gt; String
(Int -&gt; Pass -&gt; ShowS)
-&gt; (Pass -&gt; String) -&gt; ([Pass] -&gt; ShowS) -&gt; Show Pass
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Pass] -&gt; ShowS
$cshowList :: [Pass] -&gt; ShowS
show :: Pass -&gt; String
$cshow :: Pass -&gt; String
showsPrec :: Int -&gt; Pass -&gt; ShowS
$cshowsPrec :: Int -&gt; Pass -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034940"><span id="local-6989586621679034942"><span class="annot"><span class="annottext">Pass -&gt; Pass -&gt; Bool
(Pass -&gt; Pass -&gt; Bool) -&gt; (Pass -&gt; Pass -&gt; Bool) -&gt; Eq Pass
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Pass -&gt; Pass -&gt; Bool
$c/= :: Pass -&gt; Pass -&gt; Bool
== :: Pass -&gt; Pass -&gt; Bool
$c== :: Pass -&gt; Pass -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">newtype</span><span> </span><span id="Salt"><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-var">Salt</span></a></span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span id="Salt"><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-var">Salt</span></a></span></span><span>     </span><span class="hs-special">{</span><span> </span><span id="getSalt"><span class="annot"><span class="annottext">Salt -&gt; ByteString
</span><a href="Crypto.Scrypt.html#getSalt"><span class="hs-identifier hs-var hs-var">getSalt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034931"><span id="local-6989586621679034933"><span id="local-6989586621679034935"><span class="annot"><span class="annottext">Int -&gt; Salt -&gt; ShowS
[Salt] -&gt; ShowS
Salt -&gt; String
(Int -&gt; Salt -&gt; ShowS)
-&gt; (Salt -&gt; String) -&gt; ([Salt] -&gt; ShowS) -&gt; Show Salt
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Salt] -&gt; ShowS
$cshowList :: [Salt] -&gt; ShowS
show :: Salt -&gt; String
$cshow :: Salt -&gt; String
showsPrec :: Int -&gt; Salt -&gt; ShowS
$cshowsPrec :: Int -&gt; Salt -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034927"><span id="local-6989586621679034929"><span class="annot"><span class="annottext">Salt -&gt; Salt -&gt; Bool
(Salt -&gt; Salt -&gt; Bool) -&gt; (Salt -&gt; Salt -&gt; Bool) -&gt; Eq Salt
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Salt -&gt; Salt -&gt; Bool
$c/= :: Salt -&gt; Salt -&gt; Bool
== :: Salt -&gt; Salt -&gt; Bool
$c== :: Salt -&gt; Salt -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">newtype</span><span> </span><span id="PassHash"><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-var">PassHash</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span id="PassHash"><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-var">PassHash</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getHash"><span class="annot"><span class="annottext">PassHash -&gt; ByteString
</span><a href="Crypto.Scrypt.html#getHash"><span class="hs-identifier hs-var hs-var">getHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034919"><span id="local-6989586621679034921"><span id="local-6989586621679034923"><span class="annot"><span class="annottext">Int -&gt; PassHash -&gt; ShowS
[PassHash] -&gt; ShowS
PassHash -&gt; String
(Int -&gt; PassHash -&gt; ShowS)
-&gt; (PassHash -&gt; String) -&gt; ([PassHash] -&gt; ShowS) -&gt; Show PassHash
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PassHash] -&gt; ShowS
$cshowList :: [PassHash] -&gt; ShowS
show :: PassHash -&gt; String
$cshow :: PassHash -&gt; String
showsPrec :: Int -&gt; PassHash -&gt; ShowS
$cshowsPrec :: Int -&gt; PassHash -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034915"><span id="local-6989586621679034917"><span class="annot"><span class="annottext">PassHash -&gt; PassHash -&gt; Bool
(PassHash -&gt; PassHash -&gt; Bool)
-&gt; (PassHash -&gt; PassHash -&gt; Bool) -&gt; Eq PassHash
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PassHash -&gt; PassHash -&gt; Bool
$c/= :: PassHash -&gt; PassHash -&gt; Bool
== :: PassHash -&gt; PassHash -&gt; Bool
$c== :: PassHash -&gt; PassHash -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">newtype</span><span> </span><span id="EncryptedPass"><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-var">EncryptedPass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>    </span><span id="EncryptedPass"><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-var">EncryptedPass</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getEncryptedPass"><span class="annot"><span class="annottext">EncryptedPass -&gt; ByteString
</span><a href="Crypto.Scrypt.html#getEncryptedPass"><span class="hs-identifier hs-var hs-var">getEncryptedPass</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">B.ByteString</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034907"><span id="local-6989586621679034909"><span id="local-6989586621679034911"><span class="annot"><span class="annottext">Int -&gt; EncryptedPass -&gt; ShowS
[EncryptedPass] -&gt; ShowS
EncryptedPass -&gt; String
(Int -&gt; EncryptedPass -&gt; ShowS)
-&gt; (EncryptedPass -&gt; String)
-&gt; ([EncryptedPass] -&gt; ShowS)
-&gt; Show EncryptedPass
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EncryptedPass] -&gt; ShowS
$cshowList :: [EncryptedPass] -&gt; ShowS
show :: EncryptedPass -&gt; String
$cshow :: EncryptedPass -&gt; String
showsPrec :: Int -&gt; EncryptedPass -&gt; ShowS
$cshowsPrec :: Int -&gt; EncryptedPass -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034903"><span id="local-6989586621679034905"><span class="annot"><span class="annottext">EncryptedPass -&gt; EncryptedPass -&gt; Bool
(EncryptedPass -&gt; EncryptedPass -&gt; Bool)
-&gt; (EncryptedPass -&gt; EncryptedPass -&gt; Bool) -&gt; Eq EncryptedPass
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EncryptedPass -&gt; EncryptedPass -&gt; Bool
$c/= :: EncryptedPass -&gt; EncryptedPass -&gt; Bool
== :: EncryptedPass -&gt; EncryptedPass -&gt; Bool
$c== :: EncryptedPass -&gt; EncryptedPass -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- $params</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- Scrypt takes three tuning parameters: @N@, @r@ and @p@. They affect running</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- time and memory usage:</span><span>
</span><span id="line-45"></span><span class="hs-comment">--</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- /Memory usage/ is approximately @128*r*N@ bytes. Note that the</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- 'scryptParams' function takes @log_2(N)@ as a parameter. As an example,</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- the 'defaultParams'</span><span>
</span><span id="line-49"></span><span class="hs-comment">--</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt;   log_2(N) = 14, r = 8 and p = 1</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- lead to 'scrypt' using @128 * 8 * 2^14 = 16M@ bytes of memory.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- /Running time/ is proportional to all of @N@, @r@ and @p@. Since it's</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- influence on memory usage is small, @p@ can be used to independently tune</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- the running time.</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- |Encapsulates the three tuning parameters to the 'scrypt' function: @N@,</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- @r@ and @p@ (see above) as well es the length of the derived key.</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-keyword">data</span><span> </span><span id="ScryptParams"><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-var">ScryptParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Params"><span class="annot"><a href="Crypto.Scrypt.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="logN"><span class="annot"><span class="annottext">ScryptParams -&gt; Integer
</span><a href="Crypto.Scrypt.html#logN"><span class="hs-identifier hs-var hs-var">logN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="r"><span class="annot"><span class="annottext">ScryptParams -&gt; Integer
</span><a href="Crypto.Scrypt.html#r"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="p"><span class="annot"><span class="annottext">ScryptParams -&gt; Integer
</span><a href="Crypto.Scrypt.html#p"><span class="hs-identifier hs-var hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span id="bufLen"><span class="annot"><span class="annottext">ScryptParams -&gt; Integer
</span><a href="Crypto.Scrypt.html#bufLen"><span class="hs-identifier hs-var hs-var">bufLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034894"><span id="local-6989586621679034896"><span class="annot"><span class="annottext">ScryptParams -&gt; ScryptParams -&gt; Bool
(ScryptParams -&gt; ScryptParams -&gt; Bool)
-&gt; (ScryptParams -&gt; ScryptParams -&gt; Bool) -&gt; Eq ScryptParams
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ScryptParams -&gt; ScryptParams -&gt; Bool
$c/= :: ScryptParams -&gt; ScryptParams -&gt; Bool
== :: ScryptParams -&gt; ScryptParams -&gt; Bool
$c== :: ScryptParams -&gt; ScryptParams -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034888"><span id="local-6989586621679034890"><span id="local-6989586621679034892"><span class="annot"><span class="annottext">Int -&gt; ScryptParams -&gt; ShowS
[ScryptParams] -&gt; ShowS
ScryptParams -&gt; String
(Int -&gt; ScryptParams -&gt; ShowS)
-&gt; (ScryptParams -&gt; String)
-&gt; ([ScryptParams] -&gt; ShowS)
-&gt; Show ScryptParams
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ScryptParams] -&gt; ShowS
$cshowList :: [ScryptParams] -&gt; ShowS
show :: ScryptParams -&gt; String
$cshow :: ScryptParams -&gt; String
showsPrec :: Int -&gt; ScryptParams -&gt; ShowS
$cshowsPrec :: Int -&gt; ScryptParams -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- |Constructor function for 'ScryptParams' with default derived-key-length of</span><span>
</span><span id="line-64"></span><span class="hs-comment">--  64 bytes.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Crypto.Scrypt.html#scryptParams"><span class="hs-identifier hs-type">scryptParams</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-comment">-- ^ @log_2(N)@. Scrypt's @N@ parameter must be a power of two greater</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">--   than one, thus it's logarithm to base two must be greater than zero.</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-comment">--   @128*r*N@ must be smaller than the available memory address space.</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-comment">-- ^ @r@, must be greater than zero.</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- ^ @p@, must be greater than zero. @r@ and @p@</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">--   must satisfy @r*p &lt; 2^30@.</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- ^ Returns 'Just' the parameter object for valid arguments,</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">--   otherwise 'Nothing'.</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span id="scryptParams"><span class="annot"><span class="annottext">scryptParams :: Integer -&gt; Integer -&gt; Integer -&gt; Maybe ScryptParams
</span><a href="Crypto.Scrypt.html#scryptParams"><span class="hs-identifier hs-var hs-var">scryptParams</span></a></span></span><span> </span><span id="local-6989586621679034887"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034887"><span class="hs-identifier hs-var">logN</span></a></span></span><span> </span><span id="local-6989586621679034886"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034886"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679034885"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034885"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Maybe ScryptParams
</span><a href="Crypto.Scrypt.html#scryptParamsLen"><span class="hs-identifier hs-var">scryptParamsLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034887"><span class="hs-identifier hs-var">logN</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034886"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034885"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">64</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- |Constructor function for 'ScryptParams' with an additional parameter to</span><span>
</span><span id="line-82"></span><span class="hs-comment">--  control the length of the derived key. Only use this function if you are</span><span>
</span><span id="line-83"></span><span class="hs-comment">--  sure you need control over the length of the derived key. Use 'scryptParams'</span><span>
</span><span id="line-84"></span><span class="hs-comment">--  instead.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Crypto.Scrypt.html#scryptParamsLen"><span class="hs-identifier hs-type">scryptParamsLen</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- ^ @log_2(N)@,</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- ^ @r@,</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-comment">-- ^ @p@,</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- ^ Length of the derived key (the output of 'scrypt') in bytes.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">--   Must be greater than zero and less than or equal to @(2^32-1)*32@.</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span>
</span><span id="line-94"></span><span id="scryptParamsLen"><span class="annot"><span class="annottext">scryptParamsLen :: Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Maybe ScryptParams
</span><a href="Crypto.Scrypt.html#scryptParamsLen"><span class="hs-identifier hs-var hs-var">scryptParamsLen</span></a></span></span><span> </span><span id="local-6989586621679034884"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034884"><span class="hs-identifier hs-var">logN</span></a></span></span><span> </span><span id="local-6989586621679034883"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034883"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679034882"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034882"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679034881"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034881"><span class="hs-identifier hs-var">bufLen</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679034880"><span class="hs-identifier hs-var">valid</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Maybe ScryptParams
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Params :: Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; ScryptParams
</span><a href="Crypto.Scrypt.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Integer
logN :: Integer
logN :: Integer
</span><a href="#local-6989586621679034884"><span class="hs-identifier hs-var hs-var">logN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
r :: Integer
r :: Integer
</span><a href="#local-6989586621679034883"><span class="hs-identifier hs-var hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
p :: Integer
p :: Integer
</span><a href="#local-6989586621679034882"><span class="hs-identifier hs-var hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
bufLen :: Integer
bufLen :: Integer
</span><a href="#local-6989586621679034881"><span class="hs-identifier hs-var hs-var">bufLen</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ScryptParams
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679034880"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679034880"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">and</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034884"><span class="hs-identifier hs-var">logN</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034883"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034882"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-99"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034883"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034882"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034881"><span class="hs-identifier hs-var">bufLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034881"><span class="hs-identifier hs-var">bufLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">32</span></span><span>
</span><span id="line-101"></span><span>                </span><span class="hs-comment">-- allocation fits into (virtual) memory</span><span>
</span><span id="line-102"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">128</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034883"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034884"><span class="hs-identifier hs-var">logN</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">CSize -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CSize
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- |Default parameters as recommended in the scrypt paper:</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">--  &gt;   N = 2^14, r = 8, p = 1</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">--  Equivalent to @'fromJust' ('scryptParams' 14 8 1)@.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier hs-type">defaultParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span>
</span><span id="line-112"></span><span id="defaultParams"><span class="annot"><span class="annottext">defaultParams :: ScryptParams
</span><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier hs-var hs-var">defaultParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ScryptParams -&gt; ScryptParams
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Maybe ScryptParams
</span><a href="Crypto.Scrypt.html#scryptParams"><span class="hs-identifier hs-var">scryptParams</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">14</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- $password-storage</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- To allow storing encrypted passwords conveniently in a single database</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- column, the password storage API provides the data type 'EncryptedPass'. It</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- combines a 'Pass' as well as the 'Salt' and 'ScryptParams' used to compute</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- it into a single 'ByteString', separated by pipe (\&quot;|\&quot;) characters. The</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- 'Salt' and 'PassHash' are base64-encoded. Storing the 'ScryptParams' with </span><span>
</span><span id="line-122"></span><span class="hs-comment">-- the password allows to gradually strengthen password encryption in case of</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- changing security requirements.</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- A usage example is given below, showing encryption, verification and</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- changing 'ScryptParams':</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; encrypted &lt;- encryptPassIO defaultParams (Pass &quot;secret&quot;)</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; print encrypted</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &gt; EncryptedPass {getEncryptedPass = &quot;14|8|1|Wn5x[SNIP]nM=|Zl+p[SNIP]g==&quot;}</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; print $ verifyPass defaultParams (Pass &quot;secret&quot;) encrypted</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &gt; (True,Nothing)</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; print $ verifyPass defaultParams (Pass &quot;wrong&quot;) encrypted</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- &gt; (False,Nothing)</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; let newParams = fromJust $ scryptParams 16 8 1</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- &gt; &gt;&gt;&gt; print $ verifyPass newParams (Pass &quot;secret&quot;) encrypted</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- &gt; (True,Just (EncryptedPass {getEncryptedPass = &quot;16|8|1|Wn5x[SNIP]nM=|ZmWw[SNIP]Q==&quot;}))</span><span>
</span><span id="line-138"></span><span class="hs-comment">--</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="annot"><a href="Crypto.Scrypt.html#combine"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-type">PassHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-141"></span><span id="combine"><span class="annot"><span class="annottext">combine :: ScryptParams -&gt; Salt -&gt; PassHash -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#combine"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span class="hs-special">{</span><span id="local-6989586621679034867"><span id="local-6989586621679034868"><span id="local-6989586621679034869"><span id="local-6989586621679034870"><span class="annot"><span class="annottext">Integer
bufLen :: Integer
p :: Integer
r :: Integer
logN :: Integer
bufLen :: ScryptParams -&gt; Integer
p :: ScryptParams -&gt; Integer
r :: ScryptParams -&gt; Integer
logN :: ScryptParams -&gt; Integer
</span><a href="#local-6989586621679034867"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span id="local-6989586621679034866"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034866"><span class="hs-identifier hs-var">salt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-type">PassHash</span></a></span><span> </span><span id="local-6989586621679034865"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034865"><span class="hs-identifier hs-var">passHash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-var">EncryptedPass</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; EncryptedPass) -&gt; ByteString -&gt; EncryptedPass
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString] -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;|&quot;</span></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="#local-6989586621679034863"><span class="hs-identifier hs-var">showBS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034870"><span class="hs-identifier hs-var">logN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="#local-6989586621679034863"><span class="hs-identifier hs-var">showBS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034869"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="#local-6989586621679034863"><span class="hs-identifier hs-var">showBS</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034868"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier hs-var">Base64.encode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034866"><span class="hs-identifier hs-var">salt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier hs-var">Base64.encode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034865"><span class="hs-identifier hs-var">passHash</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679034863"><span class="annot"><span class="annottext">showBS :: Integer -&gt; ByteString
</span><a href="#local-6989586621679034863"><span class="hs-identifier hs-var hs-var">showBS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ByteString)
-&gt; (Integer -&gt; String) -&gt; Integer -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Crypto.Scrypt.html#separate"><span class="hs-identifier hs-type">separate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-type">PassHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span id="separate"><span class="annot"><span class="annottext">separate :: EncryptedPass -&gt; Maybe (ScryptParams, Salt, PassHash)
</span><a href="Crypto.Scrypt.html#separate"><span class="hs-identifier hs-var hs-var">separate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; Maybe (ScryptParams, Salt, PassHash)
</span><a href="#local-6989586621679034857"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([ByteString] -&gt; Maybe (ScryptParams, Salt, PassHash))
-&gt; (EncryptedPass -&gt; [ByteString])
-&gt; EncryptedPass
-&gt; Maybe (ScryptParams, Salt, PassHash)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ByteString -&gt; [ByteString]
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.split</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'|'</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; [ByteString])
-&gt; (EncryptedPass -&gt; ByteString) -&gt; EncryptedPass -&gt; [ByteString]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedPass -&gt; ByteString
</span><a href="Crypto.Scrypt.html#getEncryptedPass"><span class="hs-identifier hs-var hs-var">getEncryptedPass</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679034857"><span class="annot"><span class="annottext">go :: [ByteString] -&gt; Maybe (ScryptParams, Salt, PassHash)
</span><a href="#local-6989586621679034857"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679034855"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034855"><span class="hs-identifier hs-var">logN'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034854"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034854"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034853"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034853"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034852"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034852"><span class="hs-identifier hs-var">salt'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034851"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034851"><span class="hs-identifier hs-var">hash'</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679034850"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034850"><span class="hs-identifier hs-var">salt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034849"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034849"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe ByteString)
-&gt; [ByteString] -&gt; Maybe [ByteString]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
</span><a href="#local-6989586621679034847"><span class="hs-identifier hs-var">decodeBase64</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034852"><span class="hs-identifier hs-var">salt'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034851"><span class="hs-identifier hs-var">hash'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">[</span><span id="local-6989586621679034846"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034846"><span class="hs-identifier hs-var">logN</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034845"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034845"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034844"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034844"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Maybe Integer) -&gt; [ByteString] -&gt; Maybe [Integer]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Integer, ByteString) -&gt; Integer)
-&gt; Maybe (Integer, ByteString) -&gt; Maybe Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer, ByteString) -&gt; Integer
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Integer, ByteString) -&gt; Maybe Integer)
-&gt; (ByteString -&gt; Maybe (Integer, ByteString))
-&gt; ByteString
-&gt; Maybe Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe (Integer, ByteString)
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.readInteger</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034855"><span class="hs-identifier hs-var">logN'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034854"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034853"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679034842"><span class="annot"><span class="annottext">bufLen :: Integer
</span><a href="#local-6989586621679034842"><span class="hs-identifier hs-var hs-var">bufLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034849"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>        </span><span id="local-6989586621679034840"><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034840"><span class="hs-identifier hs-var">params</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; Integer -&gt; Maybe ScryptParams
</span><a href="Crypto.Scrypt.html#scryptParamsLen"><span class="hs-identifier hs-var">scryptParamsLen</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034846"><span class="hs-identifier hs-var">logN</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034845"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034844"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034842"><span class="hs-identifier hs-var">bufLen</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">(ScryptParams, Salt, PassHash)
-&gt; Maybe (ScryptParams, Salt, PassHash)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034840"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Salt
</span><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-var">Salt</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034850"><span class="hs-identifier hs-var">salt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; PassHash
</span><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-var">PassHash</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034849"><span class="hs-identifier hs-var">hash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="#local-6989586621679034857"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><span class="hs-identifier">_</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ScryptParams, Salt, PassHash)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679034847"><span class="annot"><span class="annottext">decodeBase64 :: ByteString -&gt; Maybe ByteString
</span><a href="#local-6989586621679034847"><span class="hs-identifier hs-var hs-var">decodeBase64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Maybe ByteString)
-&gt; (ByteString -&gt; Maybe ByteString)
-&gt; Either String ByteString
-&gt; Maybe ByteString
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ByteString -&gt; String -&gt; Maybe ByteString
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ByteString
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe ByteString
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String ByteString -&gt; Maybe ByteString)
-&gt; (ByteString -&gt; Either String ByteString)
-&gt; ByteString
-&gt; Maybe ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String ByteString
</span><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier hs-var">Base64.decode</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- |Generate a random 32-byte salt.</span><span>
</span><span id="line-161"></span><span class="hs-comment">--</span><span>
</span><span id="line-162"></span><span class="annot"><a href="Crypto.Scrypt.html#newSalt"><span class="hs-identifier hs-type">newSalt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span>
</span><span id="line-163"></span><span id="newSalt"><span class="annot"><span class="annottext">newSalt :: IO Salt
</span><a href="Crypto.Scrypt.html#newSalt"><span class="hs-identifier hs-var hs-var">newSalt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Salt
</span><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-var">Salt</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Salt) -&gt; IO ByteString -&gt; IO Salt
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ByteString
</span><a href="../../../../entropy/html/src"><span class="hs-identifier hs-var">getEntropy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- |Encrypt the password with the given parameters and a random 32-byte salt.</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- The salt is read from @\/dev\/urandom@ on Unix systems or @CryptoAPI@ on</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- Windows.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="annot"><a href="Crypto.Scrypt.html#encryptPassIO"><span class="hs-identifier hs-type">encryptPassIO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-170"></span><span id="encryptPassIO"><span class="annot"><span class="annottext">encryptPassIO :: ScryptParams -&gt; Pass -&gt; IO EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPassIO"><span class="hs-identifier hs-var hs-var">encryptPassIO</span></a></span></span><span> </span><span id="local-6989586621679034835"><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034835"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679034834"><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034834"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679034833"><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034833"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Salt
</span><a href="Crypto.Scrypt.html#newSalt"><span class="hs-identifier hs-var">newSalt</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="annottext">EncryptedPass -&gt; IO EncryptedPass
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(EncryptedPass -&gt; IO EncryptedPass)
-&gt; EncryptedPass -&gt; IO EncryptedPass
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPass"><span class="hs-identifier hs-var">encryptPass</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034835"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034833"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034834"><span class="hs-identifier hs-var">pass</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- |Equivalent to @encryptPassIO defaultParams@.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="annot"><a href="Crypto.Scrypt.html#encryptPassIO%27"><span class="hs-identifier hs-type">encryptPassIO'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-177"></span><span id="encryptPassIO%27"><span class="annot"><span class="annottext">encryptPassIO' :: Pass -&gt; IO EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPassIO%27"><span class="hs-identifier hs-var hs-var">encryptPassIO'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Pass -&gt; IO EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPassIO"><span class="hs-identifier hs-var">encryptPassIO</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier hs-var">defaultParams</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- |Encrypt the password with the given parameters and salt.</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Crypto.Scrypt.html#encryptPass"><span class="hs-identifier hs-type">encryptPass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-182"></span><span id="encryptPass"><span class="annot"><span class="annottext">encryptPass :: ScryptParams -&gt; Salt -&gt; Pass -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPass"><span class="hs-identifier hs-var hs-var">encryptPass</span></a></span></span><span> </span><span id="local-6989586621679034832"><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034832"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679034831"><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034831"><span class="hs-identifier hs-var">salt</span></a></span></span><span> </span><span id="local-6989586621679034830"><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034830"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; PassHash -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034832"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034831"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-var">scrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034832"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034831"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034830"><span class="hs-identifier hs-var">pass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- |Equivalent to @encryptPass defaultParams@.</span><span>
</span><span id="line-185"></span><span class="hs-comment">--</span><span>
</span><span id="line-186"></span><span class="annot"><a href="Crypto.Scrypt.html#encryptPass%27"><span class="hs-identifier hs-type">encryptPass'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-187"></span><span id="encryptPass%27"><span class="annot"><span class="annottext">encryptPass' :: Salt -&gt; Pass -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPass%27"><span class="hs-identifier hs-var hs-var">encryptPass'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#encryptPass"><span class="hs-identifier hs-var">encryptPass</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier hs-var">defaultParams</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- |Verify a 'Pass' against an 'EncryptedPass'. The function also takes</span><span>
</span><span id="line-190"></span><span class="hs-comment">--  'ScryptParams' meeting your current security requirements. In case the</span><span>
</span><span id="line-191"></span><span class="hs-comment">--  'EncryptedPass' was generated with different parameters, the function</span><span>
</span><span id="line-192"></span><span class="hs-comment">--  returns an updated 'EncryptedPass', generated with the given </span><span>
</span><span id="line-193"></span><span class="hs-comment">--  'ScryptParams'. The 'Salt' is kept from the given 'EncryptedPass'.</span><span>
</span><span id="line-194"></span><span class="hs-comment">--</span><span>
</span><span id="line-195"></span><span class="annot"><a href="Crypto.Scrypt.html#verifyPass"><span class="hs-identifier hs-type">verifyPass</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">-- ^ Parameters to use for updating the 'EncryptedPass'.</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- ^ The candidate 'Pass'.</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- ^ The 'EncryptedPass' to check against.</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- ^ Returns a pair of</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">--     * 'Bool' indicating verification success or failure.</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">--     * 'Just' a /new/ 'EncryptedPass' if the given 'ScryptParams' are</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">--      different from those encapsulated in the /given/ 'EncryptedPass',</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">--      otherwise 'Nothing'.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span id="verifyPass"><span class="annot"><span class="annottext">verifyPass :: ScryptParams
-&gt; Pass -&gt; EncryptedPass -&gt; (Bool, Maybe EncryptedPass)
</span><a href="Crypto.Scrypt.html#verifyPass"><span class="hs-identifier hs-var hs-var">verifyPass</span></a></span></span><span> </span><span id="local-6989586621679034829"><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034829"><span class="hs-identifier hs-var">newParams</span></a></span></span><span> </span><span id="local-6989586621679034828"><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034828"><span class="hs-identifier hs-var">candidate</span></a></span></span><span> </span><span id="local-6989586621679034827"><span class="annot"><span class="annottext">EncryptedPass
</span><a href="#local-6989586621679034827"><span class="hs-identifier hs-var">encrypted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">(Bool, Maybe EncryptedPass)
-&gt; ((ScryptParams, Salt, PassHash) -&gt; (Bool, Maybe EncryptedPass))
-&gt; Maybe (ScryptParams, Salt, PassHash)
-&gt; (Bool, Maybe EncryptedPass)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe EncryptedPass
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScryptParams, Salt, PassHash) -&gt; (Bool, Maybe EncryptedPass)
</span><a href="#local-6989586621679034825"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncryptedPass -&gt; Maybe (ScryptParams, Salt, PassHash)
</span><a href="Crypto.Scrypt.html#separate"><span class="hs-identifier hs-var">separate</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedPass
</span><a href="#local-6989586621679034827"><span class="hs-identifier hs-var">encrypted</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679034825"><span class="annot"><span class="annottext">verify :: (ScryptParams, Salt, PassHash) -&gt; (Bool, Maybe EncryptedPass)
</span><a href="#local-6989586621679034825"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679034824"><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034824"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679034823"><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034823"><span class="hs-identifier hs-var">salt</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679034822"><span class="annot"><span class="annottext">PassHash
</span><a href="#local-6989586621679034822"><span class="hs-identifier hs-var">hash</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679034821"><span class="annot"><span class="annottext">valid :: Bool
</span><a href="#local-6989586621679034821"><span class="hs-identifier hs-var hs-var">valid</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-var">scrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034824"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034823"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034828"><span class="hs-identifier hs-var">candidate</span></a></span><span> </span><span class="annot"><span class="annottext">PassHash -&gt; PassHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">PassHash
</span><a href="#local-6989586621679034822"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-216"></span><span>            </span><span id="local-6989586621679034820"><span class="annot"><span class="annottext">newHash :: PassHash
</span><a href="#local-6989586621679034820"><span class="hs-identifier hs-var hs-var">newHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-var">scrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034829"><span class="hs-identifier hs-var">newParams</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034823"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034828"><span class="hs-identifier hs-var">candidate</span></a></span><span>
</span><span id="line-217"></span><span>            </span><span id="local-6989586621679034819"><span class="annot"><span class="annottext">newEncr :: Maybe EncryptedPass
</span><a href="#local-6989586621679034819"><span class="hs-identifier hs-var hs-var">newEncr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679034821"><span class="hs-identifier hs-var">valid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034824"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; ScryptParams -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034829"><span class="hs-identifier hs-var">newParams</span></a></span><span>
</span><span id="line-218"></span><span>                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe EncryptedPass
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-219"></span><span>                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">EncryptedPass -&gt; Maybe EncryptedPass
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; PassHash -&gt; EncryptedPass
</span><a href="Crypto.Scrypt.html#combine"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="#local-6989586621679034829"><span class="hs-identifier hs-var">newParams</span></a></span><span> </span><span class="annot"><span class="annottext">Salt
</span><a href="#local-6989586621679034823"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">PassHash
</span><a href="#local-6989586621679034820"><span class="hs-identifier hs-var">newHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679034821"><span class="hs-identifier hs-var">valid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe EncryptedPass
</span><a href="#local-6989586621679034819"><span class="hs-identifier hs-var">newEncr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- |Check the 'Pass' against the 'EncryptedPass', using the 'ScryptParams'</span><span>
</span><span id="line-223"></span><span class="hs-comment">--  encapsulated in the 'EncryptedPass'.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="annot"><a href="Crypto.Scrypt.html#verifyPass%27"><span class="hs-identifier hs-type">verifyPass'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#EncryptedPass"><span class="hs-identifier hs-type">EncryptedPass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- We never evaluate an eventual new 'EncryptedPass' from 'verifyPass', so it is</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- safe to pass 'undefined' to verifyPass.</span><span>
</span><span id="line-228"></span><span id="verifyPass%27"><span class="annot"><span class="annottext">verifyPass' :: Pass -&gt; EncryptedPass -&gt; Bool
</span><a href="Crypto.Scrypt.html#verifyPass%27"><span class="hs-identifier hs-var hs-var">verifyPass'</span></a></span></span><span> </span><span id="local-6989586621679034816"><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034816"><span class="hs-identifier hs-var">pass</span></a></span></span><span> </span><span id="local-6989586621679034815"><span class="annot"><span class="annottext">EncryptedPass
</span><a href="#local-6989586621679034815"><span class="hs-identifier hs-var">encrypted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Bool, Maybe EncryptedPass) -&gt; Bool
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Bool, Maybe EncryptedPass) -&gt; Bool)
-&gt; (Bool, Maybe EncryptedPass) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
-&gt; Pass -&gt; EncryptedPass -&gt; (Bool, Maybe EncryptedPass)
</span><a href="Crypto.Scrypt.html#verifyPass"><span class="hs-identifier hs-var">verifyPass</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
forall a. HasCallStack =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span> </span><span class="annot"><span class="annottext">Pass
</span><a href="#local-6989586621679034816"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedPass
</span><a href="#local-6989586621679034815"><span class="hs-identifier hs-var">encrypted</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">------------------------------------------------------------------------------</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- $low-level</span><span>
</span><span id="line-232"></span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- Bindings to a fast C implementation of 'scrypt'. For password storage,</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- consider using the more convenient higher-level API above.</span><span>
</span><span id="line-235"></span><span class="hs-comment">--</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- |Calculates a hash from the given password, salt and parameters.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="annot"><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-type">scrypt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#ScryptParams"><span class="hs-identifier hs-type">ScryptParams</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-type">PassHash</span></a></span><span>
</span><span id="line-240"></span><span id="scrypt"><span class="annot"><span class="annottext">scrypt :: ScryptParams -&gt; Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-var hs-var">scrypt</span></a></span></span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span class="hs-special">{</span><span id="local-6989586621679034810"><span id="local-6989586621679034811"><span id="local-6989586621679034812"><span id="local-6989586621679034813"><span class="annot"><span class="annottext">Integer
bufLen :: Integer
p :: Integer
r :: Integer
logN :: Integer
bufLen :: ScryptParams -&gt; Integer
p :: ScryptParams -&gt; Integer
r :: ScryptParams -&gt; Integer
logN :: ScryptParams -&gt; Integer
</span><a href="#local-6989586621679034810"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span id="local-6989586621679034809"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034809"><span class="hs-identifier hs-var">salt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span id="local-6989586621679034808"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034808"><span class="hs-identifier hs-var">pass</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; PassHash
</span><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-var">PassHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; PassHash)
-&gt; (IO ByteString -&gt; ByteString) -&gt; IO ByteString -&gt; PassHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; ByteString
forall a. IO a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafePerformIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; PassHash) -&gt; IO ByteString -&gt; PassHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.useAsCStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034809"><span class="hs-identifier hs-var">salt</span></a></span><span> </span><span class="annot"><span class="annottext">((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679034806"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679034806"><span class="hs-identifier hs-var">saltPtr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034805"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034805"><span class="hs-identifier hs-var">saltLen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a. ByteString -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.useAsCStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679034808"><span class="hs-identifier hs-var">pass</span></a></span><span> </span><span class="annot"><span class="annottext">((CStringLen -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (CStringLen -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679034804"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679034804"><span class="hs-identifier hs-var">passPtr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679034803"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034803"><span class="hs-identifier hs-var">passLen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; (Ptr Word8 -&gt; IO ByteString) -&gt; IO ByteString
forall a b. Int -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">allocaBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034810"><span class="hs-identifier hs-var">bufLen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Ptr Word8 -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Ptr Word8 -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679034802"><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679034802"><span class="hs-identifier hs-var">bufPtr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; IO CInt -&gt; IO ()
forall a. (Eq a, Num a) =&gt; String -&gt; IO a -&gt; IO ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">throwErrnoIfMinus1_</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;crypto_scrypt&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO CInt -&gt; IO ()) -&gt; IO CInt -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
-&gt; CSize
-&gt; Ptr Word8
-&gt; CSize
-&gt; Word64
-&gt; Word32
-&gt; Word32
-&gt; Ptr Word8
-&gt; CSize
-&gt; IO CInt
</span><a href="Crypto.Scrypt.html#crypto_scrypt"><span class="hs-identifier hs-var">crypto_scrypt</span></a></span><span>
</span><span id="line-246"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679034804"><span class="hs-identifier hs-var">passPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034803"><span class="hs-identifier hs-var">passLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr Word8
forall a b. Ptr a -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679034806"><span class="hs-identifier hs-var">saltPtr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679034805"><span class="hs-identifier hs-var">saltLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Word64 -&gt; Integer -&gt; Word64
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034813"><span class="hs-identifier hs-var">logN</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034812"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034811"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>                </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679034802"><span class="hs-identifier hs-var">bufPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; CSize
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034810"><span class="hs-identifier hs-var">bufLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>            </span><span class="annot"><span class="annottext">CStringLen -&gt; IO ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B.packCStringLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr Word8 -&gt; Ptr CChar
forall a b. Ptr a -&gt; Ptr b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">castPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr Word8
</span><a href="#local-6989586621679034802"><span class="hs-identifier hs-var">bufPtr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679034810"><span class="hs-identifier hs-var">bufLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span id="crypto_scrypt"><span class="annot"><a href="Crypto.Scrypt.html#crypto_scrypt"><span class="hs-identifier hs-var">crypto_scrypt</span></a></span></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CSize</span></a></span><span>         </span><span class="hs-comment">-- password</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CSize</span></a></span><span>         </span><span class="hs-comment">-- salt</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-comment">-- N, r, p</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CSize</span></a></span><span>         </span><span class="hs-comment">-- result buffer</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">CInt</span></a></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span class="hs-comment">-- |Note the prime symbol (\'). Calls 'scrypt' with 'defaultParams'.</span><span>
</span><span id="line-260"></span><span class="hs-comment">--</span><span>
</span><span id="line-261"></span><span class="annot"><a href="Crypto.Scrypt.html#scrypt%27"><span class="hs-identifier hs-type">scrypt'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Salt"><span class="hs-identifier hs-type">Salt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#Pass"><span class="hs-identifier hs-type">Pass</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Crypto.Scrypt.html#PassHash"><span class="hs-identifier hs-type">PassHash</span></a></span><span>
</span><span id="line-262"></span><span id="scrypt%27"><span class="annot"><span class="annottext">scrypt' :: Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt%27"><span class="hs-identifier hs-var hs-var">scrypt'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScryptParams -&gt; Salt -&gt; Pass -&gt; PassHash
</span><a href="Crypto.Scrypt.html#scrypt"><span class="hs-identifier hs-var">scrypt</span></a></span><span> </span><span class="annot"><span class="annottext">ScryptParams
</span><a href="Crypto.Scrypt.html#defaultParams"><span class="hs-identifier hs-var">defaultParams</span></a></span><span>
</span><span id="line-263"></span></pre></body></html>