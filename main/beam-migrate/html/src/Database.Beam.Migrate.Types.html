<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveTraversable #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Beam.Migrate.Types</span><span>
</span><span id="line-8"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Checked database entities</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#CheckedDatabaseSettings"><span class="hs-identifier">CheckedDatabaseSettings</span></a></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#IsCheckedDatabaseEntity"><span class="hs-identifier">IsCheckedDatabaseEntity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#CheckedDatabaseEntityDescriptor"><span class="hs-identifier">CheckedDatabaseEntityDescriptor</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#CheckedDatabaseEntity"><span class="hs-identifier">CheckedDatabaseEntity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#unCheckDatabase"><span class="hs-identifier">unCheckDatabase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#collectChecks"><span class="hs-identifier">collectChecks</span></a></span><span>
</span><span id="line-16"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#renameCheckedEntity"><span class="hs-identifier">renameCheckedEntity</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Modifyinging checked entities</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-comment">--    The functions in this section can be used to modify 'CheckedDatabaseSettings' objects.</span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#CheckedFieldModification"><span class="hs-identifier">CheckedFieldModification</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#checkedFieldNamed"><span class="hs-identifier">checkedFieldNamed</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#modifyCheckedTable"><span class="hs-identifier">modifyCheckedTable</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html#checkedTableModification"><span class="hs-identifier">checkedTableModification</span></a></span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Predicates</span></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#DatabasePredicate"><span class="hs-identifier">DatabasePredicate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier">SomeDatabasePredicate</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#PredicateSpecificity"><span class="hs-identifier">PredicateSpecificity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#QualifiedName"><span class="hs-identifier">QualifiedName</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier">p</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Entity checks</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#TableCheck"><span class="hs-identifier">TableCheck</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#DomainCheck"><span class="hs-identifier">DomainCheck</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#FieldCheck"><span class="hs-identifier">FieldCheck</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Migrations</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier">MigrationStep</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier">MigrationSteps</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier">Migration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationF"><span class="hs-identifier">MigrationF</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier">MigrationCommand</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier">MigrationDataLoss</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#runMigrationSteps"><span class="hs-identifier">runMigrationSteps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#runMigrationSilenced"><span class="hs-identifier">runMigrationSilenced</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#executeMigration"><span class="hs-identifier">executeMigration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#eraseMigrationType"><span class="hs-identifier">eraseMigrationType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrationStep"><span class="hs-identifier">migrationStep</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#upDown"><span class="hs-identifier">upDown</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrationDataLoss"><span class="hs-identifier">migrationDataLoss</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrateScript"><span class="hs-identifier">migrateScript</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#evaluateDatabase"><span class="hs-identifier">evaluateDatabase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#stepNames"><span class="hs-identifier">stepNames</span></a></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL</span></a></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.CheckedEntities.html"><span class="hs-identifier">Database.Beam.Migrate.Types.CheckedEntities</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html"><span class="hs-identifier">Database.Beam.Migrate.Types.Predicates</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier">Control.Monad.Free.Church</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Category</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Category</span></a></span><span class="hs-special">)</span><span class="hs-cpp">

#if !MIN_VERSION_base(4, 11, 0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data.Semigroup</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- * Migration types</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Represents a particular step in a migration</span><span>
</span><span id="line-66"></span><span class="hs-keyword">data</span><span> </span><span id="MigrationStep"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-var">MigrationStep</span></a></span></span><span> </span><span id="local-6989586621679294456"><span class="annot"><a href="#local-6989586621679294456"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294455"><span class="annot"><a href="#local-6989586621679294455"><span class="hs-identifier hs-type">next</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621679294454"><span id="local-6989586621679294515"><span id="local-6989586621679294517"><span id="MigrationStep"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-var">MigrationStep</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294517"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679294454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294515"><span class="hs-identifier hs-type">next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294517"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294515"><span class="hs-identifier hs-type">next</span></a></span></span></span></span><span>
</span><span id="line-68"></span><span id="local-6989586621679294448"><span id="local-6989586621679294450"><span id="local-6989586621679294452"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294452"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | A series of 'MigrationStep's that take a database from the schema in @from@</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- to the one in @to@. Use the 'migrationStep' function and the arrow interface</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- to sequence 'MigrationSteps'.</span><span>
</span><span id="line-73"></span><span class="hs-keyword">newtype</span><span> </span><span id="MigrationSteps"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-var">MigrationSteps</span></a></span></span><span> </span><span id="local-6989586621679294537"><span class="annot"><a href="#local-6989586621679294537"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294536"><span class="annot"><a href="#local-6989586621679294536"><span class="hs-identifier hs-type">from</span></a></span></span><span> </span><span id="local-6989586621679294535"><span class="annot"><a href="#local-6989586621679294535"><span class="hs-identifier hs-type">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MigrationSteps"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-var">MigrationSteps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Kleisli</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294537"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679294536"><span class="hs-identifier hs-type">from</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294535"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679294442"><span id="local-6989586621679294444"><span class="annot"><span class="annottext">MigrationSteps be a a
MigrationSteps be b c
-&gt; MigrationSteps be a b -&gt; MigrationSteps be a c
(forall a. MigrationSteps be a a)
-&gt; (forall b c a.
    MigrationSteps be b c
    -&gt; MigrationSteps be a b -&gt; MigrationSteps be a c)
-&gt; Category (MigrationSteps be)
forall a. MigrationSteps be a a
forall be a. MigrationSteps be a a
forall b c a.
MigrationSteps be b c
-&gt; MigrationSteps be a b -&gt; MigrationSteps be a c
forall be b c a.
MigrationSteps be b c
-&gt; MigrationSteps be a b -&gt; MigrationSteps be a c
forall k (cat :: k -&gt; k -&gt; *).
(forall (a :: k). cat a a)
-&gt; (forall (b :: k) (c :: k) (a :: k).
    cat b c -&gt; cat a b -&gt; cat a c)
-&gt; Category cat
. :: MigrationSteps be b c
-&gt; MigrationSteps be a b -&gt; MigrationSteps be a c
$c. :: forall be b c a.
MigrationSteps be b c
-&gt; MigrationSteps be a b -&gt; MigrationSteps be a c
id :: MigrationSteps be a a
$cid :: forall be a. MigrationSteps be a a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Category</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679294430"><span id="local-6989586621679294432"><span id="local-6989586621679294434"><span id="local-6989586621679294436"><span id="local-6989586621679294438"><span class="annot"><span class="annottext">Category (MigrationSteps be)
Category (MigrationSteps be)
-&gt; (forall b c. (b -&gt; c) -&gt; MigrationSteps be b c)
-&gt; (forall b c d.
    MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d))
-&gt; (forall b c d.
    MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c))
-&gt; (forall b c b' c'.
    MigrationSteps be b c
    -&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c'))
-&gt; (forall b c c'.
    MigrationSteps be b c
    -&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c'))
-&gt; Arrow (MigrationSteps be)
MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d)
MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c)
MigrationSteps be b c
-&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c')
MigrationSteps be b c
-&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c')
(b -&gt; c) -&gt; MigrationSteps be b c
forall be. Category (MigrationSteps be)
forall b c. (b -&gt; c) -&gt; MigrationSteps be b c
forall b c d.
MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d)
forall b c d.
MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c)
forall b c c'.
MigrationSteps be b c
-&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c')
forall be b c. (b -&gt; c) -&gt; MigrationSteps be b c
forall be b c d.
MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d)
forall be b c d.
MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c)
forall be b c c'.
MigrationSteps be b c
-&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c')
forall b c b' c'.
MigrationSteps be b c
-&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c')
forall be b c b' c'.
MigrationSteps be b c
-&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c')
forall (a :: * -&gt; * -&gt; *).
Category a
-&gt; (forall b c. (b -&gt; c) -&gt; a b c)
-&gt; (forall b c d. a b c -&gt; a (b, d) (c, d))
-&gt; (forall b c d. a b c -&gt; a (d, b) (d, c))
-&gt; (forall b c b' c'. a b c -&gt; a b' c' -&gt; a (b, b') (c, c'))
-&gt; (forall b c c'. a b c -&gt; a b c' -&gt; a b (c, c'))
-&gt; Arrow a
&amp;&amp;&amp; :: MigrationSteps be b c
-&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c')
$c&amp;&amp;&amp; :: forall be b c c'.
MigrationSteps be b c
-&gt; MigrationSteps be b c' -&gt; MigrationSteps be b (c, c')
*** :: MigrationSteps be b c
-&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c')
$c*** :: forall be b c b' c'.
MigrationSteps be b c
-&gt; MigrationSteps be b' c' -&gt; MigrationSteps be (b, b') (c, c')
second :: MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c)
$csecond :: forall be b c d.
MigrationSteps be b c -&gt; MigrationSteps be (d, b) (d, c)
first :: MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d)
$cfirst :: forall be b c d.
MigrationSteps be b c -&gt; MigrationSteps be (b, d) (c, d)
arr :: (b -&gt; c) -&gt; MigrationSteps be b c
$carr :: forall be b c. (b -&gt; c) -&gt; MigrationSteps be b c
$cp1Arrow :: forall be. Category (MigrationSteps be)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Arrow</span></a></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Free monadic function for 'Migration's</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="MigrationF"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationF"><span class="hs-identifier hs-var">MigrationF</span></a></span></span><span> </span><span id="local-6989586621679294428"><span class="annot"><a href="#local-6989586621679294428"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294427"><span class="annot"><a href="#local-6989586621679294427"><span class="hs-identifier hs-type">next</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>  </span><span id="local-6989586621679294512"><span id="local-6989586621679294513"><span id="MigrationRunCommand"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-var">MigrationRunCommand</span></a></span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><span id="_migrationUpCommand"><span class="annot"><span class="annottext">MigrationF be next -&gt; BeamSqlBackendSyntax be
</span><a href="Database.Beam.Migrate.Types.html#_migrationUpCommand"><span class="hs-identifier hs-var hs-var">_migrationUpCommand</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294513"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-80"></span><span>       </span><span class="hs-comment">-- ^ What to execute when applying the migration</span><span>
</span><span id="line-81"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="_migrationDownCommand"><span class="annot"><span class="annottext">MigrationF be next -&gt; Maybe (BeamSqlBackendSyntax be)
</span><a href="Database.Beam.Migrate.Types.html#_migrationDownCommand"><span class="hs-identifier hs-var hs-var">_migrationDownCommand</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294513"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>       </span><span class="hs-comment">-- ^ What to execute when unapplying the migration</span><span>
</span><span id="line-83"></span><span>       </span><span class="hs-special">,</span><span> </span><span id="_migrationNext"><span class="annot"><span class="annottext">MigrationF be next -&gt; next
</span><a href="Database.Beam.Migrate.Types.html#_migrationNext"><span class="hs-identifier hs-var hs-var">_migrationNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679294512"><span class="hs-identifier hs-type">next</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationF"><span class="hs-identifier hs-type">MigrationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294513"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294512"><span class="hs-identifier hs-type">next</span></a></span></span></span><span>
</span><span id="line-85"></span><span id="local-6989586621679294418"><span id="local-6989586621679294420"><span id="local-6989586621679294422"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationF"><span class="hs-identifier hs-type">MigrationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294422"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | A sequence of potentially reversible schema update commands</span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="Migration"><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-var">Migration</span></a></span></span><span> </span><span id="local-6989586621679294417"><span class="annot"><a href="#local-6989586621679294417"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../free/html/src"><span class="hs-identifier hs-type">F</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationF"><span class="hs-identifier hs-type">MigrationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294417"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | Information on whether a 'MigrationCommand' loses data. You can</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- monoidally combine these to get the potential data loss for a</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- sequence of commands.</span><span>
</span><span id="line-93"></span><span class="hs-keyword">data</span><span> </span><span id="MigrationDataLoss"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier hs-var">MigrationDataLoss</span></a></span></span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MigrationLosesData"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- ^ The command loses data</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MigrationKeepsData"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- ^ The command keeps all data</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679294409"><span id="local-6989586621679294411"><span id="local-6989586621679294413"><span class="annot"><span class="annottext">Int -&gt; MigrationDataLoss -&gt; ShowS
[MigrationDataLoss] -&gt; ShowS
MigrationDataLoss -&gt; String
(Int -&gt; MigrationDataLoss -&gt; ShowS)
-&gt; (MigrationDataLoss -&gt; String)
-&gt; ([MigrationDataLoss] -&gt; ShowS)
-&gt; Show MigrationDataLoss
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MigrationDataLoss] -&gt; ShowS
$cshowList :: [MigrationDataLoss] -&gt; ShowS
show :: MigrationDataLoss -&gt; String
$cshow :: MigrationDataLoss -&gt; String
showsPrec :: Int -&gt; MigrationDataLoss -&gt; ShowS
$cshowsPrec :: Int -&gt; MigrationDataLoss -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679294403"><span id="local-6989586621679294405"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier hs-type">MigrationDataLoss</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679294401"><span class="annot"><span class="annottext">&lt;&gt; :: MigrationDataLoss -&gt; MigrationDataLoss -&gt; MigrationDataLoss
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss -&gt; MigrationDataLoss -&gt; MigrationDataLoss
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679294396"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier hs-type">MigrationDataLoss</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-104"></span><span>    </span><span id="local-6989586621679294394"><span class="annot"><span class="annottext">mempty :: MigrationDataLoss
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span id="local-6989586621679294393"><span class="annot"><span class="annottext">mappend :: MigrationDataLoss -&gt; MigrationDataLoss -&gt; MigrationDataLoss
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | A migration command along with metadata on whether the command can lose data</span><span>
</span><span id="line-110"></span><span class="hs-keyword">data</span><span> </span><span id="MigrationCommand"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span></span><span> </span><span id="local-6989586621679294392"><span class="annot"><a href="#local-6989586621679294392"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MigrationCommand"><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="migrationCommand"><span class="annot"><span class="annottext">MigrationCommand be -&gt; BeamSqlBackendSyntax be
</span><a href="Database.Beam.Migrate.Types.html#migrationCommand"><span class="hs-identifier hs-var hs-var">migrationCommand</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294392"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">-- ^ The command to run</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="migrationCommandDataLossPossible"><span class="annot"><span class="annottext">MigrationCommand be -&gt; MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#migrationCommandDataLossPossible"><span class="hs-identifier hs-var hs-var">migrationCommandDataLossPossible</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier hs-type">MigrationDataLoss</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- ^ Information on whether the migration loses data</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span id="local-6989586621679294382"><span id="local-6989586621679294384"><span id="local-6989586621679294386"><span id="local-6989586621679294388"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294388"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-type">MigrationCommand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294388"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Run the migration steps between the given indices, using a custom execution function.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679294379"><span id="local-6989586621679294380"><span id="local-6989586621679294381"><span class="annot"><a href="Database.Beam.Migrate.Types.html#runMigrationSteps"><span class="hs-identifier hs-type">runMigrationSteps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294381"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-121"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-comment">-- ^ Zero-based index of the first step to run</span><span>
</span><span id="line-122"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-comment">-- ^ Index of the last step to run, or 'Nothing' to run every step</span><span>
</span><span id="line-123"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294380"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679294379"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ The set of steps to run</span><span>
</span><span id="line-124"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294571"><span class="annot"><a href="#local-6989586621679294571"><span class="hs-identifier hs-type">a'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294380"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294571"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294381"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294571"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>                  </span><span class="hs-comment">-- ^ Callback for each step. Called with the step index, the</span><span>
</span><span id="line-126"></span><span>                  </span><span class="hs-comment">-- step description and the migration.</span><span>
</span><span id="line-127"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294381"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294379"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-128"></span><span id="runMigrationSteps"><span class="annot"><span class="annottext">runMigrationSteps :: Int
-&gt; Maybe Int
-&gt; MigrationSteps be () a
-&gt; (forall a'. Int -&gt; Text -&gt; Migration be a' -&gt; m a')
-&gt; m a
</span><a href="Database.Beam.Migrate.Types.html#runMigrationSteps"><span class="hs-identifier hs-var hs-var">runMigrationSteps</span></a></span></span><span> </span><span id="local-6989586621679294378"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294378"><span class="hs-identifier hs-var">firstIdx</span></a></span></span><span> </span><span id="local-6989586621679294377"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679294377"><span class="hs-identifier hs-var">lastIdx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span id="local-6989586621679294376"><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294376"><span class="hs-identifier hs-var">steps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679294375"><span class="annot"><span class="annottext">forall a'. Int -&gt; Text -&gt; Migration be a' -&gt; m a'
</span><a href="#local-6989586621679294375"><span class="hs-identifier hs-var">runMigration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><span class="annottext">F (MigrationStep be) a
-&gt; (a -&gt; Int -&gt; m a)
-&gt; (MigrationStep be (Int -&gt; m a) -&gt; Int -&gt; m a)
-&gt; Int
-&gt; m a
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a -&gt; () -&gt; F (MigrationStep be) a
forall (m :: * -&gt; *) a b. Kleisli m a b -&gt; a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">runKleisli</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294376"><span class="hs-identifier hs-var">steps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; m a
forall (f :: * -&gt; *) a p. Applicative f =&gt; a -&gt; p -&gt; f a
</span><a href="#local-6989586621679294372"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationStep be (Int -&gt; m a) -&gt; Int -&gt; m a
</span><a href="#local-6989586621679294371"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679294372"><span class="annot"><span class="annottext">finish :: a -&gt; p -&gt; f a
</span><a href="#local-6989586621679294372"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span id="local-6989586621679294370"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294370"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294370"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679294371"><span class="annot"><span class="annottext">step :: MigrationStep be (Int -&gt; m a) -&gt; Int -&gt; m a
</span><a href="#local-6989586621679294371"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span id="local-6989586621679294369"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294369"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621679294368"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294368"><span class="hs-identifier hs-var">doStep</span></a></span></span><span> </span><span id="local-6989586621679294367"><span class="annot"><span class="annottext">a -&gt; Int -&gt; m a
</span><a href="#local-6989586621679294367"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679294366"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294378"><span class="hs-identifier hs-var">firstIdx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Int -&gt; Bool) -&gt; Maybe Int -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679294377"><span class="hs-identifier hs-var">lastIdx</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Migration be a -&gt; m a
forall a'. Int -&gt; Text -&gt; Migration be a' -&gt; m a'
</span><a href="#local-6989586621679294375"><span class="hs-identifier hs-var">runMigration</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294369"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294368"><span class="hs-identifier hs-var">doStep</span></a></span><span> </span><span class="annot"><span class="annottext">m a -&gt; (a -&gt; m a) -&gt; m a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679294362"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294362"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; m a
</span><a href="#local-6989586621679294367"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294362"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int -&gt; m a
</span><a href="#local-6989586621679294367"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Migration be a -&gt; a
forall be a. Migration be a -&gt; a
</span><a href="Database.Beam.Migrate.Types.html#runMigrationSilenced"><span class="hs-identifier hs-var">runMigrationSilenced</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294368"><span class="hs-identifier hs-var">doStep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679294366"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Get the result of a migration, without running any steps</span><span>
</span><span id="line-137"></span><span id="local-6989586621679294546"><span id="local-6989586621679294547"><span class="annot"><a href="Database.Beam.Migrate.Types.html#runMigrationSilenced"><span class="hs-identifier hs-type">runMigrationSilenced</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294547"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294546"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-138"></span><span id="runMigrationSilenced"><span class="annot"><span class="annottext">runMigrationSilenced :: Migration be a -&gt; a
</span><a href="Database.Beam.Migrate.Types.html#runMigrationSilenced"><span class="hs-identifier hs-var hs-var">runMigrationSilenced</span></a></span></span><span> </span><span id="local-6989586621679294360"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294360"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a -&gt; (a -&gt; a) -&gt; (MigrationF be a -&gt; a) -&gt; a
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294360"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationF be a -&gt; a
forall be next. MigrationF be next -&gt; next
</span><a href="#local-6989586621679294358"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span id="local-6989586621679294358"><span class="annot"><span class="annottext">step :: MigrationF be next -&gt; next
</span><a href="#local-6989586621679294358"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294357"><span class="annot"><span class="annottext">next
</span><a href="#local-6989586621679294357"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">next
</span><a href="#local-6989586621679294357"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Remove the explicit source and destination schemas from a 'MigrationSteps' object</span><span>
</span><span id="line-143"></span><span id="local-6989586621679294354"><span id="local-6989586621679294355"><span id="local-6989586621679294356"><span class="annot"><a href="Database.Beam.Migrate.Types.html#eraseMigrationType"><span class="hs-identifier hs-type">eraseMigrationType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679294356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294355"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294356"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294354"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294355"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-144"></span><span id="eraseMigrationType"><span class="annot"><span class="annottext">eraseMigrationType :: a -&gt; MigrationSteps be a a' -&gt; MigrationSteps be () ()
</span><a href="Database.Beam.Migrate.Types.html#eraseMigrationType"><span class="hs-identifier hs-var hs-var">eraseMigrationType</span></a></span></span><span> </span><span id="local-6989586621679294353"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294353"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span id="local-6989586621679294352"><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) a a'
</span><a href="#local-6989586621679294352"><span class="hs-identifier hs-var">steps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () () -&gt; MigrationSteps be () ()
forall be from to.
Kleisli (F (MigrationStep be)) from to -&gt; MigrationSteps be from to
</span><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-var">MigrationSteps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(() -&gt; a) -&gt; Kleisli (F (MigrationStep be)) () a
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; () -&gt; a
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294353"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
-&gt; Kleisli (F (MigrationStep be)) a ()
-&gt; Kleisli (F (MigrationStep be)) () ()
forall k (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) a a'
</span><a href="#local-6989586621679294352"><span class="hs-identifier hs-var">steps</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) a a'
-&gt; Kleisli (F (MigrationStep be)) a' ()
-&gt; Kleisli (F (MigrationStep be)) a ()
forall k (cat :: k -&gt; k -&gt; *) (a :: k) (b :: k) (c :: k).
Category cat =&gt;
cat a b -&gt; cat b c -&gt; cat a c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(a' -&gt; ()) -&gt; Kleisli (F (MigrationStep be)) a' ()
forall (a :: * -&gt; * -&gt; *) b c. Arrow a =&gt; (b -&gt; c) -&gt; a b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">arr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; a' -&gt; ()
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Create a 'MigrationSteps' from the given description and migration function.</span><span>
</span><span id="line-147"></span><span id="local-6989586621679294347"><span id="local-6989586621679294348"><span id="local-6989586621679294349"><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrationStep"><span class="hs-identifier hs-type">migrationStep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679294349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294348"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294347"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294348"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294349"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294347"><span class="hs-identifier hs-type">a'</span></a></span></span></span></span><span>
</span><span id="line-148"></span><span id="migrationStep"><span class="annot"><span class="annottext">migrationStep :: Text -&gt; (a -&gt; Migration be a') -&gt; MigrationSteps be a a'
</span><a href="Database.Beam.Migrate.Types.html#migrationStep"><span class="hs-identifier hs-var hs-var">migrationStep</span></a></span></span><span> </span><span id="local-6989586621679294346"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294346"><span class="hs-identifier hs-var">stepName</span></a></span></span><span> </span><span id="local-6989586621679294345"><span class="annot"><span class="annottext">a -&gt; Migration be a'
</span><a href="#local-6989586621679294345"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) a a' -&gt; MigrationSteps be a a'
forall be from to.
Kleisli (F (MigrationStep be)) from to -&gt; MigrationSteps be from to
</span><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-var">MigrationSteps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; F (MigrationStep be) a')
-&gt; Kleisli (F (MigrationStep be)) a a'
forall (m :: * -&gt; *) a b. (a -&gt; m b) -&gt; Kleisli m a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Kleisli</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679294343"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294343"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MigrationStep be a' -&gt; F (MigrationStep be) a'
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Migration be a' -&gt; (a' -&gt; a') -&gt; MigrationStep be a'
forall be a next.
Text -&gt; Migration be a -&gt; (a -&gt; next) -&gt; MigrationStep be next
</span><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-var">MigrationStep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294346"><span class="hs-identifier hs-var">stepName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Migration be a'
</span><a href="#local-6989586621679294345"><span class="hs-identifier hs-var">migration</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294343"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a' -&gt; a'
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Given a command in the forward direction, and an optional one in the</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- reverse direction, construct a 'Migration' that performs the given</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- command. Multiple commands can be sequenced monadically.</span><span>
</span><span id="line-154"></span><span id="local-6989586621679294341"><span class="annot"><a href="Database.Beam.Migrate.Types.html#upDown"><span class="hs-identifier hs-type">upDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294341"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294341"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294341"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-155"></span><span id="upDown"><span class="annot"><span class="annottext">upDown :: BeamSqlBackendSyntax be
-&gt; Maybe (BeamSqlBackendSyntax be) -&gt; Migration be ()
</span><a href="Database.Beam.Migrate.Types.html#upDown"><span class="hs-identifier hs-var hs-var">upDown</span></a></span></span><span> </span><span id="local-6989586621679294340"><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294340"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span id="local-6989586621679294339"><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><a href="#local-6989586621679294339"><span class="hs-identifier hs-var">down</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MigrationF be () -&gt; Migration be ()
forall (f :: * -&gt; *) (m :: * -&gt; *) a.
(Functor f, MonadFree f m) =&gt;
f a -&gt; m a
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var">liftF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
-&gt; Maybe (BeamSqlBackendSyntax be) -&gt; () -&gt; MigrationF be ()
forall be next.
BeamSqlBackendSyntax be
-&gt; Maybe (BeamSqlBackendSyntax be) -&gt; next -&gt; MigrationF be next
</span><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-var">MigrationRunCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294340"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><a href="#local-6989586621679294339"><span class="hs-identifier hs-var">down</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Given functions to render a migration step description and the underlying</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- syntax, create a script for the given 'MigrationSteps'.</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrateScript"><span class="hs-identifier hs-type">migrateScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294338"><span class="annot"><a href="#local-6989586621679294338"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294337"><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679294336"><span class="annot"><a href="#local-6989586621679294336"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294338"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>              </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>              </span><span class="hs-comment">-- ^ Called at the beginning of each 'MigrationStep' with the step description</span><span>
</span><span id="line-162"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294338"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>              </span><span class="hs-comment">-- ^ Called for each command in the migration step</span><span>
</span><span id="line-164"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294338"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679294336"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-165"></span><span>              </span><span class="hs-comment">-- ^ The set of steps to run</span><span>
</span><span id="line-166"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-167"></span><span id="migrateScript"><span class="annot"><span class="annottext">migrateScript :: (Text -&gt; m)
-&gt; (BeamSqlBackendSyntax be -&gt; m) -&gt; MigrationSteps be () a -&gt; m
</span><a href="Database.Beam.Migrate.Types.html#migrateScript"><span class="hs-identifier hs-var hs-var">migrateScript</span></a></span></span><span> </span><span id="local-6989586621679294334"><span class="annot"><span class="annottext">Text -&gt; m
</span><a href="#local-6989586621679294334"><span class="hs-identifier hs-var">renderMigrationHeader</span></a></span></span><span> </span><span id="local-6989586621679294333"><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m
</span><a href="#local-6989586621679294333"><span class="hs-identifier hs-var">renderMigrationSyntax</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span id="local-6989586621679294332"><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294332"><span class="hs-identifier hs-var">steps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">F (MigrationStep be) a
-&gt; (a -&gt; m -&gt; m) -&gt; (MigrationStep be (m -&gt; m) -&gt; m -&gt; m) -&gt; m -&gt; m
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a -&gt; () -&gt; F (MigrationStep be) a
forall (m :: * -&gt; *) a b. Kleisli m a b -&gt; a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">runKleisli</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294332"><span class="hs-identifier hs-var">steps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294331"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294331"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294331"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span id="local-6989586621679294330"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294330"><span class="hs-identifier hs-var">header</span></a></span></span><span> </span><span id="local-6989586621679294329"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294329"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span id="local-6989586621679294328"><span class="annot"><span class="annottext">a -&gt; m -&gt; m
</span><a href="#local-6989586621679294328"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679294327"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294327"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679294326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294326"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679294325"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294325"><span class="hs-identifier hs-var">script</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a -&gt; m -&gt; (a, m)
forall a'. Migration be a' -&gt; m -&gt; (a', m)
</span><a href="#local-6989586621679294324"><span class="hs-identifier hs-var">renderMigration</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294329"><span class="hs-identifier hs-var">migration</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-171"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">a -&gt; m -&gt; m
</span><a href="#local-6989586621679294328"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679294326"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294327"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; m
</span><a href="#local-6989586621679294334"><span class="hs-identifier hs-var">renderMigrationHeader</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294330"><span class="hs-identifier hs-var">header</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294325"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="#local-6989586621679294324"><span class="hs-identifier hs-type">renderMigration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294507"><span class="annot"><a href="#local-6989586621679294507"><span class="hs-identifier hs-type">a'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294338"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294507"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679294507"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679294337"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679294324"><span class="annot"><span class="annottext">renderMigration :: Migration be a' -&gt; m -&gt; (a', m)
</span><a href="#local-6989586621679294324"><span class="hs-identifier hs-var hs-var">renderMigration</span></a></span></span><span> </span><span id="local-6989586621679294323"><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294323"><span class="hs-identifier hs-var">migrationSteps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">Migration be a'
-&gt; (a' -&gt; m -&gt; (a', m))
-&gt; (MigrationF be (m -&gt; (a', m)) -&gt; m -&gt; (a', m))
-&gt; m
-&gt; (a', m)
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294323"><span class="hs-identifier hs-var">migrationSteps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>           </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span id="local-6989586621679294322"><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294322"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294321"><span class="annot"><span class="annottext">m -&gt; (a', m)
</span><a href="#local-6989586621679294321"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679294320"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294320"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m -&gt; (a', m)
</span><a href="#local-6989586621679294321"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679294320"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m
</span><a href="#local-6989586621679294333"><span class="hs-identifier hs-var">renderMigrationSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294322"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Execute a given migration, provided a command to execute arbitrary syntax.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   You usually use this with 'runNoReturn'.</span><span>
</span><span id="line-180"></span><span id="local-6989586621679294317"><span id="local-6989586621679294318"><span id="local-6989586621679294319"><span class="annot"><a href="Database.Beam.Migrate.Types.html#executeMigration"><span class="hs-identifier hs-type">executeMigration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294318"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294318"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294317"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294319"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294317"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-181"></span><span id="executeMigration"><span class="annot"><span class="annottext">executeMigration :: (BeamSqlBackendSyntax be -&gt; m ()) -&gt; Migration be a -&gt; m a
</span><a href="Database.Beam.Migrate.Types.html#executeMigration"><span class="hs-identifier hs-var hs-var">executeMigration</span></a></span></span><span> </span><span id="local-6989586621679294316"><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m ()
</span><a href="#local-6989586621679294316"><span class="hs-identifier hs-var">runSyntax</span></a></span></span><span> </span><span id="local-6989586621679294315"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294315"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a -&gt; (a -&gt; m a) -&gt; (MigrationF be (m a) -&gt; m a) -&gt; m a
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294315"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationF be (m a) -&gt; m a
</span><a href="#local-6989586621679294314"><span class="hs-identifier hs-var">doStep</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679294314"><span class="annot"><span class="annottext">doStep :: MigrationF be (m a) -&gt; m a
</span><a href="#local-6989586621679294314"><span class="hs-identifier hs-var hs-var">doStep</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span id="local-6989586621679294313"><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294313"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294312"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679294312"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-184"></span><span>      </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; m ()
</span><a href="#local-6989586621679294316"><span class="hs-identifier hs-var">runSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679294313"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">m () -&gt; m a -&gt; m a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679294312"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Given a migration, get the potential data loss, if it's run top-down</span><span>
</span><span id="line-187"></span><span id="local-6989586621679294310"><span id="local-6989586621679294311"><span class="annot"><a href="Database.Beam.Migrate.Types.html#migrationDataLoss"><span class="hs-identifier hs-type">migrationDataLoss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294311"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294310"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationDataLoss"><span class="hs-identifier hs-type">MigrationDataLoss</span></a></span></span></span><span>
</span><span id="line-188"></span><span id="migrationDataLoss"><span class="annot"><span class="annottext">migrationDataLoss :: Migration be a -&gt; MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#migrationDataLoss"><span class="hs-identifier hs-var hs-var">migrationDataLoss</span></a></span></span><span> </span><span id="local-6989586621679294309"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294309"><span class="hs-identifier hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a
-&gt; (a -&gt; MigrationDataLoss)
-&gt; (MigrationF be MigrationDataLoss -&gt; MigrationDataLoss)
-&gt; MigrationDataLoss
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294309"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>                         </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294308"><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><a href="#local-6989586621679294308"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679294307"><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="#local-6989586621679294307"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><a href="#local-6989586621679294308"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-191"></span><span>                              </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span>
</span><span id="line-192"></span><span>                              </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="#local-6989586621679294307"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Run a 'MigrationSteps' without executing any of the commands against a</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- database.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="Database.Beam.Migrate.Types.html#evaluateDatabase"><span class="hs-identifier hs-type">evaluateDatabase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294306"><span class="annot"><a href="#local-6989586621679294306"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294305"><span class="annot"><a href="#local-6989586621679294305"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294306"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679294305"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294305"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-197"></span><span id="evaluateDatabase"><span class="annot"><span class="annottext">evaluateDatabase :: MigrationSteps be () a -&gt; a
</span><a href="Database.Beam.Migrate.Types.html#evaluateDatabase"><span class="hs-identifier hs-var hs-var">evaluateDatabase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span id="local-6989586621679294304"><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294304"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F (MigrationStep be) a
-&gt; (a -&gt; a) -&gt; (MigrationStep be a -&gt; a) -&gt; a
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a -&gt; () -&gt; F (MigrationStep be) a
forall (m :: * -&gt; *) a b. Kleisli m a b -&gt; a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">runKleisli</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294304"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294303"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294303"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span id="local-6989586621679294302"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679294302"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679294302"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Migration be a -&gt; a
forall a'. Migration be a' -&gt; a'
</span><a href="#local-6989586621679294301"><span class="hs-identifier hs-var">runMigration</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294303"><span class="hs-identifier hs-var">migration</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679294301"><span class="hs-identifier hs-type">runMigration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294493"><span class="annot"><a href="#local-6989586621679294493"><span class="hs-identifier hs-type">a'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294306"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294493"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294493"><span class="hs-identifier hs-type">a'</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679294301"><span class="annot"><span class="annottext">runMigration :: Migration be a' -&gt; a'
</span><a href="#local-6989586621679294301"><span class="hs-identifier hs-var hs-var">runMigration</span></a></span></span><span> </span><span id="local-6989586621679294300"><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294300"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a' -&gt; (a' -&gt; a') -&gt; (MigrationF be a' -&gt; a') -&gt; a'
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294300"><span class="hs-identifier hs-var">migration</span></a></span><span> </span><span class="annot"><span class="annottext">a' -&gt; a'
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294299"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679294299"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679294299"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Collect the names of all steps in hte given 'MigrationSteps'</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Database.Beam.Migrate.Types.html#stepNames"><span class="hs-identifier hs-type">stepNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294298"><span class="annot"><a href="#local-6989586621679294298"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span id="local-6989586621679294297"><span class="annot"><a href="#local-6989586621679294297"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294298"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679294297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span id="stepNames"><span class="annot"><span class="annottext">stepNames :: MigrationSteps be () a -&gt; [Text]
</span><a href="Database.Beam.Migrate.Types.html#stepNames"><span class="hs-identifier hs-var hs-var">stepNames</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationSteps"><span class="hs-identifier hs-type">MigrationSteps</span></a></span><span> </span><span id="local-6989586621679294296"><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294296"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">F (MigrationStep be) a
-&gt; (a -&gt; [Text] -&gt; [Text])
-&gt; (MigrationStep be ([Text] -&gt; [Text]) -&gt; [Text] -&gt; [Text])
-&gt; [Text]
-&gt; [Text]
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a -&gt; () -&gt; F (MigrationStep be) a
forall (m :: * -&gt; *) a b. Kleisli m a b -&gt; a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">runKleisli</span></a></span><span> </span><span class="annot"><span class="annottext">Kleisli (F (MigrationStep be)) () a
</span><a href="#local-6989586621679294296"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294295"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679294295"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679294295"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationStep"><span class="hs-identifier hs-type">MigrationStep</span></a></span><span> </span><span id="local-6989586621679294294"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294294"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621679294293"><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294293"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span id="local-6989586621679294292"><span class="annot"><span class="annottext">a -&gt; [Text] -&gt; [Text]
</span><a href="#local-6989586621679294292"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679294291"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679294291"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Text] -&gt; [Text]
</span><a href="#local-6989586621679294292"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Migration be a -&gt; a
forall a'. Migration be a' -&gt; a'
</span><a href="#local-6989586621679294290"><span class="hs-identifier hs-var">runMigration</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a
</span><a href="#local-6989586621679294293"><span class="hs-identifier hs-var">migration</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679294291"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; [Text] -&gt; [Text]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679294294"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679294290"><span class="hs-identifier hs-type">runMigration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679294488"><span class="annot"><a href="#local-6989586621679294488"><span class="hs-identifier hs-type">a'</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#Migration"><span class="hs-identifier hs-type">Migration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294298"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679294488"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679294488"><span class="hs-identifier hs-type">a'</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679294290"><span class="annot"><span class="annottext">runMigration :: Migration be a' -&gt; a'
</span><a href="#local-6989586621679294290"><span class="hs-identifier hs-var hs-var">runMigration</span></a></span></span><span> </span><span id="local-6989586621679294289"><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294289"><span class="hs-identifier hs-var">migration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Migration be a' -&gt; (a' -&gt; a') -&gt; (MigrationF be a' -&gt; a') -&gt; a'
forall (f :: * -&gt; *) a.
F f a -&gt; forall r. (a -&gt; r) -&gt; (f r -&gt; r) -&gt; r
</span><a href="../../../../free/html/src"><span class="hs-identifier hs-var hs-var">runF</span></a></span><span> </span><span class="annot"><span class="annottext">Migration be a'
</span><a href="#local-6989586621679294289"><span class="hs-identifier hs-var">migration</span></a></span><span> </span><span class="annot"><span class="annottext">a' -&gt; a'
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationRunCommand"><span class="hs-identifier hs-type">MigrationRunCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (BeamSqlBackendSyntax be)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679294288"><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679294288"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a'
</span><a href="#local-6989586621679294288"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span></pre></body></html>