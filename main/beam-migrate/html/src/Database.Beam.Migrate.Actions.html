<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_6QN0HeQX3TN9kbDf0MLEHs"><span id="%24tag2con_6QN0HeQX3TN9kbDf0MLEHs"><span id="%24con2tag_6QN0HeQX3TN9kbDf0MLEHs"></span></span></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Data types and functions to discover sequences of DDL commands to go from</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- one database state to another. Used for migration generation.</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- For our purposes, a database state is fully specified by the set of</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- predicates that apply to that database.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Migration generation is approached as a graph search problem over the</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- infinite graph of databases /G/. The nodes of /G/ are database states, which</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- (as said above) are simply sets of predicates (see 'DatabaseState' for the</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- realization of this concept in code). For two vertices /S1/ and /S2/ in /G/,</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- there is an edge between the two if and only if there is a DDL command that</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- can take a database at /S1/ to /S2/.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- We generate migrations by exploring this graph, starting at the source state</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- and ending at the destination state. By default we use an optimizing solver</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- that weights each edge by the complexity of the particular command, and we</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- attempt to find the shortest path using Dijkstra's algorithm, although a user</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- may override this behavior and provide a custom edge selection mechanism (or</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- even defer this choice to the user).</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- In order to conduct the breadth-first search, we must know which edges lead</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- out of whichever vertex we're currently visiting. The solving algorithm thus</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- takes a set of 'ActionProvider's, which are means of discovering edges that</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- are incident to the current database state.</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- Conceptually, an 'ActionProvider' is a function of type 'ActionProviderFn',</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- which takes the current database state and produces a list of edges in the</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- form of 'PotentialAction' objects. For optimization purposes,</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- 'ActionProvider's also take in the desired destination state, which it can</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- use to select only edges that make sense. This does not affect the result,</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- just the amount of time it may take to get there.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Note that because the graph of database states is infinite, a breadth-first</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- search may easily end up continuing to explore when there is no chance of</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- reaching our goal. This would result in non-termination and is highly</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- undesirable. In order to prevent this, we limit ourselves to only exploring</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- edges that take us /closer/ to the destination state. Here, we measure</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- distance between two states as the number of elements in the symmetric</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- difference of two database states. Thus, every action we take must either</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- remove a predicate that doesn't exist in the destination state, or add a</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- predicate that does. If a potential action only adds predicates that do not</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- exist in the final state or removes predicates that do not exist in the</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- first, then we never explore that edge.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- == A note on speed</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- There are some issues with this approach. Namely, if there is no solution, we</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- can end up exploring the entire action space, which may be quite a lot. While</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- @beam-migrate@ can solve all databases that can be made up of predicates in</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- this module, other beam backends may not make such strict guarantees</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- (although in practice, all do). Nevertheless, if you're hacking on this</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- module and notice what seems like an infinite loop, you may have accidentally</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- removed code that exposed the edge that leads to a solution to the migration.</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Beam.Migrate.Actions</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-67"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Database state</span></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSource"><span class="hs-identifier">DatabaseStateSource</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier">DatabaseState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Action generation</span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier">PotentialAction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier">ActionProvider</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier">ActionProviderFn</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier">ensuringNot_</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#justOne_"><span class="hs-identifier">justOne_</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#createTableActionProvider"><span class="hs-identifier">createTableActionProvider</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropTableActionProvider"><span class="hs-identifier">dropTableActionProvider</span></a></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#addColumnProvider"><span class="hs-identifier">addColumnProvider</span></a></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#addColumnNullProvider"><span class="hs-identifier">addColumnNullProvider</span></a></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropColumnNullProvider"><span class="hs-identifier">dropColumnNullProvider</span></a></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#defaultActionProvider"><span class="hs-identifier">defaultActionProvider</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Solver</span></span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier">Solver</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#FinalSolution"><span class="hs-identifier">FinalSolution</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier">finalSolution</span></a></span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#heuristicSolver"><span class="hs-identifier">heuristicSolver</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier">Database.Beam.Backend.SQL</span></a></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html"><span class="hs-identifier">Database.Beam.Migrate.Checks</span></a></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Migrate.SQL.html"><span class="hs-identifier">Database.Beam.Migrate.SQL</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Migrate.Types.html"><span class="hs-identifier">Database.Beam.Migrate.Types</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html"><span class="hs-identifier">Database.Beam.Migrate.Types.Predicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier">qnameAsText</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier">qnameAsTableName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../parallel/html/src"><span class="hs-identifier">Control.Parallel.Strategies</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier">Data.HashSet</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../pqueue/html/src"><span class="hs-identifier">Data.PQueue.Min</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PQ</span></span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span class="hs-cpp">
#if !MIN_VERSION_base(4, 11, 0)
</span><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data.Semigroup</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Used to indicate whether a particular predicate is from the initial</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- database state, or due to a sequence of actions we've committed too. Used to</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- prevent runaway action generation based off of derived states.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679297980"><span id="local-6989586621679297981"></span></span><span class="hs-keyword">data</span><span> </span><span id="DatabaseStateSource"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSource"><span class="hs-identifier hs-var">DatabaseStateSource</span></a></span></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DatabaseStateSourceOriginal"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSourceOriginal"><span class="hs-identifier hs-var">DatabaseStateSourceOriginal</span></a></span></span><span> </span><span class="hs-comment">-- ^ Predicate is from the original set given by the user</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="DatabaseStateSourceDerived"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSourceDerived"><span class="hs-identifier hs-var">DatabaseStateSourceDerived</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Predicate is from an action we've committed to in this action chain</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679297972"><span id="local-6989586621679297974"><span id="local-6989586621679297976"><span class="annot"><span class="annottext">Int -&gt; DatabaseStateSource -&gt; ShowS
[DatabaseStateSource] -&gt; ShowS
DatabaseStateSource -&gt; String
(Int -&gt; DatabaseStateSource -&gt; ShowS)
-&gt; (DatabaseStateSource -&gt; String)
-&gt; ([DatabaseStateSource] -&gt; ShowS)
-&gt; Show DatabaseStateSource
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DatabaseStateSource] -&gt; ShowS
$cshowList :: [DatabaseStateSource] -&gt; ShowS
show :: DatabaseStateSource -&gt; String
$cshow :: DatabaseStateSource -&gt; String
showsPrec :: Int -&gt; DatabaseStateSource -&gt; ShowS
$cshowsPrec :: Int -&gt; DatabaseStateSource -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297967"><span id="local-6989586621679297969"><span class="annot"><span class="annottext">DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
(DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; Eq DatabaseStateSource
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c/= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
== :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c== :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297951"><span id="local-6989586621679297953"><span id="local-6989586621679297955"><span id="local-6989586621679297957"><span id="local-6989586621679297959"><span id="local-6989586621679297961"><span id="local-6989586621679297963"><span class="annot"><span class="annottext">Eq DatabaseStateSource
Eq DatabaseStateSource
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Ordering)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool)
-&gt; (DatabaseStateSource
    -&gt; DatabaseStateSource -&gt; DatabaseStateSource)
-&gt; (DatabaseStateSource
    -&gt; DatabaseStateSource -&gt; DatabaseStateSource)
-&gt; Ord DatabaseStateSource
DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
DatabaseStateSource -&gt; DatabaseStateSource -&gt; Ordering
DatabaseStateSource -&gt; DatabaseStateSource -&gt; DatabaseStateSource
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; DatabaseStateSource
$cmin :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; DatabaseStateSource
max :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; DatabaseStateSource
$cmax :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; DatabaseStateSource
&gt;= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c&gt;= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
&gt; :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c&gt; :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
&lt;= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c&lt;= :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
&lt; :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
$c&lt; :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Bool
compare :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Ordering
$ccompare :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; Ordering
$cp1Ord :: Eq DatabaseStateSource
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297934"><span id="local-6989586621679297936"><span id="local-6989586621679297938"><span id="local-6989586621679297940"><span id="local-6989586621679297942"><span id="local-6989586621679297944"><span id="local-6989586621679297946"><span id="local-6989586621679297948"><span class="annot"><span class="annottext">Int -&gt; DatabaseStateSource
DatabaseStateSource -&gt; Int
DatabaseStateSource -&gt; [DatabaseStateSource]
DatabaseStateSource -&gt; DatabaseStateSource
DatabaseStateSource -&gt; DatabaseStateSource -&gt; [DatabaseStateSource]
DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; [DatabaseStateSource]
(DatabaseStateSource -&gt; DatabaseStateSource)
-&gt; (DatabaseStateSource -&gt; DatabaseStateSource)
-&gt; (Int -&gt; DatabaseStateSource)
-&gt; (DatabaseStateSource -&gt; Int)
-&gt; (DatabaseStateSource -&gt; [DatabaseStateSource])
-&gt; (DatabaseStateSource
    -&gt; DatabaseStateSource -&gt; [DatabaseStateSource])
-&gt; (DatabaseStateSource
    -&gt; DatabaseStateSource -&gt; [DatabaseStateSource])
-&gt; (DatabaseStateSource
    -&gt; DatabaseStateSource
    -&gt; DatabaseStateSource
    -&gt; [DatabaseStateSource])
-&gt; Enum DatabaseStateSource
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; [DatabaseStateSource]
$cenumFromThenTo :: DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; DatabaseStateSource
-&gt; [DatabaseStateSource]
enumFromTo :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; [DatabaseStateSource]
$cenumFromTo :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; [DatabaseStateSource]
enumFromThen :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; [DatabaseStateSource]
$cenumFromThen :: DatabaseStateSource -&gt; DatabaseStateSource -&gt; [DatabaseStateSource]
enumFrom :: DatabaseStateSource -&gt; [DatabaseStateSource]
$cenumFrom :: DatabaseStateSource -&gt; [DatabaseStateSource]
fromEnum :: DatabaseStateSource -&gt; Int
$cfromEnum :: DatabaseStateSource -&gt; Int
toEnum :: Int -&gt; DatabaseStateSource
$ctoEnum :: Int -&gt; DatabaseStateSource
pred :: DatabaseStateSource -&gt; DatabaseStateSource
$cpred :: DatabaseStateSource -&gt; DatabaseStateSource
succ :: DatabaseStateSource -&gt; DatabaseStateSource
$csucc :: DatabaseStateSource -&gt; DatabaseStateSource
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297929"><span id="local-6989586621679297931"><span class="annot"><span class="annottext">DatabaseStateSource
DatabaseStateSource
-&gt; DatabaseStateSource -&gt; Bounded DatabaseStateSource
forall a. a -&gt; a -&gt; Bounded a
maxBound :: DatabaseStateSource
$cmaxBound :: DatabaseStateSource
minBound :: DatabaseStateSource
$cminBound :: DatabaseStateSource
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DatabaseStateSource -&gt; Rep DatabaseStateSource x)
-&gt; (forall x. Rep DatabaseStateSource x -&gt; DatabaseStateSource)
-&gt; Generic DatabaseStateSource
forall x. Rep DatabaseStateSource x -&gt; DatabaseStateSource
forall x. DatabaseStateSource -&gt; Rep DatabaseStateSource x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DatabaseStateSource x -&gt; DatabaseStateSource
$cfrom :: forall x. DatabaseStateSource -&gt; Rep DatabaseStateSource x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297923"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSource"><span class="hs-identifier hs-type">DatabaseStateSource</span></a></span></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Represents the state of a database as a migration is being generated</span><span>
</span><span id="line-129"></span><span class="hs-keyword">data</span><span> </span><span id="DatabaseState"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-var">DatabaseState</span></a></span></span><span> </span><span id="local-6989586621679298051"><span class="annot"><a href="#local-6989586621679298051"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DatabaseState"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-var">DatabaseState</span></a></span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="dbStateCurrentState"><span class="annot"><span class="annottext">DatabaseState be
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="Database.Beam.Migrate.Actions.html#dbStateCurrentState"><span class="hs-identifier hs-var hs-var">dbStateCurrentState</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HM.HashMap</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSource"><span class="hs-identifier hs-type">DatabaseStateSource</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-comment">-- ^ The current set of predicates that apply to this database as well as</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-comment">-- their source (user or from previous actions)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dbStateKey"><span class="annot"><span class="annottext">DatabaseState be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#dbStateKey"><span class="hs-identifier hs-var hs-var">dbStateKey</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- ^ HS.fromMap of 'dbStateCurrentState', for maximal sharing</span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dbStateCmdSequence"><span class="annot"><span class="annottext">DatabaseState be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#dbStateCmdSequence"><span class="hs-identifier hs-var hs-var">dbStateCmdSequence</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Seq.Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-type">MigrationCommand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298051"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-comment">-- ^ The current sequence of commands we've committed to in this state</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span id="local-6989586621679297911"><span id="local-6989586621679297913"><span id="local-6989586621679297915"><span id="local-6989586621679297917"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297917"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297917"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679297910"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297910"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679297908"><span class="annot"><span class="annottext">rnf :: DatabaseState cmd -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679297906"><span class="annot"><span class="annottext">d :: DatabaseState cmd
</span><a href="#local-6989586621679297906"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseState cmd
</span><a href="#local-6989586621679297906"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState cmd -&gt; () -&gt; ()
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Wrapper for 'DatabaseState' that keeps track of the command sequence length</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- and goal distance. Used for sorting states when conducting the search.</span><span>
</span><span id="line-146"></span><span id="local-6989586621679297904"><span id="local-6989586621679297905"></span></span><span class="hs-keyword">data</span><span> </span><span id="MeasuredDatabaseState"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-var">MeasuredDatabaseState</span></a></span></span><span> </span><span id="local-6989586621679298188"><span class="annot"><a href="#local-6989586621679298188"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MeasuredDatabaseState"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-var">MeasuredDatabaseState</span></a></span></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298188"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 MeasuredDatabaseState be -&gt; Rep (MeasuredDatabaseState be) x)
-&gt; (forall x.
    Rep (MeasuredDatabaseState be) x -&gt; MeasuredDatabaseState be)
-&gt; Generic (MeasuredDatabaseState be)
forall x.
Rep (MeasuredDatabaseState be) x -&gt; MeasuredDatabaseState be
forall x.
MeasuredDatabaseState be -&gt; Rep (MeasuredDatabaseState be) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall be x.
Rep (MeasuredDatabaseState be) x -&gt; MeasuredDatabaseState be
forall be x.
MeasuredDatabaseState be -&gt; Rep (MeasuredDatabaseState be) x
$cto :: forall be x.
Rep (MeasuredDatabaseState be) x -&gt; MeasuredDatabaseState be
$cfrom :: forall be x.
MeasuredDatabaseState be -&gt; Rep (MeasuredDatabaseState be) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-149"></span><span id="local-6989586621679297894"><span id="local-6989586621679297896"><span id="local-6989586621679297898"><span id="local-6989586621679297900"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297900"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297900"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-150"></span><span id="local-6989586621679297893"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297891"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297893"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-151"></span><span id="local-6989586621679297890"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297887"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297890"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>  </span><span id="local-6989586621679297886"><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297886"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679297885"><span class="annot"><span class="annottext">== :: MeasuredDatabaseState cmd -&gt; MeasuredDatabaseState cmd -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679297884"><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297884"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd -&gt; Int
forall cmd. MeasuredDatabaseState cmd -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-var">measure</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297886"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd -&gt; Int
forall cmd. MeasuredDatabaseState cmd -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-var">measure</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297884"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-153"></span><span id="local-6989586621679297882"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297868"><span id="local-6989586621679297870"><span id="local-6989586621679297872"><span id="local-6989586621679297874"><span id="local-6989586621679297876"><span id="local-6989586621679297878"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297882"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679297867"><span class="annot"><span class="annottext">compare :: MeasuredDatabaseState cmd -&gt; MeasuredDatabaseState cmd -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span id="local-6989586621679297865"><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297865"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679297864"><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297864"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd -&gt; Int
forall cmd. MeasuredDatabaseState cmd -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-var">measure</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297865"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd -&gt; Int
forall cmd. MeasuredDatabaseState cmd -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-var">measure</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297864"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span id="local-6989586621679298194"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-type">measure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298194"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-157"></span><span id="measure"><span class="annot"><span class="annottext">measure :: MeasuredDatabaseState cmd -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#measure"><span class="hs-identifier hs-var hs-var">measure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span id="local-6989586621679297863"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297863"><span class="hs-identifier hs-var">cmdLength</span></a></span></span><span> </span><span id="local-6989586621679297862"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297862"><span class="hs-identifier hs-var">estGoalDistance</span></a></span></span><span> </span><span class="annot"><span class="annottext">DatabaseState cmd
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297863"><span class="hs-identifier hs-var">cmdLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297862"><span class="hs-identifier hs-var">estGoalDistance</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span id="local-6989586621679298029"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#measuredDbState"><span class="hs-identifier hs-type">measuredDbState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298029"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298029"><span class="hs-identifier hs-type">cmd</span></a></span></span><span>
</span><span id="line-160"></span><span id="measuredDbState"><span class="annot"><span class="annottext">measuredDbState :: MeasuredDatabaseState cmd -&gt; DatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measuredDbState"><span class="hs-identifier hs-var hs-var">measuredDbState</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297858"><span class="annot"><span class="annottext">DatabaseState cmd
</span><a href="#local-6989586621679297858"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseState cmd
</span><a href="#local-6989586621679297858"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span id="local-6989586621679298053"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#measureDb%27"><span class="hs-identifier hs-type">measureDb'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span>
</span><span id="line-163"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span>
</span><span id="line-164"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-165"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298053"><span class="hs-identifier hs-type">cmd</span></a></span><span>
</span><span id="line-166"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298053"><span class="hs-identifier hs-type">cmd</span></a></span></span><span>
</span><span id="line-167"></span><span id="measureDb%27"><span class="annot"><span class="annottext">measureDb' :: HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Int
-&gt; DatabaseState cmd
-&gt; MeasuredDatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measureDb%27"><span class="hs-identifier hs-var hs-var">measureDb'</span></a></span></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297856"><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297856"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span id="local-6989586621679297855"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297855"><span class="hs-identifier hs-var">cmdLength</span></a></span></span><span> </span><span id="local-6989586621679297854"><span class="annot"><span class="annottext">st :: DatabaseState cmd
</span><a href="#local-6989586621679297854"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297853"><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297853"><span class="hs-identifier hs-var">repr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (MigrationCommand cmd)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; DatabaseState cmd -&gt; MeasuredDatabaseState cmd
forall be.
Int -&gt; Int -&gt; DatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-var">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297855"><span class="hs-identifier hs-var">cmdLength</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297852"><span class="hs-identifier hs-var">distToGoal</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState cmd
</span><a href="#local-6989586621679297854"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span>    </span><span id="local-6989586621679297852"><span class="annot"><span class="annottext">distToGoal :: Int
</span><a href="#local-6989586621679297852"><span class="hs-identifier hs-var hs-var">distToGoal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; Int
forall a. HashSet a -&gt; Int
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297853"><span class="hs-identifier hs-var">repr</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297856"><span class="hs-identifier hs-var">post</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.union`</span></a></span><span>
</span><span id="line-172"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297856"><span class="hs-identifier hs-var">post</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297853"><span class="hs-identifier hs-var">repr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Represents an edge (or a path) in the database graph.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- Given a particular starting point, the destination database is the database</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- where each predicate in 'actionPreConditions' has been removed and each</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- predicate in 'actionPostConditions' has been added.</span><span>
</span><span id="line-179"></span><span class="hs-keyword">data</span><span> </span><span id="PotentialAction"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span></span><span> </span><span id="local-6989586621679298170"><span class="annot"><a href="#local-6989586621679298170"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PotentialAction"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="actionPreConditions"><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPreConditions"><span class="hs-identifier hs-var hs-var">actionPreConditions</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- ^ Preconditions that will no longer apply</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="actionPostConditions"><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPostConditions"><span class="hs-identifier hs-var hs-var">actionPostConditions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- ^ Conditions that will apply after we're done</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="actionCommands"><span class="annot"><span class="annottext">PotentialAction be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#actionCommands"><span class="hs-identifier hs-var hs-var">actionCommands</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Seq.Seq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-type">MigrationCommand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298170"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- ^ The sequence of commands that accomplish this movement in the database</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- graph. For an edge, 'actionCommands' contains one command; for a path, it</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- will contain more.</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="actionEnglish"><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- ^ An english description of the movement</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="actionScore"><span class="annot"><span class="annottext">PotentialAction be -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#actionScore"><span class="hs-identifier hs-var hs-var">actionScore</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- ^ A heuristic notion of complexity or weight; used to find the &quot;easiest&quot;</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- path through the graph.</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679297842"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297837"><span id="local-6989586621679297839"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-type">PotentialAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297842"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>  </span><span id="local-6989586621679297835"><span class="annot"><span class="annottext">&lt;&gt; :: PotentialAction be -&gt; PotentialAction be -&gt; PotentialAction be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; PotentialAction be -&gt; PotentialAction be
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | 'PotentialAction's can represent edges or paths. Monadically combining two</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- 'PotentialAction's results in the path between the source of the first and</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- the destination of the second. 'mempty' here returns the action that does</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- nothing (i.e., the edge going back to the same database state)</span><span>
</span><span id="line-203"></span><span id="local-6989586621679297834"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297829"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-type">PotentialAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297834"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>  </span><span id="local-6989586621679297827"><span class="annot"><span class="annottext">mempty :: PotentialAction be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679297826"><span class="annot"><span class="annottext">mappend :: PotentialAction be -&gt; PotentialAction be -&gt; PotentialAction be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span id="local-6989586621679297825"><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679297824"><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPreConditions"><span class="hs-identifier hs-var hs-var">actionPreConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPreConditions"><span class="hs-identifier hs-var hs-var">actionPreConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPostConditions"><span class="hs-identifier hs-var hs-var">actionPostConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPostConditions"><span class="hs-identifier hs-var hs-var">actionPostConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; Seq (MigrationCommand be)
forall be. PotentialAction be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#actionCommands"><span class="hs-identifier hs-var hs-var">actionCommands</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
-&gt; Seq (MigrationCommand be) -&gt; Seq (MigrationCommand be)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Seq (MigrationCommand be)
forall be. PotentialAction be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#actionCommands"><span class="hs-identifier hs-var hs-var">actionCommands</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                    </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-210"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.null</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-211"></span><span>                           </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;; &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Text
forall be. PotentialAction be -&gt; Text
</span><a href="Database.Beam.Migrate.Actions.html#actionEnglish"><span class="hs-identifier hs-var hs-var">actionEnglish</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; Int
forall be. PotentialAction be -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#actionScore"><span class="hs-identifier hs-var hs-var">actionScore</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297825"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Int
forall be. PotentialAction be -&gt; Int
</span><a href="Database.Beam.Migrate.Actions.html#actionScore"><span class="hs-identifier hs-var hs-var">actionScore</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297824"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | See 'ActionProvider'</span><span>
</span><span id="line-215"></span><span class="hs-keyword">type</span><span> </span><span id="ActionProviderFn"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-var">ActionProviderFn</span></a></span></span><span> </span><span id="local-6989586621679297822"><span class="annot"><a href="#local-6989586621679297822"><span class="hs-identifier hs-type">be</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-216"></span><span>     </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679298162"><span class="annot"><a href="#local-6989586621679298162"><span class="hs-identifier hs-type">preCondition</span></a></span></span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298162"><span class="hs-identifier hs-type">preCondition</span></a></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298162"><span class="hs-identifier hs-type">preCondition</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>             </span><span class="hs-comment">{- The list of preconditions -}</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679297821"><span class="annot"><a href="#local-6989586621679297821"><span class="hs-identifier hs-type">postCondition</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297821"><span class="hs-identifier hs-type">postCondition</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679297821"><span class="hs-identifier hs-type">postCondition</span></a></span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>            </span><span class="hs-comment">{- The list of postconditions (used for guiding action selection) -}</span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-type">PotentialAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297822"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">]</span><span>  </span><span class="hs-comment">{- A list of actions that we could perform -}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Edge discovery mechanism. A newtype wrapper over 'ActionProviderFn'.</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- An 'ActionProviderFn' takes two arguments. The first is the set of predicates</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- that exist in the current database.</span><span>
</span><span id="line-224"></span><span class="hs-comment">--</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- The function should a set of edges from the database specified in the first</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- argument to possible destination databases. For optimization purposes, the</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- second argument is the set of predicates that ought to exist in the</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- destination database. This can be used to eliminate edges that will not lead</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- to a solution.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- This second argument is just an optimization and doesn't change the final</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- result, although it can significantly impact the time it takes to get there.</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- Both the current database set and the destination database set are given as</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- polymorphic lists of predicates. When you instantiate the type, the current</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- database predicate set is queried for predicates of that type.</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- For example, 'dropTableActionProvider' provides a @DROP TABLE@ action edge</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- whenever it encounters a table that exists. In order to do this, it attempts</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- to find all 'TableExistsPredicate' that do not exist in the destination</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- database. Its 'ActionProviderFn' may be implemented like such:</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- &gt; dropTableActionProvider preConditions postConditions = do</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- &gt;     TableExistsPredicate srcTblNm &lt;- preConditions</span><span>
</span><span id="line-245"></span><span class="hs-comment">-- &gt;     ensuringNot_ $ $</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- &gt;       do TableExistsPredicate destTblNm &lt;- postConditions</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- &gt;          guard (srcTblNm == destTblNm)</span><span>
</span><span id="line-248"></span><span class="hs-comment">--</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- 'ensuringNot_' is a function that causes the action provider to return no</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- results if there are any elements in the provided list. In this case, it's</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- used to stop @DROP TABLE@ action generation for tables which must be present</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- in the final database.</span><span>
</span><span id="line-253"></span><span class="hs-keyword">newtype</span><span> </span><span id="ActionProvider"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span></span><span> </span><span id="local-6989586621679298163"><span class="annot"><a href="#local-6989586621679298163"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ActionProvider"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getPotentialActions"><span class="annot"><span class="annottext">ActionProvider be -&gt; ActionProviderFn be
</span><a href="Database.Beam.Migrate.Actions.html#getPotentialActions"><span class="hs-identifier hs-var hs-var">getPotentialActions</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298163"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span id="local-6989586621679297818"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297813"><span id="local-6989586621679297815"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297818"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679297812"><span class="annot"><span class="annottext">&lt;&gt; :: ActionProvider be -&gt; ActionProvider be -&gt; ActionProvider be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProvider be -&gt; ActionProvider be -&gt; ActionProvider be
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span id="local-6989586621679297811"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679297806"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297811"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621679297805"><span class="annot"><span class="annottext">mempty :: ActionProvider be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679297804"><span class="annot"><span class="annottext">mappend :: ActionProvider be -&gt; ActionProvider be -&gt; ActionProvider be
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span id="local-6989586621679297803"><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297803"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span id="local-6989586621679297802"><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297802"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">(ActionProviderFn be -&gt; ActionProvider be)
-&gt; ActionProviderFn be -&gt; ActionProvider be
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679297801"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297801"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679297800"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297800"><span class="hs-identifier hs-var">post</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297799"><span class="annot"><span class="annottext">aRes :: [PotentialAction be]
</span><a href="#local-6989586621679297799"><span class="hs-identifier hs-var hs-var">aRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297803"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297801"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297800"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span id="local-6989586621679297798"><span class="annot"><span class="annottext">bRes :: [PotentialAction be]
</span><a href="#local-6989586621679297798"><span class="hs-identifier hs-var hs-var">bRes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297802"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297801"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297800"><span class="hs-identifier hs-var">post</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Strategy [PotentialAction be]
-&gt; [PotentialAction be] -&gt; [PotentialAction be]
forall a. Strategy a -&gt; a -&gt; a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">withStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy [PotentialAction be] -&gt; Strategy [PotentialAction be]
forall a. Strategy a -&gt; Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rparWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy (PotentialAction be) -&gt; Strategy [PotentialAction be]
forall a. Strategy a -&gt; Strategy [a]
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">parList</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy (PotentialAction be)
forall a. Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rseq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
</span><a href="#local-6989586621679297799"><span class="hs-identifier hs-var">aRes</span></a></span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
-&gt; [PotentialAction be] -&gt; [PotentialAction be]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span>
</span><span id="line-267"></span><span>       </span><span class="annot"><span class="annottext">Strategy [PotentialAction be]
-&gt; [PotentialAction be] -&gt; [PotentialAction be]
forall a. Strategy a -&gt; a -&gt; a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">withStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy [PotentialAction be] -&gt; Strategy [PotentialAction be]
forall a. Strategy a -&gt; Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rparWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy (PotentialAction be) -&gt; Strategy [PotentialAction be]
forall a. Strategy a -&gt; Strategy [a]
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">parList</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy (PotentialAction be)
forall a. Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rseq</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
</span><a href="#local-6989586621679297798"><span class="hs-identifier hs-var">bRes</span></a></span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
-&gt; [PotentialAction be] -&gt; [PotentialAction be]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span>
</span><span id="line-268"></span><span>       </span><span class="annot"><span class="annottext">[PotentialAction be]
</span><a href="#local-6989586621679297799"><span class="hs-identifier hs-var">aRes</span></a></span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
-&gt; [PotentialAction be] -&gt; [PotentialAction be]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
</span><a href="#local-6989586621679297798"><span class="hs-identifier hs-var">bRes</span></a></span></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#createTableWeight"><span class="hs-identifier hs-type">createTableWeight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropTableWeight"><span class="hs-identifier hs-type">dropTableWeight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#addColumnWeight"><span class="hs-identifier hs-type">addColumnWeight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropColumnWeight"><span class="hs-identifier hs-type">dropColumnWeight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-271"></span><span id="createTableWeight"><span class="annot"><span class="annottext">createTableWeight :: Int
</span><a href="Database.Beam.Migrate.Actions.html#createTableWeight"><span class="hs-identifier hs-var hs-var">createTableWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">500</span></span><span>
</span><span id="line-272"></span><span id="dropTableWeight"><span class="annot"><span class="annottext">dropTableWeight :: Int
</span><a href="Database.Beam.Migrate.Actions.html#dropTableWeight"><span class="hs-identifier hs-var hs-var">dropTableWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span>
</span><span id="line-273"></span><span id="addColumnWeight"><span class="annot"><span class="annottext">addColumnWeight :: Int
</span><a href="Database.Beam.Migrate.Actions.html#addColumnWeight"><span class="hs-identifier hs-var hs-var">addColumnWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-274"></span><span id="dropColumnWeight"><span class="annot"><span class="annottext">dropColumnWeight :: Int
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnWeight"><span class="hs-identifier hs-var hs-var">dropColumnWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Proceeds only if no predicate matches the given pattern. See the</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- implementation of 'dropTableActionProvider' for an example of usage.</span><span>
</span><span id="line-278"></span><span id="local-6989586621679298140"><span id="local-6989586621679298141"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-type">ensuringNot_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Alternative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298140"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679298141"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-279"></span><span id="ensuringNot_"><span class="annot"><span class="annottext">ensuringNot_ :: [a] -&gt; m ()
</span><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-var hs-var">ensuringNot_</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-var">ensuringNot_</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m ()
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-comment">-- | Used to ensure that only one predicate matches the given pattern. See the</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- implementation of 'createTableActionProvider' for an example of usage.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679298122"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#justOne_"><span class="hs-identifier hs-type">justOne_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298122"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298122"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-285"></span><span id="justOne_"><span class="annot"><span class="annottext">justOne_ :: [a] -&gt; [a]
</span><a href="Database.Beam.Migrate.Actions.html#justOne_"><span class="hs-identifier hs-var hs-var">justOne_</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679297788"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679297788"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679297788"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-286"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#justOne_"><span class="hs-identifier hs-var">justOne_</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Action provider for SQL92 @CREATE TABLE@ actions.</span><span>
</span><span id="line-289"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#createTableActionProvider"><span class="hs-identifier hs-type">createTableActionProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679298068"><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-290"></span><span>                           </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-292"></span><span id="createTableActionProvider"><span class="annot"><span class="annottext">createTableActionProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#createTableActionProvider"><span class="hs-identifier hs-var hs-var">createTableActionProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297787"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="#local-6989586621679297787"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621679297787"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297787"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297786"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297786"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span id="local-6989586621679297785"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297785"><span class="hs-identifier hs-var">findPostConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297784"><span class="annot"><span class="annottext">tblP :: TableExistsPredicate
</span><a href="#local-6989586621679297784"><span class="hs-identifier hs-var">tblP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297782"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297785"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-298"></span><span>         </span><span class="hs-comment">-- Make sure there's no corresponding predicate in the precondition</span><span>
</span><span id="line-299"></span><span>         </span><span class="annot"><span class="annottext">[()] -&gt; [()]
forall (m :: * -&gt; *) a. Alternative m =&gt; [a] -&gt; m ()
</span><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-var">ensuringNot_</span></a></span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-300"></span><span>           </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297781"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297781"><span class="hs-identifier hs-var">preTblNm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297786"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-301"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297781"><span class="hs-identifier hs-var">preTblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679297780"><span class="annot"><span class="annottext">[[SomeDatabasePredicate]]
</span><a href="#local-6989586621679297780"><span class="hs-identifier hs-var">columnsP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297779"><span class="annot"><span class="annottext">[(Text,
  Sql92ColumnSchemaColumnTypeSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
</span><a href="#local-6989586621679297779"><span class="hs-identifier hs-var">columns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([[SomeDatabasePredicate]],
 [(Text,
   Sql92ColumnSchemaColumnTypeSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
   [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
-&gt; [([[SomeDatabasePredicate]],
     [(Text,
       Sql92ColumnSchemaColumnTypeSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
       [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(([[SomeDatabasePredicate]],
  [(Text,
    Sql92ColumnSchemaColumnTypeSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
    [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
 -&gt; [([[SomeDatabasePredicate]],
      [(Text,
        Sql92ColumnSchemaColumnTypeSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
        [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
           (Sql92CreateTableColumnSchemaSyntax
              (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])])
-&gt; ([([SomeDatabasePredicate],
      (Text,
       Sql92ColumnSchemaColumnTypeSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
       [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
    -&gt; ([[SomeDatabasePredicate]],
        [(Text,
          Sql92ColumnSchemaColumnTypeSyntax
            (Sql92CreateTableColumnSchemaSyntax
               (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
          [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
             (Sql92CreateTableColumnSchemaSyntax
                (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]))
-&gt; [([SomeDatabasePredicate],
     (Text,
      Sql92ColumnSchemaColumnTypeSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
-&gt; [([[SomeDatabasePredicate]],
     [(Text,
       Sql92ColumnSchemaColumnTypeSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
       [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[([SomeDatabasePredicate],
  (Text,
   Sql92ColumnSchemaColumnTypeSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
   [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
-&gt; ([[SomeDatabasePredicate]],
    [(Text,
      Sql92ColumnSchemaColumnTypeSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([([SomeDatabasePredicate],
   (Text,
    Sql92ColumnSchemaColumnTypeSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
    [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
 -&gt; [([[SomeDatabasePredicate]],
      [(Text,
        Sql92ColumnSchemaColumnTypeSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
        [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
           (Sql92CreateTableColumnSchemaSyntax
              (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])])
-&gt; [([SomeDatabasePredicate],
     (Text,
      Sql92ColumnSchemaColumnTypeSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
-&gt; [([[SomeDatabasePredicate]],
     [(Text,
       Sql92ColumnSchemaColumnTypeSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
       [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
          (Sql92CreateTableColumnSchemaSyntax
             (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-304"></span><span>           </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297776"><span class="annot"><span class="annottext">columnP :: TableHasColumn be
</span><a href="#local-6989586621679297776"><span class="hs-identifier hs-var">columnP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297774"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297774"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297773"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297773"><span class="hs-identifier hs-var">colNm</span></a></span></span><span> </span><span id="local-6989586621679297772"><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297772"><span class="hs-identifier hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-305"></span><span>                </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297785"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-306"></span><span>              </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297774"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
-&gt; (forall preCondition. Typeable preCondition =&gt; [preCondition])
-&gt; Bool
forall dataType.
HasDataTypeCreatedCheck dataType =&gt;
dataType
-&gt; (forall preCondition. Typeable preCondition =&gt; [preCondition])
-&gt; Bool
</span><a href="Database.Beam.Migrate.Checks.html#dataTypeHasBeenCreated"><span class="hs-identifier hs-var">dataTypeHasBeenCreated</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297772"><span class="hs-identifier hs-var">schema</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297786"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span>              </span><span class="hs-special">(</span><span id="local-6989586621679297769"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297769"><span class="hs-identifier hs-var">constraintsP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297768"><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297768"><span class="hs-identifier hs-var">constraints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-309"></span><span>                </span><span class="annot"><span class="annottext">([SomeDatabasePredicate],
 [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(([SomeDatabasePredicate],
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
 -&gt; [([SomeDatabasePredicate],
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
-&gt; ([(SomeDatabasePredicate,
      Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
    -&gt; ([SomeDatabasePredicate],
        [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
           (Sql92CreateTableColumnSchemaSyntax
              (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(SomeDatabasePredicate,
  Sql92ColumnSchemaColumnConstraintDefinitionSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; ([SomeDatabasePredicate],
    [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(SomeDatabasePredicate,
   Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
 -&gt; [([SomeDatabasePredicate],
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-310"></span><span>                </span><span id="local-6989586621679297767"><span class="annot"><span class="annottext">constraintP :: TableColumnHasConstraint be
</span><a href="#local-6989586621679297767"><span class="hs-identifier hs-var">constraintP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span id="local-6989586621679297765"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297765"><span class="hs-identifier hs-var">tblNm'</span></a></span></span><span> </span><span id="local-6989586621679297764"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297764"><span class="hs-identifier hs-var">colNm'</span></a></span></span><span> </span><span id="local-6989586621679297763"><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnConstraintDefinitionSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297763"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298068"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-311"></span><span>                  </span><span class="annot"><span class="annottext">[TableColumnHasConstraint be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297785"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-312"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297765"><span class="hs-identifier hs-var">tblNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297773"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297764"><span class="hs-identifier hs-var">colNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>                </span><span class="annot"><span class="annottext">(SomeDatabasePredicate,
 Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableColumnHasConstraint be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TableColumnHasConstraint be
</span><a href="#local-6989586621679297767"><span class="hs-identifier hs-var">constraintP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnConstraintDefinitionSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297763"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>              </span><span class="annot"><span class="annottext">([SomeDatabasePredicate],
 (Text,
  Sql92ColumnSchemaColumnTypeSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))
-&gt; [([SomeDatabasePredicate],
     (Text,
      Sql92ColumnSchemaColumnTypeSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableHasColumn be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TableHasColumn be
</span><a href="#local-6989586621679297776"><span class="hs-identifier hs-var">columnP</span></a></span><span class="annot"><span class="annottext">SomeDatabasePredicate
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297769"><span class="hs-identifier hs-var">constraintsP</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297773"><span class="hs-identifier hs-var">colNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297772"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297768"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679297761"><span class="annot"><span class="annottext">TableHasPrimaryKey
</span><a href="#local-6989586621679297761"><span class="hs-identifier hs-var">primaryKeyP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297760"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679297760"><span class="hs-identifier hs-var">primaryKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(TableHasPrimaryKey, [Text])] -&gt; [(TableHasPrimaryKey, [Text])]
forall a. [a] -&gt; [a]
</span><a href="Database.Beam.Migrate.Actions.html#justOne_"><span class="hs-identifier hs-var">justOne_</span></a></span><span> </span><span class="annot"><span class="annottext">([(TableHasPrimaryKey, [Text])] -&gt; [(TableHasPrimaryKey, [Text])])
-&gt; [(TableHasPrimaryKey, [Text])] -&gt; [(TableHasPrimaryKey, [Text])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>           </span><span id="local-6989586621679297759"><span class="annot"><span class="annottext">primaryKeyP :: TableHasPrimaryKey
</span><a href="#local-6989586621679297759"><span class="hs-identifier hs-var">primaryKeyP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasPrimaryKey"><span class="hs-identifier hs-type">TableHasPrimaryKey</span></a></span><span> </span><span id="local-6989586621679297757"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297757"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297756"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679297756"><span class="hs-identifier hs-var">primaryKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-320"></span><span>             </span><span class="annot"><span class="annottext">[TableHasPrimaryKey]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297785"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-321"></span><span>           </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297757"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>           </span><span class="annot"><span class="annottext">(TableHasPrimaryKey, [Text]) -&gt; [(TableHasPrimaryKey, [Text])]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableHasPrimaryKey
</span><a href="#local-6989586621679297759"><span class="hs-identifier hs-var">primaryKeyP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679297756"><span class="hs-identifier hs-var">primaryKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297755"><span class="annot"><span class="annottext">postConditions :: [SomeDatabasePredicate]
</span><a href="#local-6989586621679297755"><span class="hs-identifier hs-var hs-var">postConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TableExistsPredicate -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TableExistsPredicate
</span><a href="#local-6989586621679297784"><span class="hs-identifier hs-var">tblP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TableHasPrimaryKey -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TableHasPrimaryKey
</span><a href="#local-6989586621679297761"><span class="hs-identifier hs-var">primaryKeyP</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[[SomeDatabasePredicate]] -&gt; [SomeDatabasePredicate]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concat</span></a></span><span> </span><span class="annot"><span class="annottext">[[SomeDatabasePredicate]]
</span><a href="#local-6989586621679297780"><span class="hs-identifier hs-var">columnsP</span></a></span><span>
</span><span id="line-325"></span><span>             </span><span id="local-6989586621679297753"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297753"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandCreateTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#createTableCmd"><span class="hs-identifier hs-var">createTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe
  (Sql92CreateTableOptionsSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
-&gt; Sql92CreateTableTableNameSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
-&gt; [(Text,
     Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
-&gt; [Sql92CreateTableTableConstraintSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))]
-&gt; Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92CreateTableSyntax syntax =&gt;
Maybe (Sql92CreateTableOptionsSyntax syntax)
-&gt; Sql92CreateTableTableNameSyntax syntax
-&gt; [(Text, Sql92CreateTableColumnSchemaSyntax syntax)]
-&gt; [Sql92CreateTableTableConstraintSyntax syntax]
-&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#createTableSyntax"><span class="hs-identifier hs-var">createTableSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (Sql92CreateTableOptionsSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92CreateTableTableNameSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text,
  Sql92CreateTableColumnSchemaSyntax
    (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297750"><span class="hs-identifier hs-var">colsSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">[Sql92CreateTableTableConstraintSyntax
   (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))]
</span><a href="#local-6989586621679297749"><span class="hs-identifier hs-var">tblConstraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>             </span><span id="local-6989586621679297749"><span class="annot"><span class="annottext">tblConstraints :: [Sql92CreateTableTableConstraintSyntax
   (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))]
</span><a href="#local-6989586621679297749"><span class="hs-identifier hs-var hs-var">tblConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679297760"><span class="hs-identifier hs-var">primaryKey</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">[Text]
-&gt; Sql92CreateTableTableConstraintSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
forall constraint.
IsSql92TableConstraintSyntax constraint =&gt;
[Text] -&gt; constraint
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#primaryKeyConstraintSyntax"><span class="hs-identifier hs-var">primaryKeyConstraintSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679297760"><span class="hs-identifier hs-var">primaryKey</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-327"></span><span>             </span><span id="local-6989586621679297750"><span class="annot"><span class="annottext">colsSyntax :: [(Text,
  Sql92CreateTableColumnSchemaSyntax
    (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297750"><span class="hs-identifier hs-var hs-var">colsSyntax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text,
  Sql92ColumnSchemaColumnTypeSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
 -&gt; (Text,
     Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
-&gt; [(Text,
     Sql92ColumnSchemaColumnTypeSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
-&gt; [(Text,
     Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679297746"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297746"><span class="hs-identifier hs-var">colNm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297745"><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297745"><span class="hs-identifier hs-var">type_</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297744"><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297744"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297746"><span class="hs-identifier hs-var">colNm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
-&gt; Maybe
     (Sql92ColumnSchemaExpressionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
-&gt; [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
-&gt; Maybe Text
-&gt; Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
forall columnSchema.
IsSql92ColumnSchemaSyntax columnSchema =&gt;
Sql92ColumnSchemaColumnTypeSyntax columnSchema
-&gt; Maybe (Sql92ColumnSchemaExpressionSyntax columnSchema)
-&gt; [Sql92ColumnSchemaColumnConstraintDefinitionSyntax columnSchema]
-&gt; Maybe Text
-&gt; columnSchema
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#columnSchemaSyntax"><span class="hs-identifier hs-var">columnSchemaSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnTypeSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297745"><span class="hs-identifier hs-var">type_</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (Sql92ColumnSchemaExpressionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297744"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Text,
  Sql92ColumnSchemaColumnTypeSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))),
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
</span><a href="#local-6989586621679297779"><span class="hs-identifier hs-var">columns</span></a></span><span>
</span><span id="line-328"></span><span>         </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297755"><span class="hs-identifier hs-var">postConditions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297753"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Create the table &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297782"><span class="hs-identifier hs-var">postTblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Database.Beam.Migrate.Actions.html#createTableWeight"><span class="hs-identifier hs-var">createTableWeight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | Action provider for SQL92 @DROP TABLE@ actions</span><span>
</span><span id="line-333"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropTableActionProvider"><span class="hs-identifier hs-type">dropTableActionProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679298066"><span class="annot"><a href="#local-6989586621679298066"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-334"></span><span>                         </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298066"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-335"></span><span>                        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298066"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-336"></span><span id="dropTableActionProvider"><span class="annot"><span class="annottext">dropTableActionProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropTableActionProvider"><span class="hs-identifier hs-var hs-var">dropTableActionProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297738"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-338"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>   </span><span class="hs-comment">-- Look for tables that exist as a precondition but not a post condition</span><span>
</span><span id="line-340"></span><span>   </span><span class="annot"><a href="#local-6989586621679297738"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298066"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-341"></span><span>   </span><span id="local-6989586621679297738"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297738"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297737"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297737"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span id="local-6989586621679297736"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297736"><span class="hs-identifier hs-var">findPostConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>     </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297735"><span class="annot"><span class="annottext">tblP :: TableExistsPredicate
</span><a href="#local-6989586621679297735"><span class="hs-identifier hs-var">tblP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297734"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297734"><span class="hs-identifier hs-var">preTblNm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297737"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="annottext">[()] -&gt; [()]
forall (m :: * -&gt; *) a. Alternative m =&gt; [a] -&gt; m ()
</span><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-var">ensuringNot_</span></a></span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297733"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297733"><span class="hs-identifier hs-var">postTblNm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297736"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-345"></span><span>             </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297734"><span class="hs-identifier hs-var">preTblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297733"><span class="hs-identifier hs-var">postTblNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679297732"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297732"><span class="hs-identifier hs-var">relatedPreds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-348"></span><span>          </span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]])
-&gt; [SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297731"><span class="annot"><span class="annottext">p' :: SomeDatabasePredicate
</span><a href="#local-6989586621679297731"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span id="local-6989586621679297729"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297729"><span class="hs-identifier hs-var">pred'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297737"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-349"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297729"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; TableExistsPredicate -&gt; Bool
forall p p'.
(DatabasePredicate p, DatabasePredicate p') =&gt;
p -&gt; p' -&gt; Bool
</span><a href="Database.Beam.Migrate.Types.Predicates.html#predicateCascadesDropOn"><span class="hs-operator hs-var">`predicateCascadesDropOn`</span></a></span><span> </span><span class="annot"><span class="annottext">TableExistsPredicate
</span><a href="#local-6989586621679297735"><span class="hs-identifier hs-var">tblP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>                    </span><span class="annot"><span class="annottext">SomeDatabasePredicate -&gt; [SomeDatabasePredicate]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SomeDatabasePredicate
</span><a href="#local-6989586621679297731"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-comment">-- Now, collect all preconditions that may be related to the dropped table</span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297727"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297727"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandDropTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandDropTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#dropTableCmd"><span class="hs-identifier hs-var">dropTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92DropTableTableNameSyntax
  (Sql92DdlCommandDropTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92DdlCommandDropTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92DropTableSyntax syntax =&gt;
Sql92DropTableTableNameSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#dropTableSyntax"><span class="hs-identifier hs-var">dropTableSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92DropTableTableNameSyntax
     (Sql92DdlCommandDropTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297734"><span class="hs-identifier hs-var">preTblNm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-comment">{-trace (&quot;Dropping table &quot; &lt;&gt; show preTblNm &lt;&gt; &quot; would drop &quot; &lt;&gt; show relatedPreds) $ -}</span><span>
</span><span id="line-355"></span><span>              </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableExistsPredicate -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-var">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">TableExistsPredicate
</span><a href="#local-6989586621679297735"><span class="hs-identifier hs-var">tblP</span></a></span><span class="annot"><span class="annottext">SomeDatabasePredicate
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297732"><span class="hs-identifier hs-var">relatedPreds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-356"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297727"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop table &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297734"><span class="hs-identifier hs-var">preTblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Database.Beam.Migrate.Actions.html#dropTableWeight"><span class="hs-identifier hs-var">dropTableWeight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">-- | Action provider for SQL92 @ALTER TABLE ... ADD COLUMN ...@ actions</span><span>
</span><span id="line-360"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#addColumnProvider"><span class="hs-identifier hs-type">addColumnProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679297723"><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-361"></span><span>                   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-363"></span><span id="addColumnProvider"><span class="annot"><span class="annottext">addColumnProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#addColumnProvider"><span class="hs-identifier hs-var hs-var">addColumnProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297722"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="#local-6989586621679297722"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621679297722"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297722"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297721"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297721"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span id="local-6989586621679297720"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297720"><span class="hs-identifier hs-var">findPostConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297719"><span class="annot"><span class="annottext">colP :: TableHasColumn be
</span><a href="#local-6989586621679297719"><span class="hs-identifier hs-var">colP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297718"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297717"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span></span><span> </span><span id="local-6989586621679297716"><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><a href="#local-6989586621679297716"><span class="hs-identifier hs-var">colType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297720"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-370"></span><span>         </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297715"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297715"><span class="hs-identifier hs-var">tblNm'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297721"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-371"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297715"><span class="hs-identifier hs-var">tblNm'</span></a></span><span>  </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
-&gt; (forall preCondition. Typeable preCondition =&gt; [preCondition])
-&gt; Bool
forall dataType.
HasDataTypeCreatedCheck dataType =&gt;
dataType
-&gt; (forall preCondition. Typeable preCondition =&gt; [preCondition])
-&gt; Bool
</span><a href="Database.Beam.Migrate.Checks.html#dataTypeHasBeenCreated"><span class="hs-identifier hs-var">dataTypeHasBeenCreated</span></a></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><a href="#local-6989586621679297716"><span class="hs-identifier hs-var">colType</span></a></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297721"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>         </span><span class="annot"><span class="annottext">[()] -&gt; [()]
forall (m :: * -&gt; *) a. Alternative m =&gt; [a] -&gt; m ()
</span><a href="Database.Beam.Migrate.Actions.html#ensuringNot_"><span class="hs-identifier hs-var">ensuringNot_</span></a></span><span> </span><span class="annot"><span class="annottext">([()] -&gt; [()]) -&gt; [()] -&gt; [()]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>           </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297714"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297714"><span class="hs-identifier hs-var">tblNm''</span></a></span></span><span> </span><span id="local-6989586621679297713"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297713"><span class="hs-identifier hs-var">colNm'</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-374"></span><span>             </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297721"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-375"></span><span>           </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297714"><span class="hs-identifier hs-var">tblNm''</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297713"><span class="hs-identifier hs-var">colNm'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- This column exists as a different type</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679297712"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297712"><span class="hs-identifier hs-var">constraintsP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297711"><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297711"><span class="hs-identifier hs-var">constraints</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-378"></span><span>           </span><span class="annot"><span class="annottext">([SomeDatabasePredicate],
 [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(([SomeDatabasePredicate],
  [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
 -&gt; [([SomeDatabasePredicate],
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
-&gt; ([(SomeDatabasePredicate,
      Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
    -&gt; ([SomeDatabasePredicate],
        [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
           (Sql92CreateTableColumnSchemaSyntax
              (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]))
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(SomeDatabasePredicate,
  Sql92ColumnSchemaColumnConstraintDefinitionSyntax
    (Sql92CreateTableColumnSchemaSyntax
       (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; ([SomeDatabasePredicate],
    [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(SomeDatabasePredicate,
   Sql92ColumnSchemaColumnConstraintDefinitionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
 -&gt; [([SomeDatabasePredicate],
      [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
         (Sql92CreateTableColumnSchemaSyntax
            (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])])
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
-&gt; [([SomeDatabasePredicate],
     [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))])]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-379"></span><span>           </span><span id="local-6989586621679297710"><span class="annot"><span class="annottext">constraintP :: TableColumnHasConstraint be
</span><a href="#local-6989586621679297710"><span class="hs-identifier hs-var">constraintP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span id="local-6989586621679297709"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297709"><span class="hs-identifier hs-var">tblNm''</span></a></span></span><span> </span><span id="local-6989586621679297708"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297708"><span class="hs-identifier hs-var">colNm'</span></a></span></span><span> </span><span id="local-6989586621679297707"><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnConstraintDefinitionSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297707"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297723"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-380"></span><span>             </span><span class="annot"><span class="annottext">[TableColumnHasConstraint be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297720"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-381"></span><span>           </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297709"><span class="hs-identifier hs-var">tblNm''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>           </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297708"><span class="hs-identifier hs-var">colNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span>           </span><span class="annot"><span class="annottext">(SomeDatabasePredicate,
 Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
-&gt; [(SomeDatabasePredicate,
     Sql92ColumnSchemaColumnConstraintDefinitionSyntax
       (Sql92CreateTableColumnSchemaSyntax
          (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableColumnHasConstraint be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#p"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">TableColumnHasConstraint be
</span><a href="#local-6989586621679297710"><span class="hs-identifier hs-var">constraintP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Sql92ColumnSchemaColumnConstraintDefinitionSyntax
  (Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))
</span><a href="#local-6989586621679297707"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297706"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297706"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandAlterTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableCmd"><span class="hs-identifier hs-var">alterTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92AlterTableTableNameSyntax
  (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92AlterTableSyntax syntax =&gt;
Sql92AlterTableTableNameSyntax syntax
-&gt; Sql92AlterTableAlterTableActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableSyntax"><span class="hs-identifier hs-var">alterTableSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92AlterTableTableNameSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Sql92AlterTableColumnSchemaSyntax
     (Sql92AlterTableAlterTableActionSyntax
        (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92AlterTableActionSyntax syntax =&gt;
Text -&gt; Sql92AlterTableColumnSchemaSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#addColumnSyntax"><span class="hs-identifier hs-var">addColumnSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92AlterTableColumnSchemaSyntax
  (Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
Sql92CreateTableColumnSchemaSyntax
  (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
</span><a href="#local-6989586621679297702"><span class="hs-identifier hs-var">schema</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>             </span><span id="local-6989586621679297702"><span class="annot"><span class="annottext">schema :: Sql92CreateTableColumnSchemaSyntax
  (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
</span><a href="#local-6989586621679297702"><span class="hs-identifier hs-var hs-var">schema</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
-&gt; Maybe
     (Sql92ColumnSchemaExpressionSyntax
        (Sql92CreateTableColumnSchemaSyntax
           (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
-&gt; [Sql92ColumnSchemaColumnConstraintDefinitionSyntax
      (Sql92CreateTableColumnSchemaSyntax
         (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
-&gt; Maybe Text
-&gt; Sql92CreateTableColumnSchemaSyntax
     (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))
forall columnSchema.
IsSql92ColumnSchemaSyntax columnSchema =&gt;
Sql92ColumnSchemaColumnTypeSyntax columnSchema
-&gt; Maybe (Sql92ColumnSchemaExpressionSyntax columnSchema)
-&gt; [Sql92ColumnSchemaColumnConstraintDefinitionSyntax columnSchema]
-&gt; Maybe Text
-&gt; columnSchema
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#columnSchemaSyntax"><span class="hs-identifier hs-var">columnSchemaSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><a href="#local-6989586621679297716"><span class="hs-identifier hs-var">colType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe
  (Sql92ColumnSchemaExpressionSyntax
     (Sql92CreateTableColumnSchemaSyntax
        (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be))))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="annot"><span class="annottext">[Sql92ColumnSchemaColumnConstraintDefinitionSyntax
   (Sql92CreateTableColumnSchemaSyntax
      (Sql92DdlCommandCreateTableSyntax (BeamSqlBackendSyntax be)))]
</span><a href="#local-6989586621679297711"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-388"></span><span>         </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableHasColumn be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-var">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">TableHasColumn be
</span><a href="#local-6989586621679297719"><span class="hs-identifier hs-var">colP</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297712"><span class="hs-identifier hs-var">constraintsP</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297706"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Add column &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; to &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Database.Beam.Migrate.Actions.html#addColumnWeight"><span class="hs-identifier hs-var">addColumnWeight</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297718"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297717"><span class="hs-identifier hs-var">colNm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Action provider for SQL92 @ALTER TABLE ... DROP COLUMN ...@ actions</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropColumnProvider"><span class="hs-identifier hs-type">dropColumnProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679297699"><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-395"></span><span>                    </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-397"></span><span id="dropColumnProvider"><span class="annot"><span class="annottext">dropColumnProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnProvider"><span class="hs-identifier hs-var hs-var">dropColumnProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297698"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><a href="#local-6989586621679297698"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621679297698"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297698"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297697"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297697"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-401"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297696"><span class="annot"><span class="annottext">colP :: TableHasColumn be
</span><a href="#local-6989586621679297696"><span class="hs-identifier hs-var">colP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297695"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297695"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297694"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297694"><span class="hs-identifier hs-var">colNm</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297699"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297697"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">--         TableExistsPredicate tblNm' &lt;- trace (&quot;COnsider drop &quot; &lt;&gt; show tblNm &lt;&gt; &quot; &quot; &lt;&gt; show colNm)  findPreConditions</span><span>
</span><span id="line-405"></span><span class="hs-comment">--         guard (any (\(TableExistsPredicate tblNm') -&gt; tblNm' == tblNm) findPreConditions) --tblNm' == tblNm)</span><span>
</span><span id="line-406"></span><span class="hs-comment">--         ensuringNot_ $ do</span><span>
</span><span id="line-407"></span><span class="hs-comment">--           TableHasColumn tblNm' colNm' colType' :: TableHasColumn (Sql92DdlCommandColumnSchemaSyntax cmd) &lt;-</span><span>
</span><span id="line-408"></span><span class="hs-comment">--             findPostConditions</span><span>
</span><span id="line-409"></span><span class="hs-comment">--           guard (tblNm' == tblNm &amp;&amp; colNm == colNm' &amp;&amp; colType == colType') -- This column exists as a different type</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span>         </span><span id="local-6989586621679297693"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297693"><span class="hs-identifier hs-var">relatedPreds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-comment">--pure []</span><span>
</span><span id="line-412"></span><span>           </span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]])
-&gt; [SomeDatabasePredicate] -&gt; [[SomeDatabasePredicate]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297692"><span class="annot"><span class="annottext">p' :: SomeDatabasePredicate
</span><a href="#local-6989586621679297692"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span id="local-6989586621679297691"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297691"><span class="hs-identifier hs-var">pred'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297697"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-413"></span><span>                     </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297691"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; TableHasColumn be -&gt; Bool
forall p p'.
(DatabasePredicate p, DatabasePredicate p') =&gt;
p -&gt; p' -&gt; Bool
</span><a href="Database.Beam.Migrate.Types.Predicates.html#predicateCascadesDropOn"><span class="hs-operator hs-var">`predicateCascadesDropOn`</span></a></span><span> </span><span class="annot"><span class="annottext">TableHasColumn be
</span><a href="#local-6989586621679297696"><span class="hs-identifier hs-var">colP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>                     </span><span class="annot"><span class="annottext">SomeDatabasePredicate -&gt; [SomeDatabasePredicate]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SomeDatabasePredicate
</span><a href="#local-6989586621679297692"><span class="hs-identifier hs-var">p'</span></a></span><span>
</span><span id="line-415"></span><span>
</span><span id="line-416"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297690"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297690"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandAlterTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableCmd"><span class="hs-identifier hs-var">alterTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92AlterTableTableNameSyntax
  (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92AlterTableSyntax syntax =&gt;
Sql92AlterTableTableNameSyntax syntax
-&gt; Sql92AlterTableAlterTableActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableSyntax"><span class="hs-identifier hs-var">alterTableSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92AlterTableTableNameSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297695"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92AlterTableActionSyntax syntax =&gt;
Text -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#dropColumnSyntax"><span class="hs-identifier hs-var">dropColumnSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297694"><span class="hs-identifier hs-var">colNm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>         </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TableHasColumn be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-var">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">TableHasColumn be
</span><a href="#local-6989586621679297696"><span class="hs-identifier hs-var">colP</span></a></span><span class="annot"><span class="annottext">SomeDatabasePredicate
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297693"><span class="hs-identifier hs-var">relatedPreds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-418"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297690"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationLosesData"><span class="hs-identifier hs-var">MigrationLosesData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop column &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297694"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; from &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297695"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnWeight"><span class="hs-identifier hs-var">dropColumnWeight</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297695"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297694"><span class="hs-identifier hs-var">colNm</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Action provider for SQL92 @ALTER TABLE ... ALTER COLUMN ... SET NULL@</span><span>
</span><span id="line-423"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#addColumnNullProvider"><span class="hs-identifier hs-type">addColumnNullProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679297688"><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-424"></span><span>                       </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-426"></span><span id="addColumnNullProvider"><span class="annot"><span class="annottext">addColumnNullProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#addColumnNullProvider"><span class="hs-identifier hs-var hs-var">addColumnNullProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297687"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span class="annot"><a href="#local-6989586621679297687"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679297687"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297687"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297686"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297686"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span id="local-6989586621679297685"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297685"><span class="hs-identifier hs-var">findPostConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-430"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297684"><span class="annot"><span class="annottext">colP :: TableColumnHasConstraint be
</span><a href="#local-6989586621679297684"><span class="hs-identifier hs-var">colP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span id="local-6989586621679297683"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297683"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297682"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297682"><span class="hs-identifier hs-var">colNm</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendColumnConstraintDefinitionSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableColumnHasConstraint be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297685"><span class="hs-identifier hs-var">findPostConditions</span></a></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- TODO         guard (c == notNullConstraintSyntax)</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span>         </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297681"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297681"><span class="hs-identifier hs-var">tblNm'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297686"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-435"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297683"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297681"><span class="hs-identifier hs-var">tblNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span>         </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297680"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297680"><span class="hs-identifier hs-var">tblNm''</span></a></span></span><span> </span><span id="local-6989586621679297679"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297679"><span class="hs-identifier hs-var">colNm'</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297688"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-438"></span><span>           </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297686"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-439"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297683"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297680"><span class="hs-identifier hs-var">tblNm''</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297682"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297679"><span class="hs-identifier hs-var">colNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297678"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297678"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandAlterTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableCmd"><span class="hs-identifier hs-var">alterTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92AlterTableTableNameSyntax
  (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92AlterTableSyntax syntax =&gt;
Sql92AlterTableTableNameSyntax syntax
-&gt; Sql92AlterTableAlterTableActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableSyntax"><span class="hs-identifier hs-var">alterTableSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92AlterTableTableNameSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297683"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Sql92AlterTableAlterColumnActionSyntax
     (Sql92AlterTableAlterTableActionSyntax
        (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92AlterTableActionSyntax syntax =&gt;
Text -&gt; Sql92AlterTableAlterColumnActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterColumnSyntax"><span class="hs-identifier hs-var">alterColumnSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297682"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92AlterTableAlterColumnActionSyntax
  (Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
forall syntax. IsSql92AlterColumnActionSyntax syntax =&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#setNotNullSyntax"><span class="hs-identifier hs-var">setNotNullSyntax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>         </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableColumnHasConstraint be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-var">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">TableColumnHasConstraint be
</span><a href="#local-6989586621679297684"><span class="hs-identifier hs-var">colP</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297678"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Add not null constraint to &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297682"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; on &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297683"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | Action provider for SQL92 @ALTER TABLE ... ALTER COLUMN ... SET  NOT NULL@</span><span>
</span><span id="line-447"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#dropColumnNullProvider"><span class="hs-identifier hs-type">dropColumnNullProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679297675"><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-448"></span><span>                        </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-450"></span><span id="dropColumnNullProvider"><span class="annot"><span class="annottext">dropColumnNullProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnNullProvider"><span class="hs-identifier hs-var hs-var">dropColumnNullProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be -&gt; ActionProvider be
forall be. ActionProviderFn be -&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-var">ActionProvider</span></a></span><span> </span><span class="annot"><span class="annottext">ActionProviderFn be
</span><a href="#local-6989586621679297674"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="#local-6989586621679297674"><span class="hs-identifier hs-type">provider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProviderFn"><span class="hs-identifier hs-type">ActionProviderFn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span id="local-6989586621679297674"><span class="annot"><span class="annottext">provider :: ActionProviderFn be
</span><a href="#local-6989586621679297674"><span class="hs-identifier hs-var hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297673"><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297673"><span class="hs-identifier hs-var">findPreConditions</span></a></span></span><span> </span><span class="annot"><span class="annottext">forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679297672"><span class="annot"><span class="annottext">colP :: TableColumnHasConstraint be
</span><a href="#local-6989586621679297672"><span class="hs-identifier hs-var">colP</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span id="local-6989586621679297671"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297671"><span class="hs-identifier hs-var">tblNm</span></a></span></span><span> </span><span id="local-6989586621679297670"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297670"><span class="hs-identifier hs-var">colNm</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendColumnConstraintDefinitionSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableColumnHasConstraint"><span class="hs-identifier hs-type">TableColumnHasConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableColumnHasConstraint be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297673"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-456"></span><span class="hs-comment">-- TODO         guard (c == notNullConstraintSyntax)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span>         </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableExistsPredicate"><span class="hs-identifier hs-type">TableExistsPredicate</span></a></span><span> </span><span id="local-6989586621679297669"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297669"><span class="hs-identifier hs-var">tblNm'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TableExistsPredicate]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297673"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-459"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297671"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297669"><span class="hs-identifier hs-var">tblNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span>         </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span id="local-6989586621679297668"><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297668"><span class="hs-identifier hs-var">tblNm''</span></a></span></span><span> </span><span id="local-6989586621679297667"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297667"><span class="hs-identifier hs-var">colNm'</span></a></span></span><span> </span><span class="annot"><span class="annottext">BeamMigrateSqlBackendDataTypeSyntax be
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html#TableHasColumn"><span class="hs-identifier hs-type">TableHasColumn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297675"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-462"></span><span>           </span><span class="annot"><span class="annottext">[TableHasColumn be]
forall preCondition. Typeable preCondition =&gt; [preCondition]
</span><a href="#local-6989586621679297673"><span class="hs-identifier hs-var">findPreConditions</span></a></span><span>
</span><span id="line-463"></span><span>         </span><span class="annot"><span class="annottext">Bool -&gt; [()]
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297671"><span class="hs-identifier hs-var">tblNm</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; QualifiedName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297668"><span class="hs-identifier hs-var">tblNm''</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297670"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297667"><span class="hs-identifier hs-var">colNm'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297666"><span class="annot"><span class="annottext">cmd :: BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297666"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
-&gt; BeamSqlBackendSyntax be
forall syntax.
IsSql92DdlCommandSyntax syntax =&gt;
Sql92DdlCommandAlterTableSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableCmd"><span class="hs-identifier hs-var">alterTableCmd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Sql92AlterTableTableNameSyntax
  (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
-&gt; Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)
forall syntax.
IsSql92AlterTableSyntax syntax =&gt;
Sql92AlterTableTableNameSyntax syntax
-&gt; Sql92AlterTableAlterTableActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterTableSyntax"><span class="hs-identifier hs-var">alterTableSyntax</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedName
-&gt; Sql92AlterTableTableNameSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92TableNameSyntax syntax =&gt;
QualifiedName -&gt; syntax
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsTableName"><span class="hs-identifier hs-var">qnameAsTableName</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297671"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
-&gt; Sql92AlterTableAlterColumnActionSyntax
     (Sql92AlterTableAlterTableActionSyntax
        (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
-&gt; Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be))
forall syntax.
IsSql92AlterTableActionSyntax syntax =&gt;
Text -&gt; Sql92AlterTableAlterColumnActionSyntax syntax -&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#alterColumnSyntax"><span class="hs-identifier hs-var">alterColumnSyntax</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297670"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Sql92AlterTableAlterColumnActionSyntax
  (Sql92AlterTableAlterTableActionSyntax
     (Sql92DdlCommandAlterTableSyntax (BeamSqlBackendSyntax be)))
forall syntax. IsSql92AlterColumnActionSyntax syntax =&gt; syntax
</span><a href="Database.Beam.Migrate.SQL.SQL92.html#setNullSyntax"><span class="hs-identifier hs-var">setNullSyntax</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>         </span><span class="annot"><span class="annottext">PotentialAction be -&gt; [PotentialAction be]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
forall be.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; Text
-&gt; Int
-&gt; PotentialAction be
</span><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-var">PotentialAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TableColumnHasConstraint be -&gt; SomeDatabasePredicate
forall p. DatabasePredicate p =&gt; p -&gt; SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-var">SomeDatabasePredicate</span></a></span><span> </span><span class="annot"><span class="annottext">TableColumnHasConstraint be
</span><a href="#local-6989586621679297672"><span class="hs-identifier hs-var">colP</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-467"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MigrationCommand be -&gt; Seq (MigrationCommand be)
forall a. a -&gt; Seq a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Seq.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
forall be.
BeamSqlBackendSyntax be -&gt; MigrationDataLoss -&gt; MigrationCommand be
</span><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-var">MigrationCommand</span></a></span><span> </span><span class="annot"><span class="annottext">BeamSqlBackendSyntax be
</span><a href="#local-6989586621679297666"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">MigrationDataLoss
</span><a href="Database.Beam.Migrate.Types.html#MigrationKeepsData"><span class="hs-identifier hs-var">MigrationKeepsData</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>                               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Drop not null constraint for &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679297670"><span class="hs-identifier hs-var">colNm</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; on &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName -&gt; Text
</span><a href="Database.Beam.Migrate.Types.Predicates.html#qnameAsText"><span class="hs-identifier hs-var">qnameAsText</span></a></span><span> </span><span class="annot"><span class="annottext">QualifiedName
</span><a href="#local-6989586621679297671"><span class="hs-identifier hs-var">tblNm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Default action providers for any SQL92 compliant syntax.</span><span>
</span><span id="line-471"></span><span class="hs-comment">--</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- In particular, this provides edges consisting of the following statements:</span><span>
</span><span id="line-473"></span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span class="hs-comment">--  * CREATE TABLE</span><span>
</span><span id="line-475"></span><span class="hs-comment">--  * DROP TABLE</span><span>
</span><span id="line-476"></span><span class="hs-comment">--  * ALTER TABLE ... ADD COLUMN ...</span><span>
</span><span id="line-477"></span><span class="hs-comment">--  * ALTER TABLE ... DROP COLUMN ...</span><span>
</span><span id="line-478"></span><span class="hs-comment">--  * ALTER TABLE ... ALTER COLUMN ... SET [NOT] NULL</span><span>
</span><span id="line-479"></span><span id="local-6989586621679297664"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#defaultActionProvider"><span class="hs-identifier hs-type">defaultActionProvider</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297664"><span class="hs-identifier hs-type">be</span></a></span><span>
</span><span id="line-480"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.Types.html#BeamMigrateOnlySqlBackend"><span class="hs-identifier hs-type">BeamMigrateOnlySqlBackend</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297664"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297664"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-482"></span><span id="defaultActionProvider"><span class="annot"><span class="annottext">defaultActionProvider :: ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#defaultActionProvider"><span class="hs-identifier hs-var hs-var">defaultActionProvider</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-483"></span><span>  </span><span class="annot"><span class="annottext">[ActionProvider be] -&gt; ActionProvider be
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be.
(Typeable be, BeamMigrateOnlySqlBackend be) =&gt;
ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#createTableActionProvider"><span class="hs-identifier hs-var">createTableActionProvider</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be. BeamMigrateOnlySqlBackend be =&gt; ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropTableActionProvider"><span class="hs-identifier hs-var">dropTableActionProvider</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be.
(Typeable be, BeamMigrateOnlySqlBackend be) =&gt;
ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#addColumnProvider"><span class="hs-identifier hs-var">addColumnProvider</span></a></span><span>
</span><span id="line-488"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be.
(Typeable be, BeamMigrateOnlySqlBackend be) =&gt;
ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnProvider"><span class="hs-identifier hs-var">dropColumnProvider</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be.
(Typeable be, BeamMigrateOnlySqlBackend be) =&gt;
ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#addColumnNullProvider"><span class="hs-identifier hs-var">addColumnNullProvider</span></a></span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ActionProvider be
forall be.
(Typeable be, BeamMigrateOnlySqlBackend be) =&gt;
ActionProvider be
</span><a href="Database.Beam.Migrate.Actions.html#dropColumnNullProvider"><span class="hs-identifier hs-var">dropColumnNullProvider</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="hs-comment">-- | Represents current state of a database graph search.</span><span>
</span><span id="line-494"></span><span class="hs-comment">--</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- If 'ProvideSolution', the destination database has been reached, and the</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- given list of commands provides the path from the source database to the</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- destination.</span><span>
</span><span id="line-498"></span><span class="hs-comment">--</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- If 'SearchFailed', the search has failed. The provided 'DatabaseState's</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- represent the closest we could make it to the destination database. By</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- default, only the best 10 are kept around (to avoid unbounded memory growth).</span><span>
</span><span id="line-502"></span><span class="hs-comment">--</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- If 'ChooseActions', we are still searching. The caller is provided with the</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- current state as well as a list of actions, provided as an opaque type @f@.</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- The 'getPotentialActionChoice' function can be used to get the</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- 'PotentialAction' corresponding to any given @f@. The caller is free to cull</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- the set of potential actions according however they'd like (for example, by</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- prompting the user). The selected actions to explore should be passed to the</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- 'continueSearch' function.</span><span>
</span><span id="line-510"></span><span class="hs-comment">--</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- Use of the @f@ existential type may seem obtuse, but it prevents the caller</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- from injecting arbitrary actions. Instead the caller is limited to choosing</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- only valid actions as provided by the suppled 'ActionProvider'.</span><span>
</span><span id="line-514"></span><span class="hs-keyword">data</span><span> </span><span id="Solver"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-var">Solver</span></a></span></span><span> </span><span id="local-6989586621679297663"><span class="annot"><a href="#local-6989586621679297663"><span class="hs-identifier hs-type">cmd</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621679298022"><span id="ProvideSolution"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ProvideSolution"><span class="hs-identifier hs-var">ProvideSolution</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-type">MigrationCommand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298022"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298022"><span class="hs-identifier hs-type">cmd</span></a></span></span><span>
</span><span id="line-516"></span><span>  </span><span id="local-6989586621679298030"><span id="SearchFailed"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#SearchFailed"><span class="hs-identifier hs-var">SearchFailed</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298030"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298030"><span class="hs-identifier hs-type">cmd</span></a></span></span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621679297660"><span id="local-6989586621679298011"><span id="ChooseActions"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ChooseActions"><span class="hs-identifier hs-var">ChooseActions</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">{</span><span> </span><span id="choosingActionsAtState"><span class="annot"><span class="annottext">Solver cmd -&gt; DatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#choosingActionsAtState"><span class="hs-identifier hs-var hs-var">choosingActionsAtState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298011"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>                       </span><span class="hs-comment">-- ^ The current node we're searching at</span><span>
</span><span id="line-519"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="getPotentialActionChoice"><span class="annot"><span class="annottext">()
</span><a href="Database.Beam.Migrate.Actions.html#getPotentialActionChoice"><span class="hs-identifier hs-var hs-var">getPotentialActionChoice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679297660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#PotentialAction"><span class="hs-identifier hs-type">PotentialAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298011"><span class="hs-identifier hs-type">cmd</span></a></span><span>
</span><span id="line-520"></span><span>                       </span><span class="hs-comment">-- ^ Convert the opaque @f@ type to a 'PotentialAction'.</span><span>
</span><span id="line-521"></span><span>                       </span><span class="hs-comment">-- This can be used to present the actions to the user or</span><span>
</span><span id="line-522"></span><span>                       </span><span class="hs-comment">-- to inspect the action to make a more informed choice</span><span>
</span><span id="line-523"></span><span>                       </span><span class="hs-comment">-- on exploration strategies.</span><span>
</span><span id="line-524"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="potentialActionChoices"><span class="annot"><span class="annottext">()
</span><a href="Database.Beam.Migrate.Actions.html#potentialActionChoices"><span class="hs-identifier hs-var hs-var">potentialActionChoices</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679297660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-525"></span><span>                       </span><span class="hs-comment">-- ^ The possible actions that we can take, presented as</span><span>
</span><span id="line-526"></span><span>                       </span><span class="hs-comment">-- an opaque list. Use the 'getPotentialActionChoice'</span><span>
</span><span id="line-527"></span><span>                       </span><span class="hs-comment">-- function to get the corresponding 'PotentialAction'.</span><span>
</span><span id="line-528"></span><span>                     </span><span class="hs-special">,</span><span> </span><span id="continueSearch"><span class="annot"><span class="annottext">()
</span><a href="Database.Beam.Migrate.Actions.html#continueSearch"><span class="hs-identifier hs-var hs-var">continueSearch</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679297660"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298011"><span class="hs-identifier hs-type">cmd</span></a></span><span>
</span><span id="line-529"></span><span>                       </span><span class="hs-comment">-- ^ Continue the search and get the next 'Solver'</span><span>
</span><span id="line-530"></span><span>                     </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298011"><span class="hs-identifier hs-type">cmd</span></a></span></span></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">-- | Represents the final results of a search</span><span>
</span><span id="line-533"></span><span class="hs-keyword">data</span><span> </span><span id="FinalSolution"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#FinalSolution"><span class="hs-identifier hs-var">FinalSolution</span></a></span></span><span> </span><span id="local-6989586621679298059"><span class="annot"><a href="#local-6989586621679298059"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Solved"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solved"><span class="hs-identifier hs-var">Solved</span></a></span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html#MigrationCommand"><span class="hs-identifier hs-type">MigrationCommand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298059"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-comment">-- ^ The search found a path from the source to the destination database,</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-comment">-- and has provided a set of commands that would work</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Candidates"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Candidates"><span class="hs-identifier hs-var">Candidates</span></a></span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298059"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-comment">-- ^ The search failed, but provided a set of 'DatbaseState's it encountered</span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-comment">-- that were the closest to the destination database. By default, only 10</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-comment">-- candidates are provided.</span><span>
</span><span id="line-541"></span><span id="local-6989586621679297646"><span id="local-6989586621679297648"><span id="local-6989586621679297650"><span id="local-6989586621679297652"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../beam-core/html/src"><span class="hs-identifier hs-type">BeamSqlBackendSyntax</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297652"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#FinalSolution"><span class="hs-identifier hs-type">FinalSolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297652"><span class="hs-identifier hs-type">be</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">-- | Returns 'True' if the state has been solved</span><span>
</span><span id="line-544"></span><span id="local-6989586621679298023"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#solvedState"><span class="hs-identifier hs-type">solvedState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-type">HS.HashSet</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298023"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-545"></span><span id="solvedState"><span class="annot"><span class="annottext">solvedState :: HashSet SomeDatabasePredicate -&gt; DatabaseState be -&gt; Bool
</span><a href="Database.Beam.Migrate.Actions.html#solvedState"><span class="hs-identifier hs-var hs-var">solvedState</span></a></span></span><span> </span><span id="local-6989586621679297644"><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297644"><span class="hs-identifier hs-var">goal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297643"><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297643"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297644"><span class="hs-identifier hs-var">goal</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297643"><span class="hs-identifier hs-var">cur</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- | An exhaustive solving strategy that simply continues the search, while</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- exploring every possible action. If there is a solution, this will find it.</span><span>
</span><span id="line-549"></span><span id="local-6989586621679298057"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier hs-type">finalSolution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298057"><span class="hs-identifier hs-type">be</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#FinalSolution"><span class="hs-identifier hs-type">FinalSolution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298057"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-550"></span><span id="finalSolution"><span class="annot"><span class="annottext">finalSolution :: Solver be -&gt; FinalSolution be
</span><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier hs-var hs-var">finalSolution</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#SearchFailed"><span class="hs-identifier hs-type">SearchFailed</span></a></span><span> </span><span id="local-6989586621679297642"><span class="annot"><span class="annottext">[DatabaseState be]
</span><a href="#local-6989586621679297642"><span class="hs-identifier hs-var">sts</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DatabaseState be] -&gt; FinalSolution be
forall be. [DatabaseState be] -&gt; FinalSolution be
</span><a href="Database.Beam.Migrate.Actions.html#Candidates"><span class="hs-identifier hs-var">Candidates</span></a></span><span> </span><span class="annot"><span class="annottext">[DatabaseState be]
</span><a href="#local-6989586621679297642"><span class="hs-identifier hs-var">sts</span></a></span><span>
</span><span id="line-551"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier hs-var">finalSolution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ProvideSolution"><span class="hs-identifier hs-type">ProvideSolution</span></a></span><span> </span><span id="local-6989586621679297641"><span class="annot"><span class="annottext">[MigrationCommand be]
</span><a href="#local-6989586621679297641"><span class="hs-identifier hs-var">cmds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MigrationCommand be] -&gt; FinalSolution be
forall be. [MigrationCommand be] -&gt; FinalSolution be
</span><a href="Database.Beam.Migrate.Actions.html#Solved"><span class="hs-identifier hs-var">Solved</span></a></span><span> </span><span class="annot"><span class="annottext">[MigrationCommand be]
</span><a href="#local-6989586621679297641"><span class="hs-identifier hs-var">cmds</span></a></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier hs-var">finalSolution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ChooseActions"><span class="hs-identifier hs-type">ChooseActions</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; PotentialAction be
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297640"><span class="annot"><span class="annottext">[f]
</span><a href="#local-6989586621679297640"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span id="local-6989586621679297639"><span class="annot"><span class="annottext">[f] -&gt; Solver be
</span><a href="#local-6989586621679297639"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-553"></span><span>  </span><span class="annot"><span class="annottext">Solver be -&gt; FinalSolution be
forall be. Solver be -&gt; FinalSolution be
</span><a href="Database.Beam.Migrate.Actions.html#finalSolution"><span class="hs-identifier hs-var">finalSolution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[f] -&gt; Solver be
</span><a href="#local-6989586621679297639"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">[f]
</span><a href="#local-6989586621679297640"><span class="hs-identifier hs-var">actions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>
</span><span id="line-555"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#heuristicSolver"><span class="hs-pragma hs-type">heuristicSolver</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- | Conduct a breadth-first search of the database graph to find a path from</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- the source database to the destination database, using the given</span><span>
</span><span id="line-558"></span><span class="hs-comment">-- 'ActionProvider' to discovere &quot;edges&quot; (i.e., DDL commands) between the</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- databases.</span><span>
</span><span id="line-560"></span><span class="hs-comment">--</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- See the documentation on 'Solver' for more information on how to consume the</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- result.</span><span>
</span><span id="line-563"></span><span id="local-6989586621679297638"><span class="annot"><a href="Database.Beam.Migrate.Actions.html#heuristicSolver"><span class="hs-identifier hs-type">heuristicSolver</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#ActionProvider"><span class="hs-identifier hs-type">ActionProvider</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297638"><span class="hs-identifier hs-type">be</span></a></span><span>         </span><span class="hs-comment">-- ^ Edge discovery function</span><span>
</span><span id="line-564"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Source database state</span><span>
</span><span id="line-565"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Destination database state</span><span>
</span><span id="line-566"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#Solver"><span class="hs-identifier hs-type">Solver</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679297638"><span class="hs-identifier hs-type">be</span></a></span></span><span>
</span><span id="line-567"></span><span id="heuristicSolver"><span class="annot"><span class="annottext">heuristicSolver :: ActionProvider be
-&gt; [SomeDatabasePredicate] -&gt; [SomeDatabasePredicate] -&gt; Solver be
</span><a href="Database.Beam.Migrate.Actions.html#heuristicSolver"><span class="hs-identifier hs-var hs-var">heuristicSolver</span></a></span></span><span> </span><span id="local-6989586621679297637"><span class="annot"><span class="annottext">ActionProvider be
</span><a href="#local-6989586621679297637"><span class="hs-identifier hs-var">provider</span></a></span></span><span> </span><span id="local-6989586621679297636"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297636"><span class="hs-identifier hs-var">preConditionsL</span></a></span></span><span> </span><span id="local-6989586621679297635"><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297635"><span class="hs-identifier hs-var">postConditionsL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>  </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; Solver be
</span><a href="#local-6989586621679297634"><span class="hs-identifier hs-var">heuristicSolver'</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297633"><span class="hs-identifier hs-var">initQueue</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
forall a. MinQueue a
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.empty</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span class="hs-comment">-- Number of failed action chains to keep</span><span>
</span><span id="line-573"></span><span>    </span><span id="local-6989586621679297631"><span class="annot"><span class="annottext">rejectedCount :: Int
</span><a href="#local-6989586621679297631"><span class="hs-identifier hs-var hs-var">rejectedCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-574"></span><span>
</span><span id="line-575"></span><span>    </span><span id="local-6989586621679297630"><span class="annot"><span class="annottext">postConditions :: HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297630"><span class="hs-identifier hs-var hs-var">postConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297635"><span class="hs-identifier hs-var">postConditionsL</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span id="local-6989586621679297629"><span class="annot"><span class="annottext">preConditions :: HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297629"><span class="hs-identifier hs-var hs-var">preConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297636"><span class="hs-identifier hs-var">preConditionsL</span></a></span><span>
</span><span id="line-577"></span><span>    </span><span id="local-6989586621679297628"><span class="annot"><span class="annottext">allToFalsify :: HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297628"><span class="hs-identifier hs-var hs-var">allToFalsify</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297629"><span class="hs-identifier hs-var">preConditions</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate -&gt; HashSet SomeDatabasePredicate
forall a. (Eq a, Hashable a) =&gt; HashSet a -&gt; HashSet a -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297630"><span class="hs-identifier hs-var">postConditions</span></a></span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621679297627"><span class="annot"><span class="annottext">measureDb :: Int -&gt; DatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="#local-6989586621679297627"><span class="hs-identifier hs-var hs-var">measureDb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Int
-&gt; DatabaseState be
-&gt; MeasuredDatabaseState be
forall cmd.
HashSet SomeDatabasePredicate
-&gt; HashSet SomeDatabasePredicate
-&gt; Int
-&gt; DatabaseState cmd
-&gt; MeasuredDatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measureDb%27"><span class="hs-identifier hs-var">measureDb'</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297628"><span class="hs-identifier hs-var">allToFalsify</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297630"><span class="hs-identifier hs-var">postConditions</span></a></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>    </span><span id="local-6989586621679297633"><span class="annot"><span class="annottext">initQueue :: MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297633"><span class="hs-identifier hs-var hs-var">initQueue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be -&gt; MinQueue (MeasuredDatabaseState be)
forall a. a -&gt; MinQueue a
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; DatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="#local-6989586621679297627"><span class="hs-identifier hs-var">measureDb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297625"><span class="hs-identifier hs-var">initDbState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621679297625"><span class="annot"><span class="annottext">initDbState :: DatabaseState be
</span><a href="#local-6989586621679297625"><span class="hs-identifier hs-var hs-var">initDbState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; DatabaseState be
forall be.
HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; DatabaseState be
</span><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-var">DatabaseState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseStateSource
</span><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSourceOriginal"><span class="hs-identifier hs-var">DatabaseStateSourceOriginal</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate ()
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; HashMap SomeDatabasePredicate ()
forall a. HashSet a -&gt; HashMap a ()
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.toMap</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297629"><span class="hs-identifier hs-var">preConditions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>                                </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297629"><span class="hs-identifier hs-var">preConditions</span></a></span><span>
</span><span id="line-583"></span><span>                                </span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>    </span><span class="annot"><a href="#local-6989586621679297622"><span class="hs-identifier hs-type">findPredicate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679298032"><span class="annot"><a href="#local-6989586621679298032"><span class="hs-identifier hs-type">predicate</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298032"><span class="hs-identifier hs-type">predicate</span></a></span><span>
</span><span id="line-586"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span>
</span><span id="line-587"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298032"><span class="hs-identifier hs-type">predicate</span></a></span><span> </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298032"><span class="hs-identifier hs-type">predicate</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-588"></span><span>    </span><span id="local-6989586621679297622"><span class="annot"><span class="annottext">findPredicate :: SomeDatabasePredicate -&gt; [predicate] -&gt; [predicate]
</span><a href="#local-6989586621679297622"><span class="hs-identifier hs-var hs-var">findPredicate</span></a></span></span><span>
</span><span id="line-589"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">predicate :~: SomeDatabasePredicate
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679298032"><span class="hs-identifier hs-type">predicate</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-type">:~:</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (predicate :~: SomeDatabasePredicate)
forall k (a :: k) (b :: k).
(Typeable a, Typeable b) =&gt;
Maybe (a :~: b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">eqT</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-590"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>          </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span id="local-6989586621679297619"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297619"><span class="hs-identifier hs-var">pred'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679297618"><span class="annot"><span class="annottext">[predicate]
</span><a href="#local-6989586621679297618"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-593"></span><span>              </span><span class="annot"><span class="annottext">[predicate]
-&gt; (predicate -&gt; [predicate]) -&gt; Maybe predicate -&gt; [predicate]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">[predicate]
</span><a href="#local-6989586621679297618"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">predicate -&gt; [predicate] -&gt; [predicate]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[predicate]
</span><a href="#local-6989586621679297618"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; Maybe predicate
forall a b. (Typeable a, Typeable b) =&gt; a -&gt; Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">cast</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679297619"><span class="hs-identifier hs-var">pred'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><a href="#local-6989586621679297615"><span class="hs-identifier hs-type">findPredicates</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679298019"><span class="annot"><a href="#local-6989586621679298019"><span class="hs-identifier hs-type">predicate</span></a></span></span><span> </span><span id="local-6989586621679298018"><span class="annot"><a href="#local-6989586621679298018"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298019"><span class="hs-identifier hs-type">predicate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298018"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679298018"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.Predicates.html#SomeDatabasePredicate"><span class="hs-identifier hs-type">SomeDatabasePredicate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="#local-6989586621679298019"><span class="hs-identifier hs-type">predicate</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-597"></span><span>    </span><span id="local-6989586621679297615"><span class="annot"><span class="annottext">findPredicates :: f SomeDatabasePredicate -&gt; [predicate]
</span><a href="#local-6989586621679297615"><span class="hs-identifier hs-var hs-var">findPredicates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeDatabasePredicate -&gt; [predicate] -&gt; [predicate])
-&gt; [predicate] -&gt; f SomeDatabasePredicate -&gt; [predicate]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">SomeDatabasePredicate -&gt; [predicate] -&gt; [predicate]
forall predicate.
Typeable predicate =&gt;
SomeDatabasePredicate -&gt; [predicate] -&gt; [predicate]
</span><a href="#local-6989586621679297622"><span class="hs-identifier hs-var">findPredicate</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span>    </span><span id="local-6989586621679297634"><span class="annot"><span class="annottext">heuristicSolver' :: MinQueue (MeasuredDatabaseState be)
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; Solver be
</span><a href="#local-6989586621679297634"><span class="hs-identifier hs-var hs-var">heuristicSolver'</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679297613"><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297613"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679297612"><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679297611"><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297611"><span class="hs-identifier hs-var">bestRejected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
-&gt; Maybe
     (MeasuredDatabaseState be, MinQueue (MeasuredDatabaseState be))
forall a. Ord a =&gt; MinQueue a -&gt; Maybe (a, MinQueue a)
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.minView</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297613"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-601"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (MeasuredDatabaseState be, MinQueue (MeasuredDatabaseState be))
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[DatabaseState be] -&gt; Solver be
forall cmd. [DatabaseState cmd] -&gt; Solver cmd
</span><a href="Database.Beam.Migrate.Actions.html#SearchFailed"><span class="hs-identifier hs-var">SearchFailed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MeasuredDatabaseState be -&gt; DatabaseState be
forall cmd. MeasuredDatabaseState cmd -&gt; DatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measuredDbState"><span class="hs-identifier hs-var">measuredDbState</span></a></span><span> </span><span class="annot"><span class="annottext">(MeasuredDatabaseState be -&gt; DatabaseState be)
-&gt; [MeasuredDatabaseState be] -&gt; [DatabaseState be]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be) -&gt; [MeasuredDatabaseState be]
forall a. Ord a =&gt; MinQueue a -&gt; [a]
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.toList</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297611"><span class="hs-identifier hs-var">bestRejected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679297607"><span class="annot"><span class="annottext">mdbState :: MeasuredDatabaseState be
</span><a href="#local-6989586621679297607"><span class="hs-identifier hs-var">mdbState</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297606"><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297605"><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297605"><span class="hs-identifier hs-var">q'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DatabaseState be -&gt; HashSet SomeDatabasePredicate
forall be. DatabaseState be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#dbStateKey"><span class="hs-identifier hs-var hs-var">dbStateKey</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet (HashSet SomeDatabasePredicate) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.member`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; Solver be
</span><a href="#local-6989586621679297634"><span class="hs-identifier hs-var">heuristicSolver'</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297605"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297611"><span class="hs-identifier hs-var">bestRejected</span></a></span><span>
</span><span id="line-604"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; DatabaseState be -&gt; Bool
forall be.
HashSet SomeDatabasePredicate -&gt; DatabaseState be -&gt; Bool
</span><a href="Database.Beam.Migrate.Actions.html#solvedState"><span class="hs-identifier hs-var">solvedState</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><a href="#local-6989586621679297630"><span class="hs-identifier hs-var">postConditions</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MeasuredDatabaseState be -&gt; DatabaseState be
forall cmd. MeasuredDatabaseState cmd -&gt; DatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measuredDbState"><span class="hs-identifier hs-var">measuredDbState</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297607"><span class="hs-identifier hs-var">mdbState</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-605"></span><span>              </span><span class="annot"><span class="annottext">[MigrationCommand be] -&gt; Solver be
forall cmd. [MigrationCommand cmd] -&gt; Solver cmd
</span><a href="Database.Beam.Migrate.Actions.html#ProvideSolution"><span class="hs-identifier hs-var">ProvideSolution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (MigrationCommand be) -&gt; [MigrationCommand be]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseState be -&gt; Seq (MigrationCommand be)
forall be. DatabaseState be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#dbStateCmdSequence"><span class="hs-identifier hs-var hs-var">dbStateCmdSequence</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-606"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-607"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297602"><span class="annot"><span class="annottext">steps :: [PotentialAction be]
</span><a href="#local-6989586621679297602"><span class="hs-identifier hs-var hs-var">steps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ActionProvider be -&gt; ActionProviderFn be
forall be. ActionProvider be -&gt; ActionProviderFn be
</span><a href="Database.Beam.Migrate.Actions.html#getPotentialActions"><span class="hs-identifier hs-var hs-var">getPotentialActions</span></a></span><span>
</span><span id="line-608"></span><span>                              </span><span class="annot"><span class="annottext">ActionProvider be
</span><a href="#local-6989586621679297637"><span class="hs-identifier hs-var">provider</span></a></span><span>
</span><span id="line-609"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; [preCondition]
forall predicate (f :: * -&gt; *).
(Typeable predicate, Foldable f) =&gt;
f SomeDatabasePredicate -&gt; [predicate]
</span><a href="#local-6989586621679297615"><span class="hs-identifier hs-var">findPredicates</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseState be -&gt; HashSet SomeDatabasePredicate
forall be. DatabaseState be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#dbStateKey"><span class="hs-identifier hs-var hs-var">dbStateKey</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>                              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SomeDatabasePredicate] -&gt; [postCondition]
forall predicate (f :: * -&gt; *).
(Typeable predicate, Foldable f) =&gt;
f SomeDatabasePredicate -&gt; [predicate]
</span><a href="#local-6989586621679297615"><span class="hs-identifier hs-var">findPredicates</span></a></span><span> </span><span class="annot"><span class="annottext">[SomeDatabasePredicate]
</span><a href="#local-6989586621679297635"><span class="hs-identifier hs-var">postConditionsL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span>                  </span><span id="local-6989586621679297601"><span class="annot"><span class="annottext">steps' :: [(PotentialAction be, MeasuredDatabaseState be)]
</span><a href="#local-6989586621679297601"><span class="hs-identifier hs-var hs-var">steps'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((PotentialAction be, MeasuredDatabaseState be) -&gt; Bool)
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((PotentialAction be, MeasuredDatabaseState be) -&gt; Bool)
-&gt; (PotentialAction be, MeasuredDatabaseState be)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet (HashSet SomeDatabasePredicate) -&gt; Bool
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; Bool
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HS.member`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(HashSet SomeDatabasePredicate -&gt; Bool)
-&gt; ((PotentialAction be, MeasuredDatabaseState be)
    -&gt; HashSet SomeDatabasePredicate)
-&gt; (PotentialAction be, MeasuredDatabaseState be)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be -&gt; HashSet SomeDatabasePredicate
forall be. DatabaseState be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#dbStateKey"><span class="hs-identifier hs-var hs-var">dbStateKey</span></a></span><span> </span><span class="annot"><span class="annottext">(DatabaseState be -&gt; HashSet SomeDatabasePredicate)
-&gt; ((PotentialAction be, MeasuredDatabaseState be)
    -&gt; DatabaseState be)
-&gt; (PotentialAction be, MeasuredDatabaseState be)
-&gt; HashSet SomeDatabasePredicate
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be -&gt; DatabaseState be
forall cmd. MeasuredDatabaseState cmd -&gt; DatabaseState cmd
</span><a href="Database.Beam.Migrate.Actions.html#measuredDbState"><span class="hs-identifier hs-var">measuredDbState</span></a></span><span> </span><span class="annot"><span class="annottext">(MeasuredDatabaseState be -&gt; DatabaseState be)
-&gt; ((PotentialAction be, MeasuredDatabaseState be)
    -&gt; MeasuredDatabaseState be)
-&gt; (PotentialAction be, MeasuredDatabaseState be)
-&gt; DatabaseState be
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(PotentialAction be, MeasuredDatabaseState be)
-&gt; MeasuredDatabaseState be
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(PotentialAction be, MeasuredDatabaseState be)]
 -&gt; [(PotentialAction be, MeasuredDatabaseState be)])
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-613"></span><span>                           </span><span class="annot"><span class="annottext">Strategy [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
forall a. Strategy a -&gt; a -&gt; a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">withStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy (PotentialAction be, MeasuredDatabaseState be)
-&gt; Strategy [(PotentialAction be, MeasuredDatabaseState be)]
forall a. Strategy a -&gt; Strategy [a]
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">parList</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy (PotentialAction be, MeasuredDatabaseState be)
forall a. Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rseq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(PotentialAction be, MeasuredDatabaseState be)]
 -&gt; [(PotentialAction be, MeasuredDatabaseState be)])
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-614"></span><span>                           </span><span class="annot"><span class="annottext">(PotentialAction be
 -&gt; (PotentialAction be, MeasuredDatabaseState be))
-&gt; [PotentialAction be]
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679297599"><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297599"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297598"><span class="annot"><span class="annottext">dbState' :: MeasuredDatabaseState be
</span><a href="#local-6989586621679297598"><span class="hs-identifier hs-var hs-var">dbState'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PotentialAction be
-&gt; MeasuredDatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="#local-6989586621679297597"><span class="hs-identifier hs-var">applyStep</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297599"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297607"><span class="hs-identifier hs-var">mdbState</span></a></span><span>
</span><span id="line-615"></span><span>                                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297598"><span class="hs-identifier hs-var">dbState'</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
-&gt; (PotentialAction be, MeasuredDatabaseState be)
-&gt; (PotentialAction be, MeasuredDatabaseState be)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297599"><span class="hs-identifier hs-var">step</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297598"><span class="hs-identifier hs-var">dbState'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[PotentialAction be]
</span><a href="#local-6989586621679297602"><span class="hs-identifier hs-var">steps</span></a></span><span>
</span><span id="line-616"></span><span>
</span><span id="line-617"></span><span>                  </span><span id="local-6989586621679297597"><span class="annot"><span class="annottext">applyStep :: PotentialAction be
-&gt; MeasuredDatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="#local-6989586621679297597"><span class="hs-identifier hs-var hs-var">applyStep</span></a></span></span><span> </span><span id="local-6989586621679297596"><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297596"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span id="local-6989586621679297595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297595"><span class="hs-identifier hs-var">score</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297594"><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297594"><span class="hs-identifier hs-var">dbState'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-618"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297593"><span class="annot"><span class="annottext">dbState'' :: DatabaseState be
</span><a href="#local-6989586621679297593"><span class="hs-identifier hs-var hs-var">dbState''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatabaseState be -&gt; PotentialAction be -&gt; DatabaseState be
forall be.
DatabaseState be -&gt; PotentialAction be -&gt; DatabaseState be
</span><a href="#local-6989586621679297592"><span class="hs-identifier hs-var">dbStateAfterAction</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297594"><span class="hs-identifier hs-var">dbState'</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297596"><span class="hs-identifier hs-var">step</span></a></span><span>
</span><span id="line-619"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int -&gt; DatabaseState be -&gt; MeasuredDatabaseState be
</span><a href="#local-6989586621679297627"><span class="hs-identifier hs-var">measureDb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297595"><span class="hs-identifier hs-var">score</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297593"><span class="hs-identifier hs-var">dbState''</span></a></span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>              </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(PotentialAction be, MeasuredDatabaseState be)]
</span><a href="#local-6989586621679297601"><span class="hs-identifier hs-var">steps'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>                   </span><span class="hs-comment">-- Since no steps were generated, this is a dead end. Add to the rejected queue</span><span>
</span><span id="line-623"></span><span>                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; Solver be
</span><a href="#local-6989586621679297634"><span class="hs-identifier hs-var">heuristicSolver'</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297605"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MeasuredDatabaseState be
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; MinQueue (MeasuredDatabaseState be)
forall cmd.
MeasuredDatabaseState cmd
-&gt; MinQueue (MeasuredDatabaseState cmd)
-&gt; MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297591"><span class="hs-identifier hs-var">reject</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297607"><span class="hs-identifier hs-var">mdbState</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297611"><span class="hs-identifier hs-var">bestRejected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>                   </span><span class="annot"><span class="annottext">[(PotentialAction be, MeasuredDatabaseState be)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatabaseState be
-&gt; ((PotentialAction be, MeasuredDatabaseState be)
    -&gt; PotentialAction be)
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; ([(PotentialAction be, MeasuredDatabaseState be)] -&gt; Solver be)
-&gt; Solver be
forall cmd f.
DatabaseState cmd
-&gt; (f -&gt; PotentialAction cmd)
-&gt; [f]
-&gt; ([f] -&gt; Solver cmd)
-&gt; Solver cmd
</span><a href="Database.Beam.Migrate.Actions.html#ChooseActions"><span class="hs-identifier hs-var">ChooseActions</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span><span> </span><span class="annot"><span class="annottext">(PotentialAction be, MeasuredDatabaseState be)
-&gt; PotentialAction be
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">[(PotentialAction be, MeasuredDatabaseState be)]
</span><a href="#local-6989586621679297601"><span class="hs-identifier hs-var">steps'</span></a></span><span> </span><span class="annot"><span class="annottext">(([(PotentialAction be, MeasuredDatabaseState be)] -&gt; Solver be)
 -&gt; Solver be)
-&gt; ([(PotentialAction be, MeasuredDatabaseState be)] -&gt; Solver be)
-&gt; Solver be
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679297590"><span class="annot"><span class="annottext">[(PotentialAction be, MeasuredDatabaseState be)]
</span><a href="#local-6989586621679297590"><span class="hs-identifier hs-var">chosenSteps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-625"></span><span>                            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297589"><span class="annot"><span class="annottext">q'' :: MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297589"><span class="hs-identifier hs-var hs-var">q''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((PotentialAction be, MeasuredDatabaseState be)
 -&gt; MinQueue (MeasuredDatabaseState be)
 -&gt; MinQueue (MeasuredDatabaseState be))
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; [(PotentialAction be, MeasuredDatabaseState be)]
-&gt; MinQueue (MeasuredDatabaseState be)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679297588"><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297588"><span class="hs-identifier hs-var">dbState'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; MinQueue (MeasuredDatabaseState be)
forall a. Ord a =&gt; a -&gt; MinQueue a -&gt; MinQueue a
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.insert</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState be
</span><a href="#local-6989586621679297588"><span class="hs-identifier hs-var">dbState'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297605"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">[(PotentialAction be, MeasuredDatabaseState be)]
</span><a href="#local-6989586621679297590"><span class="hs-identifier hs-var">chosenSteps</span></a></span><span>
</span><span id="line-626"></span><span>                                </span><span id="local-6989586621679297586"><span class="annot"><span class="annottext">visited' :: HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297586"><span class="hs-identifier hs-var hs-var">visited'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; HashSet (HashSet SomeDatabasePredicate)
forall a. (Eq a, Hashable a) =&gt; a -&gt; HashSet a -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseState be -&gt; HashSet SomeDatabasePredicate
forall be. DatabaseState be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#dbStateKey"><span class="hs-identifier hs-var hs-var">dbStateKey</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseState be
</span><a href="#local-6989586621679297606"><span class="hs-identifier hs-var">dbState</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297612"><span class="hs-identifier hs-var">visited</span></a></span><span>
</span><span id="line-627"></span><span>                            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Strategy (MinQueue (MeasuredDatabaseState be))
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; MinQueue (MeasuredDatabaseState be)
forall a. Strategy a -&gt; a -&gt; a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">withStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Strategy (MinQueue (MeasuredDatabaseState be))
-&gt; Strategy (MinQueue (MeasuredDatabaseState be))
forall a. Strategy a -&gt; Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rparWith</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy (MinQueue (MeasuredDatabaseState be))
forall a. Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rseq</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297589"><span class="hs-identifier hs-var">q''</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be) -&gt; Solver be -&gt; Solver be
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
-&gt; HashSet (HashSet SomeDatabasePredicate)
-&gt; MinQueue (MeasuredDatabaseState be)
-&gt; Solver be
</span><a href="#local-6989586621679297634"><span class="hs-identifier hs-var">heuristicSolver'</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297589"><span class="hs-identifier hs-var">q''</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet (HashSet SomeDatabasePredicate)
</span><a href="#local-6989586621679297586"><span class="hs-identifier hs-var">visited'</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState be)
</span><a href="#local-6989586621679297611"><span class="hs-identifier hs-var">bestRejected</span></a></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679298012"><span class="annot"><a href="#local-6989586621679297591"><span class="hs-identifier hs-type">reject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298012"><span class="hs-identifier hs-type">cmd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-type">PQ.MinQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298012"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-type">PQ.MinQueue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#MeasuredDatabaseState"><span class="hs-identifier hs-type">MeasuredDatabaseState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679298012"><span class="hs-identifier hs-type">cmd</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-631"></span><span>    </span><span id="local-6989586621679297591"><span class="annot"><span class="annottext">reject :: MeasuredDatabaseState cmd
-&gt; MinQueue (MeasuredDatabaseState cmd)
-&gt; MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297591"><span class="hs-identifier hs-var hs-var">reject</span></a></span></span><span> </span><span id="local-6989586621679297584"><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297584"><span class="hs-identifier hs-var">mdbState</span></a></span></span><span> </span><span id="local-6989586621679297583"><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297583"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-632"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297582"><span class="annot"><span class="annottext">q' :: MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297582"><span class="hs-identifier hs-var hs-var">q'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
-&gt; MinQueue (MeasuredDatabaseState cmd)
-&gt; MinQueue (MeasuredDatabaseState cmd)
forall a. Ord a =&gt; a -&gt; MinQueue a -&gt; MinQueue a
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.insert</span></a></span><span> </span><span class="annot"><span class="annottext">MeasuredDatabaseState cmd
</span><a href="#local-6989586621679297584"><span class="hs-identifier hs-var">mdbState</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297583"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-633"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[MeasuredDatabaseState cmd] -&gt; MinQueue (MeasuredDatabaseState cmd)
forall a. [a] -&gt; MinQueue a
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.fromAscList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
-&gt; MinQueue (MeasuredDatabaseState cmd)
-&gt; [MeasuredDatabaseState cmd]
forall a. Ord a =&gt; Int -&gt; MinQueue a -&gt; [a]
</span><a href="../../../../pqueue/html/src"><span class="hs-identifier hs-var">PQ.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679297631"><span class="hs-identifier hs-var">rejectedCount</span></a></span><span> </span><span class="annot"><span class="annottext">MinQueue (MeasuredDatabaseState cmd)
</span><a href="#local-6989586621679297582"><span class="hs-identifier hs-var">q'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621679297592"><span class="annot"><span class="annottext">dbStateAfterAction :: DatabaseState be -&gt; PotentialAction be -&gt; DatabaseState be
</span><a href="#local-6989586621679297592"><span class="hs-identifier hs-var hs-var">dbStateAfterAction</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-type">DatabaseState</span></a></span><span> </span><span id="local-6989586621679297579"><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="#local-6989586621679297579"><span class="hs-identifier hs-var">curState</span></a></span></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679297578"><span class="annot"><span class="annottext">Seq (MigrationCommand be)
</span><a href="#local-6989586621679297578"><span class="hs-identifier hs-var">cmds</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679297577"><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297577"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-636"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679297576"><span class="annot"><span class="annottext">curState' :: HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="#local-6989586621679297576"><span class="hs-identifier hs-var hs-var">curState'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="#local-6989586621679297579"><span class="hs-identifier hs-var">curState</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate ()
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
forall k v w.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k w -&gt; HashMap k v
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HM.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; HashMap SomeDatabasePredicate ()
forall a. HashSet a -&gt; HashMap a ()
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.toMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPreConditions"><span class="hs-identifier hs-var hs-var">actionPreConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297577"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>                     </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
forall k v.
(Eq k, Hashable k) =&gt;
HashMap k v -&gt; HashMap k v -&gt; HashMap k v
</span><a href="../../../../unordered-containers/html/src"><span class="hs-operator hs-var">`HM.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatabaseStateSource
</span><a href="Database.Beam.Migrate.Actions.html#DatabaseStateSourceDerived"><span class="hs-identifier hs-var">DatabaseStateSourceDerived</span></a></span><span> </span><span class="annot"><span class="annottext">DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate ()
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">HashSet SomeDatabasePredicate -&gt; HashMap SomeDatabasePredicate ()
forall a. HashSet a -&gt; HashMap a ()
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.toMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PotentialAction be -&gt; HashSet SomeDatabasePredicate
forall be. PotentialAction be -&gt; HashSet SomeDatabasePredicate
</span><a href="Database.Beam.Migrate.Actions.html#actionPostConditions"><span class="hs-identifier hs-var hs-var">actionPostConditions</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297577"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; DatabaseState be
forall be.
HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashSet SomeDatabasePredicate
-&gt; Seq (MigrationCommand be)
-&gt; DatabaseState be
</span><a href="Database.Beam.Migrate.Actions.html#DatabaseState"><span class="hs-identifier hs-var">DatabaseState</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="#local-6989586621679297576"><span class="hs-identifier hs-var">curState'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate () -&gt; HashSet SomeDatabasePredicate
forall a. HashMap a () -&gt; HashSet a
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HS.fromMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">()
-&gt; HashMap SomeDatabasePredicate DatabaseStateSource
-&gt; HashMap SomeDatabasePredicate ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">HashMap SomeDatabasePredicate DatabaseStateSource
</span><a href="#local-6989586621679297576"><span class="hs-identifier hs-var">curState'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-639"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
</span><a href="#local-6989586621679297578"><span class="hs-identifier hs-var">cmds</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (MigrationCommand be)
-&gt; Seq (MigrationCommand be) -&gt; Seq (MigrationCommand be)
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be -&gt; Seq (MigrationCommand be)
forall be. PotentialAction be -&gt; Seq (MigrationCommand be)
</span><a href="Database.Beam.Migrate.Actions.html#actionCommands"><span class="hs-identifier hs-var hs-var">actionCommands</span></a></span><span> </span><span class="annot"><span class="annottext">PotentialAction be
</span><a href="#local-6989586621679297577"><span class="hs-identifier hs-var">action</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span></pre></body></html>