<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Top-level module import for @beam-migrate@.</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- This is most often the only module you want to import, unless you're</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- extending @beam-migrate@, implementing migrations support in a backend, or</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- writing tooling. If you are doing any of these things, please see the</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Advanced features section below.</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- The key abstractions in @beam-migrate@ are the /checked database/ and the</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- /migration/.</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- == Checked databases</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- A checked database is similar to the 'DatabaseSettings' type from</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- @beam-core@ except it comes with a set of /predicates/.</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Whereas a 'DatabaseSettings' object consists of a set of</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- database entities, a checked database (represented by the</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- 'CheckedDatabaseSettings' type) consists of a set of database entities along</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- with a set of /predicates/ (represented by types implementing</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- 'DatabasePredicate'). The /predicates/ are facts about a given</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- database schema. For example, a checked database with a table named</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &quot;Customers&quot;, would have a 'TableExistsPredicate' in its predicate set.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Predicates can be used to verify that a given beam schema is compatible with</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- a backend database or to generate migrations from a schema satisfying one set</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- of predicates to a schema satisfying another. Beam migrate provides a solver</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- for figuring out the exact sequence of steps needed to accomplish this. Beam</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- backends can provide additional predicates and solvers to implement</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- backend-specific migrations. For example, the @beam-postgres@ backend</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- provides predicates to assert that extensions have been loaded, and solvers</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- for emitting proper @CREATE EXTENSION@ statements where appropriate.</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- Predicates may also be serialized to disk in JSON format, providing an easy</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- means to detect significant changes in a beam schema.</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- As one final point, @beam-migrate@ can generate schemas in any beam-supported</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- SQL DDL syntax. The @beam-migrate@ module provides a DDL syntax for Haskell</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- in &quot;Database.Beam.Haskell.Syntax&quot;. This allows @beam-migrate@ to translate</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- predicate sets into the corresponding Haskell schema and the corresponding</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- Haskell migration script. This reflection allows tools based off of</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- @beam-migrate@ to support schema generation from an existing database.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- For more information on checked databases, see the</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- &quot;Database.Beam.Migrate.Checks&quot; module.</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- == Migrations</span><span>
</span><span id="line-46"></span><span class="hs-comment">--</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- A migration is a value of type 'MigrationSteps a b', where @a@ and @b@ are</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- database types. Conceptually, a value of this type is a list of DDL commands</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- which can be used to bring a database of type @a@ to a database of type @b@.</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- For example, if @b@ is a database type containing all the tables as @a@, but</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- with a new table added, a migration with type 'MigrationSteps a b' may</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- represent a SQL @CREATE TABLE@ statement. Migrations can sometimes be</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- reversed to produce a value of type 'MigrationSteps b a'. In our example, the</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- corresponding reversed migration may be the appropriate @DROP TABLE@</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- statement.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- Migration steps can used to modify a database schema, generate a migration</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- script in a given backend syntax, or generate an appropriate</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- 'DatabaseSettings' object for use with the rest of the beam ecosystem.</span><span>
</span><span id="line-60"></span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- For more information in migrations see &quot;Database.Beam.Migrate.Types&quot;</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- == Syntax</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- For low-level access to the underlying SQL syntax builders, see</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &quot;Database.Beam.Migrate.SQL.SQL92&quot;</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- == Advanced features</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- If you are writing a new beam backend, you will need to construct a value of</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- type 'BeamBackend'. See that module for more information.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- If you are writing tooling, you will likely need to consume 'BeamBackend'.</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- You will likely also be interested in the migration generation. See the</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- documentation on 'heuristicSolver'.</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database.Beam.Migrate</span><span>
</span><span id="line-79"></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html"><span class="hs-identifier">Database.Beam.Migrate.Actions</span></a></span><span>
</span><span id="line-80"></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html"><span class="hs-identifier">Database.Beam.Migrate.Checks</span></a></span><span>
</span><span id="line-81"></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Generics.html"><span class="hs-identifier">Database.Beam.Migrate.Generics</span></a></span><span>
</span><span id="line-82"></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.html"><span class="hs-identifier">Database.Beam.Migrate.SQL</span></a></span><span>
</span><span id="line-83"></span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html"><span class="hs-identifier">Database.Beam.Migrate.Types</span></a></span><span>
</span><span id="line-84"></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Actions.html"><span class="hs-identifier">Database.Beam.Migrate.Actions</span></a></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Checks.html"><span class="hs-identifier">Database.Beam.Migrate.Checks</span></a></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Generics.html"><span class="hs-identifier">Database.Beam.Migrate.Generics</span></a></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.SQL.html"><span class="hs-identifier">Database.Beam.Migrate.SQL</span></a></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Database.Beam.Migrate.Types.html"><span class="hs-identifier">Database.Beam.Migrate.Types</span></a></span><span>
</span><span id="line-91"></span></pre></body></html>