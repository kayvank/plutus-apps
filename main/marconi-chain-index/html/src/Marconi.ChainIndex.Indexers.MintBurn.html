<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DerivingStrategies  #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts    #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell     #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans     #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">{- | Mint/burn event indexer, the result of which is an sqlite database
   'mintburn.db' which has a table 'minting_policy_events' with the
   following fields:

     - slotNo          INT NOT NULL
     - blockHeaderHash INT NOT NULL
     - txId            BLOB NOT NULL
     - policyId        BLOB NOT NULL
     - assetName       TEXT NOT NULL
     - quantity        INT NOT NULL
     - redeemerIx      INT NOT NULL
     - redeemerData    BLOB NOT NULL
-}</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Marconi.ChainIndex.Indexers.MintBurn</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Data</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Scripts</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.Tx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier">Cardano.Ledger.Alonzo.TxWitness</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LA</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-babbage/html/src"><span class="hs-identifier">Cardano.Ledger.Babbage.Tx</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LB</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier">Cardano.Ledger.Mary.Value</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LM</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Control.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">makeLenses</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-operator">(^.)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">parseJSON</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">toJSON</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Object</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">object</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.:)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Short</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">groupBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(:|)</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier">Database.SQLite.Simple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier">NamedParam</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-operator">(:=)</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier">Database.SQLite.Simple</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SQL</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Orphans.html"><span class="hs-identifier">Marconi.ChainIndex.Orphans</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Types.html"><span class="hs-identifier">Marconi.ChainIndex.Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Types.html#SecurityParam"><span class="hs-identifier">SecurityParam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier">Marconi.Core.Storable</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">RI</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ouroboros-consensus-shelley/html/src"><span class="hs-identifier">Ouroboros.Consensus.Shelley.Eras</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">OEra</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- * Event</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">data</span><span> </span><span id="TxMintEvent"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-var">TxMintEvent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxMintEvent"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-var">TxMintEvent</span></a></span></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="txMintEventSlotNo"><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="txMintEventBlockHeaderHash"><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Hash</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="txMintEventTxAssets"><span class="annot"><span class="annottext">TxMintEvent -&gt; NonEmpty (TxId, NonEmpty MintAsset)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventTxAssets"><span class="hs-identifier hs-var hs-var">txMintEventTxAssets</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NE.NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NE.NonEmpty</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-type">MintAsset</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483114"><span id="local-6989586621679483116"><span id="local-6989586621679483118"><span class="annot"><span class="annottext">Int -&gt; TxMintEvent -&gt; ShowS
[TxMintEvent] -&gt; ShowS
TxMintEvent -&gt; String
(Int -&gt; TxMintEvent -&gt; ShowS)
-&gt; (TxMintEvent -&gt; String)
-&gt; ([TxMintEvent] -&gt; ShowS)
-&gt; Show TxMintEvent
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxMintEvent] -&gt; ShowS
$cshowList :: [TxMintEvent] -&gt; ShowS
show :: TxMintEvent -&gt; String
$cshow :: TxMintEvent -&gt; String
showsPrec :: Int -&gt; TxMintEvent -&gt; ShowS
$cshowsPrec :: Int -&gt; TxMintEvent -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483109"><span id="local-6989586621679483111"><span class="annot"><span class="annottext">TxMintEvent -&gt; TxMintEvent -&gt; Bool
(TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Bool) -&gt; Eq TxMintEvent
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c/= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
== :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c== :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483093"><span id="local-6989586621679483095"><span id="local-6989586621679483097"><span id="local-6989586621679483099"><span id="local-6989586621679483101"><span id="local-6989586621679483103"><span id="local-6989586621679483105"><span class="annot"><span class="annottext">Eq TxMintEvent
Eq TxMintEvent
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Ordering)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent)
-&gt; (TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent)
-&gt; Ord TxMintEvent
TxMintEvent -&gt; TxMintEvent -&gt; Bool
TxMintEvent -&gt; TxMintEvent -&gt; Ordering
TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent
$cmin :: TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent
max :: TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent
$cmax :: TxMintEvent -&gt; TxMintEvent -&gt; TxMintEvent
&gt;= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c&gt;= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
&gt; :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c&gt; :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
&lt;= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c&lt;= :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
&lt; :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
$c&lt; :: TxMintEvent -&gt; TxMintEvent -&gt; Bool
compare :: TxMintEvent -&gt; TxMintEvent -&gt; Ordering
$ccompare :: TxMintEvent -&gt; TxMintEvent -&gt; Ordering
$cp1Ord :: Eq TxMintEvent
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">data</span><span> </span><span id="MintAsset"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-var">MintAsset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MintAsset"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-var">MintAsset</span></a></span></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="mintAssetPolicyId"><span class="annot"><span class="annottext">MintAsset -&gt; PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetPolicyId"><span class="hs-identifier hs-var hs-var">mintAssetPolicyId</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mintAssetAssetName"><span class="annot"><span class="annottext">MintAsset -&gt; AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetAssetName"><span class="hs-identifier hs-var hs-var">mintAssetAssetName</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mintAssetQuantity"><span class="annot"><span class="annottext">MintAsset -&gt; Quantity
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetQuantity"><span class="hs-identifier hs-var hs-var">mintAssetQuantity</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Quantity</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mintAssetRedeemerIdx"><span class="annot"><span class="annottext">MintAsset -&gt; Word64
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetRedeemerIdx"><span class="hs-identifier hs-var hs-var">mintAssetRedeemerIdx</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="mintAssetRedeemerData"><span class="annot"><span class="annottext">MintAsset -&gt; ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetRedeemerData"><span class="hs-identifier hs-var hs-var">mintAssetRedeemerData</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptData</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679483080"><span id="local-6989586621679483082"><span id="local-6989586621679483084"><span class="annot"><span class="annottext">Int -&gt; MintAsset -&gt; ShowS
[MintAsset] -&gt; ShowS
MintAsset -&gt; String
(Int -&gt; MintAsset -&gt; ShowS)
-&gt; (MintAsset -&gt; String)
-&gt; ([MintAsset] -&gt; ShowS)
-&gt; Show MintAsset
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MintAsset] -&gt; ShowS
$cshowList :: [MintAsset] -&gt; ShowS
show :: MintAsset -&gt; String
$cshow :: MintAsset -&gt; String
showsPrec :: Int -&gt; MintAsset -&gt; ShowS
$cshowsPrec :: Int -&gt; MintAsset -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483076"><span id="local-6989586621679483078"><span class="annot"><span class="annottext">MintAsset -&gt; MintAsset -&gt; Bool
(MintAsset -&gt; MintAsset -&gt; Bool)
-&gt; (MintAsset -&gt; MintAsset -&gt; Bool) -&gt; Eq MintAsset
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MintAsset -&gt; MintAsset -&gt; Bool
$c/= :: MintAsset -&gt; MintAsset -&gt; Bool
== :: MintAsset -&gt; MintAsset -&gt; Bool
$c== :: MintAsset -&gt; MintAsset -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483061"><span id="local-6989586621679483063"><span id="local-6989586621679483065"><span id="local-6989586621679483067"><span id="local-6989586621679483069"><span id="local-6989586621679483071"><span id="local-6989586621679483073"><span class="annot"><span class="annottext">Eq MintAsset
Eq MintAsset
-&gt; (MintAsset -&gt; MintAsset -&gt; Ordering)
-&gt; (MintAsset -&gt; MintAsset -&gt; Bool)
-&gt; (MintAsset -&gt; MintAsset -&gt; Bool)
-&gt; (MintAsset -&gt; MintAsset -&gt; Bool)
-&gt; (MintAsset -&gt; MintAsset -&gt; Bool)
-&gt; (MintAsset -&gt; MintAsset -&gt; MintAsset)
-&gt; (MintAsset -&gt; MintAsset -&gt; MintAsset)
-&gt; Ord MintAsset
MintAsset -&gt; MintAsset -&gt; Bool
MintAsset -&gt; MintAsset -&gt; Ordering
MintAsset -&gt; MintAsset -&gt; MintAsset
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: MintAsset -&gt; MintAsset -&gt; MintAsset
$cmin :: MintAsset -&gt; MintAsset -&gt; MintAsset
max :: MintAsset -&gt; MintAsset -&gt; MintAsset
$cmax :: MintAsset -&gt; MintAsset -&gt; MintAsset
&gt;= :: MintAsset -&gt; MintAsset -&gt; Bool
$c&gt;= :: MintAsset -&gt; MintAsset -&gt; Bool
&gt; :: MintAsset -&gt; MintAsset -&gt; Bool
$c&gt; :: MintAsset -&gt; MintAsset -&gt; Bool
&lt;= :: MintAsset -&gt; MintAsset -&gt; Bool
$c&lt;= :: MintAsset -&gt; MintAsset -&gt; Bool
&lt; :: MintAsset -&gt; MintAsset -&gt; Bool
$c&lt; :: MintAsset -&gt; MintAsset -&gt; Bool
compare :: MintAsset -&gt; MintAsset -&gt; Ordering
$ccompare :: MintAsset -&gt; MintAsset -&gt; Ordering
$cp1Ord :: Eq MintAsset
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#toUpdate"><span class="hs-identifier hs-type">toUpdate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockInMode</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.CardanoMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span>
</span><span id="line-75"></span><span id="toUpdate"><span class="annot"><span class="annottext">toUpdate :: BlockInMode CardanoMode -&gt; Maybe TxMintEvent
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#toUpdate"><span class="hs-identifier hs-var hs-var">toUpdate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockInMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Block</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockHeader</span></a></span><span> </span><span id="local-6989586621679483056"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679483056"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span id="local-6989586621679483055"><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679483055"><span class="hs-identifier hs-var">blockHeaderHash</span></a></span></span><span> </span><span id="local-6989586621679483054"><span class="annot"><span class="annottext">BlockNo
</span><a href="#local-6989586621679483054"><span class="hs-identifier hs-var">_blockNo</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679483053"><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621679483053"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">EraInMode era CardanoMode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Tx era -&gt; Maybe (TxId, NonEmpty MintAsset))
-&gt; [Tx era] -&gt; [(TxId, NonEmpty MintAsset)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Tx era -&gt; Maybe (TxId, NonEmpty MintAsset)
forall era. Tx era -&gt; Maybe (TxId, NonEmpty MintAsset)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMints"><span class="hs-identifier hs-var">txMints</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx era]
</span><a href="#local-6989586621679483053"><span class="hs-identifier hs-var">txs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679483051"><span class="annot"><span class="annottext">(TxId, NonEmpty MintAsset)
</span><a href="#local-6989586621679483051"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679483050"><span class="annot"><span class="annottext">[(TxId, NonEmpty MintAsset)]
</span><a href="#local-6989586621679483050"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; Maybe TxMintEvent
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; Maybe TxMintEvent)
-&gt; TxMintEvent -&gt; Maybe TxMintEvent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; NonEmpty (TxId, NonEmpty MintAsset)
-&gt; TxMintEvent
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-var">TxMintEvent</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679483056"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679483055"><span class="hs-identifier hs-var">blockHeaderHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TxId, NonEmpty MintAsset)
</span><a href="#local-6989586621679483051"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(TxId, NonEmpty MintAsset)
-&gt; [(TxId, NonEmpty MintAsset)]
-&gt; NonEmpty (TxId, NonEmpty MintAsset)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">NE.:|</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxId, NonEmpty MintAsset)]
</span><a href="#local-6989586621679483050"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe TxMintEvent
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679483330"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMints"><span class="hs-identifier hs-type">txMints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483330"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NE.NonEmpty</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-type">MintAsset</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-81"></span><span id="txMints"><span class="annot"><span class="annottext">txMints :: Tx era -&gt; Maybe (TxId, NonEmpty MintAsset)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMints"><span class="hs-identifier hs-var hs-var">txMints</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Tx</span></a></span><span> </span><span id="local-6989586621679483048"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483048"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="annot"><span class="annottext">[KeyWitness era]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; [MintAsset]
forall era. TxBody era -&gt; [MintAsset]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txbMints"><span class="hs-identifier hs-var">txbMints</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483048"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679483046"><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679483046"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679483045"><span class="annot"><span class="annottext">[MintAsset]
</span><a href="#local-6989586621679483045"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxId, NonEmpty MintAsset) -&gt; Maybe (TxId, NonEmpty MintAsset)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBody era -&gt; TxId
forall era. TxBody era -&gt; TxId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.getTxId</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483048"><span class="hs-identifier hs-var">txb</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679483046"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset -&gt; [MintAsset] -&gt; NonEmpty MintAsset
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">NE.:|</span></a></span><span> </span><span class="annot"><span class="annottext">[MintAsset]
</span><a href="#local-6989586621679483045"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TxId, NonEmpty MintAsset)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679483321"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txbMints"><span class="hs-identifier hs-type">txbMints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483321"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-type">MintAsset</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-86"></span><span id="txbMints"><span class="annot"><span class="annottext">txbMints :: TxBody era -&gt; [MintAsset]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txbMints"><span class="hs-identifier hs-var hs-var">txbMints</span></a></span></span><span> </span><span id="local-6989586621679483043"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483043"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483043"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-87"></span><span>  </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ShelleyTxBody</span></a></span><span> </span><span id="local-6989586621679483041"><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679483041"><span class="hs-identifier hs-var">era</span></a></span></span><span> </span><span id="local-6989586621679483040"><span class="annot"><span class="annottext">TxBody (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483040"><span class="hs-identifier hs-var">shelleyTx</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Script (ShelleyLedgerEra era)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (AuxiliaryData (ShelleyLedgerEra era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="#local-6989586621679483041"><span class="hs-identifier hs-var">era</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraShelley</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraAllegra</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraMary</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraAlonzo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679483035"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679483035"><span class="hs-identifier hs-var">policyId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483034"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679483034"><span class="hs-identifier hs-var">assetName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483033"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679483033"><span class="hs-identifier hs-var">quantity</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483032"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483032"><span class="hs-identifier hs-var">index'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483031"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679483031"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
forall era.
TxBody era
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#getPolicyData"><span class="hs-identifier hs-var">getPolicyData</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483043"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">(Value StandardCrypto
 -&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)])
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (AlonzoEra StandardCrypto)
-&gt; AlonzoBody (AlonzoEra StandardCrypto) =&gt;
   Value (Crypto (AlonzoEra StandardCrypto))
forall era. TxBody era -&gt; AlonzoBody era =&gt; Value (Crypto era)
</span><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-var">LA.mint</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (AlonzoEra StandardCrypto)
TxBody (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483040"><span class="hs-identifier hs-var">shelleyTx</span></a></span><span>
</span><span id="line-93"></span><span>      </span><span class="annot"><span class="annottext">MintAsset -&gt; [MintAsset]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(MintAsset -&gt; [MintAsset]) -&gt; MintAsset -&gt; [MintAsset]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
-&gt; AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; MintAsset
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-var">MintAsset</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679483035"><span class="hs-identifier hs-var">policyId</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679483034"><span class="hs-identifier hs-var">assetName</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679483033"><span class="hs-identifier hs-var">quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483032"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679483031"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraBabbage</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679483027"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679483027"><span class="hs-identifier hs-var">policyId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483026"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679483026"><span class="hs-identifier hs-var">assetName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483025"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679483025"><span class="hs-identifier hs-var">quantity</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483024"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483024"><span class="hs-identifier hs-var">index'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483023"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679483023"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TxBody era
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
forall era.
TxBody era
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#getPolicyData"><span class="hs-identifier hs-var">getPolicyData</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483043"><span class="hs-identifier hs-var">txb</span></a></span><span> </span><span class="annot"><span class="annottext">(Value StandardCrypto
 -&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)])
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (BabbageEra StandardCrypto)
-&gt; BabbageBody (BabbageEra StandardCrypto) =&gt;
   Value (Crypto (BabbageEra StandardCrypto))
forall era. TxBody era -&gt; BabbageBody era =&gt; Value (Crypto era)
</span><a href="../../../../cardano-ledger-babbage/html/src"><span class="hs-identifier hs-var">LB.mint</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody (BabbageEra StandardCrypto)
TxBody (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483040"><span class="hs-identifier hs-var">shelleyTx</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">MintAsset -&gt; [MintAsset]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(MintAsset -&gt; [MintAsset]) -&gt; MintAsset -&gt; [MintAsset]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
-&gt; AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; MintAsset
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-var">MintAsset</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679483027"><span class="hs-identifier hs-var">policyId</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679483026"><span class="hs-identifier hs-var">assetName</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679483025"><span class="hs-identifier hs-var">quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483024"><span class="hs-identifier hs-var">index'</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679483023"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679483021"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483021"><span class="hs-identifier hs-var">_byronTxBody</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ByronTxBody is not exported but as it's the only other data constructor then _ matches it.</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span id="local-6989586621679483286"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txRedeemers"><span class="hs-identifier hs-type">txRedeemers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483286"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.RdmrPtr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483286"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.ExUnits</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-102"></span><span id="txRedeemers"><span class="annot"><span class="annottext">txRedeemers :: TxBody era -&gt; Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txRedeemers"><span class="hs-identifier hs-var hs-var">txRedeemers</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ShelleyTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra era
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxBody (ShelleyLedgerEra era)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Script (ShelleyLedgerEra era)]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483019"><span class="annot"><span class="annottext">TxBodyScriptData era
</span><a href="#local-6989586621679483019"><span class="hs-identifier hs-var">txScriptData</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (AuxiliaryData (ShelleyLedgerEra era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxScriptValidity era
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxBodyScriptData era
</span><a href="#local-6989586621679483019"><span class="hs-identifier hs-var">txScriptData</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyScriptData</span></a></span><span> </span><span id="local-6989586621679483017"><span class="annot"><span class="annottext">ScriptDataSupportedInEra era
</span><a href="#local-6989586621679483017"><span class="hs-identifier hs-var">_proof</span></a></span></span><span> </span><span id="local-6989586621679483016"><span class="annot"><span class="annottext">TxDats (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483016"><span class="hs-identifier hs-var">_datum</span></a></span></span><span> </span><span id="local-6989586621679483015"><span class="annot"><span class="annottext">Redeemers (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483015"><span class="hs-identifier hs-var">redeemers</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Redeemers (ShelleyLedgerEra era)
-&gt; Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
forall era. Redeemers era -&gt; Map RdmrPtr (Data era, ExUnits)
</span><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-var">LA.unRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemers (ShelleyLedgerEra era)
</span><a href="#local-6989586621679483015"><span class="hs-identifier hs-var">redeemers</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">TxBodyScriptData era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxBodyNoScriptData</span></a></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txRedeemers"><span class="hs-identifier hs-var">txRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679483271"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintRedeemers"><span class="hs-identifier hs-type">mintRedeemers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483271"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.Data</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ShelleyLedgerEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483271"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.ExUnits</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-108"></span><span id="mintRedeemers"><span class="annot"><span class="annottext">mintRedeemers :: TxBody era -&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintRedeemers"><span class="hs-identifier hs-var hs-var">mintRedeemers</span></a></span></span><span> </span><span id="local-6989586621679483011"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483011"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
forall era.
TxBody era -&gt; Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txRedeemers"><span class="hs-identifier hs-var">txRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483011"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
-&gt; (Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
    -&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))])
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Map RdmrPtr (Data (ShelleyLedgerEra era), ExUnits)
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="annottext">[(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; ([(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
    -&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))])
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits)) -&gt; Bool)
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.RdmrPtr</span></a></span><span> </span><span id="local-6989586621679483008"><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679483008"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra era), ExUnits)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="#local-6989586621679483008"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Tag -&gt; Tag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-var">LA.Mint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">[(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; ([(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
    -&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))])
-&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))
 -&gt; (Word64, (Data (ShelleyLedgerEra era), ExUnits)))
-&gt; [(RdmrPtr, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.RdmrPtr</span></a></span><span> </span><span class="annot"><span class="annottext">Tag
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483006"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483006"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679483005"><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra era), ExUnits)
</span><a href="#local-6989586621679483005"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679483006"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra era), ExUnits)
</span><a href="#local-6989586621679483005"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679483309"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#getPolicyData"><span class="hs-identifier hs-type">getPolicyData</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483309"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.Value</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-ledger-core/html/src"><span class="hs-identifier hs-type">OEra.StandardCrypto</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Quantity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptData</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-117"></span><span id="getPolicyData"><span class="annot"><span class="annottext">getPolicyData :: TxBody era
-&gt; Value StandardCrypto
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#getPolicyData"><span class="hs-identifier hs-var hs-var">getPolicyData</span></a></span></span><span> </span><span id="local-6989586621679483004"><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483004"><span class="hs-identifier hs-var">txb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.Value</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679483002"><span class="annot"><span class="annottext">Map (PolicyID StandardCrypto) (Map AssetName Integer)
</span><a href="#local-6989586621679483002"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">let</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679483001"><span class="annot"><span class="annottext">policyIdList :: [(PolicyID StandardCrypto, Map AssetName Integer)]
</span><a href="#local-6989586621679483001"><span class="hs-identifier hs-var hs-var">policyIdList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (PolicyID StandardCrypto) (Map AssetName Integer)
-&gt; [(PolicyID StandardCrypto, Map AssetName Integer)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map (PolicyID StandardCrypto) (Map AssetName Integer)
</span><a href="#local-6989586621679483002"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679483000"><span class="annot"><span class="annottext">getPolicyId :: Word64 -&gt; (PolicyID StandardCrypto, Map AssetName Integer)
</span><a href="#local-6989586621679483000"><span class="hs-identifier hs-var hs-var">getPolicyId</span></a></span></span><span> </span><span id="local-6989586621679482999"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482999"><span class="hs-identifier hs-var">index'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PolicyID StandardCrypto, Map AssetName Integer)]
</span><a href="#local-6989586621679483001"><span class="hs-identifier hs-var">policyIdList</span></a></span><span> </span><span class="annot"><span class="annottext">[(PolicyID StandardCrypto, Map AssetName Integer)]
-&gt; Int -&gt; (PolicyID StandardCrypto, Map AssetName Integer)
forall a. [a] -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482999"><span class="hs-identifier hs-var">index'</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679482997"><span class="annot"><span class="annottext">PolicyID StandardCrypto
</span><a href="#local-6989586621679482997"><span class="hs-identifier hs-var">maryPolicyID</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482996"><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679482996"><span class="hs-identifier hs-var">assets</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482995"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482995"><span class="hs-identifier hs-var">index''</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482994"><span class="annot"><span class="annottext">Data (ShelleyLedgerEra era)
</span><a href="#local-6989586621679482994"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExUnits
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">((Word64, (Data (ShelleyLedgerEra era), ExUnits))
 -&gt; ((PolicyID StandardCrypto, Map AssetName Integer), Word64,
     (Data (ShelleyLedgerEra era), ExUnits)))
-&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; [((PolicyID StandardCrypto, Map AssetName Integer), Word64,
     (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679482993"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482993"><span class="hs-identifier hs-var">index'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482992"><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra era), ExUnits)
</span><a href="#local-6989586621679482992"><span class="hs-identifier hs-var">data_</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64 -&gt; (PolicyID StandardCrypto, Map AssetName Integer)
</span><a href="#local-6989586621679483000"><span class="hs-identifier hs-var">getPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482993"><span class="hs-identifier hs-var">index'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482993"><span class="hs-identifier hs-var">index'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Data (ShelleyLedgerEra era), ExUnits)
</span><a href="#local-6989586621679482992"><span class="hs-identifier hs-var">data_</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
 -&gt; [((PolicyID StandardCrypto, Map AssetName Integer), Word64,
      (Data (ShelleyLedgerEra era), ExUnits))])
-&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
-&gt; [((PolicyID StandardCrypto, Map AssetName Integer), Word64,
     (Data (ShelleyLedgerEra era), ExUnits))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era -&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
forall era.
TxBody era -&gt; [(Word64, (Data (ShelleyLedgerEra era), ExUnits))]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintRedeemers"><span class="hs-identifier hs-var">mintRedeemers</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody era
</span><a href="#local-6989586621679483004"><span class="hs-identifier hs-var">txb</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679482991"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482991"><span class="hs-identifier hs-var">assetName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482990"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679482990"><span class="hs-identifier hs-var">quantity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.AssetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer -&gt; [(AssetName, Integer)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map AssetName Integer
</span><a href="#local-6989586621679482996"><span class="hs-identifier hs-var">assets</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="annottext">(PolicyId, AssetName, Quantity, Word64, ScriptData)
-&gt; [(PolicyId, AssetName, Quantity, Word64, ScriptData)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyID StandardCrypto -&gt; PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryPolicyID"><span class="hs-identifier hs-var">fromMaryPolicyID</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyID StandardCrypto
</span><a href="#local-6989586621679482997"><span class="hs-identifier hs-var">maryPolicyID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryAssetName"><span class="hs-identifier hs-var">fromMaryAssetName</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482991"><span class="hs-identifier hs-var">assetName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679482990"><span class="hs-identifier hs-var">quantity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482995"><span class="hs-identifier hs-var">index''</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra era) -&gt; ScriptData
forall ledgerera. Data ledgerera -&gt; ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromAlonzoData"><span class="hs-identifier hs-var">fromAlonzoData</span></a></span><span> </span><span class="annot"><span class="annottext">Data (ShelleyLedgerEra era)
</span><a href="#local-6989586621679482994"><span class="hs-identifier hs-var">redeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- ** Copy-paste</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryPolicyID"><span class="hs-identifier hs-type">fromMaryPolicyID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.PolicyID</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-ledger-core/html/src"><span class="hs-identifier hs-type">OEra.StandardCrypto</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span>
</span><span id="line-128"></span><span id="fromMaryPolicyID"><span class="annot"><span class="annottext">fromMaryPolicyID :: PolicyID StandardCrypto -&gt; PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryPolicyID"><span class="hs-identifier hs-var hs-var">fromMaryPolicyID</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.PolicyID</span></a></span><span> </span><span id="local-6989586621679482984"><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621679482984"><span class="hs-identifier hs-var">sh</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; PolicyId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptHash StandardCrypto -&gt; ScriptHash
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.fromShelleyScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptHash StandardCrypto
</span><a href="#local-6989586621679482984"><span class="hs-identifier hs-var">sh</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- from cardano-api:src/Cardano/Api/Value.hs</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryAssetName"><span class="hs-identifier hs-type">fromMaryAssetName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span>
</span><span id="line-131"></span><span id="fromMaryAssetName"><span class="annot"><span class="annottext">fromMaryAssetName :: AssetName -&gt; AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromMaryAssetName"><span class="hs-identifier hs-var hs-var">fromMaryAssetName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-ledger-shelley-ma/html/src"><span class="hs-identifier hs-type">LM.AssetName</span></a></span><span> </span><span id="local-6989586621679482980"><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679482980"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; AssetName
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AssetName</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AssetName) -&gt; ByteString -&gt; AssetName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">Short.fromShort</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString
</span><a href="#local-6989586621679482980"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- from cardano-api:src/Cardano/Api/Value.hs</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span id="local-6989586621679483270"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromAlonzoData"><span class="hs-identifier hs-type">fromAlonzoData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-type">LA.Data</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679483270"><span class="hs-identifier hs-type">ledgerera</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptData</span></a></span></span><span>
</span><span id="line-134"></span><span id="fromAlonzoData"><span class="annot"><span class="annottext">fromAlonzoData :: Data ledgerera -&gt; ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromAlonzoData"><span class="hs-identifier hs-var hs-var">fromAlonzoData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data -&gt; ScriptData
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.fromPlutusData</span></a></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; ScriptData)
-&gt; (Data ledgerera -&gt; Data) -&gt; Data ledgerera -&gt; ScriptData
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Data ledgerera -&gt; Data
forall era. Data era -&gt; Data
</span><a href="../../../../cardano-ledger-alonzo/html/src"><span class="hs-identifier hs-var">LA.getPlutusData</span></a></span><span> </span><span class="hs-comment">-- from cardano-api:src/Cardano/Api/ScriptData.hs</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- * Sqlite</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span id="local-6989586621679482973"><span id="local-6989586621679482974"></span></span><span class="hs-keyword">data</span><span> </span><span id="TxMintRow"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-var">TxMintRow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxMintRow"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-var">TxMintRow</span></a></span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="_txMintRowSlotNo"><span class="annot"><span class="annottext">TxMintRow -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowSlotNo"><span class="hs-identifier hs-var hs-var">_txMintRowSlotNo</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowBlockHeaderHash"><span class="annot"><span class="annottext">TxMintRow -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowBlockHeaderHash"><span class="hs-identifier hs-var hs-var">_txMintRowBlockHeaderHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Hash</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockHeader</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowTxId"><span class="annot"><span class="annottext">TxMintRow -&gt; TxId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowTxId"><span class="hs-identifier hs-var hs-var">_txMintRowTxId</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxId</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowPolicyId"><span class="annot"><span class="annottext">TxMintRow -&gt; PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowPolicyId"><span class="hs-identifier hs-var hs-var">_txMintRowPolicyId</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowAssetName"><span class="annot"><span class="annottext">TxMintRow -&gt; AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowAssetName"><span class="hs-identifier hs-var hs-var">_txMintRowAssetName</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowQuantity"><span class="annot"><span class="annottext">TxMintRow -&gt; Quantity
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowQuantity"><span class="hs-identifier hs-var hs-var">_txMintRowQuantity</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Quantity</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowRedeemerIdx"><span class="annot"><span class="annottext">TxMintRow -&gt; Word64
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowRedeemerIdx"><span class="hs-identifier hs-var hs-var">_txMintRowRedeemerIdx</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="_txMintRowRedeemerData"><span class="annot"><span class="annottext">TxMintRow -&gt; ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#_txMintRowRedeemerData"><span class="hs-identifier hs-var hs-var">_txMintRowRedeemerData</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ScriptData</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482960"><span id="local-6989586621679482962"><span class="annot"><span class="annottext">TxMintRow -&gt; TxMintRow -&gt; Bool
(TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Bool) -&gt; Eq TxMintRow
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c/= :: TxMintRow -&gt; TxMintRow -&gt; Bool
== :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c== :: TxMintRow -&gt; TxMintRow -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482945"><span id="local-6989586621679482947"><span id="local-6989586621679482949"><span id="local-6989586621679482951"><span id="local-6989586621679482953"><span id="local-6989586621679482955"><span id="local-6989586621679482957"><span class="annot"><span class="annottext">Eq TxMintRow
Eq TxMintRow
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Ordering)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; TxMintRow)
-&gt; (TxMintRow -&gt; TxMintRow -&gt; TxMintRow)
-&gt; Ord TxMintRow
TxMintRow -&gt; TxMintRow -&gt; Bool
TxMintRow -&gt; TxMintRow -&gt; Ordering
TxMintRow -&gt; TxMintRow -&gt; TxMintRow
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: TxMintRow -&gt; TxMintRow -&gt; TxMintRow
$cmin :: TxMintRow -&gt; TxMintRow -&gt; TxMintRow
max :: TxMintRow -&gt; TxMintRow -&gt; TxMintRow
$cmax :: TxMintRow -&gt; TxMintRow -&gt; TxMintRow
&gt;= :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c&gt;= :: TxMintRow -&gt; TxMintRow -&gt; Bool
&gt; :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c&gt; :: TxMintRow -&gt; TxMintRow -&gt; Bool
&lt;= :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c&lt;= :: TxMintRow -&gt; TxMintRow -&gt; Bool
&lt; :: TxMintRow -&gt; TxMintRow -&gt; Bool
$c&lt; :: TxMintRow -&gt; TxMintRow -&gt; Bool
compare :: TxMintRow -&gt; TxMintRow -&gt; Ordering
$ccompare :: TxMintRow -&gt; TxMintRow -&gt; Ordering
$cp1Ord :: Eq TxMintRow
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482939"><span id="local-6989586621679482941"><span id="local-6989586621679482943"><span class="annot"><span class="annottext">Int -&gt; TxMintRow -&gt; ShowS
[TxMintRow] -&gt; ShowS
TxMintRow -&gt; String
(Int -&gt; TxMintRow -&gt; ShowS)
-&gt; (TxMintRow -&gt; String)
-&gt; ([TxMintRow] -&gt; ShowS)
-&gt; Show TxMintRow
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxMintRow] -&gt; ShowS
$cshowList :: [TxMintRow] -&gt; ShowS
show :: TxMintRow -&gt; String
$cshow :: TxMintRow -&gt; String
showsPrec :: Int -&gt; TxMintRow -&gt; ShowS
$cshowsPrec :: Int -&gt; TxMintRow -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. TxMintRow -&gt; Rep TxMintRow x)
-&gt; (forall x. Rep TxMintRow x -&gt; TxMintRow) -&gt; Generic TxMintRow
forall x. Rep TxMintRow x -&gt; TxMintRow
forall x. TxMintRow -&gt; Rep TxMintRow x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep TxMintRow x -&gt; TxMintRow
$cfrom :: forall x. TxMintRow -&gt; Rep TxMintRow x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482934"><span class="annot"><span class="annottext">RowParser TxMintRow
RowParser TxMintRow -&gt; FromRow TxMintRow
forall a. RowParser a -&gt; FromRow a
fromRow :: RowParser TxMintRow
$cfromRow :: RowParser TxMintRow
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">SQL.FromRow</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482931"><span class="annot"><span class="annottext">TxMintRow -&gt; [SQLData]
(TxMintRow -&gt; [SQLData]) -&gt; ToRow TxMintRow
forall a. (a -&gt; [SQLData]) -&gt; ToRow a
toRow :: TxMintRow -&gt; [SQLData]
$ctoRow :: TxMintRow -&gt; [SQLData]
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">SQL.ToRow</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span id="txMintRowTxId"><span id="txMintRowSlotNo"><span id="txMintRowRedeemerIdx"><span id="txMintRowRedeemerData"><span id="txMintRowQuantity"><span id="txMintRowPolicyId"><span id="txMintRowBlockHeaderHash"><span id="txMintRowAssetName"><span class="hs-identifier">makeLenses</span><span> </span><span class="hs-special">'</span><span class="hs-identifier">TxMintRow</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679482919"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679482917"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser TxMintRow
</span><a href="#local-6989586621679482917"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Object</span></a></span><span> </span><span id="local-6989586621679482916"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; TxId
-&gt; PolicyId
-&gt; AssetName
-&gt; Quantity
-&gt; Word64
-&gt; ScriptData
-&gt; TxMintRow
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-var">TxMintRow</span></a></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">(SlotNo
 -&gt; Hash BlockHeader
 -&gt; TxId
 -&gt; PolicyId
 -&gt; AssetName
 -&gt; Quantity
 -&gt; Word64
 -&gt; ScriptData
 -&gt; TxMintRow)
-&gt; Parser SlotNo
-&gt; Parser
     (Hash BlockHeader
      -&gt; TxId
      -&gt; PolicyId
      -&gt; AssetName
      -&gt; Quantity
      -&gt; Word64
      -&gt; ScriptData
      -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser SlotNo
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;slotNo&quot;</span></span><span>
</span><span id="line-156"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Hash BlockHeader
   -&gt; TxId
   -&gt; PolicyId
   -&gt; AssetName
   -&gt; Quantity
   -&gt; Word64
   -&gt; ScriptData
   -&gt; TxMintRow)
-&gt; Parser (Hash BlockHeader)
-&gt; Parser
     (TxId
      -&gt; PolicyId
      -&gt; AssetName
      -&gt; Quantity
      -&gt; Word64
      -&gt; ScriptData
      -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Hash BlockHeader)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;blockHeaderHash&quot;</span></span><span>
</span><span id="line-157"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (TxId
   -&gt; PolicyId
   -&gt; AssetName
   -&gt; Quantity
   -&gt; Word64
   -&gt; ScriptData
   -&gt; TxMintRow)
-&gt; Parser TxId
-&gt; Parser
     (PolicyId
      -&gt; AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser TxId
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;txId&quot;</span></span><span>
</span><span id="line-158"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (PolicyId
   -&gt; AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
-&gt; Parser PolicyId
-&gt; Parser
     (AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser PolicyId
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;policyId&quot;</span></span><span>
</span><span id="line-159"></span><span>            </span><span class="annot"><span class="annottext">Parser (AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
-&gt; Parser AssetName
-&gt; Parser (Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser AssetName
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;assetName&quot;</span></span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">Parser (Quantity -&gt; Word64 -&gt; ScriptData -&gt; TxMintRow)
-&gt; Parser Quantity -&gt; Parser (Word64 -&gt; ScriptData -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Quantity
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;quantity&quot;</span></span><span>
</span><span id="line-161"></span><span>            </span><span class="annot"><span class="annottext">Parser (Word64 -&gt; ScriptData -&gt; TxMintRow)
-&gt; Parser Word64 -&gt; Parser (ScriptData -&gt; TxMintRow)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Word64
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;redeemerIdx&quot;</span></span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">Parser (ScriptData -&gt; TxMintRow)
-&gt; Parser ScriptData -&gt; Parser TxMintRow
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679482916"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser ScriptData
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;redeemerData&quot;</span></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser TxMintRow
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679482908"><span id="local-6989586621679482910"><span id="local-6989586621679482912"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679482906"><span class="annot"><span class="annottext">toJSON :: TxMintRow -&gt; Value
</span><a href="#local-6989586621679482906"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span> </span><span id="local-6989586621679482905"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482905"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span id="local-6989586621679482904"><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679482904"><span class="hs-identifier hs-var">bhh</span></a></span></span><span> </span><span id="local-6989586621679482903"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482903"><span class="hs-identifier hs-var">txId</span></a></span></span><span> </span><span id="local-6989586621679482902"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679482902"><span class="hs-identifier hs-var">policyId</span></a></span></span><span> </span><span id="local-6989586621679482901"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482901"><span class="hs-identifier hs-var">assetName</span></a></span></span><span> </span><span id="local-6989586621679482900"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679482900"><span class="hs-identifier hs-var">qty</span></a></span></span><span> </span><span id="local-6989586621679482899"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482899"><span class="hs-identifier hs-var">redIdx</span></a></span></span><span> </span><span id="local-6989586621679482898"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679482898"><span class="hs-identifier hs-var">redData</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">object</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;slotNo&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; SlotNo -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482905"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;blockHeaderHash&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Hash BlockHeader -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679482904"><span class="hs-identifier hs-var">bhh</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;txId&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; TxId -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482903"><span class="hs-identifier hs-var">txId</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;policyId&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; PolicyId -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679482902"><span class="hs-identifier hs-var">policyId</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;assetName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; AssetName -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482901"><span class="hs-identifier hs-var">assetName</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;quantity&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Quantity -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679482900"><span class="hs-identifier hs-var">qty</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;redeemerIdx&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Word64 -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482899"><span class="hs-identifier hs-var">redIdx</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;redeemerData&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; ScriptData -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679482898"><span class="hs-identifier hs-var">redData</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInit"><span class="hs-identifier hs-type">sqliteInit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="sqliteInit"><span class="annot"><span class="annottext">sqliteInit :: Connection -&gt; IO ()
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInit"><span class="hs-identifier hs-var hs-var">sqliteInit</span></a></span></span><span> </span><span id="local-6989586621679482896"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482896"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482896"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot; CREATE TABLE IF NOT EXISTS        \
    \   minting_policy_events           \
    \   ( slotNo          INT NOT NULL  \
    \   , blockHeaderHash INT NOT NULL  \
    \   , txId            BLOB NOT NULL \
    \   , policyId        BLOB NOT NULL \
    \   , assetName       TEXT NOT NULL \
    \   , quantity        INT NOT NULL  \
    \   , redeemerIx      INT NOT NULL  \
    \   , redeemerData    BLOB NOT NULL)&quot;</span></span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482896"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot; CREATE INDEX IF NOT EXISTS               \
    \    minting_policy_events__txId_policyId  \
    \ ON minting_policy_events (txId, policyId)&quot;</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInsert"><span class="hs-identifier hs-type">sqliteInsert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Connection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="sqliteInsert"><span class="annot"><span class="annottext">sqliteInsert :: Connection -&gt; [TxMintEvent] -&gt; IO ()
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInsert"><span class="hs-identifier hs-var hs-var">sqliteInsert</span></a></span></span><span> </span><span id="local-6989586621679482893"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482893"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679482892"><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482892"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [TxMintRow] -&gt; IO ()
forall q. ToRow q =&gt; Connection -&gt; Query -&gt; [q] -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.executeMany</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482893"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679482890"><span class="hs-identifier hs-var">template</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintRow] -&gt; IO ()) -&gt; [TxMintRow] -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; [TxMintRow]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#toRows"><span class="hs-identifier hs-var">toRows</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; [TxMintRow]) -&gt; [TxMintEvent] -&gt; [TxMintRow]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent] -&gt; [TxMintEvent]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482892"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679482890"><span class="annot"><span class="annottext">template :: Query
</span><a href="#local-6989586621679482890"><span class="hs-identifier hs-var hs-var">template</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-199"></span><span>      </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;INSERT INTO minting_policy_events \
      \ ( slotNo, blockHeaderHash, txId  \
      \ , policyId, assetName, quantity  \
      \ , redeemerIx, redeemerData )     \
      \ VALUES (?, ?, ?, ?, ?, ?, ?, ?)  &quot;</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#toRows"><span class="hs-identifier hs-type">toRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-206"></span><span id="toRows"><span class="annot"><span class="annottext">toRows :: TxMintEvent -&gt; [TxMintRow]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#toRows"><span class="hs-identifier hs-var hs-var">toRows</span></a></span></span><span> </span><span id="local-6989586621679482887"><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482887"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679482886"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482886"><span class="hs-identifier hs-var">txId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482885"><span class="annot"><span class="annottext">NonEmpty MintAsset
</span><a href="#local-6989586621679482885"><span class="hs-identifier hs-var">txMintAssets</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (TxId, NonEmpty MintAsset) -&gt; [(TxId, NonEmpty MintAsset)]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (TxId, NonEmpty MintAsset)
 -&gt; [(TxId, NonEmpty MintAsset)])
-&gt; NonEmpty (TxId, NonEmpty MintAsset)
-&gt; [(TxId, NonEmpty MintAsset)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; NonEmpty (TxId, NonEmpty MintAsset)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventTxAssets"><span class="hs-identifier hs-var hs-var">txMintEventTxAssets</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482887"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679482883"><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty MintAsset -&gt; [MintAsset]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty MintAsset
</span><a href="#local-6989586621679482885"><span class="hs-identifier hs-var">txMintAssets</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">TxMintRow -&gt; [TxMintRow]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintRow -&gt; [TxMintRow]) -&gt; TxMintRow -&gt; [TxMintRow]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; TxId
-&gt; PolicyId
-&gt; AssetName
-&gt; Quantity
-&gt; Word64
-&gt; ScriptData
-&gt; TxMintRow
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-var">TxMintRow</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482887"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482887"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482886"><span class="hs-identifier hs-var">txId</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintAsset -&gt; PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetPolicyId"><span class="hs-identifier hs-var hs-var">mintAssetPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintAsset -&gt; AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetAssetName"><span class="hs-identifier hs-var hs-var">mintAssetAssetName</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintAsset -&gt; Quantity
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetQuantity"><span class="hs-identifier hs-var hs-var">mintAssetQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintAsset -&gt; Word64
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetRedeemerIdx"><span class="hs-identifier hs-var hs-var">mintAssetRedeemerIdx</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintAsset -&gt; ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#mintAssetRedeemerData"><span class="hs-identifier hs-var hs-var">mintAssetRedeemerData</span></a></span><span> </span><span class="annot"><span class="annottext">MintAsset
</span><a href="#local-6989586621679482883"><span class="hs-identifier hs-var">mintAsset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Input rows must be sorted by C.SlotNo.</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromRows"><span class="hs-identifier hs-type">fromRows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-221"></span><span id="fromRows"><span class="annot"><span class="annottext">fromRows :: [TxMintRow] -&gt; [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromRows"><span class="hs-identifier hs-var hs-var">fromRows</span></a></span></span><span> </span><span id="local-6989586621679482881"><span class="annot"><span class="annottext">[TxMintRow]
</span><a href="#local-6989586621679482881"><span class="hs-identifier hs-var">rows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679482880"><span class="annot"><span class="annottext">rs :: NonEmpty TxMintRow
</span><a href="#local-6989586621679482880"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679482879"><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482879"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-type">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintRow]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; [TxMintRow] -&gt; [NonEmpty TxMintRow]
forall (f :: * -&gt; *) a.
Foldable f =&gt;
(a -&gt; a -&gt; Bool) -&gt; f a -&gt; [NonEmpty a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotNo -&gt; SlotNo -&gt; Bool)
-&gt; (TxMintRow -&gt; SlotNo) -&gt; TxMintRow -&gt; TxMintRow -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; SlotNo
</span><a href="#local-6989586621679482877"><span class="hs-identifier hs-var">slotNo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxMintRow]
</span><a href="#local-6989586621679482881"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-comment">-- group by SlotNo</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">TxMintEvent -&gt; [TxMintEvent]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; [TxMintEvent]) -&gt; TxMintEvent -&gt; [TxMintEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; NonEmpty (TxId, NonEmpty MintAsset)
-&gt; TxMintEvent
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-var">TxMintEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow -&gt; SlotNo
</span><a href="#local-6989586621679482877"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482879"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow -&gt; Hash BlockHeader
</span><a href="#local-6989586621679482876"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482879"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (TxId, NonEmpty MintAsset) -&gt; TxMintEvent)
-&gt; NonEmpty (TxId, NonEmpty MintAsset) -&gt; TxMintEvent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-224"></span><span>    </span><span id="local-6989586621679482875"><span class="annot"><span class="annottext">NonEmpty TxMintRow
</span><a href="#local-6989586621679482875"><span class="hs-identifier hs-var">rs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxMintRow -&gt; TxMintRow -&gt; Bool)
-&gt; NonEmpty TxMintRow -&gt; NonEmpty (NonEmpty TxMintRow)
forall a. (a -&gt; a -&gt; Bool) -&gt; NonEmpty a -&gt; NonEmpty (NonEmpty a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.groupBy1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">(TxId -&gt; TxId -&gt; Bool)
-&gt; (TxMintRow -&gt; TxId) -&gt; TxMintRow -&gt; TxMintRow -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; TxId
</span><a href="#local-6989586621679482873"><span class="hs-identifier hs-var">txId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty TxMintRow
</span><a href="#local-6989586621679482880"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-comment">-- group by TxId</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">(TxId, NonEmpty MintAsset) -&gt; NonEmpty (TxId, NonEmpty MintAsset)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow -&gt; TxId
</span><a href="#local-6989586621679482873"><span class="hs-identifier hs-var">txId</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482879"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; MintAsset
</span><a href="#local-6989586621679482872"><span class="hs-identifier hs-var">rowToMintAsset</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintRow -&gt; MintAsset)
-&gt; NonEmpty TxMintRow -&gt; NonEmpty MintAsset
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty TxMintRow
</span><a href="#local-6989586621679482875"><span class="hs-identifier hs-var">rs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679482877"><span class="annot"><span class="annottext">slotNo :: TxMintRow -&gt; SlotNo
</span><a href="#local-6989586621679482877"><span class="hs-identifier hs-var hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting SlotNo TxMintRow SlotNo -&gt; TxMintRow -&gt; SlotNo
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting SlotNo TxMintRow SlotNo
Lens' TxMintRow SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowSlotNo"><span class="hs-identifier hs-var">txMintRowSlotNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span id="local-6989586621679482876"><span class="annot"><span class="annottext">hash :: TxMintRow -&gt; Hash BlockHeader
</span><a href="#local-6989586621679482876"><span class="hs-identifier hs-var hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting (Hash BlockHeader) TxMintRow (Hash BlockHeader)
-&gt; TxMintRow -&gt; Hash BlockHeader
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Hash BlockHeader) TxMintRow (Hash BlockHeader)
Lens' TxMintRow (Hash BlockHeader)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowBlockHeaderHash"><span class="hs-identifier hs-var">txMintRowBlockHeaderHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Hash</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BlockHeader</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span id="local-6989586621679482873"><span class="annot"><span class="annottext">txId :: TxMintRow -&gt; TxId
</span><a href="#local-6989586621679482873"><span class="hs-identifier hs-var hs-var">txId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting TxId TxMintRow TxId -&gt; TxMintRow -&gt; TxId
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><a href="../../../../lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">Getting TxId TxMintRow TxId
Lens' TxMintRow TxId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowTxId"><span class="hs-identifier hs-var">txMintRowTxId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxId</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="#local-6989586621679482872"><span class="hs-identifier hs-type">rowToMintAsset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-type">MintAsset</span></a></span><span>
</span><span id="line-231"></span><span>    </span><span id="local-6989586621679482872"><span class="annot"><span class="annottext">rowToMintAsset :: TxMintRow -&gt; MintAsset
</span><a href="#local-6989586621679482872"><span class="hs-identifier hs-var hs-var">rowToMintAsset</span></a></span></span><span> </span><span id="local-6989586621679482871"><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-232"></span><span>        </span><span class="annot"><span class="annottext">PolicyId
-&gt; AssetName -&gt; Quantity -&gt; Word64 -&gt; ScriptData -&gt; MintAsset
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-var">MintAsset</span></a></span><span>
</span><span id="line-233"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; Getting PolicyId TxMintRow PolicyId -&gt; PolicyId
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../../../../lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting PolicyId TxMintRow PolicyId
Lens' TxMintRow PolicyId
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowPolicyId"><span class="hs-identifier hs-var">txMintRowPolicyId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; Getting AssetName TxMintRow AssetName -&gt; AssetName
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../../../../lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting AssetName TxMintRow AssetName
Lens' TxMintRow AssetName
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowAssetName"><span class="hs-identifier hs-var">txMintRowAssetName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; Getting Quantity TxMintRow Quantity -&gt; Quantity
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../../../../lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Quantity TxMintRow Quantity
Lens' TxMintRow Quantity
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowQuantity"><span class="hs-identifier hs-var">txMintRowQuantity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; Getting Word64 TxMintRow Word64 -&gt; Word64
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../../../../lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting Word64 TxMintRow Word64
Lens' TxMintRow Word64
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowRedeemerIdx"><span class="hs-identifier hs-var">txMintRowRedeemerIdx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintRow
</span><a href="#local-6989586621679482871"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintRow -&gt; Getting ScriptData TxMintRow ScriptData -&gt; ScriptData
forall s a. s -&gt; Getting a s a -&gt; a
</span><a href="../../../../lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting ScriptData TxMintRow ScriptData
Lens' TxMintRow ScriptData
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintRowRedeemerData"><span class="hs-identifier hs-var">txMintRowRedeemerData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#queryStoredTxMintEvents"><span class="hs-identifier hs-type">queryStoredTxMintEvents</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Connection</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Query</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">NamedParam</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-243"></span><span id="queryStoredTxMintEvents"><span class="annot"><span class="annottext">queryStoredTxMintEvents :: Connection -&gt; ([Query], [NamedParam]) -&gt; IO [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#queryStoredTxMintEvents"><span class="hs-identifier hs-var hs-var">queryStoredTxMintEvents</span></a></span></span><span> </span><span id="local-6989586621679482869"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482869"><span class="hs-identifier hs-var">sqlCon</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482868"><span class="annot"><span class="annottext">[Query]
</span><a href="#local-6989586621679482868"><span class="hs-identifier hs-var">conditions</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482867"><span class="annot"><span class="annottext">[NamedParam]
</span><a href="#local-6989586621679482867"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><span class="annottext">([TxMintRow] -&gt; [TxMintEvent])
-&gt; IO [TxMintRow] -&gt; IO [TxMintEvent]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintRow] -&gt; [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromRows"><span class="hs-identifier hs-var">fromRows</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [TxMintRow] -&gt; IO [TxMintEvent])
-&gt; IO [TxMintRow] -&gt; IO [TxMintEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; [NamedParam] -&gt; IO [TxMintRow]
forall r.
FromRow r =&gt;
Connection -&gt; Query -&gt; [NamedParam] -&gt; IO [r]
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.queryNamed</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482869"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Query
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.Query</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679482864"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[NamedParam]
</span><a href="#local-6989586621679482867"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679482863"><span class="annot"><span class="annottext">allConditions :: Text
</span><a href="#local-6989586621679482863"><span class="hs-identifier hs-var hs-var">allConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Text] -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">Text.intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; AND &quot;</span></span><span> </span><span class="annot"><span class="annottext">([Text] -&gt; Text) -&gt; [Text] -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Query -&gt; Text) -&gt; [Query] -&gt; [Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Query -&gt; Text
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var hs-var">SQL.fromQuery</span></a></span><span> </span><span class="annot"><span class="annottext">[Query]
</span><a href="#local-6989586621679482868"><span class="hs-identifier hs-var">conditions</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span id="local-6989586621679482860"><span class="annot"><span class="annottext">whereClause :: Text
</span><a href="#local-6989586621679482860"><span class="hs-identifier hs-var hs-var">whereClause</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679482863"><span class="hs-identifier hs-var">allConditions</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;WHERE &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679482863"><span class="hs-identifier hs-var">allConditions</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679482864"><span class="annot"><span class="annottext">query :: Text
</span><a href="#local-6989586621679482864"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; SELECT slotNo, blockHeaderHash, txId, policyId       \
          \      , assetName, quantity, redeemerIx, redeemerData \
          \   FROM minting_policy_events                         \
          \   &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679482860"><span class="hs-identifier hs-var">whereClause</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;                              \
          \  ORDER BY slotNo, txId                               &quot;</span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#intervalToWhereClause"><span class="hs-identifier hs-type">intervalToWhereClause</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.QueryInterval</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Query</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">NamedParam</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span id="intervalToWhereClause"><span class="annot"><span class="annottext">intervalToWhereClause :: QueryInterval ChainPoint -&gt; ([Query], [NamedParam])
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#intervalToWhereClause"><span class="hs-identifier hs-var hs-var">intervalToWhereClause</span></a></span></span><span> </span><span id="local-6989586621679482858"><span class="annot"><span class="annottext">QueryInterval ChainPoint
</span><a href="#local-6989586621679482858"><span class="hs-identifier hs-var">qi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QueryInterval ChainPoint
</span><a href="#local-6989586621679482858"><span class="hs-identifier hs-var">qi</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><span class="annottext">QueryInterval ChainPoint
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.QEverything</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.QInterval</span></a></span><span> </span><span id="local-6989586621679482855"><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679482855"><span class="hs-identifier hs-var">from</span></a></span></span><span> </span><span id="local-6989586621679482854"><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679482854"><span class="hs-identifier hs-var">to</span></a></span></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482853"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482853"><span class="hs-identifier hs-var">from'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; Maybe SlotNo
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var">slotMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679482855"><span class="hs-identifier hs-var">from</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482851"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482851"><span class="hs-identifier hs-var">to'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; Maybe SlotNo
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var">slotMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679482854"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;slotNo BETWEEN :fromSlot AND :toSlot&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:fromSlot&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SlotNo -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482853"><span class="hs-identifier hs-var">from'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:toSlot&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SlotNo -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482851"><span class="hs-identifier hs-var">to'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482850"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482850"><span class="hs-identifier hs-var">to'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; Maybe SlotNo
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var">slotMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679482854"><span class="hs-identifier hs-var">to</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;slotNo &lt;= :toSlot&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:toSlot&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SlotNo -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482850"><span class="hs-identifier hs-var">to'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;FALSE&quot;</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><a href="#local-6989586621679482852"><span class="hs-identifier hs-type">slotMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679482852"><span class="annot"><span class="annottext">slotMaybe :: ChainPoint -&gt; Maybe SlotNo
</span><a href="#local-6989586621679482852"><span class="hs-identifier hs-var hs-var">slotMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span> </span><span id="local-6989586621679482848"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482848"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Hash BlockHeader
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Maybe SlotNo
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482848"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ChainPointAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#groupBySlotAndHash"><span class="hs-identifier hs-type">groupBySlotAndHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span id="groupBySlotAndHash"><span class="annot"><span class="annottext">groupBySlotAndHash :: [TxMintEvent] -&gt; [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#groupBySlotAndHash"><span class="hs-identifier hs-var hs-var">groupBySlotAndHash</span></a></span></span><span> </span><span id="local-6989586621679482845"><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482845"><span class="hs-identifier hs-var">events</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482845"><span class="hs-identifier hs-var">events</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">[TxMintEvent] -&gt; ([TxMintEvent] -&gt; [TxMintEvent]) -&gt; [TxMintEvent]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent] -&gt; [TxMintEvent]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sort</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="annottext">[TxMintEvent]
-&gt; ([TxMintEvent] -&gt; [[TxMintEvent]]) -&gt; [[TxMintEvent]]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; TxMintEvent -&gt; Bool)
-&gt; [TxMintEvent] -&gt; [[TxMintEvent]]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [[a]]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">groupBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482844"><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482844"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679482843"><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482843"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482844"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482843"><span class="hs-identifier hs-var">e2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482844"><span class="hs-identifier hs-var">e1</span></a></span><span> </span><span class="annot"><span class="annottext">Hash BlockHeader -&gt; Hash BlockHeader -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482843"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">[[TxMintEvent]]
-&gt; ([[TxMintEvent]] -&gt; [TxMintEvent]) -&gt; [TxMintEvent]
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintEvent] -&gt; [TxMintEvent])
-&gt; [[TxMintEvent]] -&gt; [TxMintEvent]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span id="local-6989586621679482840"><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482840"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679482839"><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482839"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; NonEmpty (TxId, NonEmpty MintAsset)
-&gt; TxMintEvent
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-var">TxMintEvent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482840"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482840"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(NonEmpty (TxId, NonEmpty MintAsset) -&gt; TxMintEvent)
-&gt; NonEmpty (TxId, NonEmpty MintAsset) -&gt; TxMintEvent
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; NonEmpty (TxId, NonEmpty MintAsset)
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventTxAssets"><span class="hs-identifier hs-var hs-var">txMintEventTxAssets</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; NonEmpty (TxId, NonEmpty MintAsset))
-&gt; NonEmpty TxMintEvent -&gt; NonEmpty (TxId, NonEmpty MintAsset)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482840"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; [TxMintEvent] -&gt; NonEmpty TxMintEvent
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482839"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-273"></span><span>                     </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- * Indexer</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-keyword">data</span><span> </span><span id="MintBurnHandle"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-var">MintBurnHandle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MintBurnHandle"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-var">MintBurnHandle</span></a></span></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="sqlConnection"><span class="annot"><span class="annottext">MintBurnHandle -&gt; Connection
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqlConnection"><span class="hs-identifier hs-var hs-var">sqlConnection</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-type">SQL.Connection</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="securityParam"><span class="annot"><span class="annottext">MintBurnHandle -&gt; SecurityParam
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#securityParam"><span class="hs-identifier hs-var hs-var">securityParam</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Marconi.ChainIndex.Types.html#SecurityParam"><span class="hs-identifier hs-type">SecurityParam</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-281"></span><span>
</span><span id="line-282"></span><span class="hs-keyword">type</span><span> </span><span id="MintBurnIndexer"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnIndexer"><span class="hs-identifier hs-var">MintBurnIndexer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.State</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StorablePoint"><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.StorablePoint</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StorableMonad"><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.StorableMonad</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StorableEvent"><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.StorableEvent</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MintBurnEvent"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnEvent"><span class="hs-identifier hs-var">MintBurnEvent</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482829"><span id="local-6989586621679482831"><span id="local-6989586621679482833"><span class="annot"><span class="annottext">Int -&gt; StorableEvent MintBurnHandle -&gt; ShowS
[StorableEvent MintBurnHandle] -&gt; ShowS
StorableEvent MintBurnHandle -&gt; String
(Int -&gt; StorableEvent MintBurnHandle -&gt; ShowS)
-&gt; (StorableEvent MintBurnHandle -&gt; String)
-&gt; ([StorableEvent MintBurnHandle] -&gt; ShowS)
-&gt; Show (StorableEvent MintBurnHandle)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StorableEvent MintBurnHandle] -&gt; ShowS
$cshowList :: [StorableEvent MintBurnHandle] -&gt; ShowS
show :: StorableEvent MintBurnHandle -&gt; String
$cshow :: StorableEvent MintBurnHandle -&gt; String
showsPrec :: Int -&gt; StorableEvent MintBurnHandle -&gt; ShowS
$cshowsPrec :: Int -&gt; StorableEvent MintBurnHandle -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-keyword">data</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StorableQuery"><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.StorableQuery</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="QueryByAssetId"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#QueryByAssetId"><span class="hs-identifier hs-var">QueryByAssetId</span></a></span></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span class="hs-comment">-- ^ Query all transactions that minted a specific 'AssetId' until an upper bound slot in the</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-comment">-- blockchain. If the upper bound slot is 'Nothing', then we return everything.</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryAllMintBurn"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#QueryAllMintBurn"><span class="hs-identifier hs-var">QueryAllMintBurn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-slotting/html/src"><span class="hs-identifier hs-type">C.SlotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-comment">-- ^ Query all transactions that minted 'AssetId's until an upper bound slot in the blockchain. If</span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-comment">-- the upper bound slot is 'Nothing', then we return everything.</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482821"><span id="local-6989586621679482823"><span id="local-6989586621679482825"><span class="annot"><span class="annottext">Int -&gt; StorableQuery MintBurnHandle -&gt; ShowS
[StorableQuery MintBurnHandle] -&gt; ShowS
StorableQuery MintBurnHandle -&gt; String
(Int -&gt; StorableQuery MintBurnHandle -&gt; ShowS)
-&gt; (StorableQuery MintBurnHandle -&gt; String)
-&gt; ([StorableQuery MintBurnHandle] -&gt; ShowS)
-&gt; Show (StorableQuery MintBurnHandle)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StorableQuery MintBurnHandle] -&gt; ShowS
$cshowList :: [StorableQuery MintBurnHandle] -&gt; ShowS
show :: StorableQuery MintBurnHandle -&gt; String
$cshow :: StorableQuery MintBurnHandle -&gt; String
showsPrec :: Int -&gt; StorableQuery MintBurnHandle -&gt; ShowS
$cshowsPrec :: Int -&gt; StorableQuery MintBurnHandle -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-keyword">newtype</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="StorableResult"><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.StorableResult</span></a></span></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MintBurnResult"><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnResult"><span class="hs-identifier hs-var">MintBurnResult</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-type">TxMintRow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482814"><span id="local-6989586621679482816"><span id="local-6989586621679482818"><span class="annot"><span class="annottext">Int -&gt; StorableResult MintBurnHandle -&gt; ShowS
[StorableResult MintBurnHandle] -&gt; ShowS
StorableResult MintBurnHandle -&gt; String
(Int -&gt; StorableResult MintBurnHandle -&gt; ShowS)
-&gt; (StorableResult MintBurnHandle -&gt; String)
-&gt; ([StorableResult MintBurnHandle] -&gt; ShowS)
-&gt; Show (StorableResult MintBurnHandle)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StorableResult MintBurnHandle] -&gt; ShowS
$cshowList :: [StorableResult MintBurnHandle] -&gt; ShowS
show :: StorableResult MintBurnHandle -&gt; String
$cshow :: StorableResult MintBurnHandle -&gt; String
showsPrec :: Int -&gt; StorableResult MintBurnHandle -&gt; ShowS
$cshowsPrec :: Int -&gt; StorableResult MintBurnHandle -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.Queryable</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679482811"><span class="annot"><span class="annottext">queryStorage :: QueryInterval (StorablePoint MintBurnHandle)
-&gt; f (StorableEvent MintBurnHandle)
-&gt; MintBurnHandle
-&gt; StorableQuery MintBurnHandle
-&gt; StorableMonad MintBurnHandle (StorableResult MintBurnHandle)
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">queryStorage</span></a></span></span><span> </span><span id="local-6989586621679482809"><span class="annot"><span class="annottext">QueryInterval (StorablePoint MintBurnHandle)
</span><a href="#local-6989586621679482809"><span class="hs-identifier hs-var">queryInterval</span></a></span></span><span> </span><span id="local-6989586621679482808"><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle)
</span><a href="#local-6989586621679482808"><span class="hs-identifier hs-var">memoryEvents</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span id="local-6989586621679482807"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482807"><span class="hs-identifier hs-var">sqlCon</span></a></span></span><span> </span><span id="local-6989586621679482806"><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482806"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679482805"><span class="annot"><span class="annottext">StorableQuery MintBurnHandle
</span><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorableQuery MintBurnHandle
</span><a href="#local-6989586621679482805"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#QueryAllMintBurn"><span class="hs-identifier hs-type">QueryAllMintBurn</span></a></span><span> </span><span id="local-6989586621679482804"><span class="annot"><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482803"><span class="annot"><span class="annottext">slotCondition :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482803"><span class="hs-identifier hs-var hs-var">slotCondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>                      </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482802"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482802"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;slotNo &lt;= :slotNo&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:slotNo&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SlotNo -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482802"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                </span><span id="local-6989586621679482801"><span class="annot"><span class="annottext">conditions :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482801"><span class="hs-identifier hs-var hs-var">conditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482800"><span class="hs-identifier hs-var">interval</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
-&gt; ([Query], [NamedParam]) -&gt; ([Query], [NamedParam])
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482803"><span class="hs-identifier hs-var">slotCondition</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">Maybe SlotNo -&gt; [TxMintEvent] -&gt; StorableResult MintBurnHandle
</span><a href="#local-6989586621679482799"><span class="hs-identifier hs-var">toResult</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482804"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintEvent] -&gt; StorableResult MintBurnHandle)
-&gt; IO [TxMintEvent] -&gt; IO (StorableResult MintBurnHandle)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ([Query], [NamedParam]) -&gt; IO [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#queryStoredTxMintEvents"><span class="hs-identifier hs-var">queryStoredTxMintEvents</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482807"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482801"><span class="hs-identifier hs-var">conditions</span></a></span><span>
</span><span id="line-315"></span><span>        </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#QueryByAssetId"><span class="hs-identifier hs-type">QueryByAssetId</span></a></span><span> </span><span id="local-6989586621679482798"><span class="annot"><a href="#local-6989586621679482798"><span class="hs-identifier hs-var">policyId</span></a></span></span><span> </span><span id="local-6989586621679482797"><span class="annot"><a href="#local-6989586621679482797"><span class="hs-identifier hs-var">assetName</span></a></span></span><span> </span><span id="local-6989586621679482796"><span class="annot"><a href="#local-6989586621679482796"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482795"><span class="annot"><span class="annottext">slotCondition :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482795"><span class="hs-identifier hs-var hs-var">slotCondition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-317"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482796"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-318"></span><span>                      </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>                      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482794"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482794"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;slotNo &lt;= :slotNo&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:slotNo&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; SlotNo -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482794"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482793"><span class="annot"><span class="annottext">assetIdConditions :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482793"><span class="hs-identifier hs-var hs-var">assetIdConditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;policyId = :policyId AND assetName = :assetName&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-322"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:policyId&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PolicyId -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679482798"><span class="hs-identifier hs-var">policyId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:assetName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; AssetName -&gt; NamedParam
forall v. ToField v =&gt; Text -&gt; v -&gt; NamedParam
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-operator hs-var">:=</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482797"><span class="hs-identifier hs-var">assetName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-323"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>                </span><span id="local-6989586621679482792"><span class="annot"><span class="annottext">conditions :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482792"><span class="hs-identifier hs-var hs-var">conditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482800"><span class="hs-identifier hs-var">interval</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
-&gt; ([Query], [NamedParam]) -&gt; ([Query], [NamedParam])
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482793"><span class="hs-identifier hs-var">assetIdConditions</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
-&gt; ([Query], [NamedParam]) -&gt; ([Query], [NamedParam])
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482795"><span class="hs-identifier hs-var">slotCondition</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">Maybe SlotNo -&gt; [TxMintEvent] -&gt; StorableResult MintBurnHandle
</span><a href="#local-6989586621679482799"><span class="hs-identifier hs-var">toResult</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482796"><span class="hs-identifier hs-var">slotNo</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintEvent] -&gt; StorableResult MintBurnHandle)
-&gt; IO [TxMintEvent] -&gt; IO (StorableResult MintBurnHandle)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; ([Query], [NamedParam]) -&gt; IO [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#queryStoredTxMintEvents"><span class="hs-identifier hs-var">queryStoredTxMintEvents</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482807"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="annot"><span class="annottext">([Query], [NamedParam])
</span><a href="#local-6989586621679482792"><span class="hs-identifier hs-var">conditions</span></a></span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>          </span><span id="local-6989586621679482799"><span class="annot"><span class="annottext">toResult :: Maybe SlotNo -&gt; [TxMintEvent] -&gt; StorableResult MintBurnHandle
</span><a href="#local-6989586621679482799"><span class="hs-identifier hs-var hs-var">toResult</span></a></span></span><span> </span><span id="local-6989586621679482791"><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482791"><span class="hs-identifier hs-var">querySlotNo</span></a></span></span><span> </span><span id="local-6989586621679482790"><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482790"><span class="hs-identifier hs-var">storedEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TxMintRow] -&gt; StorableResult MintBurnHandle
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnResult"><span class="hs-identifier hs-var">MintBurnResult</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintRow] -&gt; StorableResult MintBurnHandle)
-&gt; [TxMintRow] -&gt; StorableResult MintBurnHandle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482789"><span class="annot"><span class="annottext">memoryEventsList :: [TxMintEvent]
</span><a href="#local-6989586621679482789"><span class="hs-identifier hs-var hs-var">memoryEventsList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StorableEvent MintBurnHandle -&gt; TxMintEvent)
-&gt; [StorableEvent MintBurnHandle] -&gt; [TxMintEvent]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">StorableEvent MintBurnHandle -&gt; TxMintEvent
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">([StorableEvent MintBurnHandle] -&gt; [TxMintEvent])
-&gt; [StorableEvent MintBurnHandle] -&gt; [TxMintEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle) -&gt; [StorableEvent MintBurnHandle]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle)
</span><a href="#local-6989586621679482808"><span class="hs-identifier hs-var">memoryEvents</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482788"><span class="annot"><span class="annottext">filteredMemoryEvents :: [TxMintEvent]
</span><a href="#local-6989586621679482788"><span class="hs-identifier hs-var hs-var">filteredMemoryEvents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="#local-6989586621679482791"><span class="hs-identifier hs-var">querySlotNo</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-331"></span><span>                      </span><span class="annot"><span class="annottext">Maybe SlotNo
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482789"><span class="hs-identifier hs-var">memoryEventsList</span></a></span><span>
</span><span id="line-332"></span><span>                      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679482787"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482787"><span class="hs-identifier hs-var">sn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; Bool) -&gt; [TxMintEvent] -&gt; [TxMintEvent]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482786"><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482786"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482786"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482787"><span class="hs-identifier hs-var">sn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482789"><span class="hs-identifier hs-var">memoryEventsList</span></a></span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintEvent"><span class="hs-identifier hs-type">TxMintEvent</span></a></span><span> </span><span id="local-6989586621679482784"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482784"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span id="local-6989586621679482783"><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679482783"><span class="hs-identifier hs-var">blockHeaderHash</span></a></span></span><span> </span><span id="local-6989586621679482782"><span class="annot"><span class="annottext">NonEmpty (TxId, NonEmpty MintAsset)
</span><a href="#local-6989586621679482782"><span class="hs-identifier hs-var">txAssets</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482788"><span class="hs-identifier hs-var">filteredMemoryEvents</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent] -&gt; [TxMintEvent] -&gt; [TxMintEvent]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintEvent]
</span><a href="#local-6989586621679482790"><span class="hs-identifier hs-var">storedEvents</span></a></span><span>
</span><span id="line-334"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679482781"><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482781"><span class="hs-identifier hs-var">txId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679482780"><span class="annot"><span class="annottext">NonEmpty MintAsset
</span><a href="#local-6989586621679482780"><span class="hs-identifier hs-var">mintAssets</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (TxId, NonEmpty MintAsset) -&gt; [(TxId, NonEmpty MintAsset)]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (TxId, NonEmpty MintAsset)
</span><a href="#local-6989586621679482782"><span class="hs-identifier hs-var">txAssets</span></a></span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintAsset"><span class="hs-identifier hs-type">MintAsset</span></a></span><span> </span><span id="local-6989586621679482779"><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679482779"><span class="hs-identifier hs-var">policyId</span></a></span></span><span> </span><span id="local-6989586621679482778"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482778"><span class="hs-identifier hs-var">assetName</span></a></span></span><span> </span><span id="local-6989586621679482777"><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679482777"><span class="hs-identifier hs-var">quantity</span></a></span></span><span> </span><span id="local-6989586621679482776"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482776"><span class="hs-identifier hs-var">redeemerIx</span></a></span></span><span> </span><span id="local-6989586621679482775"><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679482775"><span class="hs-identifier hs-var">redeemerData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty MintAsset -&gt; [MintAsset]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty MintAsset
</span><a href="#local-6989586621679482780"><span class="hs-identifier hs-var">mintAssets</span></a></span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">TxMintRow -&gt; [TxMintRow]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxMintRow -&gt; [TxMintRow]) -&gt; TxMintRow -&gt; [TxMintRow]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-337"></span><span>                </span><span class="annot"><span class="annottext">SlotNo
-&gt; Hash BlockHeader
-&gt; TxId
-&gt; PolicyId
-&gt; AssetName
-&gt; Quantity
-&gt; Word64
-&gt; ScriptData
-&gt; TxMintRow
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#TxMintRow"><span class="hs-identifier hs-var">TxMintRow</span></a></span><span>
</span><span id="line-338"></span><span>                    </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482784"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-339"></span><span>                    </span><span class="annot"><span class="annottext">Hash BlockHeader
</span><a href="#local-6989586621679482783"><span class="hs-identifier hs-var">blockHeaderHash</span></a></span><span>
</span><span id="line-340"></span><span>                    </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679482781"><span class="hs-identifier hs-var">txId</span></a></span><span>
</span><span id="line-341"></span><span>                    </span><span class="annot"><span class="annottext">PolicyId
</span><a href="#local-6989586621679482779"><span class="hs-identifier hs-var">policyId</span></a></span><span>
</span><span id="line-342"></span><span>                    </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679482778"><span class="hs-identifier hs-var">assetName</span></a></span><span>
</span><span id="line-343"></span><span>                    </span><span class="annot"><span class="annottext">Quantity
</span><a href="#local-6989586621679482777"><span class="hs-identifier hs-var">quantity</span></a></span><span>
</span><span id="line-344"></span><span>                    </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679482776"><span class="hs-identifier hs-var">redeemerIx</span></a></span><span>
</span><span id="line-345"></span><span>                    </span><span class="annot"><span class="annottext">ScriptData
</span><a href="#local-6989586621679482775"><span class="hs-identifier hs-var">redeemerData</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>          </span><span id="local-6989586621679482800"><span class="annot"><span class="annottext">interval :: ([Query], [NamedParam])
</span><a href="#local-6989586621679482800"><span class="hs-identifier hs-var hs-var">interval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">QueryInterval ChainPoint -&gt; ([Query], [NamedParam])
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#intervalToWhereClause"><span class="hs-identifier hs-var">intervalToWhereClause</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInterval ChainPoint
QueryInterval (StorablePoint MintBurnHandle)
</span><a href="#local-6989586621679482809"><span class="hs-identifier hs-var">queryInterval</span></a></span><span>
</span><span id="line-348"></span><span>
</span><span id="line-349"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.HasPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.StorableEvent</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621679482772"><span class="annot"><span class="annottext">getPoint :: StorableEvent MintBurnHandle -&gt; ChainPoint
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">getPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnEvent"><span class="hs-identifier hs-type">MintBurnEvent</span></a></span><span> </span><span id="local-6989586621679482770"><span class="annot"><a href="#local-6989586621679482770"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Hash BlockHeader -&gt; ChainPoint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ChainPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482770"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482770"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.Buffered</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>  </span><span id="local-6989586621679482766"><span class="annot"><span class="annottext">persistToStorage :: f (StorableEvent MintBurnHandle)
-&gt; MintBurnHandle -&gt; StorableMonad MintBurnHandle MintBurnHandle
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">persistToStorage</span></a></span></span><span> </span><span id="local-6989586621679482764"><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle)
</span><a href="#local-6989586621679482764"><span class="hs-identifier hs-var">events</span></a></span></span><span> </span><span id="local-6989586621679482763"><span class="annot"><span class="annottext">h :: MintBurnHandle
</span><a href="#local-6989586621679482763"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span id="local-6989586621679482762"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482762"><span class="hs-identifier hs-var">sqlCon</span></a></span></span><span> </span><span id="local-6989586621679482761"><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482761"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="annottext">Connection -&gt; [TxMintEvent] -&gt; IO ()
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInsert"><span class="hs-identifier hs-var">sqliteInsert</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482762"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StorableEvent MintBurnHandle -&gt; TxMintEvent)
-&gt; [StorableEvent MintBurnHandle] -&gt; [TxMintEvent]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StorableEvent MintBurnHandle -&gt; TxMintEvent
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span><span> </span><span class="annot"><span class="annottext">([StorableEvent MintBurnHandle] -&gt; [TxMintEvent])
-&gt; [StorableEvent MintBurnHandle] -&gt; [TxMintEvent]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle) -&gt; [StorableEvent MintBurnHandle]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">f (StorableEvent MintBurnHandle)
</span><a href="#local-6989586621679482764"><span class="hs-identifier hs-var">events</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><span class="annottext">MintBurnHandle -&gt; IO MintBurnHandle
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">MintBurnHandle
</span><a href="#local-6989586621679482763"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679482760"><span class="annot"><span class="annottext">getStoredEvents :: MintBurnHandle
-&gt; StorableMonad MintBurnHandle [StorableEvent MintBurnHandle]
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">getStoredEvents</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span id="local-6989586621679482758"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482758"><span class="hs-identifier hs-var">sqlCon</span></a></span></span><span> </span><span id="local-6989586621679482757"><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482757"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><span class="annottext">(TxMintEvent -&gt; StorableEvent MintBurnHandle)
-&gt; [TxMintEvent] -&gt; [StorableEvent MintBurnHandle]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent -&gt; StorableEvent MintBurnHandle
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnEvent"><span class="hs-identifier hs-var">MintBurnEvent</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintEvent] -&gt; [StorableEvent MintBurnHandle])
-&gt; ([TxMintRow] -&gt; [TxMintEvent])
-&gt; [TxMintRow]
-&gt; [StorableEvent MintBurnHandle]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[TxMintRow] -&gt; [TxMintEvent]
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#fromRows"><span class="hs-identifier hs-var">fromRows</span></a></span><span> </span><span class="annot"><span class="annottext">([TxMintRow] -&gt; [StorableEvent MintBurnHandle])
-&gt; IO [TxMintRow] -&gt; IO [StorableEvent MintBurnHandle]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; Only SecurityParam -&gt; IO [TxMintRow]
forall q r.
(ToRow q, FromRow r) =&gt;
Connection -&gt; Query -&gt; q -&gt; IO [r]
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.query</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482758"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><a href="#local-6989586621679482755"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecurityParam -&gt; Only SecurityParam
forall a. a -&gt; Only a
</span><a href="../../../../Only/html/src"><span class="hs-identifier hs-var">SQL.Only</span></a></span><span> </span><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482757"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>      </span><span id="local-6989586621679482755"><span class="annot"><span class="annottext">query :: Query
</span><a href="#local-6989586621679482755"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot; SELECT slotNo, blockHeaderHash, txId, policyId, assetName, quantity, \
        \        redeemerIx, redeemerData                                      \
        \   FROM minting_policy_events                                         \
        \  WHERE slotNo &gt;= (SELECT MAX(slotNo) - ? FROM minting_policy_events) \
        \  ORDER BY slotNo DESC, txId                                          &quot;</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.Resumable</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679482751"><span class="annot"><span class="annottext">resumeFromStorage :: MintBurnHandle
-&gt; StorableMonad MintBurnHandle [StorablePoint MintBurnHandle]
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">resumeFromStorage</span></a></span></span><span> </span><span id="local-6989586621679482749"><span class="annot"><span class="annottext">MintBurnHandle
</span><a href="#local-6989586621679482749"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621679482748"><span class="annot"><span class="annottext">[StorableEvent MintBurnHandle]
</span><a href="#local-6989586621679482748"><span class="hs-identifier hs-var">events</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MintBurnHandle
-&gt; StorableMonad MintBurnHandle [StorableEvent MintBurnHandle]
forall h. Buffered h =&gt; h -&gt; StorableMonad h [StorableEvent h]
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.getStoredEvents</span></a></span><span> </span><span class="annot"><span class="annottext">MintBurnHandle
</span><a href="#local-6989586621679482749"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">[ChainPoint] -&gt; IO [ChainPoint]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([ChainPoint] -&gt; IO [ChainPoint])
-&gt; [ChainPoint] -&gt; IO [ChainPoint]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(StorableEvent MintBurnHandle -&gt; ChainPoint)
-&gt; [StorableEvent MintBurnHandle] -&gt; [ChainPoint]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">StorableEvent MintBurnHandle -&gt; ChainPoint
</span><a href="#local-6989586621679482747"><span class="hs-identifier hs-var">getChainPoint</span></a></span><span> </span><span class="annot"><span class="annottext">[StorableEvent MintBurnHandle]
</span><a href="#local-6989586621679482748"><span class="hs-identifier hs-var">events</span></a></span><span> </span><span class="annot"><span class="annottext">[ChainPoint] -&gt; [ChainPoint] -&gt; [ChainPoint]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ChainPoint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ChainPointAtGenesis</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679482747"><span class="annot"><span class="annottext">getChainPoint :: StorableEvent MintBurnHandle -&gt; ChainPoint
</span><a href="#local-6989586621679482747"><span class="hs-identifier hs-var hs-var">getChainPoint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnEvent"><span class="hs-identifier hs-type">MintBurnEvent</span></a></span><span> </span><span id="local-6989586621679482746"><span class="annot"><a href="#local-6989586621679482746"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; Hash BlockHeader -&gt; ChainPoint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ChainPoint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; SlotNo
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventSlotNo"><span class="hs-identifier hs-var hs-var">txMintEventSlotNo</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482746"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxMintEvent -&gt; Hash BlockHeader
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#txMintEventBlockHeaderHash"><span class="hs-identifier hs-var hs-var">txMintEventBlockHeaderHash</span></a></span><span> </span><span class="annot"><span class="annottext">TxMintEvent
</span><a href="#local-6989586621679482746"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-type">RI.Rewindable</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-375"></span><span>  </span><span id="local-6989586621679482743"><span class="annot"><span class="annottext">rewindStorage :: StorablePoint MintBurnHandle
-&gt; MintBurnHandle
-&gt; StorableMonad MintBurnHandle (Maybe MintBurnHandle)
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rewindStorage</span></a></span></span><span> </span><span id="local-6989586621679482741"><span class="annot"><span class="annottext">StorablePoint MintBurnHandle
</span><a href="#local-6989586621679482741"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span id="local-6989586621679482740"><span class="annot"><span class="annottext">h :: MintBurnHandle
</span><a href="#local-6989586621679482740"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-type">MintBurnHandle</span></a></span><span> </span><span id="local-6989586621679482739"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482739"><span class="hs-identifier hs-var">sqlCon</span></a></span></span><span> </span><span id="local-6989586621679482738"><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482738"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679482737"><span class="hs-identifier hs-var">doRewind</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO (Maybe MintBurnHandle) -&gt; IO (Maybe MintBurnHandle)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MintBurnHandle -&gt; IO (Maybe MintBurnHandle)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintBurnHandle -&gt; Maybe MintBurnHandle
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">MintBurnHandle
</span><a href="#local-6989586621679482740"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>      </span><span id="local-6989586621679482737"><span class="annot"><span class="annottext">doRewind :: IO ()
</span><a href="#local-6989586621679482737"><span class="hs-identifier hs-var hs-var">doRewind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StorablePoint MintBurnHandle
</span><a href="#local-6989586621679482741"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-378"></span><span>        </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.ChainPoint</span></a></span><span> </span><span id="local-6989586621679482736"><span class="annot"><a href="#local-6989586621679482736"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>          </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; Only SlotNo -&gt; IO ()
forall q. ToRow q =&gt; Connection -&gt; Query -&gt; q -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.execute</span></a></span><span>  </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482739"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;DELETE FROM minting_policy_events WHERE slotNo &gt; ?&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SlotNo -&gt; Only SlotNo
forall a. a -&gt; Only a
</span><a href="../../../../Only/html/src"><span class="hs-identifier hs-var">SQL.Only</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679482736"><span class="hs-identifier hs-var">slotNo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><span class="annottext">StorablePoint MintBurnHandle
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ChainPointAtGenesis</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>          </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482739"><span class="hs-identifier hs-var">sqlCon</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;DELETE FROM minting_policy_events&quot;</span></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#open"><span class="hs-identifier hs-type">open</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Types.html#SecurityParam"><span class="hs-identifier hs-type">SecurityParam</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnIndexer"><span class="hs-identifier hs-type">MintBurnIndexer</span></a></span><span>
</span><span id="line-384"></span><span id="open"><span class="annot"><span class="annottext">open :: String -&gt; SecurityParam -&gt; IO MintBurnIndexer
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#open"><span class="hs-identifier hs-var hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679482732"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482732"><span class="hs-identifier hs-var">dbPath</span></a></span></span><span> </span><span id="local-6989586621679482731"><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482731"><span class="hs-identifier hs-var">bufferSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>  </span><span id="local-6989586621679482730"><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482730"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO Connection
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.open</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482732"><span class="hs-identifier hs-var">dbPath</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">Connection -&gt; Query -&gt; IO ()
</span><a href="../../../../sqlite-simple/html/src"><span class="hs-identifier hs-var">SQL.execute_</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482730"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Query
</span><span class="hs-string">&quot;PRAGMA journal_mode=WAL&quot;</span></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">Connection -&gt; IO ()
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#sqliteInit"><span class="hs-identifier hs-var">sqliteInit</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482730"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="annottext">Int
-&gt; MintBurnHandle -&gt; StorableMonad MintBurnHandle MintBurnIndexer
forall h.
PrimMonad (StorableMonad h) =&gt;
Int -&gt; h -&gt; StorableMonad h (State h)
</span><a href="../../../../marconi-core/html/src"><span class="hs-identifier hs-var">RI.emptyState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SecurityParam -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482731"><span class="hs-identifier hs-var">bufferSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Connection -&gt; SecurityParam -&gt; MintBurnHandle
</span><a href="Marconi.ChainIndex.Indexers.MintBurn.html#MintBurnHandle"><span class="hs-identifier hs-var">MintBurnHandle</span></a></span><span> </span><span class="annot"><span class="annottext">Connection
</span><a href="#local-6989586621679482730"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">SecurityParam
</span><a href="#local-6989586621679482731"><span class="hs-identifier hs-var">bufferSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span></pre></body></html>