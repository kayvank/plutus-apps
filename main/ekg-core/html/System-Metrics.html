<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>System.Metrics</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">ekg-core-0.1.1.7: Tracking of system metrics</span><ul class="links" id="page-menu"><li><a href="src/System.Metrics.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">System.Metrics</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Naming metrics</a></li><li><a href="#g:2">The metric store</a></li><li><a href="#g:3">Registering metrics</a><ul><li><a href="#g:4">Convenience functions</a></li><li><a href="#g:5">Predefined metrics</a></li></ul></li><li><a href="#g:6">Sampling metrics</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A module for defining metrics that can be monitored.</p><p>Metrics are used to monitor program behavior and performance. All
 metrics have</p><ul><li>a name, and</li><li>a way to get the metric's current value.</li></ul><p>This module provides a way to register metrics in a global &quot;metric
 store&quot;. The store can then be used to get a snapshot of all
 metrics. The store also serves as a central place to keep track of
 all the program's metrics, both user and library defined.</p><p>Here's an example of creating a single counter, used to count the
 number of request served by a web server:</p><pre>import System.Metrics
import qualified System.Metrics.Counter as Counter

main = do
    store &lt;- newStore
    requests &lt;- createCounter &quot;myapp.request_count&quot; store
    -- Every time we receive a request:
    Counter.inc requests</pre><p>This module also provides a way to register a number of predefined
 metrics that are useful in most applications. See e.g.
 <code><a href="System-Metrics.html#v:registerGcMetrics" title="System.Metrics">registerGcMetrics</a></code>.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Store">Store</a></li><li class="src short"><a href="#v:newStore">newStore</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></li><li class="src short"><a href="#v:registerCounter">registerCounter</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:registerGauge">registerGauge</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:registerLabel">registerLabel</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:registerDistribution">registerDistribution</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Distribution-Internal.html#t:Stats" title="System.Metrics.Distribution.Internal">Stats</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:registerGroup">registerGroup</a> :: <a href="../../unordered-containers/html/Data-HashMap-Strict.html#t:HashMap" title="Data.HashMap.Strict">HashMap</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> (a -&gt; <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a>) -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><a href="#v:createCounter">createCounter</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Counter.html#t:Counter" title="System.Metrics.Counter">Counter</a></li><li class="src short"><a href="#v:createGauge">createGauge</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Gauge.html#t:Gauge" title="System.Metrics.Gauge">Gauge</a></li><li class="src short"><a href="#v:createLabel">createLabel</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Label.html#t:Label" title="System.Metrics.Label">Label</a></li><li class="src short"><a href="#v:createDistribution">createDistribution</a> :: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Distribution.html#t:Distribution" title="System.Metrics.Distribution">Distribution</a></li><li class="src short"><a href="#v:registerGcMetrics">registerGcMetrics</a> :: <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</li><li class="src short"><span class="keyword">type</span> <a href="#t:Sample">Sample</a> = <a href="../../unordered-containers/html/Data-HashMap-Strict.html#t:HashMap" title="Data.HashMap.Strict">HashMap</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a></li><li class="src short"><a href="#v:sampleAll">sampleAll</a> :: <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics.html#t:Sample" title="System.Metrics">Sample</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:Value">Value</a><ul class="subs"><li>= <a href="#v:Counter">Counter</a> !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></li><li>| <a href="#v:Gauge">Gauge</a> !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></li><li>| <a href="#v:Label">Label</a> !<a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></li><li>| <a href="#v:Distribution">Distribution</a> !<a href="System-Metrics-Distribution-Internal.html#t:Stats" title="System.Metrics.Distribution.Internal">Stats</a></li></ul></li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Naming metrics</h1></a><div class="doc"><p>Compound metric names should be separated using underscores.
 Example: <code>request_count</code>. Periods in the name imply namespacing.
 Example: <code>&quot;myapp.users&quot;</code>. Some consumers of metrics will use
 these namespaces to group metrics in e.g. UIs.</p><p>Libraries and frameworks that want to register their own metrics
 should prefix them with a namespace, to avoid collision with
 user-defined metrics and metrics defined by other libraries. For
 example, the Snap web framework could prefix all its metrics with
 <code>&quot;snap.&quot;</code>.</p><p>It's customary to suffix the metric name with a short string
 explaining the metric's type e.g. using <code>&quot;_ms&quot;</code> to denote
 milliseconds.</p></div><a href="#g:2" id="g:2"><h1>The metric store</h1></a><div class="doc"><p>The metric store is a shared store of metrics. It allows several
 disjoint components (e.g. libraries) to contribute to the set of
 metrics exposed by an application. Libraries that want to provide a
 set of metrics should defined a register method, in the style of
 <code><a href="System-Metrics.html#v:registerGcMetrics" title="System.Metrics">registerGcMetrics</a></code>, that registers the metrics in the <code><a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></code>. The
 register function should document which metrics are registered and
 their types (i.e. counter, gauge, label, or distribution).</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Store" class="def">Store</a> <a href="src/System.Metrics.html#Store" class="link">Source</a> <a href="#t:Store" class="selflink">#</a></p><div class="doc"><p>A mutable metric store.</p></div></div><div class="top"><p class="src"><a id="v:newStore" class="def">newStore</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> <a href="src/System.Metrics.html#newStore" class="link">Source</a> <a href="#v:newStore" class="selflink">#</a></p><div class="doc"><p>Create a new, empty metric store.</p></div></div><a href="#g:3" id="g:3"><h1>Registering metrics</h1></a><div class="doc"><p>Before metrics can be sampled they need to be registered with the
 metric store. The same metric name can only be used once. Passing a
 metric name that has already been used to one of the register
 function is an <code><a href="../../ghc/html/libraries/base-4.14.3.0/Prelude.html#v:error" title="Prelude">error</a></code>.</p></div><div class="top"><p class="src"><a id="v:registerCounter" class="def">registerCounter</a> <a href="src/System.Metrics.html#registerCounter" class="link">Source</a> <a href="#v:registerCounter" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Counter name</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc"><p>Action to read the current metric value</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register a non-negative, monotonically increasing, integer-valued
 metric. The provided action to read the value must be thread-safe.
 Also see <code><a href="System-Metrics.html#v:createCounter" title="System.Metrics">createCounter</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:registerGauge" class="def">registerGauge</a> <a href="src/System.Metrics.html#registerGauge" class="link">Source</a> <a href="#v:registerGauge" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Gauge name</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc"><p>Action to read the current metric value</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register an integer-valued metric. The provided action to read
 the value must be thread-safe. Also see <code><a href="System-Metrics.html#v:createGauge" title="System.Metrics">createGauge</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:registerLabel" class="def">registerLabel</a> <a href="src/System.Metrics.html#registerLabel" class="link">Source</a> <a href="#v:registerLabel" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Label name</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Action to read the current metric value</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register a text metric. The provided action to read the value
 must be thread-safe. Also see <code><a href="System-Metrics.html#v:createLabel" title="System.Metrics">createLabel</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:registerDistribution" class="def">registerDistribution</a> <a href="src/System.Metrics.html#registerDistribution" class="link">Source</a> <a href="#v:registerDistribution" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Distribution name</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Distribution-Internal.html#t:Stats" title="System.Metrics.Distribution.Internal">Stats</a></td><td class="doc"><p>Action to read the current metric
 value</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register a distribution metric. The provided action to read the
 value must be thread-safe. Also see <code><a href="System-Metrics.html#v:createDistribution" title="System.Metrics">createDistribution</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:registerGroup" class="def">registerGroup</a> <a href="src/System.Metrics.html#registerGroup" class="link">Source</a> <a href="#v:registerGroup" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../unordered-containers/html/Data-HashMap-Strict.html#t:HashMap" title="Data.HashMap.Strict">HashMap</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> (a -&gt; <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a>)</td><td class="doc"><p>Metric names and getter functions.</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> a</td><td class="doc"><p>Action to sample the metric group</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> ()</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Register an action that will be executed any time one of the
 metrics computed from the value it returns needs to be sampled.</p><p>When one or more of the metrics listed in the first argument needs
 to be sampled, the action is executed and the provided getter
 functions will be used to extract the metric(s) from the action's
 return value.</p><p>The registered action might be called from a different thread and
 therefore needs to be thread-safe.</p><p>This function allows you to sample groups of metrics together. This
 is useful if</p><ul><li>you need a consistent view of several metric or</li><li>sampling the metrics together is more efficient.</li></ul><p>For example, sampling GC statistics needs to be done atomically or
 a GC might strike in the middle of sampling, rendering the values
 incoherent. Sampling GC statistics is also more efficient if done
 in &quot;bulk&quot;, as the run-time system provides a function to sample all
 GC statistics at once.</p><p>Note that sampling of the metrics is only atomic if the provided
 action computes <code>a</code> atomically (e.g. if <code>a</code> is a record, the action
 needs to compute its fields atomically if the sampling is to be
 atomic.)</p><p>Example usage:</p><pre>{-# LANGUAGE OverloadedStrings #-}
import qualified Data.HashMap.Strict as M
import GHC.Stats
import System.Metrics

main = do
    store &lt;- newStore
    let metrics =
            [ (&quot;num_gcs&quot;, Counter . numGcs)
            , (&quot;max_bytes_used&quot;, Gauge . maxBytesUsed)
            ]
    registerGroup (M.fromList metrics) getGCStats store</pre></div></div><a href="#g:4" id="g:4"><h2>Convenience functions</h2></a><div class="doc"><p>These functions combined the creation of a mutable reference (e.g.
 a <code><a href="System-Metrics.html#v:Counter" title="System.Metrics">Counter</a></code>) with registering that reference in the store in one
 convenient function.</p></div><div class="top"><p class="src"><a id="v:createCounter" class="def">createCounter</a> <a href="src/System.Metrics.html#createCounter" class="link">Source</a> <a href="#v:createCounter" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Counter name</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Counter.html#t:Counter" title="System.Metrics.Counter">Counter</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create and register a zero-initialized counter.</p></div></div><div class="top"><p class="src"><a id="v:createGauge" class="def">createGauge</a> <a href="src/System.Metrics.html#createGauge" class="link">Source</a> <a href="#v:createGauge" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Gauge name</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Gauge.html#t:Gauge" title="System.Metrics.Gauge">Gauge</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create and register a zero-initialized gauge.</p></div></div><div class="top"><p class="src"><a id="v:createLabel" class="def">createLabel</a> <a href="src/System.Metrics.html#createLabel" class="link">Source</a> <a href="#v:createLabel" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Label name</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Label.html#t:Label" title="System.Metrics.Label">Label</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create and register an empty label.</p></div></div><div class="top"><p class="src"><a id="v:createDistribution" class="def">createDistribution</a> <a href="src/System.Metrics.html#createDistribution" class="link">Source</a> <a href="#v:createDistribution" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Distribution name</p></td></tr><tr><td class="src">-&gt; <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a></td><td class="doc"><p>Metric store</p></td></tr><tr><td class="src">-&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics-Distribution.html#t:Distribution" title="System.Metrics.Distribution">Distribution</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create and register an event tracker.</p></div></div><a href="#g:5" id="g:5"><h2>Predefined metrics</h2></a><div class="doc"><p>This library provides a number of pre-defined metrics that can
 easily be added to a metrics store by calling their register
 function.</p></div><div class="top"><p class="src"><a id="v:registerGcMetrics" class="def">registerGcMetrics</a> :: <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> () <a href="src/System.Metrics.html#registerGcMetrics" class="link">Source</a> <a href="#v:registerGcMetrics" class="selflink">#</a></p><div class="doc"><p>Register a number of metrics related to garbage collector
 behavior.</p><p>To enable GC statistics collection, either run your program with</p><pre>+RTS -T</pre><p>or compile it with</p><pre>-with-rtsopts=-T</pre><p>The runtime overhead of <code>-T</code> is very small so it's safe to always
 leave it enabled.</p><p>Registered counters:</p><dl><dt><code>rts.gc.bytes_allocated</code></dt><dd>Total number of bytes allocated</dd><dt><code>rts.gc.num_gcs</code></dt><dd>Number of garbage collections performed</dd><dt><code>rts.gc.num_bytes_usage_samples</code></dt><dd>Number of byte usage samples taken</dd><dt><code>rts.gc.cumulative_bytes_used</code></dt><dd>Sum of all byte usage samples, can be
 used with <code>numByteUsageSamples</code> to calculate averages with
 arbitrary weighting (if you are sampling this record multiple
 times).</dd><dt><code>rts.gc.bytes_copied</code></dt><dd>Number of bytes copied during GC</dd><dt><code>rts.gc.init_cpu_ms</code></dt><dd>CPU time used by the init phase, in
 milliseconds. GHC 8.6+ only.</dd><dt><code>rts.gc.init_wall_ms</code></dt><dd>Wall clock time spent running the init
 phase, in milliseconds. GHC 8.6+ only.</dd><dt><code>rts.gc.mutator_cpu_ms</code></dt><dd>CPU time spent running mutator threads,
 in milliseconds. This does not include any profiling overhead or
 initialization.</dd><dt><code>rts.gc.mutator_wall_ms</code></dt><dd>Wall clock time spent running mutator
 threads, in milliseconds. This does not include initialization.</dd><dt><code>rts.gc.gc_cpu_ms</code></dt><dd>CPU time spent running GC, in milliseconds.</dd><dt><code>rts.gc.gc_wall_ms</code></dt><dd>Wall clock time spent running GC, in
 milliseconds.</dd><dt><code>rts.gc.cpu_ms</code></dt><dd>Total CPU time elapsed since program start, in
 milliseconds.</dd><dt><code>rts.gc.wall_ms</code></dt><dd>Total wall clock time elapsed since start, in
 milliseconds.</dd></dl><p>Registered gauges:</p><dl><dt><code>rts.gc.max_bytes_used</code></dt><dd>Maximum number of live bytes seen so far</dd><dt><code>rts.gc.current_bytes_used</code></dt><dd>Current number of live bytes</dd><dt><code>rts.gc.current_bytes_slop</code></dt><dd>Current number of bytes lost to slop</dd><dt><code>rts.gc.max_bytes_slop</code></dt><dd>Maximum number of bytes lost to slop at any one time so far</dd><dt><code>rts.gc.peak_megabytes_allocated</code></dt><dd>Maximum number of megabytes allocated</dd><dt><code>rts.gc.par_tot_bytes_copied</code></dt><dd>Number of bytes copied during GC, minus
 space held by mutable lists held by the capabilities.  Can be used
 with <code>parMaxBytesCopied</code> to determine how well parallel GC utilized
 all cores.</dd><dt><code>rts.gc.par_avg_bytes_copied</code></dt><dd>Deprecated alias for
 <code>par_tot_bytes_copied</code>.</dd><dt><code>rts.gc.par_max_bytes_copied</code></dt><dd>Sum of number of bytes copied each GC by
 the most active GC thread each GC. The ratio of
 <code>par_tot_bytes_copied</code> divided by <code>par_max_bytes_copied</code> approaches
 1 for a maximally sequential run and approaches the number of
 threads (set by the RTS flag <code>-N</code>) for a maximally parallel run.</dd></dl></div></div><a href="#g:6" id="g:6"><h1>Sampling metrics</h1></a><div class="doc"><p>The metrics register in the store can be sampled together. Sampling
 is <em>not</em> atomic. While each metric will be retrieved atomically,
 the sample is not an atomic snapshot of the system as a whole. See
 <code><a href="System-Metrics.html#v:registerGroup" title="System.Metrics">registerGroup</a></code> for an explanation of how to sample a subset of all
 metrics atomically.</p></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:Sample" class="def">Sample</a> = <a href="../../unordered-containers/html/Data-HashMap-Strict.html#t:HashMap" title="Data.HashMap.Strict">HashMap</a> <a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a> <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> <a href="src/System.Metrics.html#Sample" class="link">Source</a> <a href="#t:Sample" class="selflink">#</a></p><div class="doc"><p>A sample of some metrics.</p></div></div><div class="top"><p class="src"><a id="v:sampleAll" class="def">sampleAll</a> :: <a href="System-Metrics.html#t:Store" title="System.Metrics">Store</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="System-Metrics.html#t:Sample" title="System.Metrics">Sample</a> <a href="src/System.Metrics.html#sampleAll" class="link">Source</a> <a href="#v:sampleAll" class="selflink">#</a></p><div class="doc"><p>Sample all metrics. Sampling is <em>not</em> atomic in the sense that
 some metrics might have been mutated before they're sampled but
 after some other metrics have already been sampled.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Value" class="def">Value</a> <a href="src/System.Metrics.html#Value" class="link">Source</a> <a href="#t:Value" class="selflink">#</a></p><div class="doc"><p>The value of a sampled metric.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:Counter" class="def">Counter</a> !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Gauge" class="def">Gauge</a> !<a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int64" title="Data.Int">Int64</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Label" class="def">Label</a> !<a href="../../text/html/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Distribution" class="def">Distribution</a> !<a href="System-Metrics-Distribution-Internal.html#t:Stats" title="System.Metrics.Distribution.Internal">Stats</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Value">Instances</h4><details id="i:Value" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Value:Eq:1"></span> <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Eq.html#t:Eq" title="Data.Eq">Eq</a> <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a></span> <a href="src/System.Metrics.html#line-622" class="link">Source</a> <a href="#t:Value" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Value:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Metrics.html">System.Metrics</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Value:Show:2"></span> <a href="../../ghc/html/libraries/base-4.14.3.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a></span> <a href="src/System.Metrics.html#line-622" class="link">Source</a> <a href="#t:Value" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Value:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="System-Metrics.html">System.Metrics</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-String.html#t:String" title="Data.String">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="System-Metrics.html#t:Value" title="System.Metrics">Value</a>] -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>