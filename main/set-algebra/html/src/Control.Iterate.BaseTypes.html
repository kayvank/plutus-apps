<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-comment">-- | Defines what types can be used in the SetAlgebra, and</span><span>
</span><span id="line-9"></span><span class="hs-comment">--   what operations those types must support (Iter, Basic, Embed)</span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Iterate.BaseTypes</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html"><span class="hs-identifier">Control.Iterate.Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier">hasElem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier">isempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier">none</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier">one</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier">Data.BiMap</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sortBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier">Data.MapExtras</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier">StrictTriple</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier">splitMemberSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier">Data.UMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UM</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- ================= The Iter class =================================================</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- The Set algebra include types that encode finite maps of some type. They</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- have a finite domain, and for each domain element they pair a single range</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- element. We are interested in those finite maps that can iterate their</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- pairs in ascending domain order. The operations are: `nxt` and `lub` .</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- lub can skip over many items in sub-linear time, it can make things really fast.</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- Many finite maps can support a support lub operation in sub-linear time. Some examples:</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- Balanced binary trees, Arrays (using binary search), Tries, etc. There are basic and compound</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- Iter instances. Compound types include components with types that have Iter instances.</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- ===================================================================================</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">class</span><span> </span><span id="Iter"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-var">Iter</span></a></span></span><span> </span><span id="local-6989586621679092226"><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>  </span><span id="local-6989586621679092219"><span id="local-6989586621679092220"><span id="nxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-type">nxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092219"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092220"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092219"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092220"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092219"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-35"></span><span>  </span><span id="local-6989586621679092215"><span id="local-6989586621679092216"><span id="lub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-type">lub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092216"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092216"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092216"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092215"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092216"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092215"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092216"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092215"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-comment">-- The next few methods can all be defined via nxt and lub, but for base types there often exist</span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-comment">-- much more efficent means, so the default definitions should be overwritten for such basic types.</span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- For compound types with Guards, these are often the only way to define them.</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span id="local-6989586621679092129"><span id="local-6989586621679092130"><span id="hasNxt"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-type">hasNxt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092129"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092130"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092129"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092129"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-42"></span><span>  </span><span id="local-6989586621679091805"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var hs-var">hasNxt</span></a></span><span> </span><span id="local-6989586621679091804"><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679091804"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, f a b) -&gt; Maybe (a, b, f a b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a b -&gt; Collect (a, b, f a b)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f a b
</span><a href="#local-6989586621679091804"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679092211"><span id="local-6989586621679092212"><span id="hasLub"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-type">hasLub</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092211"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092212"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092211"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092211"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679091802"><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var hs-var">hasLub</span></a></span><span> </span><span id="local-6989586621679091801"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091801"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091800"><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679091800"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, f k b) -&gt; Maybe (k, b, f k b)
forall t. Collect t -&gt; Maybe t
</span><a href="Control.Iterate.Collect.html#hasElem"><span class="hs-identifier hs-var">hasElem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k b -&gt; Collect (k, b, f k b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Collect (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091801"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">f k b
</span><a href="#local-6989586621679091800"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-45"></span><span>  </span><span id="local-6989586621679092200"><span id="local-6989586621679092201"><span id="haskey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-type">haskey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092201"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092201"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092201"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092200"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679091798"><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679091797"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091797"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091796"><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679091796"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key b -&gt; Maybe (key, b, f key b)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091797"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key b
</span><a href="#local-6989586621679091796"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, b, f key b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091795"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091795"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091797"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091795"><span class="hs-identifier hs-var">key</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span id="local-6989586621679092127"><span id="local-6989586621679092128"><span id="isnull"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-type">isnull</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092128"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092127"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-48"></span><span>  </span><span id="local-6989586621679091793"><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var hs-var">isnull</span></a></span><span> </span><span id="local-6989586621679091792"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091792"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (k, v, f k v) -&gt; Bool
forall t. Collect t -&gt; Bool
</span><a href="Control.Iterate.Collect.html#isempty"><span class="hs-identifier hs-var">isempty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f k v -&gt; Collect (k, v, f k v)
forall (f :: * -&gt; * -&gt; *) a b.
Iter f =&gt;
f a b -&gt; Collect (a, b, f a b)
</span><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091792"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679092125"><span id="local-6989586621679092126"><span id="lookup"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092126"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092126"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092126"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092125"><span class="hs-identifier hs-type">rng</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092125"><span class="hs-identifier hs-type">rng</span></a></span></span></span><span>
</span><span id="line-50"></span><span>  </span><span id="local-6989586621679091790"><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679091789"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091789"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091788"><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679091788"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; f key rng -&gt; Maybe (key, rng, f key rng)
forall (f :: * -&gt; * -&gt; *) k b.
(Iter f, Ord k) =&gt;
k -&gt; f k b -&gt; Maybe (k, b, f k b)
</span><a href="Control.Iterate.BaseTypes.html#hasLub"><span class="hs-identifier hs-var">hasLub</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091789"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f key rng
</span><a href="#local-6989586621679091788"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (key, rng, f key rng)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091787"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091787"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091786"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679091786"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f key rng
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091789"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091787"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679091786"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span id="local-6989586621679092123"><span id="local-6989586621679092124"><span id="element"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-type">element</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092124"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092124"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092226"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092124"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092123"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-type">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-52"></span><span>  </span><span id="local-6989586621679091784"><span class="annot"><a href="Control.Iterate.BaseTypes.html#element"><span class="hs-identifier hs-var hs-var">element</span></a></span><span> </span><span id="local-6989586621679091783"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091783"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091782"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091782"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Collect ()
</span><a href="Control.Iterate.Collect.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; f k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091783"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091782"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">-- ==================================================================================================</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- | In order to build typed Exp (which are a typed deep embedding) of Set operations, we need to know</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- what kind of basic types of Maps and Sets can be used this way. Every Basic type has a few operations</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- for creating one from a list, for adding and removing key-value pairs, looking up a value given a key.</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Instances of this algebra are functional in that every key has exactly one value associated with it.</span><span>
</span><span id="line-60"></span><span class="hs-keyword">class</span><span> </span><span id="Basic"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-var">Basic</span></a></span></span><span> </span><span id="local-6989586621679092197"><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- | in addpair the new value always prevails, to make a choice use 'addkv' which has a combining function that allows choice.</span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679092165"><span id="local-6989586621679092166"><span id="addpair"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-type">addpair</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092166"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092166"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092165"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092166"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092165"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092166"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092165"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-63"></span><span>  </span><span id="local-6989586621679091780"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addpair"><span class="hs-identifier hs-var hs-var">addpair</span></a></span><span> </span><span id="local-6989586621679091779"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091779"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091778"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091778"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679091777"><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091777"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
forall (f :: * -&gt; * -&gt; *) k v.
(Basic f, Ord k) =&gt;
(k, v) -&gt; f k v -&gt; (v -&gt; v -&gt; v) -&gt; f k v
</span><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-var">addkv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091779"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091778"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f k v
</span><a href="#local-6989586621679091777"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091775"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091775"><span class="hs-identifier hs-var">_old</span></a></span></span><span> </span><span id="local-6989586621679091774"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091774"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091774"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- | use (\ old new -&gt; old) if you want the v in (f k v) to prevail, and use (\ old new -&gt; new) if you want the v in (k,v) to prevail</span></span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679092194"><span id="local-6989586621679092195"><span id="addkv"><span class="annot"><a href="Control.Iterate.BaseTypes.html#addkv"><span class="hs-identifier hs-type">addkv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092195"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092195"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092195"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092195"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092194"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679092163"><span id="local-6989586621679092164"><span id="removekey"><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-type">removekey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092164"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092164"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092164"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092163"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092164"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092163"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-69"></span><span>  </span><span id="local-6989586621679092161"><span id="local-6989586621679092162"><span id="domain"><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-type">domain</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092162"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092162"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092161"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092162"><span class="hs-identifier hs-type">k</span></a></span></span></span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679092158"><span id="local-6989586621679092159"><span id="range"><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-type">range</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092159"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092197"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092158"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092159"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092159"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- ===============================================================================================</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | BaseRep witnesses Basic types. I.e. those types that are instances of both Basic and Iter.</span><span>
</span><span id="line-75"></span><span class="hs-comment">--   Pattern matching against a constructor of type BaseRep, determines which base type. For example</span><span>
</span><span id="line-76"></span><span class="hs-comment">--   data Tag f k v = Tag (BaseRep f k v) (f k v)</span><span>
</span><span id="line-77"></span><span class="hs-comment">--   case Tag MapR x -&gt;  -- here we know x :: Map.Map k v</span><span>
</span><span id="line-78"></span><span class="hs-keyword">data</span><span> </span><span id="BaseRep"><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-var">BaseRep</span></a></span></span><span> </span><span id="local-6989586621679091770"><span class="annot"><a href="#local-6989586621679091770"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679091769"><span class="annot"><a href="#local-6989586621679091769"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679091768"><span class="annot"><a href="#local-6989586621679091768"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679091766"><span id="local-6989586621679091767"><span id="MapR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091767"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091766"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-80"></span><span>  </span><span id="local-6989586621679091764"><span id="SetR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091764"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-81"></span><span>  </span><span id="local-6989586621679091761"><span id="local-6989586621679091762"><span id="ListR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091762"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091761"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679091758"><span id="local-6989586621679091759"><span id="SingleR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091759"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091758"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-83"></span><span>  </span><span id="local-6989586621679091755"><span id="local-6989586621679091756"><span id="BiMapR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091756"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091756"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091756"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679091755"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091756"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-84"></span><span>  </span><span id="local-6989586621679091748"><span id="local-6989586621679091749"><span id="local-6989586621679091750"><span id="local-6989586621679091751"><span id="local-6989586621679091752"><span id="local-6989586621679091753"><span id="ViewR"><span class="annot"><a href="Control.Iterate.BaseTypes.html#ViewR"><span class="hs-identifier hs-var">ViewR</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091753"><span class="hs-identifier hs-type">coin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091752"><span class="hs-identifier hs-type">cred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091751"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091753"><span class="hs-identifier hs-type">coin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091750"><span class="hs-identifier hs-type">pool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.Tag</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091753"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091752"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091750"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091751"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091748"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091753"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091752"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091750"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091751"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679091749"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091748"><span class="hs-identifier hs-type">v</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621679091744"><span id="local-6989586621679091745"><span id="local-6989586621679091746"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091739"><span id="local-6989586621679091742"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#BaseRep"><span class="hs-identifier hs-type">BaseRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091746"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091745"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091744"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span id="local-6989586621679091737"><span class="annot"><span class="annottext">show :: BaseRep f k v -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#MapR"><span class="hs-identifier hs-var">MapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Map&quot;</span></span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SetR"><span class="hs-identifier hs-var">SetR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Set&quot;</span></span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#ListR"><span class="hs-identifier hs-var">ListR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;List&quot;</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#SingleR"><span class="hs-identifier hs-var">SingleR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single&quot;</span></span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BaseRep f k v
</span><a href="Control.Iterate.BaseTypes.html#BiMapR"><span class="hs-identifier hs-var">BiMapR</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BiMap&quot;</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a></span><span> </span><span class="annot"><span class="annottext">Tag coin cred pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.Rew</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ViewR-cred-coin&quot;</span></span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a></span><span> </span><span class="annot"><span class="annottext">Tag coin cred pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.Del</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ViewR-cred-keyhash&quot;</span></span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#ViewR"><span class="hs-identifier hs-type">ViewR</span></a></span><span> </span><span class="annot"><span class="annottext">Tag coin cred pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.Ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ViewR-ptr-cred&quot;</span></span></span></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- Now for each Basic type we provide instances</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- ==================================================================</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- ========== Basic List ==============</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-keyword">data</span><span> </span><span id="List"><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span id="local-6989586621679091732"><span class="annot"><a href="#local-6989586621679091732"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679091731"><span class="annot"><a href="#local-6989586621679091731"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679092152"><span id="local-6989586621679092153"><span id="UnSafeList"><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092153"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092153"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092152"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092153"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092152"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span id="local-6989586621679091728"><span id="local-6989586621679091729"><span class="annot"><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-type">unList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091729"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091728"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091729"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679091728"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-108"></span><span id="unList"><span class="annot"><span class="annottext">unList :: List k v -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#unList"><span class="hs-identifier hs-var hs-var">unList</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091726"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091726"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091726"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679091720"><span id="local-6989586621679091722"><span id="local-6989586621679091724"><span id="local-6989586621679091725"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091725"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091724"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091725"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091724"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679091717"><span id="local-6989586621679091718"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091712"><span id="local-6989586621679091715"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091718"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091717"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091718"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091717"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>  </span><span id="local-6989586621679091711"><span class="annot"><span class="annottext">show :: List k v -&gt; String
</span><a href="#local-6989586621679091711"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091710"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091710"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091710"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | The constructor for List is hidden, since it requires some invariants. Use fromPairs to build an initial List.</span><span>
</span><span id="line-116"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091708"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-117"></span><span>  </span><span id="local-6989586621679091702"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; List k v -&gt; (v -&gt; v -&gt; v) -&gt; List k v
</span><a href="#local-6989586621679091702"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091701"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091701"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091700"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091700"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091699"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091699"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091698"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091698"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091697"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091699"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>      </span><span id="local-6989586621679091697"><span class="annot"><span class="annottext">insert :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091697"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091701"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091700"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><a href="#local-6989586621679091697"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091696"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091696"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091695"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091695"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091694"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091694"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091696"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091701"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091696"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091695"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091697"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091694"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091701"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091700"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091696"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091695"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091694"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-124"></span><span>          </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091696"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091698"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091695"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091700"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091694"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="local-6989586621679091692"><span class="annot"><span class="annottext">removekey :: k -&gt; List k v -&gt; List k v
</span><a href="#local-6989586621679091692"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679091691"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091691"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091690"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091690"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091689"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091690"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>      </span><span id="local-6989586621679091689"><span class="annot"><span class="annottext">remove :: [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091689"><span class="hs-identifier hs-var hs-var">remove</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><a href="#local-6989586621679091689"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091688"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091688"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091687"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091687"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091686"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091686"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091688"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091691"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091686"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091691"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091687"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679091689"><span class="hs-identifier hs-var">remove</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091686"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679091685"><span class="annot"><span class="annottext">domain :: List k v -&gt; Set k
</span><a href="#local-6989586621679091685"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091684"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091684"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set k -&gt; Set k) -&gt; Set k -&gt; [(k, v)] -&gt; Set k
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679091682"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091682"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091681"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091681"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091680"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091680"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091682"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091680"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091684"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679091677"><span class="annot"><span class="annottext">range :: List k v -&gt; Set v
</span><a href="#local-6989586621679091677"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091676"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091676"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; [(k, v)] -&gt; Set v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679091675"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091675"><span class="hs-identifier hs-var">_k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091674"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091674"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091673"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679091673"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091674"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679091673"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091676"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679091671"><span id="local-6989586621679091672"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-type">fromPairs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091672"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091671"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091671"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091671"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091672"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679091671"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091672"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091671"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-133"></span><span id="fromPairs"><span class="annot"><span class="annottext">fromPairs :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#fromPairs"><span class="hs-identifier hs-var hs-var">fromPairs</span></a></span></span><span> </span><span id="local-6989586621679091669"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091669"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span id="local-6989586621679091668"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091668"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091669"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091666"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091666"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679091665"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091665"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091666"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091665"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091668"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679092136"><span id="local-6989586621679092137"><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-type">normalize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092137"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092136"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092136"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092136"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092137"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092136"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679092137"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679092136"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-136"></span><span id="normalize"><span class="annot"><span class="annottext">normalize :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var hs-var">normalize</span></a></span></span><span> </span><span id="local-6989586621679091664"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091664"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-137"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679091663"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091663"><span class="hs-identifier hs-var">_combine</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679091662"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091662"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091661"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091661"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091662"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091661"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679091660"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091660"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091659"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091659"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091658"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091658"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091657"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091657"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091656"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091656"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091655"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091655"><span class="hs-identifier hs-var">more</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091659"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091657"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091660"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091659"><span class="hs-identifier hs-var">k1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091660"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091658"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091656"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091655"><span class="hs-identifier hs-var">more</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span class="annot"><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span id="local-6989586621679091654"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091654"><span class="hs-identifier hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091653"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091653"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091652"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091652"><span class="hs-identifier hs-var">pairs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091653"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
forall k v. Ord k =&gt; (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="Control.Iterate.BaseTypes.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091654"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091652"><span class="hs-identifier hs-var">pairs</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091641"><span id="local-6989586621679091645"><span id="local-6989586621679091647"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- List is the only basic instance with non-linear nxt and lub. It also depends on</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679091639"><span class="annot"><span class="annottext">nxt :: List a b -&gt; Collect (a, b, List a b)
</span><a href="#local-6989586621679091639"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Collect (a, b, List a b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span> </span><span class="hs-comment">-- key-value pairs being stored in ascending order. For small Lists (10 or so elements) this is OK.</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091638"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091638"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091637"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091637"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091636"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679091636"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Collect (a, b, List a b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091638"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091637"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679091636"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679091635"><span class="annot"><span class="annottext">lub :: k -&gt; List k b -&gt; Collect (k, b, List k b)
</span><a href="#local-6989586621679091635"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091634"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091634"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091633"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679091633"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((k, b) -&gt; Bool) -&gt; [(k, b)] -&gt; [(k, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">dropWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679091631"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091631"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091630"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091630"><span class="hs-identifier hs-var">_v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091631"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091634"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679091633"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Collect (k, b, List k b)
forall t. Collect t
</span><a href="Control.Iterate.Collect.html#none"><span class="hs-identifier hs-var">none</span></a></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091628"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091628"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091627"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091627"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091626"><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679091626"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, List k b) -&gt; Collect (k, b, List k b)
forall t. t -&gt; Collect t
</span><a href="Control.Iterate.Collect.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091628"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091627"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(k, b)] -&gt; List k b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, b)]
</span><a href="#local-6989586621679091626"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679091625"><span class="annot"><span class="annottext">isnull :: List k v -&gt; Bool
</span><a href="#local-6989586621679091625"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091624"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091624"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091624"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679091622"><span class="annot"><span class="annottext">lookup :: key -&gt; List key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091622"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679091621"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091621"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091620"><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679091620"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; [(key, rng)] -&gt; Maybe rng
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091621"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[(key, rng)]
</span><a href="#local-6989586621679091620"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679091618"><span class="annot"><span class="annottext">hasNxt :: List a b -&gt; Maybe (a, b, List a b)
</span><a href="#local-6989586621679091618"><span class="hs-identifier hs-var hs-var hs-var hs-var">hasNxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (a, b, List a b)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#hasNxt"><span class="hs-identifier hs-var">hasNxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091617"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091617"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091616"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091616"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679091615"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679091615"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a, b, List a b) -&gt; Maybe (a, b, List a b)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091617"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091616"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; List a b
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679091615"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- ================ Basic Single ===============</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- The Single type encode 0 or 1 pairs. Iteration is trivial. Succeeds only once.</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-keyword">data</span><span> </span><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span id="local-6989586621679091614"><span class="annot"><a href="#local-6989586621679091614"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679091613"><span class="annot"><a href="#local-6989586621679091613"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="local-6989586621679092092"><span id="local-6989586621679092093"><span id="Single"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679092093"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679092092"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092093"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092092"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-157"></span><span>  </span><span id="local-6989586621679092087"><span id="local-6989586621679092088"><span id="Fail"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092088"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092087"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679092091"><span id="SetSingle"><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679092091"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092091"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span id="local-6989586621679091604"><span id="local-6989586621679091606"><span id="local-6989586621679091608"><span id="local-6989586621679091609"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091609"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091608"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091609"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091608"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- Since we can only store one key, we have to choose who wins</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- We use the combine function to decide. (\ old new -&gt; old) keeps</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- the orginal value. (\ old new -&gt; new) overwrites the stored value.</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- Something else like (\ old new -&gt; old+new) overwrites with a combination</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091602"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679091597"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Single k v -&gt; (v -&gt; v -&gt; v) -&gt; Single k v
</span><a href="#local-6989586621679091597"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091596"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091596"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091595"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091595"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091594"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091594"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span id="local-6989586621679091593"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091593"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091594"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091592"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091592"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091591"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091591"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091592"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091593"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091591"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091595"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091590"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091590"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091590"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-172"></span><span>      </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091596"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091595"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679091589"><span class="annot"><span class="annottext">removekey :: k -&gt; Single k v -&gt; Single k v
</span><a href="#local-6989586621679091589"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679091588"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091588"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091587"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091587"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091586"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091586"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091588"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091587"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; v -&gt; Single k v
forall k v. k -&gt; v -&gt; Single k v
</span><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-var">Single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091587"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091586"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679091585"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091585"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091584"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091584"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091585"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091584"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Single k ()
forall k. k -&gt; Single k ()
</span><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-var">SetSingle</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091584"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#removekey"><span class="hs-identifier hs-var">removekey</span></a></span><span> </span><span id="local-6989586621679091583"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091583"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span id="local-6989586621679091582"><span class="annot"><span class="annottext">domain :: Single k v -&gt; Set k
</span><a href="#local-6989586621679091582"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091581"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091581"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091580"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091580"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091581"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091578"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091578"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091578"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#domain"><span class="hs-identifier hs-var">domain</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679091577"><span class="annot"><span class="annottext">range :: Single k v -&gt; Set v
</span><a href="#local-6989586621679091577"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091576"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091576"><span class="hs-identifier hs-var">_a</span></a></span></span><span> </span><span id="local-6989586621679091575"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091575"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091575"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091574"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091574"><span class="hs-identifier hs-var">_a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#range"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091563"><span id="local-6989586621679091568"><span id="local-6989586621679091570"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679091562"><span class="annot"><span class="annottext">nxt :: Single a b -&gt; Collect (a, b, Single a b)
</span><a href="#local-6989586621679091562"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091561"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091561"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091560"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091560"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091558"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091558"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091557"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091557"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091557"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091561"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091560"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single a b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091558"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091556"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091556"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091555"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091555"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091554"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091554"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091554"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091556"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single a ()
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091555"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#nxt"><span class="hs-identifier hs-var">nxt</span></a></span><span> </span><span class="annot"><span class="annottext">Single a b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Single a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Single a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091553"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091553"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091552"><span class="annot"><span class="annottext">(a, b, Single a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091552"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091553"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679091551"><span class="annot"><span class="annottext">lub :: k -&gt; Single k b -&gt; Collect (k, b, Single k b)
</span><a href="#local-6989586621679091551"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091550"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091550"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091549"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091549"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091548"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091548"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091547"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091547"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091546"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091546"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091549"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091550"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091546"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091549"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091548"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single k b
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091547"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091547"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679091544"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091544"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091543"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091543"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091542"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091542"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091541"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091541"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091543"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091544"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091541"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091543"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Single k ()
forall k v. Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091542"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091542"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lub"><span class="hs-identifier hs-var">lub</span></a></span><span> </span><span id="local-6989586621679091540"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091540"><span class="hs-identifier hs-var">_key</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Single k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Single k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091539"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091539"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091538"><span class="annot"><span class="annottext">(k, b, Single k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091538"><span class="hs-identifier hs-var">_f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091539"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679091537"><span class="annot"><span class="annottext">haskey :: key -&gt; Single key b -&gt; Bool
</span><a href="#local-6989586621679091537"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679091536"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091536"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091535"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091535"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091536"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091535"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679091534"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091534"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091533"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091533"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091532"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091532"><span class="hs-identifier hs-var">_b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091534"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091533"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span id="local-6989586621679091531"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091531"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key b
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679091530"><span class="annot"><span class="annottext">isnull :: Single k v -&gt; Bool
</span><a href="#local-6989586621679091530"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="local-6989586621679091529"><span class="annot"><span class="annottext">lookup :: key -&gt; Single key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091529"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679091528"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091528"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091527"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091527"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091528"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091527"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679091526"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091526"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091525"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091525"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679091524"><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679091524"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091526"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">key -&gt; key -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091525"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">rng -&gt; Maybe rng
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">rng
</span><a href="#local-6989586621679091524"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span id="local-6989586621679091523"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091523"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span class="annot"><span class="annottext">Single key rng
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span id="local-6989586621679091521"><span id="local-6989586621679091522"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091516"><span id="local-6989586621679091519"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091522"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091521"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091522"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091521"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679091515"><span class="annot"><span class="annottext">show :: Single k v -&gt; String
</span><a href="#local-6989586621679091515"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span id="local-6989586621679091514"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091514"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091513"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091513"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(Single &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091513"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#SetSingle"><span class="hs-identifier hs-type">SetSingle</span></a></span><span> </span><span id="local-6989586621679091512"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091512"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(SetSingle &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">k -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="Control.Iterate.BaseTypes.html#Fail"><span class="hs-identifier hs-var">Fail</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Fail&quot;</span></span></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- ================= Basic Set =====================</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span id="local-6989586621679091511"><span class="annot"><a href="#local-6989586621679091511"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679091510"><span class="annot"><a href="#local-6989586621679091510"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679092051"><span id="Sett"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092051"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679092051"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679091503"><span class="annot"><span class="annottext">addpair :: k -&gt; v -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679091503"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span id="local-6989586621679091502"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091502"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679091501"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091501"><span class="hs-identifier hs-var">_unit</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091500"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091500"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091502"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091500"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679091499"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Sett k v -&gt; (v -&gt; v -&gt; v) -&gt; Sett k v
</span><a href="#local-6989586621679091499"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091498"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091498"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091497"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091497"><span class="hs-identifier hs-var">_unit</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091496"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091496"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091495"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091495"><span class="hs-identifier hs-var">_comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091498"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091496"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- We can ignore comb since there is only one function at type: () -&gt; () -&gt; ()</span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679091494"><span class="annot"><span class="annottext">removekey :: k -&gt; Sett k v -&gt; Sett k v
</span><a href="#local-6989586621679091494"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679091493"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091493"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091492"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091492"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091493"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091492"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679091490"><span class="annot"><span class="annottext">domain :: Sett k v -&gt; Set k
</span><a href="#local-6989586621679091490"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091489"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091489"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091489"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="local-6989586621679091488"><span class="annot"><span class="annottext">range :: Sett k v -&gt; Set v
</span><a href="#local-6989586621679091488"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091487"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091487"><span class="hs-identifier hs-var">_xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; Set ()
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span id="local-6989586621679091486"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091481"><span id="local-6989586621679091484"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091486"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091486"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679091480"><span class="annot"><span class="annottext">show :: Sett key () -&gt; String
</span><a href="#local-6989586621679091480"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091479"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091479"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set key -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091479"><span class="hs-identifier hs-var">ss</span></a></span></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679091474"><span id="local-6989586621679091476"><span id="local-6989586621679091478"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091478"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091478"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091463"><span id="local-6989586621679091468"><span id="local-6989586621679091470"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-223"></span><span>  </span><span id="local-6989586621679091462"><span class="annot"><span class="annottext">nxt :: Sett a b -&gt; Collect (a, b, Sett a b)
</span><a href="#local-6989586621679091462"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091461"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679091461"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Sett a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Sett a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091460"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091459"><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091459"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679091461"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091457"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091456"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679091456"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; (a, Set a)
forall a. Set a -&gt; (a, Set a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.deleteFindMin</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679091461"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(a, b, Sett a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091459"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091457"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Sett a ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679091456"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091460"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679091454"><span class="annot"><span class="annottext">lub :: k -&gt; Sett k b -&gt; Collect (k, b, Sett k b)
</span><a href="#local-6989586621679091454"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091453"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091453"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091452"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Sett k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Sett k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091451"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091450"><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091450"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-228"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-229"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; StrictTriple (Set k) Bool (Set k)
forall a. Ord a =&gt; a -&gt; Set a -&gt; StrictTriple (Set a) Bool (Set a)
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">splitMemberSet</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091453"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091452"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679091448"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091448"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span id="local-6989586621679091447"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091447"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091450"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091453"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091447"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-231"></span><span>              </span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">StrictTriple</span></a></span><span> </span><span id="local-6989586621679091446"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091446"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span id="local-6989586621679091445"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-233"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-234"></span><span>                  </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091444"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091443"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091443"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; (k, Set k)
forall a. Set a -&gt; (a, Set a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.deleteFindMin</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091445"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(k, b, Sett k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091450"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091444"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091443"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091451"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679091442"><span class="annot"><span class="annottext">haskey :: key -&gt; Sett key b -&gt; Bool
</span><a href="#local-6989586621679091442"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679091441"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091441"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091440"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091440"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091441"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091440"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679091438"><span class="annot"><span class="annottext">isnull :: Sett k v -&gt; Bool
</span><a href="#local-6989586621679091438"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091437"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091437"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Bool
forall a. Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.null</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091437"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679091436"><span class="annot"><span class="annottext">lookup :: key -&gt; Sett key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091436"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679091435"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091435"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091434"><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">key -&gt; Set key -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.member</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091435"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Set key
</span><a href="#local-6989586621679091434"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe rng
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- ================ Basic BiMap ================================</span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621679091433"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091431"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091433"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091433"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679091426"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; BiMap v k v -&gt; (v -&gt; v -&gt; v) -&gt; BiMap v k v
</span><a href="#local-6989586621679091426"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091425"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091424"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091422"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679091421"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091421"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091420"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091415"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091421"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679091416"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091416"><span class="hs-identifier hs-var">oldv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091415"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091415"><span class="hs-identifier hs-var">newv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091425"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091422"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679091413"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091420"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091413"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091424"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679091412"><span class="annot"><span class="annottext">removekey :: k -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679091412"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679091411"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091410"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679091410"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091409"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091409"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679091408"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091408"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- equality constraint (a ~ v) from (BiMap a k v) into scope.</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091409"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679091407"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091407"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091409"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091407"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091411"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091408"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Maybe v
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679091410"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span id="local-6989586621679091404"><span class="annot"><span class="annottext">domain :: BiMap v k v -&gt; Set k
</span><a href="#local-6989586621679091404"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091403"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679091402"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091402"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091403"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679091400"><span class="annot"><span class="annottext">range :: BiMap v k v -&gt; Set v
</span><a href="#local-6989586621679091400"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091399"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091399"><span class="hs-identifier hs-var">_left</span></a></span></span><span> </span><span id="local-6989586621679091398"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091398"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map v (Set k) -&gt; Set v
forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091398"><span class="hs-identifier hs-var">right</span></a></span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621679091397"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091386"><span id="local-6989586621679091391"><span id="local-6989586621679091393"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091397"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091397"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679091385"><span class="annot"><span class="annottext">nxt :: BiMap v a b -&gt; Collect (a, b, BiMap v a b)
</span><a href="#local-6989586621679091385"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091384"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091384"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679091383"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679091383"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, BiMap v a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, BiMap v a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091382"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091382"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091381"><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091381"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.minViewWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091384"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>            </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091382"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-260"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091379"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091379"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091378"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091378"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091377"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091377"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, BiMap v a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091381"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091379"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091378"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091377"><span class="hs-identifier hs-var">nextm</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679091383"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091382"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679091376"><span class="annot"><span class="annottext">lub :: k -&gt; BiMap v k b -&gt; Collect (k, b, BiMap v k b)
</span><a href="#local-6989586621679091376"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091375"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091375"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091374"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091374"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679091373"><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679091373"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, BiMap v k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, BiMap v k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091372"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091372"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091371"><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091371"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.splitLookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091375"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091374"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091369"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091369"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679091368"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091368"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091367"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091367"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091371"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091375"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091368"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091367"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679091373"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091372"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-267"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091366"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091366"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091365"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091365"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091365"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091372"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-268"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091363"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091363"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091362"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091362"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, BiMap v k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091371"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091361"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091360"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; Map b (Set k) -&gt; BiMap v k b
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091359"><span class="hs-identifier hs-var">m3</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set k)
</span><a href="#local-6989586621679091373"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091372"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-269"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091361"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091361"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091360"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091360"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091359"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091359"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.deleteFindMin</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091362"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>  </span><span id="local-6989586621679091357"><span class="annot"><span class="annottext">isnull :: BiMap v k v -&gt; Bool
</span><a href="#local-6989586621679091357"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091356"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091356"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679091355"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679091355"><span class="hs-identifier hs-var">_g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall (f :: * -&gt; * -&gt; *) k v. Iter f =&gt; f k v -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#isnull"><span class="hs-identifier hs-var">isnull</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091356"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span id="local-6989586621679091354"><span class="annot"><span class="annottext">lookup :: key -&gt; BiMap v key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091354"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679091353"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091353"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091352"><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679091352"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679091351"><span class="annot"><span class="annottext">Map rng (Set key)
</span><a href="#local-6989586621679091351"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091353"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key rng
</span><a href="#local-6989586621679091352"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679091350"><span class="annot"><span class="annottext">haskey :: key -&gt; BiMap v key b -&gt; Bool
</span><a href="#local-6989586621679091350"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679091349"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091349"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679091348"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679091348"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679091347"><span class="annot"><span class="annottext">Map b (Set key)
</span><a href="#local-6989586621679091347"><span class="hs-identifier hs-var">_right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Bool
forall (f :: * -&gt; * -&gt; *) key b.
(Iter f, Ord key) =&gt;
key -&gt; f key b -&gt; Bool
</span><a href="Control.Iterate.BaseTypes.html#haskey"><span class="hs-identifier hs-var">haskey</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091349"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679091348"><span class="hs-identifier hs-var">left</span></a></span></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- ============== Basic Map =========================</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091345"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>  </span><span id="local-6989586621679091340"><span class="annot"><span class="annottext">addkv :: (k, v) -&gt; Map k v -&gt; (v -&gt; v -&gt; v) -&gt; Map k v
</span><a href="#local-6989586621679091340"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091339"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091339"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091338"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091338"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091337"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091337"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679091336"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091336"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091336"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091339"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091338"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091337"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679091335"><span class="annot"><span class="annottext">removekey :: k -&gt; Map k v -&gt; Map k v
</span><a href="#local-6989586621679091335"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span id="local-6989586621679091334"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091334"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679091333"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091333"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091334"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091333"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679091332"><span class="annot"><span class="annottext">domain :: Map k v -&gt; Set k
</span><a href="#local-6989586621679091332"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span id="local-6989586621679091331"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091331"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Set k
forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091331"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679091330"><span class="annot"><span class="annottext">range :: Map k v -&gt; Set v
</span><a href="#local-6989586621679091330"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679091329"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091329"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Set v -&gt; Set v) -&gt; Set v -&gt; Map k v -&gt; Set v
forall k a b. (k -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.foldrWithKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091327"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091327"><span class="hs-identifier hs-var">_k</span></a></span></span><span> </span><span id="local-6989586621679091326"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091326"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679091325"><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679091325"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; Set v -&gt; Set v
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091326"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Set v
</span><a href="#local-6989586621679091325"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Set v
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091329"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-- emptyc = Map.empty</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679091314"><span id="local-6989586621679091319"><span id="local-6989586621679091321"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679091313"><span class="annot"><span class="annottext">nxt :: Map a b -&gt; Collect (a, b, Map a b)
</span><a href="#local-6989586621679091313"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679091312"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091312"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((a, b, Map a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, Map a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091311"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091311"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091310"><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091310"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Maybe ((a, b), Map a b)
forall k a. Map k a -&gt; Maybe ((k, a), Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.minViewWithKey</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091312"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="annottext">Maybe ((a, b), Map a b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091311"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091309"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091309"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091308"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091308"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091307"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091307"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, Map a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091310"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091309"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091308"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679091307"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091311"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-293"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>  </span><span id="local-6989586621679091306"><span class="annot"><span class="annottext">lub :: k -&gt; Map k b -&gt; Collect (k, b, Map k b)
</span><a href="#local-6989586621679091306"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091305"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091305"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679091304"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091304"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><span class="annottext">(forall ans. ans -&gt; ((k, b, Map k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, Map k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091303"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091303"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091302"><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091302"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k b -&gt; (Map k b, Maybe b, Map k b)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; (Map k a, Maybe a, Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.splitLookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091305"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091304"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- NOTE in Log time, we skip over all those tuples in _left</span><span>
</span><span id="line-298"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091301"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091301"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679091300"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091300"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091299"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091299"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091302"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091305"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091300"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091299"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091303"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-299"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091298"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091298"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091297"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091297"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091297"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091303"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-300"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679091296"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091296"><span class="hs-identifier hs-var">_left</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091295"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091295"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, Map k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091302"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091294"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091293"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091292"><span class="hs-identifier hs-var">m3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091303"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-301"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-302"></span><span>                </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679091294"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091294"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091293"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091293"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091292"><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091292"><span class="hs-identifier hs-var">m3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k b -&gt; ((k, b), Map k b)
forall k a. Map k a -&gt; ((k, a), Map k a)
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.deleteFindMin</span></a></span><span> </span><span class="annot"><span class="annottext">Map k b
</span><a href="#local-6989586621679091295"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span id="local-6989586621679091291"><span class="annot"><span class="annottext">haskey :: key -&gt; Map key b -&gt; Bool
</span><a href="#local-6989586621679091291"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span id="local-6989586621679091290"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091290"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679091289"><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679091289"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key b -&gt; Maybe b
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679091290"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Map key b
</span><a href="#local-6989586621679091289"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span id="local-6989586621679091288"><span class="annot"><span class="annottext">isnull :: Map k v -&gt; Bool
</span><a href="#local-6989586621679091288"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span id="local-6989586621679091287"><span class="annot"><span class="annottext">lookup :: key -&gt; Map key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091287"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; Map key rng -&gt; Maybe rng
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">-- ==========================================================================</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- Basic ViewMap</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span id="local-6989586621679091283"><span id="local-6989586621679091284"><span id="local-6989586621679091285"><span id="local-6989586621679091286"><span class="hs-keyword">instance</span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091286"><span class="hs-identifier hs-type">coin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091286"><span class="hs-identifier hs-type">coin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091285"><span class="hs-identifier hs-type">cred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091284"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091283"><span class="hs-identifier hs-type">pool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Basic"><span class="hs-identifier hs-type">Basic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091286"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091285"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091283"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091284"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679091277"><span class="annot"><span class="annottext">addkv :: (k, v)
-&gt; View coin cred pool ptr k v
-&gt; (v -&gt; v -&gt; v)
-&gt; View coin cred pool ptr k v
</span><a href="#local-6989586621679091277"><span class="hs-identifier hs-var hs-var hs-var hs-var">addkv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091276"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091276"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091275"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091275"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679091274"><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091274"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679091273"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091273"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v)
-&gt; k
-&gt; v
-&gt; View coin cred pool ptr k v
-&gt; View coin cred pool ptr k v
forall cr coin ptr v k pool.
(Ord cr, Monoid coin, Ord ptr) =&gt;
(v -&gt; v -&gt; v)
-&gt; k -&gt; v -&gt; View coin cr pool ptr k v -&gt; View coin cr pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.insertWith'</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679091273"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091276"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679091275"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091274"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span id="local-6989586621679091271"><span class="annot"><span class="annottext">addpair :: k
-&gt; v -&gt; View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
</span><a href="#local-6989586621679091271"><span class="hs-identifier hs-var hs-var hs-var hs-var">addpair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k
-&gt; v -&gt; View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
forall cr coin ptr k v pool.
(Ord cr, Monoid coin, Ord ptr) =&gt;
k -&gt; v -&gt; View coin cr pool ptr k v -&gt; View coin cr pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.insert'</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span id="local-6989586621679091269"><span class="annot"><span class="annottext">removekey :: k -&gt; View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
</span><a href="#local-6989586621679091269"><span class="hs-identifier hs-var hs-var hs-var hs-var">removekey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k -&gt; View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
forall cr ptr k coin pool v.
(Ord cr, Ord ptr) =&gt;
k -&gt; View coin cr pool ptr k v -&gt; View coin cr pool ptr k v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.delete'</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679091267"><span class="annot"><span class="annottext">domain :: View coin cred pool ptr k v -&gt; Set k
</span><a href="#local-6989586621679091267"><span class="hs-identifier hs-var hs-var hs-var hs-var">domain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v -&gt; Set k
forall cr coin pool ptr k v.
Ord cr =&gt;
View coin cr pool ptr k v -&gt; Set k
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.domain</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679091265"><span class="annot"><span class="annottext">range :: View coin cred pool ptr k v -&gt; Set v
</span><a href="#local-6989586621679091265"><span class="hs-identifier hs-var hs-var hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v -&gt; Set v
forall coin pool cr ptr k v.
(Ord coin, Ord pool, Ord cr) =&gt;
View coin cr pool ptr k v -&gt; Set v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.range</span></a></span></span></span></span></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span id="local-6989586621679091260"><span id="local-6989586621679091261"><span id="local-6989586621679091262"><span id="local-6989586621679091263"><span class="hs-keyword">instance</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679091249"><span id="local-6989586621679091254"><span id="local-6989586621679091256"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091263"><span class="hs-identifier hs-type">coin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091262"><span class="hs-identifier hs-type">cred</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091261"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Iter"><span class="hs-identifier hs-type">Iter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091263"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091262"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091260"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091261"><span class="hs-identifier hs-type">ptr</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-325"></span><span>  </span><span id="local-6989586621679091248"><span class="annot"><span class="annottext">nxt :: View coin cred pool ptr a b
-&gt; Collect (a, b, View coin cred pool ptr a b)
</span><a href="#local-6989586621679091248"><span class="hs-identifier hs-var hs-var hs-var hs-var">nxt</span></a></span></span><span> </span><span id="local-6989586621679091247"><span class="annot"><span class="annottext">View coin cred pool ptr a b
</span><a href="#local-6989586621679091247"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">(forall ans.
 ans -&gt; ((a, b, View coin cred pool ptr a b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (a, b, View coin cred pool ptr a b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091246"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091246"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091245"><span class="annot"><span class="annottext">(a, b, View coin cred pool ptr a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091245"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr a b
-&gt; Maybe (a, b, View coin cred pool ptr a b)
forall coin cr pl ptr k v.
View coin cr pl ptr k v -&gt; Maybe (k, v, View coin cr pl ptr k v)
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.next</span></a></span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr a b
</span><a href="#local-6989586621679091247"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-329"></span><span>            </span><span class="annot"><span class="annottext">Maybe (a, b, View coin cred pool ptr a b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091246"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091243"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091243"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091242"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091242"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091241"><span class="annot"><span class="annottext">View coin cred pool ptr a b
</span><a href="#local-6989586621679091241"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, b, View coin cred pool ptr a b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091245"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679091243"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091242"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr a b
</span><a href="#local-6989586621679091241"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091246"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span id="local-6989586621679091240"><span class="annot"><span class="annottext">lub :: k
-&gt; View coin cred pool ptr k b
-&gt; Collect (k, b, View coin cred pool ptr k b)
</span><a href="#local-6989586621679091240"><span class="hs-identifier hs-var hs-var hs-var hs-var">lub</span></a></span></span><span> </span><span id="local-6989586621679091239"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091239"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span id="local-6989586621679091238"><span class="annot"><span class="annottext">View coin cred pool ptr k b
</span><a href="#local-6989586621679091238"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">(forall ans.
 ans -&gt; ((k, b, View coin cred pool ptr k b) -&gt; ans -&gt; ans) -&gt; ans)
-&gt; Collect (k, b, View coin cred pool ptr k b)
forall tuple.
(forall ans. ans -&gt; (tuple -&gt; ans -&gt; ans) -&gt; ans) -&gt; Collect tuple
</span><a href="Control.Iterate.Collect.html#Collect"><span class="hs-identifier hs-var">Collect</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679091237"><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091237"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679091236"><span class="annot"><span class="annottext">(k, b, View coin cred pool ptr k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091236"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k
-&gt; View coin cred pool ptr k b
-&gt; Maybe (k, b, View coin cred pool ptr k b)
forall ptr cr k coin pool v.
(Ord ptr, Ord cr) =&gt;
k
-&gt; View coin cr pool ptr k v
-&gt; Maybe (k, v, View coin cr pool ptr k v)
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.leastUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091239"><span class="hs-identifier hs-var">key</span></a></span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k b
</span><a href="#local-6989586621679091238"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">Maybe (k, b, View coin cred pool ptr k b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091237"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679091234"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091234"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091233"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091233"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679091232"><span class="annot"><span class="annottext">View coin cred pool ptr k b
</span><a href="#local-6989586621679091232"><span class="hs-identifier hs-var">nextm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(k, b, View coin cred pool ptr k b) -&gt; ans -&gt; ans
</span><a href="#local-6989586621679091236"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679091234"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679091233"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k b
</span><a href="#local-6989586621679091232"><span class="hs-identifier hs-var">nextm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ans
</span><a href="#local-6989586621679091237"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679091231"><span class="annot"><span class="annottext">haskey :: key -&gt; View coin cred pool ptr key b -&gt; Bool
</span><a href="#local-6989586621679091231"><span class="hs-identifier hs-var hs-var hs-var hs-var">haskey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; View coin cred pool ptr key b -&gt; Bool
forall cr ptr k coin pool v.
(Ord cr, Ord ptr) =&gt;
k -&gt; View coin cr pool ptr k v -&gt; Bool
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.member</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span id="local-6989586621679091229"><span class="annot"><span class="annottext">isnull :: View coin cred pool ptr k v -&gt; Bool
</span><a href="#local-6989586621679091229"><span class="hs-identifier hs-var hs-var hs-var hs-var">isnull</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v -&gt; Bool
forall coin cr pool ptr k v. View coin cr pool ptr k v -&gt; Bool
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.isNull</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679091227"><span class="annot"><span class="annottext">lookup :: key -&gt; View coin cred pool ptr key rng -&gt; Maybe rng
</span><a href="#local-6989586621679091227"><span class="hs-identifier hs-var hs-var hs-var hs-var">lookup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">key -&gt; View coin cred pool ptr key rng -&gt; Maybe rng
forall cr ptr k coin pool v.
(Ord cr, Ord ptr) =&gt;
k -&gt; View coin cr pool ptr k v -&gt; Maybe v
</span><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-var">UM.lookup</span></a></span></span></span></span></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- ===========================================================================</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- Every iterable type type forms an isomorphism with some Base type. For most</span><span>
</span><span id="line-345"></span><span class="hs-comment">-- Base types the isomorphism is the identity in both directions, but for some,</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- like List and Sett, the embeddings are not the trivial identities because the</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- concrete types are not binary type constructors. The Embed class also allows</span><span>
</span><span id="line-348"></span><span class="hs-comment">-- us to add 'newtypes' which encode some Base type to the system.</span><span>
</span><span id="line-349"></span><span class="hs-comment">-- ============================================================================</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-keyword">class</span><span> </span><span id="Embed"><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-var">Embed</span></a></span></span><span> </span><span id="local-6989586621679091830"><span class="annot"><a href="#local-6989586621679091830"><span class="hs-identifier hs-type">concrete</span></a></span></span><span> </span><span id="local-6989586621679091829"><span class="annot"><a href="#local-6989586621679091829"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679091830"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091829"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-352"></span><span>  </span><span id="toBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#toBase"><span class="hs-identifier hs-type">toBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091830"><span class="hs-identifier hs-type">concrete</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091829"><span class="hs-identifier hs-type">base</span></a></span><span>
</span><span id="line-353"></span><span>  </span><span id="fromBase"><span class="annot"><a href="Control.Iterate.BaseTypes.html#fromBase"><span class="hs-identifier hs-type">fromBase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679091829"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679091830"><span class="hs-identifier hs-type">concrete</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span id="local-6989586621679091222"><span id="local-6989586621679091223"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091223"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679091223"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679091222"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091223"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091222"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621679091218"><span class="annot"><span class="annottext">toBase :: [(k, v)] -&gt; List k v
</span><a href="#local-6989586621679091218"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091217"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091217"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; List k v
forall k v. Ord k =&gt; [(k, v)] -&gt; List k v
</span><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-var">UnSafeList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((k, v) -&gt; (k, v) -&gt; Ordering) -&gt; [(k, v)] -&gt; [(k, v)]
forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679091216"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091216"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679091215"><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091215"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; k -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091216"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k, v) -&gt; k
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v)
</span><a href="#local-6989586621679091215"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091217"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621679091214"><span class="annot"><span class="annottext">fromBase :: List k v -&gt; [(k, v)]
</span><a href="#local-6989586621679091214"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#UnSafeList"><span class="hs-identifier hs-type">UnSafeList</span></a></span><span> </span><span id="local-6989586621679091213"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091213"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679091213"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span id="local-6989586621679091212"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091212"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091212"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679091209"><span class="annot"><span class="annottext">toBase :: Set k -&gt; Sett k ()
</span><a href="#local-6989586621679091209"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091208"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091208"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Sett k ()
forall k. Set k -&gt; Sett k ()
</span><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-var">Sett</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091208"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span id="local-6989586621679091207"><span class="annot"><span class="annottext">fromBase :: Sett k () -&gt; Set k
</span><a href="#local-6989586621679091207"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Sett"><span class="hs-identifier hs-type">Sett</span></a></span><span> </span><span id="local-6989586621679091206"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091206"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679091206"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span id="local-6989586621679091204"><span id="local-6989586621679091205"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091205"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091204"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091205"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091204"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679091201"><span class="annot"><span class="annottext">toBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679091201"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091200"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091200"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091200"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679091199"><span class="annot"><span class="annottext">fromBase :: Map k v -&gt; Map k v
</span><a href="#local-6989586621679091199"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679091198"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091198"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679091198"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span id="local-6989586621679091196"><span id="local-6989586621679091197"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091197"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091196"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091197"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091197"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091196"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091197"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span id="local-6989586621679091193"><span class="annot"><span class="annottext">toBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679091193"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091192"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679091192"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679091192"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span id="local-6989586621679091191"><span class="annot"><span class="annottext">fromBase :: BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679091191"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679091190"><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679091190"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679091190"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621679091188"><span id="local-6989586621679091189"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091189"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091188"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Single"><span class="hs-identifier hs-type">Single</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091189"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091188"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>  </span><span id="local-6989586621679091185"><span class="annot"><span class="annottext">toBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679091185"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091184"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091184"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091184"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-373"></span><span>  </span><span id="local-6989586621679091183"><span class="annot"><span class="annottext">fromBase :: Single k v -&gt; Single k v
</span><a href="#local-6989586621679091183"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679091182"><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091182"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Single k v
</span><a href="#local-6989586621679091182"><span class="hs-identifier hs-var">xs</span></a></span></span></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- Necessary when asking Boolean queries like: (&#8838;),(&#8712;),(&#8713;)</span><span>
</span><span id="line-376"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-377"></span><span>  </span><span id="local-6989586621679091179"><span class="annot"><span class="annottext">toBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679091179"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091178"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679091178"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679091178"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679091177"><span class="annot"><span class="annottext">fromBase :: Bool -&gt; Bool
</span><a href="#local-6989586621679091177"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679091176"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679091176"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679091176"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span id="local-6989586621679091170"><span id="local-6989586621679091171"><span id="local-6989586621679091172"><span id="local-6989586621679091173"><span id="local-6989586621679091174"><span id="local-6989586621679091175"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Iterate.BaseTypes.html#Embed"><span class="hs-identifier hs-type">Embed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091175"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091174"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091173"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091172"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091171"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091170"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-data/html/src"><span class="hs-identifier hs-type">UM.View</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091175"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091174"><span class="hs-identifier hs-type">cred</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091173"><span class="hs-identifier hs-type">pool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091172"><span class="hs-identifier hs-type">ptr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091171"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679091170"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>  </span><span id="local-6989586621679091167"><span class="annot"><span class="annottext">toBase :: View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
</span><a href="#local-6989586621679091167"><span class="hs-identifier hs-var hs-var hs-var hs-var">toBase</span></a></span></span><span> </span><span id="local-6989586621679091166"><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091166"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091166"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621679091165"><span class="annot"><span class="annottext">fromBase :: View coin cred pool ptr k v -&gt; View coin cred pool ptr k v
</span><a href="#local-6989586621679091165"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromBase</span></a></span></span><span> </span><span id="local-6989586621679091164"><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091164"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">View coin cred pool ptr k v
</span><a href="#local-6989586621679091164"><span class="hs-identifier hs-var">xs</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-383"></span></pre></body></html>