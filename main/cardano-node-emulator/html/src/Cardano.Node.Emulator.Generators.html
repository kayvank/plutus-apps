<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds           #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores  #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TupleSections       #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications    #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies        #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-- | Generators for constructing blockchains and transactions for use in property-based testing.</span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Node.Emulator.Generators</span><span class="hs-special">(</span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Mockchain</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier">Mockchain</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier">genMockchain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier">genMockchain'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier">emptyChain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier">GeneratorModel</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier">TxInputWitnessed</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier">generatorModel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Transactions</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier">genValidTransaction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier">genValidTransactionBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier">genValidTransaction'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier">genValidTransactionSpending</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier">genValidTransactionSpending'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier">genInitialTransaction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier">makeTx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Assertions</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier">assertValid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Time</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier">genInterval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier">genSlotRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier">genTimeRange</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier">genSlot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier">genPOSIXTime</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier">genSlotConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Etc.</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier">failOnCardanoError</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier">genPolicyId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier">genAssetId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-identifier">Gen.genAssetName</span></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier">genSingleton</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier">genValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier">genValueNonNegative</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier">genSizedByteString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteStringExact"><span class="hs-identifier">genSizedByteStringExact</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier">genSeed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier">genPassphrase</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier">splitVal</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier">validateMockchain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier">signAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownAddresses</span></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentPublicKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentPrivateKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-identifier">CW.knownPaymentKeys</span></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier">knownXPrvs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier">alwaysSucceedPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier">alwaysSucceedPolicyId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier">someTokenValue</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyTxBodyContent"><span class="hs-identifier">emptyTxBodyContent</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../data-default/html/src"><span class="hs-identifier">Data.Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../data-default-class/html/src"><span class="hs-identifier">Default</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../data-default-class/html/src"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../data-default-class/html/src"><span class="hs-identifier">def</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../either/html/src"><span class="hs-identifier">Data.Either.Combinators</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../either/html/src"><span class="hs-identifier">leftToMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fold</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">List</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Gen.Cardano.Api.Typed</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog.Gen</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Gen</span></span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier">Hedgehog.Range</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Range</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">Cardano.Api</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">ProtocolParameters</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier">Cardano.Api.Shelley</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">Cardano.Crypto.Wallet</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><a href="../../../../plutus-core/html/src"><span class="hs-identifier">Crypto</span></a></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Params.html"><span class="hs-identifier">Cardano.Node.Emulator.Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Params.html#Params"><span class="hs-identifier">Params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Params.html#pSlotConfig"><span class="hs-identifier">pSlotConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html"><span class="hs-identifier">Cardano.Node.Emulator.TimeSlot</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html#SlotConfig"><span class="hs-identifier">SlotConfig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html"><span class="hs-identifier">Cardano.Node.Emulator.TimeSlot</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TimeSlot</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Validation.html"><span class="hs-identifier">Cardano.Node.Emulator.Validation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Validation.html#validateCardanoTx"><span class="hs-identifier">validateCardanoTx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lens/html/src"><span class="hs-identifier">Control.Lens.Lens</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;&amp;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">($&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Gen.Cardano.Api.Typed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">genTxIn</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CardanoEmulatorEraTx</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Interval</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">MintingPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">getMintingPolicy</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>               </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">POSIXTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">POSIXTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">getPOSIXTime</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">POSIXTimeRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Passphrase</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>               </span><span class="annot"><span class="hs-identifier">PaymentPrivateKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unPaymentPrivateKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PaymentPubKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Slot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Slot</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SlotRange</span></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>               </span><span class="annot"><span class="hs-identifier">TxInType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ConsumePublicKeyAddress</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ConsumeSimpleScriptAddress</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ScriptAddress</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxInput</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TxInputType</span></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>               </span><span class="annot"><span class="hs-identifier">TxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOutRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">TxOutRef</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ValidationErrorInPhase</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">addCardanoTxSignature</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maxFee</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">minAdaTxOutEstimated</span></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>               </span><span class="annot"><span class="hs-identifier">minLovelaceTxOutEstimated</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pubKeyTxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">txOutValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">validatorHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.CardanoWallet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CW</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Index.Internal</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Index</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UtxoIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UtxoIndex</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Tx</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromCardanoPlutusScript</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromPlutusIndex</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Tx.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeTransactionBody</span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value.CardanoAPI</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Value</span></span><span>
</span><span id="line-106"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Numeric.Natural</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Natural</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Ada</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ada</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">datumHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Interval</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Interval</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier">Plutus.V1.Ledger.Scripts</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Script</span></span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">PlutusTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-tx/html/src"><span class="hs-identifier">toData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Attach signatures of all known private keys to a transaction.</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-type">signAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-115"></span><span id="signAll"><span class="annot"><span class="annottext">signAll :: CardanoTx -&gt; CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-var hs-var">signAll</span></a></span></span><span> </span><span id="local-6989586621679417360"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417360"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; PrivateKey -&gt; CardanoTx)
-&gt; CardanoTx -&gt; [PrivateKey] -&gt; CardanoTx
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(PrivateKey -&gt; CardanoTx -&gt; CardanoTx)
-&gt; CardanoTx -&gt; PrivateKey -&gt; CardanoTx
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">PrivateKey -&gt; CardanoTx -&gt; CardanoTx
</span><span class="hs-identifier hs-var">addCardanoTxSignature</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417360"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-116"></span><span>           </span><span class="annot"><span class="annottext">([PrivateKey] -&gt; CardanoTx) -&gt; [PrivateKey] -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(PaymentPrivateKey -&gt; PrivateKey)
-&gt; [PaymentPrivateKey] -&gt; [PrivateKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; PrivateKey
</span><span class="hs-identifier hs-var hs-var">unPaymentPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">[PaymentPrivateKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPrivateKeys</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | The parameters for the generators in this module.</span><span>
</span><span id="line-119"></span><span class="hs-keyword">data</span><span> </span><span id="GeneratorModel"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-var">GeneratorModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="GeneratorModel"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-var">GeneratorModel</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-120"></span><span>    </span><span id="gmInitialBalance"><span class="annot"><span class="annottext">GeneratorModel -&gt; Map PaymentPubKey Lovelace
</span><a href="Cardano.Node.Emulator.Generators.html#gmInitialBalance"><span class="hs-identifier hs-var hs-var">gmInitialBalance</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKey</span></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Lovelace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-comment">-- ^ Value created at the beginning of the blockchain.</span><span>
</span><span id="line-122"></span><span>    </span><span id="gmPubKeys"><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span></span><span>             </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentPubKey</span></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- ^ Public keys that are to be used for generating transactions.</span><span>
</span><span id="line-124"></span><span>    </span><span id="gmMaxCollateralInputs"><span class="annot"><span class="annottext">GeneratorModel -&gt; Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var hs-var">gmMaxCollateralInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679417349"><span id="local-6989586621679417351"><span id="local-6989586621679417353"><span class="annot"><span class="annottext">Int -&gt; GeneratorModel -&gt; ShowS
[GeneratorModel] -&gt; ShowS
GeneratorModel -&gt; String
(Int -&gt; GeneratorModel -&gt; ShowS)
-&gt; (GeneratorModel -&gt; String)
-&gt; ([GeneratorModel] -&gt; ShowS)
-&gt; Show GeneratorModel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [GeneratorModel] -&gt; ShowS
$cshowList :: [GeneratorModel] -&gt; ShowS
show :: GeneratorModel -&gt; String
$cshow :: GeneratorModel -&gt; String
showsPrec :: Int -&gt; GeneratorModel -&gt; ShowS
$cshowsPrec :: Int -&gt; GeneratorModel -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | A generator model with some sensible defaults.</span><span>
</span><span id="line-128"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-type">generatorModel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-129"></span><span id="generatorModel"><span class="annot"><span class="annottext">generatorModel :: GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var hs-var">generatorModel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417347"><span class="annot"><span class="annottext">vl :: Lovelace
</span><a href="#local-6989586621679417347"><span class="hs-identifier hs-var hs-var">vl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.Lovelace</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Lovelace) -&gt; Integer -&gt; Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1_000_000</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">100</span></span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679417344"><span class="annot"><span class="annottext">pubKeys :: [PaymentPubKey]
</span><a href="#local-6989586621679417344"><span class="hs-identifier hs-var hs-var">pubKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPublicKeys</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">in</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel :: Map PaymentPubKey Lovelace
-&gt; Set PaymentPubKey -&gt; Maybe Natural -&gt; GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">gmInitialBalance :: Map PaymentPubKey Lovelace
</span><a href="Cardano.Node.Emulator.Generators.html#gmInitialBalance"><span class="hs-identifier hs-var">gmInitialBalance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace)
-&gt; [(PaymentPubKey, Lovelace)] -&gt; Map PaymentPubKey Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; [Lovelace] -&gt; [(PaymentPubKey, Lovelace)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679417344"><span class="hs-identifier hs-var">pubKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; [Lovelace]
forall a. a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">repeat</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417347"><span class="hs-identifier hs-var">vl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gmPubKeys :: Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var">gmPubKeys</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; Set PaymentPubKey
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679417344"><span class="hs-identifier hs-var">pubKeys</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gmMaxCollateralInputs :: Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var">gmMaxCollateralInputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Maybe Natural
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var hs-var">protocolParamMaxCollateralInputs</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
forall a. Default a =&gt; a
</span><a href="../../../../data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Blockchain for testing the emulator implementation and traces.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">--   To avoid having to rely on functions from the implementation of</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   plutus-ledger (in particular, 'Ledger.Tx.unspentOutputs') we note the</span><span>
</span><span id="line-144"></span><span class="hs-comment">--   unspent outputs of the chain when it is first created.</span><span>
</span><span id="line-145"></span><span class="hs-keyword">data</span><span> </span><span id="Mockchain"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mockchain"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-146"></span><span>    </span><span id="mockchainInitialTxPool"><span class="annot"><span class="annottext">Mockchain -&gt; [CardanoTx]
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainInitialTxPool"><span class="hs-identifier hs-var hs-var">mockchainInitialTxPool</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-147"></span><span>    </span><span id="mockchainUtxo"><span class="annot"><span class="annottext">Mockchain -&gt; Map TxOutRef TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainUtxo"><span class="hs-identifier hs-var hs-var">mockchainUtxo</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-148"></span><span>    </span><span id="mockchainParams"><span class="annot"><span class="annottext">Mockchain -&gt; Params
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainParams"><span class="hs-identifier hs-var hs-var">mockchainParams</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Params.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679417330"><span id="local-6989586621679417332"><span id="local-6989586621679417334"><span class="annot"><span class="annottext">Int -&gt; Mockchain -&gt; ShowS
[Mockchain] -&gt; ShowS
Mockchain -&gt; String
(Int -&gt; Mockchain -&gt; ShowS)
-&gt; (Mockchain -&gt; String)
-&gt; ([Mockchain] -&gt; ShowS)
-&gt; Show Mockchain
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Mockchain] -&gt; ShowS
$cshowList :: [Mockchain] -&gt; ShowS
show :: Mockchain -&gt; String
$cshow :: Mockchain -&gt; String
showsPrec :: Int -&gt; Mockchain -&gt; ShowS
$cshowsPrec :: Int -&gt; Mockchain -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | The empty mockchain.</span><span>
</span><span id="line-152"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier hs-type">emptyChain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-153"></span><span id="emptyChain"><span class="annot"><span class="annottext">emptyChain :: Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#emptyChain"><span class="hs-identifier hs-var hs-var">emptyChain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[CardanoTx] -&gt; Map TxOutRef TxOut -&gt; Params -&gt; Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-var">Mockchain</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><a href="../../../../data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Generate a mockchain.</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">--   TODO: Generate more than 1 txn</span><span>
</span><span id="line-158"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-type">genMockchain'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-159"></span><span>       </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-161"></span><span id="genMockchain%27"><span class="annot"><span class="annottext">genMockchain' :: GeneratorModel -&gt; Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-var hs-var">genMockchain'</span></a></span></span><span> </span><span id="local-6989586621679417328"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417328"><span class="hs-identifier hs-var">gm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679417327"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417327"><span class="hs-identifier hs-var">slotCfg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenT Identity SlotConfig
forall (m :: * -&gt; *). MonadGen m =&gt; m SlotConfig
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-var">genSlotConfig</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679417326"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417326"><span class="hs-identifier hs-var">txn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679417325"><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417325"><span class="hs-identifier hs-var">ot</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Gen (CardanoTx, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-var">genInitialTransaction</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417328"><span class="hs-identifier hs-var">gm</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417324"><span class="annot"><span class="annottext">params :: Params
</span><a href="#local-6989586621679417324"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
forall a. Default a =&gt; a
</span><a href="../../../../data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">pSlotConfig :: SlotConfig
</span><a href="Cardano.Node.Emulator.Params.html#pSlotConfig"><span class="hs-identifier hs-var">pSlotConfig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417327"><span class="hs-identifier hs-var">slotCfg</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-comment">-- There is a problem that txId of emulator tx and tx of cardano tx are different.</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-comment">-- We convert the emulator tx to cardano tx here to get the correct transaction id</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-comment">-- because later we anyway will use the converted cardano tx so the utxo should match it.</span><span>
</span><span id="line-168"></span><span>        </span><span id="local-6989586621679417323"><span class="annot"><span class="annottext">tid :: TxId
</span><a href="#local-6989586621679417323"><span class="hs-identifier hs-var hs-var">tid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; TxId
</span><span class="hs-identifier hs-var">Tx.getCardanoTxId</span></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417326"><span class="hs-identifier hs-var">txn</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">Mockchain -&gt; Gen Mockchain
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain :: [CardanoTx] -&gt; Map TxOutRef TxOut -&gt; Params -&gt; Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-170"></span><span>        </span><span class="annot"><span class="annottext">mockchainInitialTxPool :: [CardanoTx]
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainInitialTxPool"><span class="hs-identifier hs-var">mockchainInitialTxPool</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417326"><span class="hs-identifier hs-var">txn</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="annottext">mockchainUtxo :: Map TxOutRef TxOut
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainUtxo"><span class="hs-identifier hs-var">mockchainUtxo</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut)
-&gt; [(TxOutRef, TxOut)] -&gt; Map TxOutRef TxOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; TxOutRef) -&gt; (Integer, TxOut) -&gt; (TxOutRef, TxOut)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxId -&gt; Integer -&gt; TxOutRef
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">TxOutRef</span></a></span><span> </span><span class="annot"><span class="annottext">TxId
</span><a href="#local-6989586621679417323"><span class="hs-identifier hs-var">tid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Integer, TxOut) -&gt; (TxOutRef, TxOut))
-&gt; [(Integer, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Integer] -&gt; [TxOut] -&gt; [(Integer, TxOut)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417325"><span class="hs-identifier hs-var">ot</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">mockchainParams :: Params
</span><a href="Cardano.Node.Emulator.Generators.html#mockchainParams"><span class="hs-identifier hs-var">mockchainParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679417324"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Generate a mockchain using the default 'GeneratorModel'.</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier hs-type">genMockchain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-178"></span><span id="genMockchain"><span class="annot"><span class="annottext">genMockchain :: Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain"><span class="hs-identifier hs-var hs-var">genMockchain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Gen Mockchain
</span><a href="Cardano.Node.Emulator.Generators.html#genMockchain%27"><span class="hs-identifier hs-var">genMockchain'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | A transaction with no inputs that mints some value (to be used at the</span><span>
</span><span id="line-181"></span><span class="hs-comment">--   beginning of a blockchain).</span><span>
</span><span id="line-182"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-type">genInitialTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-183"></span><span>       </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span id="genInitialTransaction"><span class="annot"><span class="annottext">genInitialTransaction :: GeneratorModel -&gt; Gen (CardanoTx, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#genInitialTransaction"><span class="hs-identifier hs-var hs-var">genInitialTransaction</span></a></span></span><span> </span><span id="local-6989586621679417320"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417320"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679417319"><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679417319"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679417318"><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417318"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Gen (TxBodyContent BuildTx BabbageEra, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#initialTxBody"><span class="hs-identifier hs-var">initialTxBody</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417320"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417318"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; (CardanoTx, [TxOut]))
-&gt; GenT Identity CardanoTx -&gt; Gen (CardanoTx, [TxOut])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; GenT Identity CardanoTx
forall (m :: * -&gt; *).
MonadFail m =&gt;
TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var">makeTx</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679417319"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#emptyTxBodyContent"><span class="hs-identifier hs-type">emptyTxBodyContent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span>
</span><span id="line-190"></span><span id="emptyTxBodyContent"><span class="annot"><span class="annottext">emptyTxBodyContent :: TxBodyContent BuildTx BabbageEra
</span><a href="Cardano.Node.Emulator.Generators.html#emptyTxBodyContent"><span class="hs-identifier hs-var hs-var">emptyTxBodyContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxBodyContent :: forall build era.
TxIns build era
-&gt; TxInsCollateral era
-&gt; TxInsReference build era
-&gt; [TxOut CtxTx era]
-&gt; TxTotalCollateral era
-&gt; TxReturnCollateral CtxTx era
-&gt; TxFee era
-&gt; (TxValidityLowerBound era, TxValidityUpperBound era)
-&gt; TxMetadataInEra era
-&gt; TxAuxScripts era
-&gt; TxExtraKeyWitnesses era
-&gt; BuildTxWith build (Maybe ProtocolParameters)
-&gt; TxWithdrawals build era
-&gt; TxCertificates build era
-&gt; TxUpdateProposal era
-&gt; TxMintValue build era
-&gt; TxScriptValidity era
-&gt; TxBodyContent build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span>
</span><span id="line-191"></span><span>   </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txIns :: TxIns BuildTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txIns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txInsCollateral :: TxInsCollateral BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txInsCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
forall era. TxInsCollateral era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsCollateralNone</span></a></span><span>
</span><span id="line-193"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txMintValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
forall build era. TxMintValue build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMintNone</span></a></span><span>
</span><span id="line-194"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txFee :: TxFee BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txFee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; TxFee BabbageEra
</span><span class="hs-identifier hs-var">C.toCardanoFee</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">0</span></span><span>
</span><span id="line-195"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txProtocolParams :: BuildTxWith BuildTx (Maybe ProtocolParameters)
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txProtocolParams</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe ProtocolParameters
 -&gt; BuildTxWith BuildTx (Maybe ProtocolParameters))
-&gt; Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Maybe ProtocolParameters
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(ProtocolParameters -&gt; Maybe ProtocolParameters)
-&gt; ProtocolParameters -&gt; Maybe ProtocolParameters
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra BabbageEra
-&gt; PParams (ShelleyLedgerEra BabbageEra) -&gt; ProtocolParameters
forall era.
ShelleyBasedEra era
-&gt; PParams (ShelleyLedgerEra era) -&gt; ProtocolParameters
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.fromLedgerPParams</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ShelleyBasedEraBabbage</span></a></span><span> </span><span class="annot"><span class="annottext">PParams (ShelleyLedgerEra BabbageEra)
forall a. Default a =&gt; a
</span><a href="../../../../data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-197"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txInsReference :: TxInsReference BuildTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txInsReference</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInsReference BuildTx BabbageEra
forall build era. TxInsReference build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxInsReferenceNone</span></a></span><span>
</span><span id="line-198"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txTotalCollateral :: TxTotalCollateral BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txTotalCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxTotalCollateral BabbageEra
forall era. TxTotalCollateral era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxTotalCollateralNone</span></a></span><span>
</span><span id="line-199"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txReturnCollateral :: TxReturnCollateral CtxTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txReturnCollateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxReturnCollateral CtxTx BabbageEra
forall ctx era. TxReturnCollateral ctx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxReturnCollateralNone</span></a></span><span>
</span><span id="line-200"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txValidityRange :: (TxValidityLowerBound BabbageEra, TxValidityUpperBound BabbageEra)
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txValidityRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TxValidityLowerBound BabbageEra
forall era. TxValidityLowerBound era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxValidityNoLowerBound</span></a></span><span>
</span><span id="line-201"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra BabbageEra
-&gt; TxValidityUpperBound BabbageEra
forall era.
ValidityNoUpperBoundSupportedInEra era -&gt; TxValidityUpperBound era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxValidityNoUpperBound</span></a></span><span> </span><span class="annot"><span class="annottext">ValidityNoUpperBoundSupportedInEra BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ValidityNoUpperBoundInBabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txScriptValidity :: TxScriptValidity BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txScriptValidity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxScriptValidity BabbageEra
forall era. TxScriptValidity era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxScriptValidityNone</span></a></span><span>
</span><span id="line-203"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txExtraKeyWits :: TxExtraKeyWitnesses BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txExtraKeyWits</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses BabbageEra
forall era. TxExtraKeyWitnesses era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxExtraKeyWitnessesNone</span></a></span><span>
</span><span id="line-204"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txMetadata :: TxMetadataInEra BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txMetadata</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxMetadataInEra BabbageEra
forall era. TxMetadataInEra era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMetadataNone</span></a></span><span>
</span><span id="line-205"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txAuxScripts :: TxAuxScripts BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txAuxScripts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxAuxScripts BabbageEra
forall era. TxAuxScripts era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxAuxScriptsNone</span></a></span><span>
</span><span id="line-206"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txWithdrawals :: TxWithdrawals BuildTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txWithdrawals</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxWithdrawals BuildTx BabbageEra
forall build era. TxWithdrawals build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxWithdrawalsNone</span></a></span><span>
</span><span id="line-207"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txCertificates :: TxCertificates BuildTx BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txCertificates</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxCertificates BuildTx BabbageEra
forall build era. TxCertificates build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxCertificatesNone</span></a></span><span>
</span><span id="line-208"></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txUpdateProposal :: TxUpdateProposal BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">txUpdateProposal</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxUpdateProposal BabbageEra
forall era. TxUpdateProposal era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxUpdateProposalNone</span></a></span><span>
</span><span id="line-209"></span><span>   </span><span class="hs-special">}</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#initialTxBody"><span class="hs-identifier hs-type">initialTxBody</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-212"></span><span>       </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="initialTxBody"><span class="annot"><span class="annottext">initialTxBody :: GeneratorModel -&gt; Gen (TxBodyContent BuildTx BabbageEra, [TxOut])
</span><a href="Cardano.Node.Emulator.Generators.html#initialTxBody"><span class="hs-identifier hs-var hs-var">initialTxBody</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span class="hs-special">{</span><span id="local-6989586621679417277"><span id="local-6989586621679417278"><span id="local-6989586621679417279"><span class="annot"><span class="annottext">Maybe Natural
Set PaymentPubKey
Map PaymentPubKey Lovelace
gmMaxCollateralInputs :: Maybe Natural
gmPubKeys :: Set PaymentPubKey
gmInitialBalance :: Map PaymentPubKey Lovelace
gmMaxCollateralInputs :: GeneratorModel -&gt; Maybe Natural
gmPubKeys :: GeneratorModel -&gt; Set PaymentPubKey
gmInitialBalance :: GeneratorModel -&gt; Map PaymentPubKey Lovelace
</span><a href="#local-6989586621679417277"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417276"><span class="annot"><span class="annottext">o :: [TxOut]
</span><a href="#local-6989586621679417276"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; [TxOut])
-&gt; ([TxOut] -&gt; [TxOut]) -&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [TxOut]
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [TxOut])
-&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; [TxOut]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot create outputs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxOut] -&gt; [TxOut]
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-216"></span><span>          </span><span class="annot"><span class="annottext">(Either ToCardanoError [TxOut] -&gt; [TxOut])
-&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((PaymentPubKey, Value) -&gt; Either ToCardanoError TxOut)
-&gt; [(PaymentPubKey, Value)] -&gt; Either ToCardanoError [TxOut]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679417269"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679417269"><span class="hs-identifier hs-var">ppk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679417268"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417268"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
-&gt; PaymentPubKey
-&gt; Maybe StakingCredential
-&gt; Either ToCardanoError TxOut
</span><span class="hs-identifier hs-var">pubKeyTxOut</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417268"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679417269"><span class="hs-identifier hs-var">ppk</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(PaymentPubKey, Value)] -&gt; Either ToCardanoError [TxOut])
-&gt; [(PaymentPubKey, Value)] -&gt; Either ToCardanoError [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKey Value -&gt; [(PaymentPubKey, Value)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map PaymentPubKey Value -&gt; [(PaymentPubKey, Value)])
-&gt; Map PaymentPubKey Value -&gt; [(PaymentPubKey, Value)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value)
-&gt; Map PaymentPubKey Lovelace -&gt; Map PaymentPubKey Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Map PaymentPubKey Lovelace
</span><a href="#local-6989586621679417279"><span class="hs-identifier hs-var">gmInitialBalance</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- we use a generated tx in input it's unbalanced but it's &quot;fine&quot; as we don't validate this tx</span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679417265"><span class="annot"><span class="annottext">TxIns BuildTx BabbageEra
</span><a href="#local-6989586621679417265"><span class="hs-identifier hs-var">txIns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxIn
 -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)))
-&gt; [TxIn] -&gt; TxIns BuildTx BabbageEra
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn BabbageEra
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>                 </span><span class="annot"><span class="annottext">([TxIn] -&gt; TxIns BuildTx BabbageEra)
-&gt; GenT Identity [TxIn] -&gt; GenT Identity (TxIns BuildTx BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity TxIn -&gt; GenT Identity [TxIn]
forall (m :: * -&gt; *) a. MonadGen m =&gt; Range Int -&gt; m a -&gt; m [a]
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.list</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.constant</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GenT Identity TxIn
</span><span class="hs-identifier hs-var">genTxIn</span></span><span>
</span><span id="line-220"></span><span>    </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra, [TxOut])
-&gt; Gen (TxBodyContent BuildTx BabbageEra, [TxOut])
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="Cardano.Node.Emulator.Generators.html#emptyTxBodyContent"><span class="hs-identifier hs-var">emptyTxBodyContent</span></a></span><span>
</span><span id="line-221"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TxIns BuildTx BabbageEra
txIns :: TxIns BuildTx BabbageEra
txIns :: TxIns BuildTx BabbageEra
</span><a href="#local-6989586621679417265"><span class="hs-identifier hs-var hs-var">C.txIns</span></a></span><span>
</span><span id="line-222"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.txOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxTx BabbageEra
</span><span class="hs-identifier hs-var hs-var">Tx.getTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut CtxTx BabbageEra)
-&gt; [TxOut] -&gt; [TxOut CtxTx BabbageEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417276"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-223"></span><span>           </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417276"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   of the unspent outputs is smaller than the minimum fee.</span><span>
</span><span id="line-228"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier hs-type">genValidTransaction</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-231"></span><span id="genValidTransaction"><span class="annot"><span class="annottext">genValidTransaction :: Mockchain -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction"><span class="hs-identifier hs-var hs-var">genValidTransaction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Mockchain -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-var">genValidTransaction'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier hs-type">genValidTransactionBody</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span id="genValidTransactionBody"><span class="annot"><span class="annottext">genValidTransactionBody :: Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody"><span class="hs-identifier hs-var hs-var">genValidTransactionBody</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var">genValidTransactionBody'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-240"></span><span class="hs-comment">--   of the unspent outputs is smaller than the estimated fee.</span><span>
</span><span id="line-241"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-type">genValidTransaction'</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-245"></span><span id="genValidTransaction%27"><span class="annot"><span class="annottext">genValidTransaction' :: GeneratorModel -&gt; Mockchain -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransaction%27"><span class="hs-identifier hs-var hs-var">genValidTransaction'</span></a></span></span><span> </span><span id="local-6989586621679417258"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417258"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679417257"><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679417257"><span class="hs-identifier hs-var">chain</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var">genValidTransactionBody'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417258"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679417257"><span class="hs-identifier hs-var">chain</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (TxBodyContent BuildTx BabbageEra)
-&gt; (TxBodyContent BuildTx BabbageEra -&gt; GenT Identity CardanoTx)
-&gt; GenT Identity CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; GenT Identity CardanoTx
forall (m :: * -&gt; *).
MonadFail m =&gt;
TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var">makeTx</span></a></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier hs-type">genValidTransactionSpending</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-251"></span><span id="genValidTransactionSpending"><span class="annot"><span class="annottext">genValidTransactionSpending :: [TxInputWitnessed] -&gt; Value -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending"><span class="hs-identifier hs-var hs-var">genValidTransactionSpending</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; [TxInputWitnessed] -&gt; Value -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-var">genValidTransactionSpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="Cardano.Node.Emulator.Generators.html#generatorModel"><span class="hs-identifier hs-var">generatorModel</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | A transaction input, consisting of a transaction output reference and an input type with data witnesses.</span><span>
</span><span id="line-255"></span><span class="hs-keyword">data</span><span> </span><span id="TxInputWitnessed"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-var">TxInputWitnessed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxInputWitnessed"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-var">TxInputWitnessed</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">TxOutRef</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Ledger.TxInType</span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-type">genValidTransactionSpending'</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-263"></span><span id="genValidTransactionSpending%27"><span class="annot"><span class="annottext">genValidTransactionSpending' :: GeneratorModel
-&gt; [TxInputWitnessed] -&gt; Value -&gt; GenT Identity CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionSpending%27"><span class="hs-identifier hs-var hs-var">genValidTransactionSpending'</span></a></span></span><span> </span><span id="local-6989586621679417255"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417255"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679417254"><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417254"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679417253"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417253"><span class="hs-identifier hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; [TxInputWitnessed]
-&gt; Value
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var">genValidTransactionBodySpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417255"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417254"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417253"><span class="hs-identifier hs-var">totalVal</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (TxBodyContent BuildTx BabbageEra)
-&gt; (TxBodyContent BuildTx BabbageEra -&gt; GenT Identity CardanoTx)
-&gt; GenT Identity CardanoTx
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra -&gt; GenT Identity CardanoTx
forall (m :: * -&gt; *).
MonadFail m =&gt;
TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var">makeTx</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span id="local-6989586621679417696"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-type">makeTx</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417696"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span></span><span>
</span><span id="line-271"></span><span id="makeTx"><span class="annot"><span class="annottext">makeTx :: TxBodyContent BuildTx BabbageEra -&gt; m CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#makeTx"><span class="hs-identifier hs-var hs-var">makeTx</span></a></span></span><span> </span><span id="local-6989586621679417251"><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679417251"><span class="hs-identifier hs-var">bodyContent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679417250"><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679417250"><span class="hs-identifier hs-var">txBody</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TxBodyError -&gt; m (TxBody BabbageEra))
-&gt; (TxBody BabbageEra -&gt; m (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra)
-&gt; m (TxBody BabbageEra)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m (TxBody BabbageEra)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m (TxBody BabbageEra))
-&gt; (TxBodyError -&gt; String) -&gt; TxBodyError -&gt; m (TxBody BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Can't create TxBody&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (TxBodyError -&gt; String) -&gt; TxBodyError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; m (TxBody BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TxBodyError (TxBody BabbageEra) -&gt; m (TxBody BabbageEra))
-&gt; Either TxBodyError (TxBody BabbageEra) -&gt; m (TxBody BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Either TxBodyError (TxBody BabbageEra)
forall era.
IsCardanoEra era =&gt;
TxBodyContent BuildTx era -&gt; Either TxBodyError (TxBody era)
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.makeTransactionBody</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="#local-6989586621679417251"><span class="hs-identifier hs-var">bodyContent</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">CardanoTx -&gt; m CardanoTx
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; m CardanoTx) -&gt; CardanoTx -&gt; m CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx -&gt; CardanoTx
</span><a href="Cardano.Node.Emulator.Generators.html#signAll"><span class="hs-identifier hs-var">signAll</span></a></span><span> </span><span class="annot"><span class="annottext">(CardanoTx -&gt; CardanoTx) -&gt; CardanoTx -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; CardanoTx
</span><span class="hs-identifier hs-var">CardanoEmulatorEraTx</span></span><span> </span><span class="annot"><span class="annottext">(Tx BabbageEra -&gt; CardanoTx) -&gt; Tx BabbageEra -&gt; CardanoTx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra -&gt; [KeyWitness BabbageEra] -&gt; Tx BabbageEra
forall era. TxBody era -&gt; [KeyWitness era] -&gt; Tx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.Tx</span></a></span><span> </span><span class="annot"><span class="annottext">TxBody BabbageEra
</span><a href="#local-6989586621679417250"><span class="hs-identifier hs-var">txBody</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Generate a valid transaction, using the unspent outputs provided.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--   Fails if the there are no unspent outputs, or if the total value</span><span>
</span><span id="line-277"></span><span class="hs-comment">--   of the unspent outputs is smaller than the estimated fee.</span><span>
</span><span id="line-278"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-type">genValidTransactionBody'</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span id="genValidTransactionBody%27"><span class="annot"><span class="annottext">genValidTransactionBody' :: GeneratorModel
-&gt; Mockchain -&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBody%27"><span class="hs-identifier hs-var hs-var">genValidTransactionBody'</span></a></span></span><span> </span><span id="local-6989586621679417247"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417247"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="annot"><span class="annottext">[CardanoTx]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679417246"><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417246"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="annot"><span class="annottext">Params
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-comment">-- Take a random number of UTXO from the input</span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621679417245"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417245"><span class="hs-identifier hs-var">nUtxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417246"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">GenT Identity Int
forall (m :: * -&gt; *) a. MonadGen m =&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.discard</span></a></span><span>
</span><span id="line-286"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; Int
forall k a. Map k a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417246"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417239"><span class="annot"><span class="annottext">ins :: [TxInputWitnessed]
</span><a href="#local-6989586621679417239"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOutRef -&gt; TxInType -&gt; TxInputWitnessed
</span><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-operator hs-var">`TxInputWitnessed`</span></a></span><span> </span><span class="annot"><span class="annottext">TxInType
</span><span class="hs-identifier hs-var">ConsumePublicKeyAddress</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TxOutRef -&gt; TxInputWitnessed)
-&gt; ((TxOutRef, TxOut) -&gt; TxOutRef)
-&gt; (TxOutRef, TxOut)
-&gt; TxInputWitnessed
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOutRef
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; TxInputWitnessed)
-&gt; [(TxOutRef, TxOut)] -&gt; [TxInputWitnessed]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)]
</span><a href="#local-6989586621679417238"><span class="hs-identifier hs-var">inUTXO</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span id="local-6989586621679417238"><span class="annot"><span class="annottext">inUTXO :: [(TxOutRef, TxOut)]
</span><a href="#local-6989586621679417238"><span class="hs-identifier hs-var hs-var">inUTXO</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417245"><span class="hs-identifier hs-var">nUtxo</span></a></span><span> </span><span class="annot"><span class="annottext">([(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)])
-&gt; [(TxOutRef, TxOut)] -&gt; [(TxOutRef, TxOut)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; [(TxOutRef, TxOut)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417246"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span id="local-6989586621679417236"><span class="annot"><span class="annottext">totalVal :: Value
</span><a href="#local-6989586621679417236"><span class="hs-identifier hs-var hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TxOutRef, TxOut) -&gt; Value) -&gt; [(TxOutRef, TxOut)] -&gt; Value
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; Value)
-&gt; ((TxOutRef, TxOut) -&gt; TxOut) -&gt; (TxOutRef, TxOut) -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxOutRef, TxOut) -&gt; TxOut
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(TxOutRef, TxOut)]
</span><a href="#local-6989586621679417238"><span class="hs-identifier hs-var">inUTXO</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="annottext">GeneratorModel
-&gt; [TxInputWitnessed]
-&gt; Value
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var">genValidTransactionBodySpending'</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417247"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417239"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417236"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-type">genValidTransactionBodySpending'</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#GeneratorModel"><span class="hs-identifier hs-type">GeneratorModel</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxBodyContent</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span id="genValidTransactionBodySpending%27"><span class="annot"><span class="annottext">genValidTransactionBodySpending' :: GeneratorModel
-&gt; [TxInputWitnessed]
-&gt; Value
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
</span><a href="Cardano.Node.Emulator.Generators.html#genValidTransactionBodySpending%27"><span class="hs-identifier hs-var hs-var">genValidTransactionBodySpending'</span></a></span></span><span> </span><span id="local-6989586621679417234"><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417234"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679417233"><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417233"><span class="hs-identifier hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679417232"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417232"><span class="hs-identifier hs-var">totalVal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679417231"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417231"><span class="hs-identifier hs-var">mintAmount</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a. Integral a =&gt; a -&gt; Integer
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toInteger</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; GenT Identity Int -&gt; GenT Identity Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679417229"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679417229"><span class="hs-identifier hs-var">mintTokenName</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Gen AssetName
</span><span class="hs-identifier hs-var">Gen.genAssetName</span></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417228"><span class="annot"><span class="annottext">mintValue :: Maybe Value
</span><a href="#local-6989586621679417228"><span class="hs-identifier hs-var hs-var">mintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417231"><span class="hs-identifier hs-var">mintAmount</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Value -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName -&gt; Integer -&gt; Value
</span><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-var">someTokenValue</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679417229"><span class="hs-identifier hs-var">mintTokenName</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417231"><span class="hs-identifier hs-var">mintAmount</span></a></span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621679417227"><span class="annot"><span class="annottext">fee' :: Lovelace
</span><a href="#local-6989586621679417227"><span class="hs-identifier hs-var hs-var">fee'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Lovelace
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.Lovelace</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">300000</span></span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621679417226"><span class="annot"><span class="annottext">numOut :: Int
</span><a href="#local-6989586621679417226"><span class="hs-identifier hs-var hs-var">numOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set PaymentPubKey -&gt; Int
forall a. Set a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.size</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417234"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-303"></span><span>        </span><span id="local-6989586621679417224"><span class="annot"><span class="annottext">totalValAda :: Lovelace
</span><a href="#local-6989586621679417224"><span class="hs-identifier hs-var hs-var">totalValAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Lovelace
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.selectLovelace</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417232"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621679417222"><span class="annot"><span class="annottext">totalValTokens :: Maybe Value
</span><a href="#local-6989586621679417222"><span class="hs-identifier hs-var hs-var">totalValTokens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><span class="hs-identifier hs-var">Value.isZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">Value.noAdaValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417232"><span class="hs-identifier hs-var">totalVal</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe () -&gt; Value -&gt; Maybe Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><span class="hs-identifier hs-var">Value.noAdaValue</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417232"><span class="hs-identifier hs-var">totalVal</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span id="local-6989586621679417219"><span class="annot"><span class="annottext">canPayTheFees :: Bool
</span><a href="#local-6989586621679417219"><span class="hs-identifier hs-var hs-var">canPayTheFees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417227"><span class="hs-identifier hs-var">fee'</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417224"><span class="hs-identifier hs-var">totalValAda</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; GenT Identity ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679417219"><span class="hs-identifier hs-var">canPayTheFees</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- We only split the Ada part of the input value</span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679417217"><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679417217"><span class="hs-identifier hs-var">splitOutVals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Lovelace -&gt; GenT Identity [Lovelace]
forall (m :: * -&gt; *) n.
(MonadGen m, Integral n) =&gt;
Int -&gt; n -&gt; m [n]
</span><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var">splitVal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417226"><span class="hs-identifier hs-var">numOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417224"><span class="hs-identifier hs-var">totalValAda</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Lovelace
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417227"><span class="hs-identifier hs-var">fee'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417216"><span class="annot"><span class="annottext">outVals :: [Value]
</span><a href="#local-6989586621679417216"><span class="hs-identifier hs-var hs-var">outVals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679417222"><span class="hs-identifier hs-var">totalValTokens</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value -&gt; Maybe Value -&gt; Maybe Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679417228"><span class="hs-identifier hs-var">mintValue</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; [Lovelace] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679417217"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679417215"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417215"><span class="hs-identifier hs-var">mv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-comment">-- If there is a minted value, we look for a value in the</span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-comment">-- splitted values which can be associated with it.</span><span>
</span><span id="line-314"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417214"><span class="annot"><span class="annottext">outValForMint :: Lovelace
</span><a href="#local-6989586621679417214"><span class="hs-identifier hs-var hs-var">outValForMint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-315"></span><span>                        </span><span class="annot"><span class="annottext">Lovelace -&gt; Maybe Lovelace -&gt; Lovelace
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Lovelace -&gt; Lovelace) -&gt; Maybe Lovelace -&gt; Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Bool) -&gt; [Lovelace] -&gt; Maybe Lovelace
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.find</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; Lovelace -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-identifier hs-var">Ledger.minLovelaceTxOutEstimated</span></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>                                         </span><span class="annot"><span class="annottext">([Lovelace] -&gt; Maybe Lovelace) -&gt; [Lovelace] -&gt; Maybe Lovelace
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace] -&gt; [Lovelace]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.sort</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679417217"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span>
</span><span id="line-317"></span><span>                </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417214"><span class="hs-identifier hs-var">outValForMint</span></a></span><span>
</span><span id="line-318"></span><span>                    </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417215"><span class="hs-identifier hs-var">mv</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [Value] -&gt; [Value]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(Lovelace -&gt; Value) -&gt; [Lovelace] -&gt; [Value]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; Value
</span><span class="hs-identifier hs-var">Value.lovelaceToValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lovelace -&gt; [Lovelace] -&gt; [Lovelace]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">List.delete</span></a></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417214"><span class="hs-identifier hs-var">outValForMint</span></a></span><span> </span><span class="annot"><span class="annottext">[Lovelace]
</span><a href="#local-6989586621679417217"><span class="hs-identifier hs-var">splitOutVals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679417211"><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679417211"><span class="hs-identifier hs-var">pubKeys</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey] -&gt; GenT Identity [PaymentPubKey]
forall (m :: * -&gt; *) a. MonadGen m =&gt; [a] -&gt; m [a]
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">([PaymentPubKey] -&gt; GenT Identity [PaymentPubKey])
-&gt; [PaymentPubKey] -&gt; GenT Identity [PaymentPubKey]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Set PaymentPubKey -&gt; [PaymentPubKey]
forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Set PaymentPubKey -&gt; [PaymentPubKey])
-&gt; Set PaymentPubKey -&gt; [PaymentPubKey]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel -&gt; Set PaymentPubKey
</span><a href="Cardano.Node.Emulator.Generators.html#gmPubKeys"><span class="hs-identifier hs-var hs-var">gmPubKeys</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417234"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417208"><span class="annot"><span class="annottext">txOutputs :: [TxOut]
</span><a href="#local-6989586621679417208"><span class="hs-identifier hs-var hs-var">txOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; [TxOut])
-&gt; ([TxOut] -&gt; [TxOut]) -&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [TxOut]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [TxOut])
-&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; [TxOut]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot create outputs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TxOut] -&gt; [TxOut]
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-321"></span><span>                    </span><span class="annot"><span class="annottext">(Either ToCardanoError [TxOut] -&gt; [TxOut])
-&gt; Either ToCardanoError [TxOut] -&gt; [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Value, PaymentPubKey) -&gt; Either ToCardanoError TxOut)
-&gt; [(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679417207"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417207"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679417206"><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679417206"><span class="hs-identifier hs-var">ppk</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
-&gt; PaymentPubKey
-&gt; Maybe StakingCredential
-&gt; Either ToCardanoError TxOut
</span><span class="hs-identifier hs-var">pubKeyTxOut</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679417207"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">PaymentPubKey
</span><a href="#local-6989586621679417206"><span class="hs-identifier hs-var">ppk</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>                    </span><span class="annot"><span class="annottext">([(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut])
-&gt; [(Value, PaymentPubKey)] -&gt; Either ToCardanoError [TxOut]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Value] -&gt; [PaymentPubKey] -&gt; [(Value, PaymentPubKey)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679417216"><span class="hs-identifier hs-var">outVals</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPubKey]
</span><a href="#local-6989586621679417211"><span class="hs-identifier hs-var">pubKeys</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679417205"><span class="annot"><span class="annottext">TxIns BuildTx BabbageEra
</span><a href="#local-6989586621679417205"><span class="hs-identifier hs-var">txIns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError (TxIns BuildTx BabbageEra)
-&gt; GenT Identity (TxIns BuildTx BabbageEra)
forall (m :: * -&gt; *) a.
MonadFail m =&gt;
Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var">failOnCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (TxIns BuildTx BabbageEra)
 -&gt; GenT Identity (TxIns BuildTx BabbageEra))
-&gt; Either ToCardanoError (TxIns BuildTx BabbageEra)
-&gt; GenT Identity (TxIns BuildTx BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInputWitnessed
 -&gt; Either
      ToCardanoError
      (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)))
-&gt; [TxInputWitnessed]
-&gt; Either ToCardanoError (TxIns BuildTx BabbageEra)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">TxInputWitnessed
-&gt; Either
     ToCardanoError
     (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
</span><a href="#local-6989586621679417204"><span class="hs-identifier hs-var">txInToCardanoTxInput</span></a></span><span> </span><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417233"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679417203"><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679417203"><span class="hs-identifier hs-var">mintWitness</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra)
forall (m :: * -&gt; *) a.
MonadFail m =&gt;
Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var">failOnCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
 -&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra))
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
-&gt; GenT Identity (ScriptWitness WitCtxMint BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
-&gt; PlutusScriptVersion PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
-&gt; ScriptDatum WitCtxMint
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness WitCtxMint BabbageEra
forall lang era witctx.
ScriptLanguageInEra lang era
-&gt; PlutusScriptVersion lang
-&gt; PlutusScriptOrReferenceInput lang
-&gt; ScriptDatum witctx
-&gt; ScriptRedeemer
-&gt; ExecutionUnits
-&gt; ScriptWitness witctx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PlutusScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptLanguageInEra PlutusScriptV2 BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PlutusScriptV2InBabbage</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV2
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PlutusScriptV2</span></a></span><span>
</span><span id="line-325"></span><span>                           </span><span class="annot"><span class="annottext">(PlutusScriptOrReferenceInput PlutusScriptV2
 -&gt; ScriptDatum WitCtxMint
 -&gt; ScriptRedeemer
 -&gt; ExecutionUnits
 -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either
     ToCardanoError
     (ScriptDatum WitCtxMint
      -&gt; ScriptRedeemer
      -&gt; ExecutionUnits
      -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV2
-&gt; PlutusScriptOrReferenceInput PlutusScriptV2
forall lang. PlutusScript lang -&gt; PlutusScriptOrReferenceInput lang
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PScript</span></a></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV2
 -&gt; PlutusScriptOrReferenceInput PlutusScriptV2)
-&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
-&gt; Either
     ToCardanoError (PlutusScriptOrReferenceInput PlutusScriptV2)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">AsType (PlutusScript PlutusScriptV2)
-&gt; Script -&gt; Either ToCardanoError (PlutusScript PlutusScriptV2)
forall plutusScript.
SerialiseAsRawBytes plutusScript =&gt;
AsType plutusScript -&gt; Script -&gt; Either ToCardanoError plutusScript
</span><span class="hs-identifier hs-var">C.toCardanoPlutusScript</span></span><span>
</span><span id="line-326"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AsType PlutusScriptV2 -&gt; AsType (PlutusScript PlutusScriptV2)
forall lang. AsType lang -&gt; AsType (PlutusScript lang)
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AsPlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">AsType PlutusScriptV2
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AsPlutusScriptV2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>                                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintingPolicy -&gt; Script
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">getMintingPolicy</span></a></span><span> </span><span class="annot"><span class="annottext">MintingPolicy
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-var">alwaysSucceedPolicy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptDatum WitCtxMint
   -&gt; ScriptRedeemer
   -&gt; ExecutionUnits
   -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
-&gt; Either
     ToCardanoError
     (ScriptRedeemer
      -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
-&gt; Either ToCardanoError (ScriptDatum WitCtxMint)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptDatum WitCtxMint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.NoScriptDatumForMint</span></a></span><span>
</span><span id="line-329"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ScriptRedeemer
   -&gt; ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ScriptRedeemer
-&gt; Either
     ToCardanoError
     (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptRedeemer -&gt; Either ToCardanoError ScriptRedeemer
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Data -&gt; ScriptRedeemer
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.fromPlutusData</span></a></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; ScriptRedeemer) -&gt; Data -&gt; ScriptRedeemer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><a href="../../../../plutus-tx/html/src"><span class="hs-identifier hs-var">toData</span></a></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Script.unitRedeemer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>                           </span><span class="annot"><span class="annottext">Either
  ToCardanoError
  (ExecutionUnits -&gt; ScriptWitness WitCtxMint BabbageEra)
-&gt; Either ToCardanoError ExecutionUnits
-&gt; Either ToCardanoError (ScriptWitness WitCtxMint BabbageEra)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits -&gt; Either ToCardanoError ExecutionUnits
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionUnits
</span><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417191"><span class="annot"><span class="annottext">txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679417191"><span class="hs-identifier hs-var hs-var">txMintValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
-&gt; Value
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
-&gt; TxMintValue BuildTx BabbageEra
forall era build.
MultiAssetSupportedInEra era
-&gt; Value
-&gt; BuildTxWith build (Map PolicyId (ScriptWitness WitCtxMint era))
-&gt; TxMintValue build era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.TxMintValue</span></a></span><span> </span><span class="annot"><span class="annottext">MultiAssetSupportedInEra BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.MultiAssetInBabbageEra</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Maybe Value -&gt; Value
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="#local-6989586621679417228"><span class="hs-identifier hs-var">mintValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
-&gt; BuildTxWith
     BuildTx (Map PolicyId (ScriptWitness WitCtxMint BabbageEra))
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId
-&gt; ScriptWitness WitCtxMint BabbageEra
-&gt; Map PolicyId (ScriptWitness WitCtxMint BabbageEra)
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var">alwaysSucceedPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxMint BabbageEra
</span><a href="#local-6989586621679417203"><span class="hs-identifier hs-var">mintWitness</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679417187"><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
</span><a href="#local-6989586621679417187"><span class="hs-identifier hs-var">txInsCollateral</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GenT Identity (TxInsCollateral BabbageEra)
-&gt; (Natural -&gt; GenT Identity (TxInsCollateral BabbageEra))
-&gt; Maybe Natural
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; GenT Identity (TxInsCollateral BabbageEra)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot gen collateral&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ToCardanoError (TxInsCollateral BabbageEra)
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall (m :: * -&gt; *) a.
MonadFail m =&gt;
Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var">failOnCardanoError</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ToCardanoError (TxInsCollateral BabbageEra)
 -&gt; GenT Identity (TxInsCollateral BabbageEra))
-&gt; (Natural -&gt; Either ToCardanoError (TxInsCollateral BabbageEra))
-&gt; Natural
-&gt; GenT Identity (TxInsCollateral BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxInput] -&gt; Either ToCardanoError (TxInsCollateral BabbageEra)
</span><span class="hs-identifier hs-var">C.toCardanoTxInsCollateral</span></span><span> </span><span class="annot"><span class="annottext">([TxInput] -&gt; Either ToCardanoError (TxInsCollateral BabbageEra))
-&gt; (Natural -&gt; [TxInput])
-&gt; Natural
-&gt; Either ToCardanoError (TxInsCollateral BabbageEra)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInputWitnessed -&gt; TxInput) -&gt; [TxInputWitnessed] -&gt; [TxInput]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">TxInputWitnessed -&gt; TxInput
</span><a href="#local-6989586621679417184"><span class="hs-identifier hs-var">toTxInput</span></a></span><span> </span><span class="annot"><span class="annottext">([TxInputWitnessed] -&gt; [TxInput])
-&gt; (Natural -&gt; [TxInputWitnessed]) -&gt; Natural -&gt; [TxInput]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [TxInputWitnessed] -&gt; [TxInputWitnessed])
-&gt; [TxInputWitnessed] -&gt; Int -&gt; [TxInputWitnessed]
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [TxInputWitnessed] -&gt; [TxInputWitnessed]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">[TxInputWitnessed]
</span><a href="#local-6989586621679417233"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; [TxInputWitnessed])
-&gt; (Natural -&gt; Int) -&gt; Natural -&gt; [TxInputWitnessed]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GeneratorModel -&gt; Maybe Natural
</span><a href="Cardano.Node.Emulator.Generators.html#gmMaxCollateralInputs"><span class="hs-identifier hs-var hs-var">gmMaxCollateralInputs</span></a></span><span> </span><span class="annot"><span class="annottext">GeneratorModel
</span><a href="#local-6989586621679417234"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(TxBodyContent BuildTx BabbageEra
 -&gt; Gen (TxBodyContent BuildTx BabbageEra))
-&gt; TxBodyContent BuildTx BabbageEra
-&gt; Gen (TxBodyContent BuildTx BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxBodyContent BuildTx BabbageEra
</span><a href="Cardano.Node.Emulator.Generators.html#emptyTxBodyContent"><span class="hs-identifier hs-var">emptyTxBodyContent</span></a></span><span>
</span><span id="line-338"></span><span>           </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">TxIns BuildTx BabbageEra
txIns :: TxIns BuildTx BabbageEra
txIns :: TxIns BuildTx BabbageEra
</span><a href="#local-6989586621679417205"><span class="hs-identifier hs-var hs-var">C.txIns</span></a></span><span>
</span><span id="line-339"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxInsCollateral BabbageEra
txInsCollateral :: TxInsCollateral BabbageEra
txInsCollateral :: TxInsCollateral BabbageEra
</span><a href="#local-6989586621679417187"><span class="hs-identifier hs-var hs-var">C.txInsCollateral</span></a></span><span>
</span><span id="line-340"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxMintValue BuildTx BabbageEra
txMintValue :: TxMintValue BuildTx BabbageEra
txMintValue :: TxMintValue BuildTx BabbageEra
</span><a href="#local-6989586621679417191"><span class="hs-identifier hs-var hs-var">C.txMintValue</span></a></span><span>
</span><span id="line-341"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txFee :: TxFee BabbageEra
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.txFee</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; TxFee BabbageEra
</span><span class="hs-identifier hs-var">C.toCardanoFee</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><a href="#local-6989586621679417227"><span class="hs-identifier hs-var">fee'</span></a></span><span>
</span><span id="line-342"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">txOuts :: [TxOut CtxTx BabbageEra]
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.txOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut CtxTx BabbageEra
</span><span class="hs-identifier hs-var hs-var">Tx.getTxOut</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut CtxTx BabbageEra)
-&gt; [TxOut] -&gt; [TxOut CtxTx BabbageEra]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[TxOut]
</span><a href="#local-6989586621679417208"><span class="hs-identifier hs-var">txOutputs</span></a></span><span>
</span><span id="line-343"></span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-comment">-- | Translate TxIn to TxInput taking out data witnesses if present.</span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><a href="#local-6989586621679417204"><span class="hs-identifier hs-type">txInToCardanoTxInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-347"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.ToCardanoError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.TxIn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTxWith</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BuildTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Witness</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.WitCtxTxIn</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.BabbageEra</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span id="local-6989586621679417204"><span class="annot"><span class="annottext">txInToCardanoTxInput :: TxInputWitnessed
-&gt; Either
     ToCardanoError
     (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
</span><a href="#local-6989586621679417204"><span class="hs-identifier hs-var hs-var">txInToCardanoTxInput</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span> </span><span id="local-6989586621679417183"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679417183"><span class="hs-identifier hs-var">outref</span></a></span></span><span> </span><span id="local-6989586621679417182"><span class="annot"><span class="annottext">TxInType
</span><a href="#local-6989586621679417182"><span class="hs-identifier hs-var">txInType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxInType
</span><a href="#local-6989586621679417182"><span class="hs-identifier hs-var">txInType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>            </span><span class="annot"><span class="annottext">TxInType
</span><span class="hs-identifier hs-var">Ledger.ConsumePublicKeyAddress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-350"></span><span>                 </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><span class="hs-identifier hs-var">C.toCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679417183"><span class="hs-identifier hs-var">outref</span></a></span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError TxIn
-&gt; (TxIn
    -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)))
-&gt; Either
     ToCardanoError
     (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Witness WitCtxTxIn BabbageEra
 -&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
-&gt; Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn -&gt; Witness WitCtxTxIn BabbageEra
forall witctx era. KeyWitnessInCtx witctx -&gt; Witness witctx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitness</span></a></span><span> </span><span class="annot"><span class="annottext">KeyWitnessInCtx WitCtxTxIn
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.KeyWitnessForSpending</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>            </span><span class="annot"><span class="annottext">TxInType
</span><span class="hs-identifier hs-var">Ledger.ConsumeSimpleScriptAddress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-352"></span><span>                 </span><span class="annot"><span class="annottext">ToCardanoError
-&gt; Either
     ToCardanoError
     (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError
</span><span class="hs-identifier hs-var">C.SimpleScriptsNotSupportedToCardano</span></span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ScriptAddress</span></span><span> </span><span id="local-6989586621679417179"><span class="annot"><span class="annottext">Either (Versioned Validator) (Versioned TxOutRef)
</span><a href="#local-6989586621679417179"><span class="hs-identifier hs-var">valOrRef</span></a></span></span><span> </span><span id="local-6989586621679417178"><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679417178"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679417177"><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679417177"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>                 </span><span id="local-6989586621679417176"><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679417176"><span class="hs-identifier hs-var">mkWitness</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (Versioned Validator) (Versioned TxOutRef)
</span><a href="#local-6989586621679417179"><span class="hs-identifier hs-var">valOrRef</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-355"></span><span>                     </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679417175"><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679417175"><span class="hs-identifier hs-var">vl</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; Either ToCardanoError WitnessHeader
</span><span class="hs-identifier hs-var">C.toCardanoTxInScriptWitnessHeader</span></span><span> </span><span class="annot"><span class="annottext">(Versioned Script -&gt; Either ToCardanoError WitnessHeader)
-&gt; Versioned Script -&gt; Either ToCardanoError WitnessHeader
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Validator -&gt; Script) -&gt; Versioned Validator -&gt; Versioned Script
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Validator -&gt; Script
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">Script.getValidator</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679417175"><span class="hs-identifier hs-var">vl</span></a></span><span>
</span><span id="line-356"></span><span>                     </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679417172"><span class="annot"><span class="annottext">Versioned TxOutRef
</span><a href="#local-6989586621679417172"><span class="hs-identifier hs-var">vref</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Versioned TxOutRef -&gt; Either ToCardanoError WitnessHeader
</span><span class="hs-identifier hs-var">C.toCardanoTxInReferenceWitnessHeader</span></span><span> </span><span class="annot"><span class="annottext">Versioned TxOutRef
</span><a href="#local-6989586621679417172"><span class="hs-identifier hs-var">vref</span></a></span><span>
</span><span id="line-357"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Script.Redeemer</span></a></span><span> </span><span id="local-6989586621679417169"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679417169"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679417178"><span class="hs-identifier hs-var">rd</span></a></span><span>
</span><span id="line-358"></span><span>                     </span><span id="local-6989586621679417168"><span class="annot"><span class="annottext">sw :: ScriptWitness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679417168"><span class="hs-identifier hs-var hs-var">sw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WitnessHeader
</span><a href="#local-6989586621679417176"><span class="hs-identifier hs-var">mkWitness</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Datum -&gt; ScriptDatum WitCtxTxIn
</span><span class="hs-identifier hs-var">C.toCardanoDatumWitness</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679417177"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; ScriptRedeemer
</span><span class="hs-identifier hs-var">C.toCardanoScriptData</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679417169"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExecutionUnits
</span><span class="hs-identifier hs-var">C.zeroExecutionUnits</span></span><span>
</span><span id="line-359"></span><span>                 </span><span class="annot"><span class="annottext">TxOutRef -&gt; Either ToCardanoError TxIn
</span><span class="hs-identifier hs-var">C.toCardanoTxIn</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679417183"><span class="hs-identifier hs-var">outref</span></a></span><span> </span><span class="annot"><span class="annottext">Either ToCardanoError TxIn
-&gt; (TxIn
    -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)))
-&gt; Either
     ToCardanoError
     (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a. a -&gt; BuildTxWith BuildTx a
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.BuildTxWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Witness WitCtxTxIn BabbageEra
 -&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra))
-&gt; Witness WitCtxTxIn BabbageEra
-&gt; BuildTxWith BuildTx (Witness WitCtxTxIn BabbageEra)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
-&gt; ScriptWitness WitCtxTxIn BabbageEra
-&gt; Witness WitCtxTxIn BabbageEra
forall witctx era.
ScriptWitnessInCtx witctx
-&gt; ScriptWitness witctx era -&gt; Witness witctx era
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitness</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitnessInCtx WitCtxTxIn
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.ScriptWitnessForSpending</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptWitness WitCtxTxIn BabbageEra
</span><a href="#local-6989586621679417168"><span class="hs-identifier hs-var">sw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><a href="#local-6989586621679417184"><span class="hs-identifier hs-type">toTxInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxInput</span></span><span>
</span><span id="line-361"></span><span>        </span><span id="local-6989586621679417184"><span class="annot"><span class="annottext">toTxInput :: TxInputWitnessed -&gt; TxInput
</span><a href="#local-6989586621679417184"><span class="hs-identifier hs-var hs-var">toTxInput</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#TxInputWitnessed"><span class="hs-identifier hs-type">TxInputWitnessed</span></a></span><span> </span><span id="local-6989586621679417163"><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679417163"><span class="hs-identifier hs-var">outref</span></a></span></span><span> </span><span id="local-6989586621679417162"><span class="annot"><span class="annottext">TxInType
</span><a href="#local-6989586621679417162"><span class="hs-identifier hs-var">txin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOutRef -&gt; TxInputType -&gt; TxInput
</span><span class="hs-identifier hs-var">Tx.TxInput</span></span><span> </span><span class="annot"><span class="annottext">TxOutRef
</span><a href="#local-6989586621679417163"><span class="hs-identifier hs-var">outref</span></a></span><span> </span><span class="annot"><span class="annottext">(TxInputType -&gt; TxInput) -&gt; TxInputType -&gt; TxInput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxInType -&gt; TxInputType
</span><a href="#local-6989586621679417160"><span class="hs-identifier hs-var">toTxInType</span></a></span><span> </span><span class="annot"><span class="annottext">TxInType
</span><a href="#local-6989586621679417162"><span class="hs-identifier hs-var">txin</span></a></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="#local-6989586621679417160"><span class="hs-identifier hs-type">toTxInType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxInType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxInputType</span></span><span>
</span><span id="line-364"></span><span>        </span><span id="local-6989586621679417160"><span class="annot"><span class="annottext">toTxInType :: TxInType -&gt; TxInputType
</span><a href="#local-6989586621679417160"><span class="hs-identifier hs-var hs-var">toTxInType</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxInType
</span><span class="hs-identifier hs-var">Tx.ConsumeSimpleScriptAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInputType
</span><span class="hs-identifier hs-var">Tx.TxConsumeSimpleScriptAddress</span></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><a href="#local-6989586621679417160"><span class="hs-identifier hs-var">toTxInType</span></a></span><span> </span><span class="annot"><span class="annottext">TxInType
</span><span class="hs-identifier hs-var">Tx.ConsumePublicKeyAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxInputType
</span><span class="hs-identifier hs-var">Tx.TxConsumePublicKeyAddress</span></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><a href="#local-6989586621679417160"><span class="hs-identifier hs-var">toTxInType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx.ScriptAddress</span></span><span> </span><span id="local-6989586621679417157"><span class="annot"><span class="annottext">Either (Versioned Validator) (Versioned TxOutRef)
</span><a href="#local-6989586621679417157"><span class="hs-identifier hs-var">valOrRef</span></a></span></span><span> </span><span id="local-6989586621679417156"><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679417156"><span class="hs-identifier hs-var">rd</span></a></span></span><span> </span><span id="local-6989586621679417155"><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679417155"><span class="hs-identifier hs-var">dat</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Redeemer
-&gt; Either ValidatorHash (Versioned TxOutRef)
-&gt; Maybe DatumHash
-&gt; TxInputType
</span><span class="hs-identifier hs-var">Tx.TxScriptAddress</span></span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><a href="#local-6989586621679417156"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Versioned Validator -&gt; ValidatorHash)
-&gt; Either (Versioned Validator) (Versioned TxOutRef)
-&gt; Either ValidatorHash (Versioned TxOutRef)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">validatorHash</span></span><span> </span><span class="annot"><span class="annottext">Either (Versioned Validator) (Versioned TxOutRef)
</span><a href="#local-6989586621679417157"><span class="hs-identifier hs-var">valOrRef</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe DatumHash -&gt; TxInputType) -&gt; Maybe DatumHash -&gt; TxInputType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; DatumHash) -&gt; Maybe Datum -&gt; Maybe DatumHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><span class="hs-identifier hs-var">datumHash</span></span><span> </span><span class="annot"><span class="annottext">Maybe Datum
</span><a href="#local-6989586621679417155"><span class="hs-identifier hs-var">dat</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Validate a transaction in a mockchain.</span><span>
</span><span id="line-369"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-type">validateMockchain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ledger.ValidationErrorInPhase</span></span><span>
</span><span id="line-370"></span><span id="validateMockchain"><span class="annot"><span class="annottext">validateMockchain :: Mockchain -&gt; CardanoTx -&gt; Maybe ValidationErrorInPhase
</span><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-var hs-var">validateMockchain</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span> </span><span class="annot"><span class="annottext">[CardanoTx]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679417153"><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417153"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span id="local-6989586621679417152"><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679417152"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679417151"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417151"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679417150"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-371"></span><span>    </span><span id="local-6989586621679417149"><span class="annot"><span class="annottext">cUtxoIndex :: UTxO (BabbageEra StandardCrypto)
</span><a href="#local-6989586621679417149"><span class="hs-identifier hs-var hs-var">cUtxoIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either ValidationErrorInPhase ToCardanoError
 -&gt; UTxO (BabbageEra StandardCrypto))
-&gt; (UTxO (BabbageEra StandardCrypto)
    -&gt; UTxO (BabbageEra StandardCrypto))
-&gt; Either
     (Either ValidationErrorInPhase ToCardanoError)
     (UTxO (BabbageEra StandardCrypto))
-&gt; UTxO (BabbageEra StandardCrypto)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; UTxO (BabbageEra StandardCrypto)
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; UTxO (BabbageEra StandardCrypto))
-&gt; (Either ValidationErrorInPhase ToCardanoError -&gt; String)
-&gt; Either ValidationErrorInPhase ToCardanoError
-&gt; UTxO (BabbageEra StandardCrypto)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either ValidationErrorInPhase ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxO (BabbageEra StandardCrypto)
-&gt; UTxO (BabbageEra StandardCrypto)
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (Either ValidationErrorInPhase ToCardanoError)
   (UTxO (BabbageEra StandardCrypto))
 -&gt; UTxO (BabbageEra StandardCrypto))
-&gt; Either
     (Either ValidationErrorInPhase ToCardanoError)
     (UTxO (BabbageEra StandardCrypto))
-&gt; UTxO (BabbageEra StandardCrypto)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UtxoIndex
-&gt; Either
     (Either ValidationErrorInPhase ToCardanoError)
     (UTxO (BabbageEra StandardCrypto))
</span><span class="hs-identifier hs-var">fromPlutusIndex</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map TxOutRef TxOut -&gt; UtxoIndex
</span><span class="hs-identifier hs-var">Index.UtxoIndex</span></span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxOut
</span><a href="#local-6989586621679417153"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span id="local-6989586621679417150"><span class="annot"><span class="annottext">result :: Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679417150"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either ValidationErrorInPhase ValidationSuccess
-&gt; Maybe ValidationErrorInPhase
forall a b. Either a b -&gt; Maybe a
</span><a href="../../../../either/html/src"><span class="hs-identifier hs-var">leftToMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ValidationErrorInPhase ValidationSuccess
 -&gt; Maybe ValidationErrorInPhase)
-&gt; Either ValidationErrorInPhase ValidationSuccess
-&gt; Maybe ValidationErrorInPhase
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Params
-&gt; Slot
-&gt; UTxO (BabbageEra StandardCrypto)
-&gt; CardanoTx
-&gt; Either ValidationErrorInPhase ValidationSuccess
</span><a href="Cardano.Node.Emulator.Validation.html#validateCardanoTx"><span class="hs-identifier hs-var">validateCardanoTx</span></a></span><span> </span><span class="annot"><span class="annottext">Params
</span><a href="#local-6989586621679417152"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Slot
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">UTxO (BabbageEra StandardCrypto)
</span><a href="#local-6989586621679417149"><span class="hs-identifier hs-var">cUtxoIndex</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417151"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- | Generate an 'Interval where the lower bound if less or equal than the</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-376"></span><span id="local-6989586621679417495"><span id="local-6989586621679417496"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-type">genInterval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417496"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417495"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417495"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417496"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Interval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417495"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-379"></span><span id="genInterval"><span class="annot"><span class="annottext">genInterval :: m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var hs-var">genInterval</span></a></span></span><span> </span><span id="local-6989586621679417148"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679417148"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">[</span><span id="local-6989586621679417147"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679417147"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679417146"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679417146"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Ord a =&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; m [a] -&gt; m [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m a -&gt; m [a]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679417148"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-381"></span><span>    </span><span class="annot"><span class="annottext">Interval a -&gt; m (Interval a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Interval a -&gt; m (Interval a)) -&gt; Interval a -&gt; m (Interval a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Interval a
forall a. a -&gt; a -&gt; Interval a
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Interval.interval</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679417147"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679417146"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="hs-comment">-- | Generate a 'SlotRange' where the lower bound if less or equal than the</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-385"></span><span id="local-6989586621679417144"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier hs-type">genSlotRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417144"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417144"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417144"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotRange</span></span></span><span>
</span><span id="line-386"></span><span id="genSlotRange"><span class="annot"><span class="annottext">genSlotRange :: m SlotRange
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotRange"><span class="hs-identifier hs-var hs-var">genSlotRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Slot -&gt; m SlotRange
forall (m :: * -&gt; *) a.
(MonadFail m, Ord a) =&gt;
m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var">genInterval</span></a></span><span> </span><span class="annot"><span class="annottext">m Slot
forall (m :: * -&gt; *). MonadGen m =&gt; m Slot
</span><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-var">genSlot</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Generate a 'POSIXTimeRange' where the lower bound if less or equal than the</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- upper bound.</span><span>
</span><span id="line-390"></span><span id="local-6989586621679417143"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier hs-type">genTimeRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417143"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417143"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTimeRange</span></a></span></span><span>
</span><span id="line-391"></span><span id="genTimeRange"><span class="annot"><span class="annottext">genTimeRange :: SlotConfig -&gt; m POSIXTimeRange
</span><a href="Cardano.Node.Emulator.Generators.html#genTimeRange"><span class="hs-identifier hs-var hs-var">genTimeRange</span></a></span></span><span> </span><span id="local-6989586621679417142"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417142"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m POSIXTime -&gt; m POSIXTimeRange
forall (m :: * -&gt; *) a.
(MonadFail m, Ord a) =&gt;
m a -&gt; m (Interval a)
</span><a href="Cardano.Node.Emulator.Generators.html#genInterval"><span class="hs-identifier hs-var">genInterval</span></a></span><span> </span><span class="annot"><span class="annottext">(m POSIXTime -&gt; m POSIXTimeRange)
-&gt; m POSIXTime -&gt; m POSIXTimeRange
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; m POSIXTime
forall (m :: * -&gt; *). MonadGen m =&gt; SlotConfig -&gt; m POSIXTime
</span><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-var">genPOSIXTime</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417142"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | Generate a 'Slot' where the lowest slot number is 0.</span><span>
</span><span id="line-394"></span><span id="local-6989586621679417494"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-type">genSlot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417494"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417494"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Slot</span></span></span><span>
</span><span id="line-395"></span><span id="genSlot"><span class="annot"><span class="annottext">genSlot :: m Slot
</span><a href="Cardano.Node.Emulator.Generators.html#genSlot"><span class="hs-identifier hs-var hs-var">genSlot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Slot
</span><span class="hs-identifier hs-var">Slot</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Slot) -&gt; m Integer -&gt; m Slot
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10000</span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span class="hs-comment">-- | Generate a 'POSIXTime' where the lowest value is 'scSlotZeroTime' given a</span><span>
</span><span id="line-398"></span><span class="hs-comment">-- 'SlotConfig'.</span><span>
</span><span id="line-399"></span><span id="local-6989586621679417490"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-type">genPOSIXTime</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417490"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417490"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">POSIXTime</span></a></span></span><span>
</span><span id="line-400"></span><span id="genPOSIXTime"><span class="annot"><span class="annottext">genPOSIXTime :: SlotConfig -&gt; m POSIXTime
</span><a href="Cardano.Node.Emulator.Generators.html#genPOSIXTime"><span class="hs-identifier hs-var hs-var">genPOSIXTime</span></a></span></span><span> </span><span id="local-6989586621679417140"><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417140"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417139"><span class="annot"><span class="annottext">beginTime :: Integer
</span><a href="#local-6989586621679417139"><span class="hs-identifier hs-var hs-var">beginTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTime -&gt; Integer
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var hs-var">getPOSIXTime</span></a></span><span> </span><span class="annot"><span class="annottext">(POSIXTime -&gt; Integer) -&gt; POSIXTime -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig -&gt; POSIXTime
</span><a href="Cardano.Node.Emulator.TimeSlot.html#scSlotZeroTime"><span class="hs-identifier hs-var hs-var">TimeSlot.scSlotZeroTime</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
</span><a href="#local-6989586621679417140"><span class="hs-identifier hs-var">sc</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">Integer -&gt; POSIXTime
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">POSIXTime</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; POSIXTime) -&gt; m Integer -&gt; m POSIXTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417139"><span class="hs-identifier hs-var">beginTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417139"><span class="hs-identifier hs-var">beginTime</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">10000000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | Generate a 'SlotConfig' where the slot length goes from 1 to 100000</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- ms and the time of Slot 0 is the default 'scSlotZeroTime'.</span><span>
</span><span id="line-406"></span><span id="local-6989586621679417712"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-type">genSlotConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Hedgehog.MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417712"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417712"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.TimeSlot.html#SlotConfig"><span class="hs-identifier hs-type">SlotConfig</span></a></span></span><span>
</span><span id="line-407"></span><span id="genSlotConfig"><span class="annot"><span class="annottext">genSlotConfig :: m SlotConfig
</span><a href="Cardano.Node.Emulator.Generators.html#genSlotConfig"><span class="hs-identifier hs-var hs-var">genSlotConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621679417136"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417136"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; m Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Range Integer
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>    </span><span class="annot"><span class="annottext">SlotConfig -&gt; m SlotConfig
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(SlotConfig -&gt; m SlotConfig) -&gt; SlotConfig -&gt; m SlotConfig
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SlotConfig
forall a. Default a =&gt; a
</span><a href="../../../../data-default-class/html/src"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">scSlotLength :: Integer
</span><a href="Cardano.Node.Emulator.TimeSlot.html#scSlotLength"><span class="hs-identifier hs-var">TimeSlot.scSlotLength</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417136"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- | Generate a 'ByteString s' of up to @s@ bytes.</span><span>
</span><span id="line-412"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier hs-type">genSizedByteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679417134"><span class="annot"><a href="#local-6989586621679417134"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417134"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-413"></span><span id="genSizedByteString"><span class="annot"><span class="annottext">genSizedByteString :: Int -&gt; m ByteString
</span><a href="Cardano.Node.Emulator.Generators.html#genSizedByteString"><span class="hs-identifier hs-var hs-var">genSizedByteString</span></a></span></span><span> </span><span id="local-6989586621679417133"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417133"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417132"><span class="annot"><span class="annottext">range :: Range Int
</span><a href="#local-6989586621679417132"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417133"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; m ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int
</span><a href="#local-6989586621679417132"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Generate a 'ByteString s' of exactly @s@ bytes.</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSizedByteStringExact"><span class="hs-identifier hs-type">genSizedByteStringExact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679417130"><span class="annot"><a href="#local-6989586621679417130"><span class="hs-identifier hs-type">m</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417130"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-419"></span><span id="genSizedByteStringExact"><span class="annot"><span class="annottext">genSizedByteStringExact :: Int -&gt; m ByteString
</span><a href="Cardano.Node.Emulator.Generators.html#genSizedByteStringExact"><span class="hs-identifier hs-var hs-var">genSizedByteStringExact</span></a></span></span><span> </span><span id="local-6989586621679417129"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417129"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417128"><span class="annot"><span class="annottext">range :: Range Int
</span><a href="#local-6989586621679417128"><span class="hs-identifier hs-var hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Range Int
forall a. a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417129"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; m ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int
</span><a href="#local-6989586621679417128"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- Copied from Gen.Cardano.Api.Typed, because it's not exported.</span><span>
</span><span id="line-424"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-type">genPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span>
</span><span id="line-425"></span><span id="genPolicyId"><span class="annot"><span class="annottext">genPolicyId :: Gen PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-var hs-var">genPolicyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-426"></span><span>  </span><span class="annot"><span class="annottext">[(Int, Gen PolicyId)] -&gt; Gen PolicyId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [(Int, m a)] -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.frequency</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span class="hs-comment">-- mostly from a small number of choices, so we get plenty of repetition</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[PolicyId] -&gt; Gen PolicyId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [a] -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.element</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; PolicyId
forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679417124"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">55</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679417124"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679417124"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'a'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span class="hs-special">]</span><span> </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>
</span><span id="line-430"></span><span>       </span><span class="hs-comment">-- and some from the full range of the type</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; PolicyId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; PolicyId)
-&gt; GenT Identity ScriptHash -&gt; Gen PolicyId
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity ScriptHash
</span><span class="hs-identifier hs-var">Gen.genScriptHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- Copied from Gen.Cardano.Api.Typed, because it's not exported.</span><span>
</span><span id="line-435"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-type">genAssetId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetId</span></a></span><span>
</span><span id="line-436"></span><span id="genAssetId"><span class="annot"><span class="annottext">genAssetId :: Gen AssetId
</span><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-var hs-var">genAssetId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Gen AssetId] -&gt; Gen AssetId
forall (m :: * -&gt; *) a. MonadGen m =&gt; [m a] -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.choice</span></a></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AssetId</span></a></span><span> </span><span class="annot"><span class="annottext">(PolicyId -&gt; AssetName -&gt; AssetId)
-&gt; Gen PolicyId -&gt; GenT Identity (AssetName -&gt; AssetId)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#genPolicyId"><span class="hs-identifier hs-var">genPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (AssetName -&gt; AssetId)
-&gt; Gen AssetName -&gt; Gen AssetId
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetName
</span><span class="hs-identifier hs-var">Gen.genAssetName</span></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Gen AssetId
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AdaAssetId</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-type">genSingleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-442"></span><span id="genSingleton"><span class="annot"><span class="annottext">genSingleton :: Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-var hs-var">genSingleton</span></a></span></span><span> </span><span id="local-6989586621679417117"><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679417117"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Integer -&gt; Value
</span><span class="hs-identifier hs-var">Value.assetIdValue</span></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Integer -&gt; Value)
-&gt; Gen AssetId -&gt; GenT Identity (Integer -&gt; Value)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetId
</span><a href="Cardano.Node.Emulator.Generators.html#genAssetId"><span class="hs-identifier hs-var">genAssetId</span></a></span><span> </span><span class="annot"><span class="annottext">GenT Identity (Integer -&gt; Value)
-&gt; GenT Identity Integer -&gt; Gen Value
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; GenT Identity Integer
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679417117"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-type">genValue'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Range</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-445"></span><span id="genValue%27"><span class="annot"><span class="annottext">genValue' :: Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var hs-var">genValue'</span></a></span></span><span> </span><span id="local-6989586621679417114"><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679417114"><span class="hs-identifier hs-var">valueRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-447"></span><span>        </span><span class="hs-comment">-- generate values with no more than 5 elements to avoid the tests</span><span>
</span><span id="line-448"></span><span>        </span><span class="hs-comment">-- taking too long (due to the map-as-list-of-kv-pairs implementation)</span><span>
</span><span id="line-449"></span><span>        </span><span id="local-6989586621679417113"><span class="annot"><span class="annottext">maxCurrencies :: Int
</span><a href="#local-6989586621679417113"><span class="hs-identifier hs-var hs-var">maxCurrencies</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>    </span><span id="local-6989586621679417112"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417112"><span class="hs-identifier hs-var">numValues</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; GenT Identity Int
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m Int
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417113"><span class="hs-identifier hs-var">maxCurrencies</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><span class="annottext">[Value] -&gt; Value
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">([Value] -&gt; Value) -&gt; GenT Identity [Value] -&gt; Gen Value
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Gen Value) -&gt; [Int] -&gt; GenT Identity [Value]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen Value -&gt; Int -&gt; Gen Value
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Gen Value -&gt; Int -&gt; Gen Value) -&gt; Gen Value -&gt; Int -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genSingleton"><span class="hs-identifier hs-var">genSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">Range Integer
</span><a href="#local-6989586621679417114"><span class="hs-identifier hs-var">valueRange</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417112"><span class="hs-identifier hs-var">numValues</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="hs-comment">-- | Generate a 'Value' with a value range of @minBound .. maxBound@.</span><span>
</span><span id="line-455"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier hs-type">genValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-456"></span><span id="genValue"><span class="annot"><span class="annottext">genValue :: Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue"><span class="hs-identifier hs-var hs-var">genValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var">genValue'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range Integer -&gt; Gen Value) -&gt; Range Integer -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Range Int -&gt; Range Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Bounded Int, Integral Int) =&gt; Range Int
forall a. (Bounded a, Integral a) =&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linearBounded</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Generate a 'Value' with a value range of @0 .. maxBound@.</span><span>
</span><span id="line-459"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier hs-type">genValueNonNegative</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-460"></span><span id="genValueNonNegative"><span class="annot"><span class="annottext">genValueNonNegative :: Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValueNonNegative"><span class="hs-identifier hs-var hs-var">genValueNonNegative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range Integer -&gt; Gen Value
</span><a href="Cardano.Node.Emulator.Generators.html#genValue%27"><span class="hs-identifier hs-var">genValue'</span></a></span><span> </span><span class="annot"><span class="annottext">(Range Integer -&gt; Gen Value) -&gt; Range Integer -&gt; Gen Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Integer) -&gt; Range Int -&gt; Range Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Range Int
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | Assert that a transaction is valid in a chain.</span><span>
</span><span id="line-463"></span><span id="local-6989586621679417109"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier hs-type">assertValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadTest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417109"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoTx</span></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#Mockchain"><span class="hs-identifier hs-type">Mockchain</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417109"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-467"></span><span id="assertValid"><span class="annot"><span class="annottext">assertValid :: CardanoTx -&gt; Mockchain -&gt; m ()
</span><a href="Cardano.Node.Emulator.Generators.html#assertValid"><span class="hs-identifier hs-var hs-var">assertValid</span></a></span></span><span> </span><span id="local-6989586621679417108"><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417108"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span id="local-6989586621679417107"><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679417107"><span class="hs-identifier hs-var">mc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679417106"><span class="annot"><span class="annottext">res :: Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679417106"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Mockchain -&gt; CardanoTx -&gt; Maybe ValidationErrorInPhase
</span><a href="Cardano.Node.Emulator.Generators.html#validateMockchain"><span class="hs-identifier hs-var">validateMockchain</span></a></span><span> </span><span class="annot"><span class="annottext">Mockchain
</span><a href="#local-6989586621679417107"><span class="hs-identifier hs-var">mc</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoTx
</span><a href="#local-6989586621679417108"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase -&gt; m ()
forall (m :: * -&gt; *) a.
(MonadTest m, Show a, HasCallStack) =&gt;
a -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Hedgehog.annotateShow</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679417106"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m ()
forall (m :: * -&gt; *). (MonadTest m, HasCallStack) =&gt; Bool -&gt; m ()
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Hedgehog.assert</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; m ()) -&gt; Bool -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ValidationErrorInPhase
</span><a href="#local-6989586621679417106"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">{- | Split a value into max. n positive-valued parts such that the sum of the
     parts equals the original value. Each part should contain the required
     minimum amount of Ada.

     I noticed how for values of `mx` &gt; 1000 the resulting lists are much smaller than
     one would expect. I think this may be caused by the way we select the next value
     for the split. It looks like the available funds get exhausted quite fast, which
     makes the function return before generating anything close to `mx` values.
-}</span><span>
</span><span id="line-480"></span><span id="local-6989586621679417575"><span id="local-6989586621679417576"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-type">splitVal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417576"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Integral</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417575"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417575"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417576"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679417575"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-481"></span><span id="splitVal"><span class="annot"><span class="annottext">splitVal :: Int -&gt; n -&gt; m [n]
</span><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var hs-var">splitVal</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-482"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#splitVal"><span class="hs-identifier hs-var">splitVal</span></a></span><span> </span><span id="local-6989586621679417103"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417103"><span class="hs-identifier hs-var">mx</span></a></span></span><span> </span><span id="local-6989586621679417102"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417102"><span class="hs-identifier hs-var">init'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679417101"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679417101"><span class="annot"><span class="annottext">go :: Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679417101"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679417100"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417100"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679417099"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679417098"><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679417098"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pred</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417103"><span class="hs-identifier hs-var">mx</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417102"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417095"><span class="hs-identifier hs-var">minAda</span></a></span><span>
</span><span id="line-485"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; m [n]) -&gt; [n] -&gt; m [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417102"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679417098"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-487"></span><span>            </span><span id="local-6989586621679417094"><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417094"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Range n -&gt; m n
forall (m :: * -&gt; *) a. (MonadGen m, Integral a) =&gt; Range a -&gt; m a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.integral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n -&gt; n -&gt; Range n
forall a. Integral a =&gt; a -&gt; a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.linear</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417095"><span class="hs-identifier hs-var">minAda</span></a></span><span> </span><span class="annot"><span class="annottext">(n -&gt; Range n) -&gt; n -&gt; Range n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417102"><span class="hs-identifier hs-var">init'</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417095"><span class="hs-identifier hs-var">minAda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417102"><span class="hs-identifier hs-var">init'</span></a></span><span>
</span><span id="line-489"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[n] -&gt; m [n]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">([n] -&gt; m [n]) -&gt; [n] -&gt; m [n]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679417098"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-490"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; n -&gt; [n] -&gt; m [n]
</span><a href="#local-6989586621679417101"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">succ</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679417100"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; n -&gt; n
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417099"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">n
</span><a href="#local-6989586621679417094"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">n -&gt; [n] -&gt; [n]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[n]
</span><a href="#local-6989586621679417098"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679417095"><span class="annot"><span class="annottext">minAda :: n
</span><a href="#local-6989586621679417095"><span class="hs-identifier hs-var hs-var">minAda</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; n
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; n) -&gt; Integer -&gt; n
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ada -&gt; Integer
</span><span class="hs-identifier hs-var hs-var">Ada.getLovelace</span></span><span> </span><span class="annot"><span class="annottext">(Ada -&gt; Integer) -&gt; Ada -&gt; Integer
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Ada
</span><span class="hs-identifier hs-var">Ledger.minAdaTxOutEstimated</span></span><span> </span><span class="annot"><span class="annottext">Ada -&gt; Ada -&gt; Ada
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Ada
</span><span class="hs-identifier hs-var">Ledger.maxFee</span></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier hs-type">knownXPrvs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">Crypto.XPrv</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-494"></span><span id="knownXPrvs"><span class="annot"><span class="annottext">knownXPrvs :: [PrivateKey]
</span><a href="Cardano.Node.Emulator.Generators.html#knownXPrvs"><span class="hs-identifier hs-var hs-var">knownXPrvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PaymentPrivateKey -&gt; PrivateKey
</span><span class="hs-identifier hs-var hs-var">unPaymentPrivateKey</span></span><span> </span><span class="annot"><span class="annottext">(PaymentPrivateKey -&gt; PrivateKey)
-&gt; [PaymentPrivateKey] -&gt; [PrivateKey]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[PaymentPrivateKey]
</span><span class="hs-identifier hs-var">CW.knownPaymentPrivateKeys</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- | Seed suitable for testing a seed but not for actual wallets as ScrubbedBytes isn't used to ensure</span><span>
</span><span id="line-497"></span><span class="hs-comment">--  memory isn't inspectable</span><span>
</span><span id="line-498"></span><span id="local-6989586621679417090"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier hs-type">genSeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span></span><span>
</span><span id="line-499"></span><span id="genSeed"><span class="annot"><span class="annottext">genSeed :: m ByteString
</span><a href="Cardano.Node.Emulator.Generators.html#genSeed"><span class="hs-identifier hs-var hs-var">genSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Range Int -&gt; m ByteString
forall (m :: * -&gt; *). MonadGen m =&gt; Range Int -&gt; m ByteString
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.bytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Range Int -&gt; m ByteString) -&gt; Range Int -&gt; m ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Range Int
forall a. a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span id="local-6989586621679417089"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier hs-type">genPassphrase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-type">MonadGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417089"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Passphrase</span></span></span><span>
</span><span id="line-502"></span><span id="genPassphrase"><span class="annot"><span class="annottext">genPassphrase :: m Passphrase
</span><a href="Cardano.Node.Emulator.Generators.html#genPassphrase"><span class="hs-identifier hs-var hs-var">genPassphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><span class="annottext">ByteString -&gt; Passphrase
</span><span class="hs-identifier hs-var">Passphrase</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Passphrase) -&gt; m ByteString -&gt; m Passphrase
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Range Int -&gt; m Char -&gt; m ByteString
forall (m :: * -&gt; *).
MonadGen m =&gt;
Range Int -&gt; m Char -&gt; m ByteString
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.utf8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Range Int
forall a. a -&gt; Range a
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Range.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m Char
forall (m :: * -&gt; *). MonadGen m =&gt; m Char
</span><a href="../../../../hedgehog/html/src"><span class="hs-identifier hs-var">Gen.unicode</span></a></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-type">alwaysSucceedPolicy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-type">Script.MintingPolicy</span></a></span><span>
</span><span id="line-506"></span><span id="alwaysSucceedPolicy"><span class="annot"><span class="annottext">alwaysSucceedPolicy :: MintingPolicy
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicy"><span class="hs-identifier hs-var hs-var">alwaysSucceedPolicy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Script -&gt; MintingPolicy
</span><a href="../../../../plutus-ledger-api/html/src"><span class="hs-identifier hs-var">Script.MintingPolicy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScript PlutusScriptV1 -&gt; Script
forall lang. HasTypeProxy lang =&gt; PlutusScript lang -&gt; Script
</span><span class="hs-identifier hs-var">fromCardanoPlutusScript</span></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV1 -&gt; Script)
-&gt; PlutusScript PlutusScriptV1 -&gt; Script
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint -&gt; PlutusScript PlutusScriptV1
forall witctx. WitCtx witctx -&gt; PlutusScript PlutusScriptV1
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.examplePlutusScriptAlwaysSucceeds</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.WitCtxMint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-type">alwaysSucceedPolicyId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.PolicyId</span></a></span><span>
</span><span id="line-509"></span><span id="alwaysSucceedPolicyId"><span class="annot"><span class="annottext">alwaysSucceedPolicyId :: PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var hs-var">alwaysSucceedPolicyId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Script PlutusScriptV1 -&gt; PolicyId
forall lang. Script lang -&gt; PolicyId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.scriptPolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV1
-&gt; PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1
forall lang.
PlutusScriptVersion lang -&gt; PlutusScript lang -&gt; Script lang
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PlutusScript</span></a></span><span> </span><span class="annot"><span class="annottext">PlutusScriptVersion PlutusScriptV1
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.PlutusScriptV1</span></a></span><span> </span><span class="annot"><span class="annottext">(PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1)
-&gt; PlutusScript PlutusScriptV1 -&gt; Script PlutusScriptV1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint -&gt; PlutusScript PlutusScriptV1
forall witctx. WitCtx witctx -&gt; PlutusScript PlutusScriptV1
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.examplePlutusScriptAlwaysSucceeds</span></a></span><span> </span><span class="annot"><span class="annottext">WitCtx WitCtxMint
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.WitCtxMint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-type">someTokenValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.AssetName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-type">C.Value</span></a></span><span>
</span><span id="line-512"></span><span id="someTokenValue"><span class="annot"><span class="annottext">someTokenValue :: AssetName -&gt; Integer -&gt; Value
</span><a href="Cardano.Node.Emulator.Generators.html#someTokenValue"><span class="hs-identifier hs-var hs-var">someTokenValue</span></a></span></span><span> </span><span id="local-6989586621679417080"><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679417080"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span id="local-6989586621679417079"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417079"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)] -&gt; Value
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.valueFromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PolicyId -&gt; AssetName -&gt; AssetId
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.AssetId</span></a></span><span> </span><span class="annot"><span class="annottext">PolicyId
</span><a href="Cardano.Node.Emulator.Generators.html#alwaysSucceedPolicyId"><span class="hs-identifier hs-var">alwaysSucceedPolicyId</span></a></span><span> </span><span class="annot"><span class="annottext">AssetName
</span><a href="#local-6989586621679417080"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Quantity
</span><a href="../../../../cardano-api/html/src"><span class="hs-identifier hs-var">C.Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679417079"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- | Catch cardano error and fail wi it</span><span>
</span><span id="line-515"></span><span id="local-6989586621679417564"><span id="local-6989586621679417565"><span class="annot"><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-type">failOnCardanoError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadFail</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417565"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.ToCardanoError</span></span><span> </span><span class="annot"><a href="#local-6989586621679417564"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417565"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417564"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-516"></span><span id="failOnCardanoError"><span class="annot"><span class="annottext">failOnCardanoError :: Either ToCardanoError a -&gt; m a
</span><a href="Cardano.Node.Emulator.Generators.html#failOnCardanoError"><span class="hs-identifier hs-var hs-var">failOnCardanoError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ToCardanoError -&gt; m a)
-&gt; (a -&gt; m a) -&gt; Either ToCardanoError a -&gt; m a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; m a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; m a)
-&gt; (ToCardanoError -&gt; String) -&gt; ToCardanoError -&gt; m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ToCardanoError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-517"></span></pre></body></html>