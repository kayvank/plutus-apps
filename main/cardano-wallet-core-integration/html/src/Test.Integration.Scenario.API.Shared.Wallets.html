<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NumericUnderscores #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeSynonymInstances #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Test.Integration.Scenario.API.Shared.Wallets</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Integration.Scenario.API.Shared.Wallets.html#spec"><span class="hs-identifier">spec</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Script</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cosigner</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">ScriptTemplate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Mnemonic</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">MkSomeMnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Api.Types</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiAccountKeyShared</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiActiveSharedWallet</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiAddress</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiFee</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiTransaction</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">ApiWallet</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">DecodeAddress</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">DecodeStakeAddress</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">EncodeAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">KeyFormat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">WalletStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Compat</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-operator">(^?)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">DerivationIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Role</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDiscovery.Shared</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">CredentialType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Primitive.Passphrase</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Passphrase</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Primitive.SyncProgress</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">SyncProgress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">forM</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.IO.Class</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftIO</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../resourcet/html/src"><span class="hs-identifier">Control.Monad.Trans.Resource</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../resourcet/html/src"><span class="hs-identifier">runResourceT</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">String</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../either/html/src"><span class="hs-identifier">Data.Either.Combinators</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../either/html/src"><span class="hs-identifier">swapEither</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">Data.Generics.Internal.VL.Lens</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-operator">(^.)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Data.Quantity</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Quantity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">Data.Text.Class</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">ToText</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec/html/src"><span class="hs-identifier">Test.Hspec</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier">SpecWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier">describe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-identifier">Test.Hspec.Expectations.Lifted</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-identifier">shouldBe</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-identifier">shouldNotBe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier">Test.Hspec.Extra</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier">it</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html"><span class="hs-identifier">Test.Integration.Framework.DSL</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Integration.Framework.Context.html#Context"><span class="hs-identifier">Context</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.Request.html#Headers"><span class="hs-identifier">Headers</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#MnemonicLength"><span class="hs-identifier">MnemonicLength</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.Request.html#Payload"><span class="hs-identifier">Payload</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#accPubKeyFromMnemonics"><span class="hs-identifier">accPubKeyFromMnemonics</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#deleteSharedWallet"><span class="hs-identifier">deleteSharedWallet</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#eventually"><span class="hs-identifier">eventually</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier">expectErrorMessage</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier">expectField</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier">expectListField</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#expectListSize"><span class="hs-identifier">expectListSize</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier">expectResponseCode</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#faucetAmt"><span class="hs-identifier">faucetAmt</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#fixturePassphrase"><span class="hs-identifier">fixturePassphrase</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#fixtureWallet"><span class="hs-identifier">fixtureWallet</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier">genMnemonics</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier">genXPubs</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#getAccountKeyShared"><span class="hs-identifier">getAccountKeyShared</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier">getFromResponse</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#getSharedWallet"><span class="hs-identifier">getSharedWallet</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier">getSharedWalletKey</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier">getWalletIdFromSharedWallet</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#hexText"><span class="hs-identifier">hexText</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#json"><span class="hs-identifier">json</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#listFilteredSharedWallets"><span class="hs-identifier">listFilteredSharedWallets</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#minUTxOValue"><span class="hs-identifier">minUTxOValue</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#notDelegating"><span class="hs-identifier">notDelegating</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier">patchSharedWallet</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#postAccountKeyShared"><span class="hs-identifier">postAccountKeyShared</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier">postSharedWallet</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.Request.html#request"><span class="hs-identifier">request</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.Request.html#unsafeRequest"><span class="hs-identifier">unsafeRequest</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.DSL.html#walletId"><span class="hs-identifier">walletId</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html"><span class="hs-identifier">Test.Integration.Framework.TestData</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403CannotUpdateThisCosigner"><span class="hs-identifier">errMsg403CannotUpdateThisCosigner</span></a></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403CreateIllegal"><span class="hs-identifier">errMsg403CreateIllegal</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403KeyAlreadyPresent"><span class="hs-identifier">errMsg403KeyAlreadyPresent</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403NoDelegationTemplate"><span class="hs-identifier">errMsg403NoDelegationTemplate</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403NoSuchCosigner"><span class="hs-identifier">errMsg403NoSuchCosigner</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidDuplicateXPub"><span class="hs-identifier">errMsg403TemplateInvalidDuplicateXPub</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidNoCosignerInScript"><span class="hs-identifier">errMsg403TemplateInvalidNoCosignerInScript</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidScript"><span class="hs-identifier">errMsg403TemplateInvalidScript</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidUnknownCosigner"><span class="hs-identifier">errMsg403TemplateInvalidUnknownCosigner</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403WalletAlreadyActive"><span class="hs-identifier">errMsg403WalletAlreadyActive</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Test.Integration.Framework.TestData.html#errMsg403WrongIndex"><span class="hs-identifier">errMsg403WrongIndex</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier">Cardano.Wallet.Api.Link</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Link</span></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../http-types/html/src"><span class="hs-identifier">Network.HTTP.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HTTP</span></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><a href="Test.Integration.Scenario.API.Shared.Wallets.html#spec"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682943892"><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">DecodeAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">DecodeStakeAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">EncodeAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-type">SpecWith</span></a></span><span> </span><span class="annot"><a href="Test.Integration.Framework.Context.html#Context"><span class="hs-identifier hs-type">Context</span></a></span><span>
</span><span id="line-139"></span><span id="spec"><span class="annot"><span class="annottext">spec :: SpecWith Context
</span><a href="Test.Integration.Scenario.API.Shared.Wallets.html#spec"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; SpecWith Context -&gt; SpecWith Context
forall a. HasCallStack =&gt; String -&gt; SpecWith a -&gt; SpecWith a
</span><a href="../../../../hspec-core/html/src"><span class="hs-identifier hs-var">describe</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS&quot;</span></span><span> </span><span class="annot"><span class="annottext">(SpecWith Context -&gt; SpecWith Context)
-&gt; SpecWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_01 - Create an active shared wallet from root xprv&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943891"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943891"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621682943890"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943890"><span class="hs-identifier hs-var">m15txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M15"><span class="hs-identifier hs-var">M15</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span id="local-6989586621682943888"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943888"><span class="hs-identifier hs-var">m12txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M12"><span class="hs-identifier hs-var">M12</span></a></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943886"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943886"><span class="hs-identifier hs-var">m15</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[15]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943890"><span class="hs-identifier hs-var">m15txt</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943884"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943884"><span class="hs-identifier hs-var">m12</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[12]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943888"><span class="hs-identifier hs-var">m12txt</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943883"><span class="annot"><span class="annottext">passphrase :: Passphrase purpose
</span><a href="#local-6989586621682943883"><span class="hs-identifier hs-var hs-var">passphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Passphrase purpose
forall (purpose :: Symbol). ScrubbedBytes -&gt; Passphrase purpose
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; Passphrase purpose)
-&gt; ScrubbedBytes -&gt; Passphrase purpose
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ScrubbedBytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.convert</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ScrubbedBytes) -&gt; ByteString -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Test.Integration.Framework.DSL.html#fixturePassphrase"><span class="hs-identifier hs-var">fixturePassphrase</span></a></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943879"><span class="annot"><span class="annottext">index :: Word32
</span><a href="#local-6989586621682943879"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">30</span></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943878"><span class="annot"><span class="annottext">accXPubDerived :: Text
</span><a href="#local-6989586621682943878"><span class="hs-identifier hs-var hs-var">accXPubDerived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
-&gt; Maybe SomeMnemonic -&gt; Word32 -&gt; Passphrase &quot;encryption&quot; -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#accPubKeyFromMnemonics"><span class="hs-identifier hs-var">accPubKeyFromMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943886"><span class="hs-identifier hs-var">m15</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMnemonic -&gt; Maybe SomeMnemonic
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943884"><span class="hs-identifier hs-var">m12</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943879"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall (purpose :: Symbol). Passphrase purpose
</span><a href="#local-6989586621682943883"><span class="hs-identifier hs-var">passphrase</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943877"><span class="annot"><span class="annottext">payloadPost :: Payload
</span><a href="#local-6989586621682943877"><span class="hs-identifier hs-var hs-var">payloadPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: #{m15txt},
                &quot;mnemonic_second_factor&quot;: #{m12txt},
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-166"></span><span>        </span><span id="local-6989586621682943869"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943869"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943891"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943877"><span class="hs-identifier hs-var">payloadPost</span></a></span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943867"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943869"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-169"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-170"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Text -&gt; f Text)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Text -&gt; f Text)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; f (ApiT WalletName))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943862"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; f (ApiT WalletName))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Text -&gt; f Text) -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; (Text -&gt; f Text)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; f WalletName)
   -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
(WalletName -&gt; f WalletName)
-&gt; ApiT WalletName -&gt; f (ApiT WalletName)
</span><a href="#local-6989586621682943861"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; f WalletName)
 -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
-&gt; (Text -&gt; f Text)
-&gt; ApiT WalletName
-&gt; f (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
(Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName
</span><a href="#local-6989586621682943860"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet) Word32
-&gt; (Word32 -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-173"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Word32 -&gt; f Word32)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;addressPoolGap&quot;
  ((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943859"><span class="hs-var">#addressPoolGap</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((AddressPoolGap -&gt; f AddressPoolGap)
   -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
(AddressPoolGap -&gt; f AddressPoolGap)
-&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap)
</span><a href="#local-6989586621682943858"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((AddressPoolGap -&gt; f AddressPoolGap)
 -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiT AddressPoolGap
-&gt; f (ApiT AddressPoolGap)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getAddressPoolGap&quot;
  ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
(Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap
</span><a href="#local-6989586621682943857"><span class="hs-var">#getAddressPoolGap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-176"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943856"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943855"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-178"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943853"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943852"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-180"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943851"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;reward&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943850"><span class="hs-var">#reward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943849"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943848"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943847"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943846"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  ApiWalletDelegation
-&gt; (ApiWalletDelegation -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegation&quot;
  ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943845"><span class="hs-var">#delegation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWalletDelegation -&gt; ApiWalletDelegation -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Maybe (ApiT PoolId), ApiEpochInfo)] -&gt; ApiWalletDelegation
</span><a href="Test.Integration.Framework.DSL.html#notDelegating"><span class="hs-identifier hs-var">notDelegating</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Maybe ApiWalletPassphraseInfo)
-&gt; (Maybe ApiWalletPassphraseInfo -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Maybe ApiWalletPassphraseInfo
     -&gt; f (Maybe ApiWalletPassphraseInfo))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Maybe ApiWalletPassphraseInfo
    -&gt; f (Maybe ApiWalletPassphraseInfo))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;passphrase&quot;
  ((Maybe ApiWalletPassphraseInfo
    -&gt; f (Maybe ApiWalletPassphraseInfo))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(Maybe ApiWalletPassphraseInfo
 -&gt; f (Maybe ApiWalletPassphraseInfo))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943844"><span class="hs-var">#passphrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ApiWalletPassphraseInfo
-&gt; Maybe ApiWalletPassphraseInfo -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldNotBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ApiWalletPassphraseInfo
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Maybe ScriptTemplate)
-&gt; (Maybe ScriptTemplate -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943843"><span class="hs-var">#delegationScriptTemplate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScriptTemplate -&gt; Maybe ScriptTemplate -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  DerivationIndex
-&gt; (DerivationIndex -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;accountIndex&quot;
  ((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943842"><span class="hs-var">#accountIndex</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((DerivationIndex -&gt; f DerivationIndex)
   -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
(DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex)
</span><a href="#local-6989586621682943841"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483678</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_01 - Compare wallet ids&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943839"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>        </span><span id="local-6989586621682943838"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943838"><span class="hs-identifier hs-var">m15txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M15"><span class="hs-identifier hs-var">M15</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621682943837"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943837"><span class="hs-identifier hs-var">m12txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M12"><span class="hs-identifier hs-var">M12</span></a></span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943836"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943836"><span class="hs-identifier hs-var">m15</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[15]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943838"><span class="hs-identifier hs-var">m15txt</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943835"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943835"><span class="hs-identifier hs-var">m12</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[12]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943837"><span class="hs-identifier hs-var">m12txt</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943834"><span class="annot"><span class="annottext">passphrase :: Passphrase purpose
</span><a href="#local-6989586621682943834"><span class="hs-identifier hs-var hs-var">passphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Passphrase purpose
forall (purpose :: Symbol). ScrubbedBytes -&gt; Passphrase purpose
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; Passphrase purpose)
-&gt; ScrubbedBytes -&gt; Passphrase purpose
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ScrubbedBytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.convert</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ScrubbedBytes) -&gt; ByteString -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Test.Integration.Framework.DSL.html#fixturePassphrase"><span class="hs-identifier hs-var">fixturePassphrase</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943833"><span class="annot"><span class="annottext">index :: Word32
</span><a href="#local-6989586621682943833"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">30</span></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943832"><span class="annot"><span class="annottext">accXPubDerived :: Text
</span><a href="#local-6989586621682943832"><span class="hs-identifier hs-var hs-var">accXPubDerived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
-&gt; Maybe SomeMnemonic -&gt; Word32 -&gt; Passphrase &quot;encryption&quot; -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#accPubKeyFromMnemonics"><span class="hs-identifier hs-var">accPubKeyFromMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943836"><span class="hs-identifier hs-var">m15</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMnemonic -&gt; Maybe SomeMnemonic
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943835"><span class="hs-identifier hs-var">m12</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943833"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall (purpose :: Symbol). Passphrase purpose
</span><a href="#local-6989586621682943834"><span class="hs-identifier hs-var">passphrase</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943831"><span class="annot"><span class="annottext">payloadPost :: Payload
</span><a href="#local-6989586621682943831"><span class="hs-identifier hs-var hs-var">payloadPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: #{m15txt},
                &quot;mnemonic_second_factor&quot;: #{m12txt},
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-220"></span><span>        </span><span id="local-6989586621682943830"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943830"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943831"><span class="hs-identifier hs-var">payloadPost</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943829"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943830"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-223"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943828"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943828"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943830"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943826"><span class="annot"><span class="annottext">payloadKey :: Payload
</span><a href="#local-6989586621682943826"><span class="hs-identifier hs-var hs-var">payloadKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json|{
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;format&quot;: &quot;extended&quot;
            }|]</span></span><span>
</span><span id="line-231"></span><span>        </span><span id="local-6989586621682943825"><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943825"><span class="hs-identifier hs-var">rKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; DerivationIndex
-&gt; Headers
-&gt; Payload
-&gt; ResourceT
     IO (Status, Either RequestException ApiAccountKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; DerivationIndex
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException ApiAccountKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#postAccountKeyShared"><span class="hs-identifier hs-var">postAccountKeyShared</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943828"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483648</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943833"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943826"><span class="hs-identifier hs-var">payloadKey</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
-&gt; [(Status, Either RequestException ApiAccountKeyShared)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943825"><span class="hs-identifier hs-var">rKey</span></a></span><span>
</span><span id="line-235"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status202</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal' ApiAccountKeyShared KeyFormat
-&gt; (KeyFormat -&gt; IO ())
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;format&quot;
  ((KeyFormat -&gt; f KeyFormat)
   -&gt; ApiAccountKeyShared -&gt; f ApiAccountKeyShared)
Traversal' ApiAccountKeyShared KeyFormat
</span><a href="#local-6989586621682943822"><span class="hs-var">#format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; KeyFormat -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiAccountKeyShared</span></a></span><span> </span><span id="local-6989586621682943819"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943819"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiAccountKeyShared ApiAccountKeyShared
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ApiAccountKeyShared
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiAccountKeyShared ApiAccountKeyShared
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943825"><span class="hs-identifier hs-var">rKey</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#hexText"><span class="hs-identifier hs-var">hexText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943819"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943832"><span class="hs-identifier hs-var">accXPubDerived</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>        </span><span id="local-6989586621682943818"><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943818"><span class="hs-identifier hs-var">aKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Maybe KeyFormat
-&gt; ResourceT
     IO (Status, Either RequestException ApiAccountKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Maybe KeyFormat
-&gt; m (Status, Either RequestException ApiAccountKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getAccountKeyShared"><span class="hs-identifier hs-var">getAccountKeyShared</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943828"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; Maybe KeyFormat
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
-&gt; [(Status, Either RequestException ApiAccountKeyShared)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943818"><span class="hs-identifier hs-var">aKey</span></a></span><span>
</span><span id="line-244"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-245"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal' ApiAccountKeyShared KeyFormat
-&gt; (KeyFormat -&gt; IO ())
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;format&quot;
  ((KeyFormat -&gt; f KeyFormat)
   -&gt; ApiAccountKeyShared -&gt; f ApiAccountKeyShared)
Traversal' ApiAccountKeyShared KeyFormat
</span><a href="#local-6989586621682943816"><span class="hs-var">#format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; KeyFormat -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiAccountKeyShared</span></a></span><span> </span><span id="local-6989586621682943815"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943815"><span class="hs-identifier hs-var">bytes'</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiAccountKeyShared ApiAccountKeyShared
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ApiAccountKeyShared
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiAccountKeyShared ApiAccountKeyShared
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943818"><span class="hs-identifier hs-var">aKey</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#hexText"><span class="hs-identifier hs-var">hexText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943815"><span class="hs-identifier hs-var">bytes'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943832"><span class="hs-identifier hs-var">accXPubDerived</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943813"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943813"><span class="hs-identifier hs-var">walActive</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943828"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>        </span><span id="local-6989586621682943812"><span class="annot"><span class="annottext">(Status, Either RequestException ApiActiveSharedWallet)
</span><a href="#local-6989586621682943812"><span class="hs-identifier hs-var">rDel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; ResourceT
     IO (Status, Either RequestException ApiActiveSharedWallet)
forall a (m :: * -&gt; *) s.
(FromJSON a, MonadIO m, MonadUnliftIO m,
 HasType (URI, Manager) s) =&gt;
s
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException a)
</span><a href="Test.Integration.Framework.Request.html#request"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiActiveSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet -&gt; (ByteString, Text)
forall (style :: WalletStyle) w.
(Discriminate style, HasType (ApiT WalletId) w) =&gt;
w -&gt; (ByteString, Text)
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Link.deleteWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Shared</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943813"><span class="hs-identifier hs-var">walActive</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="Test.Integration.Framework.Request.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiActiveSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status204</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiActiveSharedWallet)
</span><a href="#local-6989586621682943812"><span class="hs-identifier hs-var">rDel</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943807"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943807"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943806"><span class="annot"><span class="annottext">payloadAcctOther :: Payload
</span><a href="#local-6989586621682943806"><span class="hs-identifier hs-var hs-var">payloadAcctOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621682943805"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943805"><span class="hs-identifier hs-var">rPostAcctOther</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943806"><span class="hs-identifier hs-var">payloadAcctOther</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943804"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943805"><span class="hs-identifier hs-var">rPostAcctOther</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943803"><span class="annot"><span class="annottext">walAcctOther :: ApiSharedWallet
</span><a href="#local-6989586621682943803"><span class="hs-identifier hs-var hs-var">walAcctOther</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943805"><span class="hs-identifier hs-var">rPostAcctOther</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943802"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943802"><span class="hs-identifier hs-var">walAcctOtherActive</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943803"><span class="hs-identifier hs-var">walAcctOther</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943802"><span class="hs-identifier hs-var">walAcctOtherActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943801"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">ApiT WalletId -&gt; ApiT WalletId -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldNotBe`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943813"><span class="hs-identifier hs-var">walActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943800"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943799"><span class="annot"><span class="annottext">payloadAcctSame :: Payload
</span><a href="#local-6989586621682943799"><span class="hs-identifier hs-var hs-var">payloadAcctSame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubDerived},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-295"></span><span>        </span><span id="local-6989586621682943798"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943798"><span class="hs-identifier hs-var">rPostAcctSame</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943799"><span class="hs-identifier hs-var">payloadAcctSame</span></a></span><span>
</span><span id="line-296"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943797"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943798"><span class="hs-identifier hs-var">rPostAcctSame</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943796"><span class="annot"><span class="annottext">walAcctSame :: ApiSharedWallet
</span><a href="#local-6989586621682943796"><span class="hs-identifier hs-var hs-var">walAcctSame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943798"><span class="hs-identifier hs-var">rPostAcctSame</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943795"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943795"><span class="hs-identifier hs-var">walAcctSameActive</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943796"><span class="hs-identifier hs-var">walAcctSame</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943795"><span class="hs-identifier hs-var">walAcctSameActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943794"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">ApiT WalletId -&gt; ApiT WalletId -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943813"><span class="hs-identifier hs-var">walActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943793"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943792"><span class="annot"><span class="annottext">payloadAcctSameOtherScript :: Payload
</span><a href="#local-6989586621682943792"><span class="hs-identifier hs-var hs-var">payloadAcctSameOtherScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubDerived},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 100 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621682943791"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943791"><span class="hs-identifier hs-var">rPostAcctSameOtherScript</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943839"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943792"><span class="hs-identifier hs-var">payloadAcctSameOtherScript</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943790"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943791"><span class="hs-identifier hs-var">rPostAcctSameOtherScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943789"><span class="annot"><span class="annottext">walAcctSameOtherScript :: ApiSharedWallet
</span><a href="#local-6989586621682943789"><span class="hs-identifier hs-var hs-var">walAcctSameOtherScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943791"><span class="hs-identifier hs-var">rPostAcctSameOtherScript</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943788"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943788"><span class="hs-identifier hs-var">walAcctSameOtherScriptActive</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943789"><span class="hs-identifier hs-var">walAcctSameOtherScript</span></a></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943788"><span class="hs-identifier hs-var">walAcctSameOtherScriptActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943787"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">ApiT WalletId -&gt; ApiT WalletId -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldNotBe`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943813"><span class="hs-identifier hs-var">walActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943786"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>       </span><span class="hs-comment">-- In cardano-addresses</span><span>
</span><span id="line-327"></span><span>       </span><span class="hs-comment">-- \$ cat phrase.prv</span><span>
</span><span id="line-328"></span><span>       </span><span class="hs-comment">-- rib kiwi begin other second pool raise prosper inspire forum keep stereo option ride region</span><span>
</span><span id="line-329"></span><span>       </span><span class="hs-comment">--</span><span>
</span><span id="line-330"></span><span>       </span><span class="hs-comment">-- \$ cardano-address key from-recovery-phrase Shared &lt; phrase.prv &gt; root.shared_xsk</span><span>
</span><span id="line-331"></span><span>       </span><span class="hs-comment">--</span><span>
</span><span id="line-332"></span><span>       </span><span class="hs-comment">-- \$ cardano-address key child 1854H/1815H/0H &lt; root.shared_xsk &gt; acct.shared_xsk</span><span>
</span><span id="line-333"></span><span>       </span><span class="hs-comment">--</span><span>
</span><span id="line-334"></span><span>       </span><span class="hs-comment">-- \$ cardano-address key walletid --spending &quot;all [cosigner#0]&quot; &lt; acct.shared_xsk</span><span>
</span><span id="line-335"></span><span>       </span><span class="hs-comment">-- 654a69cd246ab08aeb4d44837ff5d5ceddfbce20</span><span>
</span><span id="line-336"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_01 - golden test comparing wallet id&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943785"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943785"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943784"><span class="annot"><span class="annottext">payloadPost :: Payload
</span><a href="#local-6989586621682943784"><span class="hs-identifier hs-var hs-var">payloadPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: [&quot;rib&quot;,&quot;kiwi&quot;,&quot;begin&quot;,&quot;other&quot;,&quot;second&quot;,&quot;pool&quot;,&quot;raise&quot;,&quot;prosper&quot;,&quot;inspire&quot;,&quot;forum&quot;,&quot;keep&quot;,&quot;stereo&quot;,&quot;option&quot;,&quot;ride&quot;,&quot;region&quot;],
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;0H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: &quot;self&quot; },
                      &quot;template&quot;:
                          { &quot;all&quot;: [&quot;cosigner#0&quot;]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-350"></span><span>        </span><span id="local-6989586621682943783"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943783"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943785"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943784"><span class="hs-identifier hs-var">payloadPost</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943782"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943783"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-353"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943781"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943781"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943783"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943780"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943780"><span class="hs-identifier hs-var">walActive</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943781"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><span class="annottext">WalletId -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT WalletId -&gt; WalletId
forall a. ApiT a -&gt; a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var hs-var">getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">(ApiT WalletId -&gt; WalletId) -&gt; ApiT WalletId -&gt; WalletId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943780"><span class="hs-identifier hs-var">walActive</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
-&gt; ApiT WalletId
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  ((ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (ApiT WalletId) ApiActiveSharedWallet)
(ApiT WalletId -&gt; Const (ApiT WalletId) (ApiT WalletId))
-&gt; ApiActiveSharedWallet
-&gt; Const (ApiT WalletId) ApiActiveSharedWallet
</span><a href="#local-6989586621682943777"><span class="hs-var">#id</span></a></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span>
</span><span id="line-359"></span><span>            </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;654a69cd246ab08aeb4d44837ff5d5ceddfbce20&quot;</span></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_02 - Create a pending shared wallet from root xprv&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943776"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943776"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-363"></span><span>        </span><span id="local-6989586621682943775"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943775"><span class="hs-identifier hs-var">m15txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M15"><span class="hs-identifier hs-var">M15</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span id="local-6989586621682943774"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943774"><span class="hs-identifier hs-var">m12txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M12"><span class="hs-identifier hs-var">M12</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943773"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943773"><span class="hs-identifier hs-var">m15</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[15]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943775"><span class="hs-identifier hs-var">m15txt</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943772"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943772"><span class="hs-identifier hs-var">m12</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[12]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943774"><span class="hs-identifier hs-var">m12txt</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943771"><span class="annot"><span class="annottext">passphrase :: Passphrase purpose
</span><a href="#local-6989586621682943771"><span class="hs-identifier hs-var hs-var">passphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Passphrase purpose
forall (purpose :: Symbol). ScrubbedBytes -&gt; Passphrase purpose
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; Passphrase purpose)
-&gt; ScrubbedBytes -&gt; Passphrase purpose
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ScrubbedBytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.convert</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ScrubbedBytes) -&gt; ByteString -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Test.Integration.Framework.DSL.html#fixturePassphrase"><span class="hs-identifier hs-var">fixturePassphrase</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943770"><span class="annot"><span class="annottext">index :: Word32
</span><a href="#local-6989586621682943770"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">30</span></span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943769"><span class="annot"><span class="annottext">accXPubDerived :: Text
</span><a href="#local-6989586621682943769"><span class="hs-identifier hs-var hs-var">accXPubDerived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
-&gt; Maybe SomeMnemonic -&gt; Word32 -&gt; Passphrase &quot;encryption&quot; -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#accPubKeyFromMnemonics"><span class="hs-identifier hs-var">accPubKeyFromMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943773"><span class="hs-identifier hs-var">m15</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMnemonic -&gt; Maybe SomeMnemonic
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943772"><span class="hs-identifier hs-var">m12</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943770"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall (purpose :: Symbol). Passphrase purpose
</span><a href="#local-6989586621682943771"><span class="hs-identifier hs-var">passphrase</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943768"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943768"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: #{m15txt},
                &quot;mnemonic_second_factor&quot;: #{m12txt},
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-388"></span><span>        </span><span id="local-6989586621682943767"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943767"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943776"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943768"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiActiveSharedWallet ApiPendingSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
forall e a. Either e a -&gt; Either a e
</span><a href="../../../../either/html/src"><span class="hs-identifier hs-var">swapEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet)
-&gt; (ApiSharedWallet
    -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943766"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943767"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-392"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Text -&gt; f Text)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Text -&gt; f Text)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; f (ApiT WalletName))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943765"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; f (ApiT WalletName))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((Text -&gt; f Text) -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; (Text -&gt; f Text)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; f WalletName)
   -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
(WalletName -&gt; f WalletName)
-&gt; ApiT WalletName -&gt; f (ApiT WalletName)
</span><a href="#local-6989586621682943764"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; f WalletName)
 -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
-&gt; (Text -&gt; f Text)
-&gt; ApiT WalletName
-&gt; f (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
(Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName
</span><a href="#local-6989586621682943763"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet) Word32
-&gt; (Word32 -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-395"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Word32 -&gt; f Word32)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;addressPoolGap&quot;
  ((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943762"><span class="hs-var">#addressPoolGap</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((AddressPoolGap -&gt; f AddressPoolGap)
   -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
(AddressPoolGap -&gt; f AddressPoolGap)
-&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap)
</span><a href="#local-6989586621682943761"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((AddressPoolGap -&gt; f AddressPoolGap)
 -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiT AddressPoolGap
-&gt; f (ApiT AddressPoolGap)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getAddressPoolGap&quot;
  ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
(Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap
</span><a href="#local-6989586621682943760"><span class="hs-var">#getAddressPoolGap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet)
  (Maybe ScriptTemplate)
-&gt; (Maybe ScriptTemplate -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-398"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943759"><span class="hs-var">#delegationScriptTemplate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScriptTemplate -&gt; Maybe ScriptTemplate -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet)
  DerivationIndex
-&gt; (DerivationIndex -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-401"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;accountIndex&quot;
  ((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943758"><span class="hs-var">#accountIndex</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((DerivationIndex -&gt; f DerivationIndex)
   -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
(DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex)
</span><a href="#local-6989586621682943757"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483678</span></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943756"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943756"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943767"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943755"><span class="annot"><span class="annottext">payloadKey :: Payload
</span><a href="#local-6989586621682943755"><span class="hs-identifier hs-var hs-var">payloadKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json|{
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;format&quot;: &quot;extended&quot;
            }|]</span></span><span>
</span><span id="line-411"></span><span>        </span><span id="local-6989586621682943754"><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943754"><span class="hs-identifier hs-var">rKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-412"></span><span>            </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; DerivationIndex
-&gt; Headers
-&gt; Payload
-&gt; ResourceT
     IO (Status, Either RequestException ApiAccountKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; DerivationIndex
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException ApiAccountKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#postAccountKeyShared"><span class="hs-identifier hs-var">postAccountKeyShared</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943776"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943756"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483648</span></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; Word32
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943770"><span class="hs-identifier hs-var">index</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943755"><span class="hs-identifier hs-var">payloadKey</span></a></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
-&gt; [(Status, Either RequestException ApiAccountKeyShared)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943754"><span class="hs-identifier hs-var">rKey</span></a></span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status202</span></a></span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal' ApiAccountKeyShared KeyFormat
-&gt; (KeyFormat -&gt; IO ())
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;format&quot;
  ((KeyFormat -&gt; f KeyFormat)
   -&gt; ApiAccountKeyShared -&gt; f ApiAccountKeyShared)
Traversal' ApiAccountKeyShared KeyFormat
</span><a href="#local-6989586621682943753"><span class="hs-var">#format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; KeyFormat -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiAccountKeyShared</span></a></span><span> </span><span id="local-6989586621682943752"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943752"><span class="hs-identifier hs-var">bytes</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiAccountKeyShared ApiAccountKeyShared
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ApiAccountKeyShared
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiAccountKeyShared ApiAccountKeyShared
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943754"><span class="hs-identifier hs-var">rKey</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#hexText"><span class="hs-identifier hs-var">hexText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943752"><span class="hs-identifier hs-var">bytes</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943769"><span class="hs-identifier hs-var">accXPubDerived</span></a></span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_03 - Create an active shared wallet from account xpub&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943751"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943751"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943750"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943750"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943749"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943749"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-438"></span><span>        </span><span id="local-6989586621682943748"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943748"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943751"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943749"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943747"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943748"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-441"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-442"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Text -&gt; f Text)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Text -&gt; f Text)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; f (ApiT WalletName))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943746"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; f (ApiT WalletName))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Text -&gt; f Text) -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; (Text -&gt; f Text)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; f WalletName)
   -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
(WalletName -&gt; f WalletName)
-&gt; ApiT WalletName -&gt; f (ApiT WalletName)
</span><a href="#local-6989586621682943745"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; f WalletName)
 -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
-&gt; (Text -&gt; f Text)
-&gt; ApiT WalletName
-&gt; f (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
(Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName
</span><a href="#local-6989586621682943744"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet) Word32
-&gt; (Word32 -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-445"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Word32 -&gt; f Word32)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;addressPoolGap&quot;
  ((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943743"><span class="hs-var">#addressPoolGap</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((AddressPoolGap -&gt; f AddressPoolGap)
   -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
(AddressPoolGap -&gt; f AddressPoolGap)
-&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap)
</span><a href="#local-6989586621682943742"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((AddressPoolGap -&gt; f AddressPoolGap)
 -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiT AddressPoolGap
-&gt; f (ApiT AddressPoolGap)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getAddressPoolGap&quot;
  ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
(Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap
</span><a href="#local-6989586621682943741"><span class="hs-var">#getAddressPoolGap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943740"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943739"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943738"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943737"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943736"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;reward&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943735"><span class="hs-var">#reward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943734"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943733"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943732"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943731"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  ApiWalletDelegation
-&gt; (ApiWalletDelegation -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegation&quot;
  ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943730"><span class="hs-var">#delegation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWalletDelegation -&gt; ApiWalletDelegation -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Maybe (ApiT PoolId), ApiEpochInfo)] -&gt; ApiWalletDelegation
</span><a href="Test.Integration.Framework.DSL.html#notDelegating"><span class="hs-identifier hs-var">notDelegating</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Maybe ApiWalletPassphraseInfo)
-&gt; (Maybe ApiWalletPassphraseInfo -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Maybe ApiWalletPassphraseInfo
     -&gt; f (Maybe ApiWalletPassphraseInfo))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Maybe ApiWalletPassphraseInfo
    -&gt; f (Maybe ApiWalletPassphraseInfo))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;passphrase&quot;
  ((Maybe ApiWalletPassphraseInfo
    -&gt; f (Maybe ApiWalletPassphraseInfo))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(Maybe ApiWalletPassphraseInfo
 -&gt; f (Maybe ApiWalletPassphraseInfo))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943729"><span class="hs-var">#passphrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ApiWalletPassphraseInfo
-&gt; Maybe ApiWalletPassphraseInfo -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ApiWalletPassphraseInfo
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Maybe ScriptTemplate)
-&gt; (Maybe ScriptTemplate -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943728"><span class="hs-var">#delegationScriptTemplate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScriptTemplate -&gt; Maybe ScriptTemplate -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  DerivationIndex
-&gt; (DerivationIndex -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-464"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;accountIndex&quot;
  ((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943727"><span class="hs-var">#accountIndex</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((DerivationIndex -&gt; f DerivationIndex)
   -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
(DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex)
</span><a href="#local-6989586621682943726"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483658</span></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943725"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943725"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943748"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span id="local-6989586621682943724"><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943724"><span class="hs-identifier hs-var">aKey</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Maybe KeyFormat
-&gt; ResourceT
     IO (Status, Either RequestException ApiAccountKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Maybe KeyFormat
-&gt; m (Status, Either RequestException ApiAccountKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getAccountKeyShared"><span class="hs-identifier hs-var">getAccountKeyShared</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943751"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943725"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; Maybe KeyFormat
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
-&gt; [(Status, Either RequestException ApiAccountKeyShared)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943724"><span class="hs-identifier hs-var">aKey</span></a></span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal' ApiAccountKeyShared KeyFormat
-&gt; (KeyFormat -&gt; IO ())
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;format&quot;
  ((KeyFormat -&gt; f KeyFormat)
   -&gt; ApiAccountKeyShared -&gt; f ApiAccountKeyShared)
Traversal' ApiAccountKeyShared KeyFormat
</span><a href="#local-6989586621682943723"><span class="hs-var">#format</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyFormat -&gt; KeyFormat -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Extended</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiAccountKeyShared</span></a></span><span> </span><span id="local-6989586621682943722"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943722"><span class="hs-identifier hs-var">bytes'</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyFormat
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiAccountKeyShared ApiAccountKeyShared
-&gt; (Status, Either RequestException ApiAccountKeyShared)
-&gt; ApiAccountKeyShared
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiAccountKeyShared ApiAccountKeyShared
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiAccountKeyShared)
</span><a href="#local-6989586621682943724"><span class="hs-identifier hs-var">aKey</span></a></span><span>
</span><span id="line-476"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#hexText"><span class="hs-identifier hs-var">hexText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682943722"><span class="hs-identifier hs-var">bytes'</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943750"><span class="hs-identifier hs-var">accXPubTxt</span></a></span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_04 - Create a pending shared wallet from account xpub&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943721"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943721"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943720"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943720"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943719"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943719"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-496"></span><span>        </span><span id="local-6989586621682943718"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943718"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943721"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943719"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-497"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiActiveSharedWallet ApiPendingSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
forall e a. Either e a -&gt; Either a e
</span><a href="../../../../either/html/src"><span class="hs-identifier hs-var">swapEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet)
-&gt; (ApiSharedWallet
    -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943717"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943718"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-500"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Text -&gt; f Text)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Text -&gt; f Text)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; f (ApiT WalletName))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943716"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; f (ApiT WalletName))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((Text -&gt; f Text) -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; (Text -&gt; f Text)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; f WalletName)
   -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
(WalletName -&gt; f WalletName)
-&gt; ApiT WalletName -&gt; f (ApiT WalletName)
</span><a href="#local-6989586621682943715"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; f WalletName)
 -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
-&gt; (Text -&gt; f Text)
-&gt; ApiT WalletName
-&gt; f (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
(Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName
</span><a href="#local-6989586621682943714"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet) Word32
-&gt; (Word32 -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-503"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Word32 -&gt; f Word32)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;addressPoolGap&quot;
  ((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943713"><span class="hs-var">#addressPoolGap</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((AddressPoolGap -&gt; f AddressPoolGap)
   -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
(AddressPoolGap -&gt; f AddressPoolGap)
-&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap)
</span><a href="#local-6989586621682943712"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((AddressPoolGap -&gt; f AddressPoolGap)
 -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiT AddressPoolGap
-&gt; f (ApiT AddressPoolGap)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getAddressPoolGap&quot;
  ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
(Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap
</span><a href="#local-6989586621682943711"><span class="hs-var">#getAddressPoolGap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet)
  (Maybe ScriptTemplate)
-&gt; (Maybe ScriptTemplate -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-506"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943710"><span class="hs-var">#delegationScriptTemplate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScriptTemplate -&gt; Maybe ScriptTemplate -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiActiveSharedWallet ApiPendingSharedWallet)
  DerivationIndex
-&gt; (DerivationIndex -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-509"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
 -&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
 -&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet))
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; Either ApiActiveSharedWallet ApiPendingSharedWallet
-&gt; f (Either ApiActiveSharedWallet ApiPendingSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;accountIndex&quot;
  ((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
   -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
(ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet
</span><a href="#local-6989586621682943709"><span class="hs-var">#accountIndex</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
 -&gt; ApiPendingSharedWallet -&gt; f ApiPendingSharedWallet)
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiPendingSharedWallet
-&gt; f ApiPendingSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((DerivationIndex -&gt; f DerivationIndex)
   -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
(DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex)
</span><a href="#local-6989586621682943708"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483658</span></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_05 - Create an active shared wallet from root xprv with self&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943707"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943707"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-514"></span><span>        </span><span id="local-6989586621682943706"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943706"><span class="hs-identifier hs-var">m15txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M15"><span class="hs-identifier hs-var">M15</span></a></span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621682943705"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943705"><span class="hs-identifier hs-var">m12txt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [Text] -&gt; ResourceT IO [Text]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [Text] -&gt; ResourceT IO [Text])
-&gt; IO [Text] -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength -&gt; IO [Text]
</span><a href="Test.Integration.Framework.DSL.html#genMnemonics"><span class="hs-identifier hs-var">genMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">MnemonicLength
</span><a href="Test.Integration.Framework.DSL.html#M12"><span class="hs-identifier hs-var">M12</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943704"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943704"><span class="hs-identifier hs-var">m15</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[15]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">15</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943706"><span class="hs-identifier hs-var">m15txt</span></a></span><span>
</span><span id="line-517"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943703"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943703"><span class="hs-identifier hs-var">m12</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Either (MkSomeMnemonicError '[12]) SomeMnemonic
forall (sz :: [Nat]).
MkSomeMnemonic sz =&gt;
[Text] -&gt; Either (MkSomeMnemonicError sz) SomeMnemonic
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">mkSomeMnemonic</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="annot"><span class="hs-number">12</span></span><span> </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943705"><span class="hs-identifier hs-var">m12txt</span></a></span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943702"><span class="annot"><span class="annottext">passphrase :: Passphrase purpose
</span><a href="#local-6989586621682943702"><span class="hs-identifier hs-var hs-var">passphrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Passphrase purpose
forall (purpose :: Symbol). ScrubbedBytes -&gt; Passphrase purpose
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; Passphrase purpose)
-&gt; ScrubbedBytes -&gt; Passphrase purpose
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ScrubbedBytes
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.convert</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ScrubbedBytes) -&gt; ByteString -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Test.Integration.Framework.DSL.html#fixturePassphrase"><span class="hs-identifier hs-var">fixturePassphrase</span></a></span><span>
</span><span id="line-519"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943701"><span class="annot"><span class="annottext">index :: Word32
</span><a href="#local-6989586621682943701"><span class="hs-identifier hs-var hs-var">index</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">30</span></span><span>
</span><span id="line-520"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943700"><span class="annot"><span class="annottext">accXPubDerived :: Text
</span><a href="#local-6989586621682943700"><span class="hs-identifier hs-var hs-var">accXPubDerived</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
-&gt; Maybe SomeMnemonic -&gt; Word32 -&gt; Passphrase &quot;encryption&quot; -&gt; Text
</span><a href="Test.Integration.Framework.DSL.html#accPubKeyFromMnemonics"><span class="hs-identifier hs-var">accPubKeyFromMnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943704"><span class="hs-identifier hs-var">m15</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMnemonic -&gt; Maybe SomeMnemonic
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682943703"><span class="hs-identifier hs-var">m12</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682943701"><span class="hs-identifier hs-var">index</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall (purpose :: Symbol). Passphrase purpose
</span><a href="#local-6989586621682943702"><span class="hs-identifier hs-var">passphrase</span></a></span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943699"><span class="annot"><span class="annottext">payloadPost :: Payload
</span><a href="#local-6989586621682943699"><span class="hs-identifier hs-var hs-var">payloadPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: #{m15txt},
                &quot;mnemonic_second_factor&quot;: #{m12txt},
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubDerived} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-538"></span><span>        </span><span id="local-6989586621682943698"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943698"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943707"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943699"><span class="hs-identifier hs-var">payloadPost</span></a></span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943698"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-540"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-541"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943697"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943697"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943698"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span>        </span><span id="local-6989586621682943696"><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943696"><span class="hs-identifier hs-var">rDel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; ResourceT IO (Status, Either RequestException Value)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet -&gt; m (Status, Either RequestException Value)
</span><a href="Test.Integration.Framework.DSL.html#deleteSharedWallet"><span class="hs-identifier hs-var">deleteSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943707"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943697"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-546"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException Value) -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status204</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943696"><span class="hs-identifier hs-var">rDel</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943695"><span class="annot"><span class="annottext">payloadPostWithSelf :: Payload
</span><a href="#local-6989586621682943695"><span class="hs-identifier hs-var hs-var">payloadPostWithSelf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;mnemonic_sentence&quot;: #{m15txt},
                &quot;mnemonic_second_factor&quot;: #{m12txt},
                &quot;passphrase&quot;: #{fixturePassphrase},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: &quot;self&quot; },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-565"></span><span>        </span><span id="local-6989586621682943694"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943694"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943707"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943695"><span class="hs-identifier hs-var">payloadPostWithSelf</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943694"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span><span>
</span><span id="line-567"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-568"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>
</span><span id="line-570"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943693"><span class="annot"><span class="annottext">walWithSelf :: ApiSharedWallet
</span><a href="#local-6989586621682943693"><span class="hs-identifier hs-var hs-var">walWithSelf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943694"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span>        </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943693"><span class="hs-identifier hs-var">walWithSelf</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT WalletId -&gt; ApiT WalletId -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943697"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-573"></span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_06 - Create an active shared wallet from account xpub with self&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943692"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943692"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943691"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943691"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-576"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943690"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943690"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-591"></span><span>        </span><span id="local-6989586621682943689"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943689"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943692"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943690"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943689"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-593"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-594"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943688"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943688"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943689"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span>        </span><span id="local-6989586621682943687"><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943687"><span class="hs-identifier hs-var">rDel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; ResourceT IO (Status, Either RequestException Value)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet -&gt; m (Status, Either RequestException Value)
</span><a href="Test.Integration.Framework.DSL.html#deleteSharedWallet"><span class="hs-identifier hs-var">deleteSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943692"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943688"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-599"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException Value) -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status204</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943687"><span class="hs-identifier hs-var">rDel</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943686"><span class="annot"><span class="annottext">payloadWithSelf :: Payload
</span><a href="#local-6989586621682943686"><span class="hs-identifier hs-var hs-var">payloadWithSelf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: &quot;self&quot; },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-616"></span><span>        </span><span id="local-6989586621682943685"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943685"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943692"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943686"><span class="hs-identifier hs-var">payloadWithSelf</span></a></span><span>
</span><span id="line-617"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943685"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span><span>
</span><span id="line-618"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-619"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943684"><span class="annot"><span class="annottext">walWithSelf :: ApiSharedWallet
</span><a href="#local-6989586621682943684"><span class="hs-identifier hs-var hs-var">walWithSelf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943685"><span class="hs-identifier hs-var">rPostWithSelf</span></a></span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span>        </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943684"><span class="hs-identifier hs-var">walWithSelf</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT WalletId -&gt; ApiT WalletId -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943688"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-624"></span><span>
</span><span id="line-625"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_07 - Incorrect script template due to NoCosignerInScript&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943683"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943683"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943682"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943682"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-627"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943681"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943681"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-641"></span><span>        </span><span id="local-6989586621682943680"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943680"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943683"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943681"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-642"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943680"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-643"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidNoCosignerInScript"><span class="hs-identifier hs-var">errMsg403TemplateInvalidNoCosignerInScript</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943680"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_08 - Incorrect script template due to UnknownCosigner&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943678"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943678"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943677"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943677"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-647"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943676"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943676"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#1&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                              { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-662"></span><span>        </span><span id="local-6989586621682943675"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943675"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943678"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943676"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943675"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidUnknownCosigner"><span class="hs-identifier hs-var">errMsg403TemplateInvalidUnknownCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943675"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_09 - Incorrect script template due to DuplicateXPub&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943674"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943674"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-667"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943673"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943673"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-668"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943672"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943672"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt}, &quot;cosigner#1&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                              { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-684"></span><span>        </span><span id="local-6989586621682943671"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943671"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943674"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943672"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943671"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidDuplicateXPub"><span class="hs-identifier hs-var">errMsg403TemplateInvalidDuplicateXPub</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943671"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-687"></span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_10 - Incorrect script template due to WrongScript when recommended validation&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943670"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943670"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943669"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943669"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-690"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943668"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943668"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 },
                               &quot;cosigner#0&quot;
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-706"></span><span>        </span><span id="local-6989586621682943667"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943667"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943670"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943668"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-707"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943667"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-708"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943666"><span class="annot"><span class="annottext">reason :: String
</span><a href="#local-6989586621682943666"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The list inside a script has duplicate keys (which is not recommended).&quot;</span></span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidScript"><span class="hs-identifier hs-var">errMsg403TemplateInvalidScript</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682943666"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943667"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-710"></span><span>
</span><span id="line-711"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_11 - Correct script template when required validation&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943665"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943665"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-712"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943664"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943664"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-713"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943663"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943663"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 },
                               &quot;cosigner#0&quot;
                             ]
                          }
                    },
                &quot;script_validation&quot;: &quot;required&quot;
                } |]</span></span><span>
</span><span id="line-730"></span><span>        </span><span id="local-6989586621682943662"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943662"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943665"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943663"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-731"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943662"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_12 - Incorrect script template due to WrongScript - timelocks&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943661"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943661"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-734"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943660"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943660"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-735"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943659"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943659"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 },
                               { &quot;active_until&quot;: 110 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621682943658"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943658"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943661"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943659"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-752"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943658"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-753"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943657"><span class="annot"><span class="annottext">reason :: String
</span><a href="#local-6989586621682943657"><span class="hs-identifier hs-var hs-var">reason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The timelocks used are contradictory when used with 'all' (which is not recommended).&quot;</span></span><span>
</span><span id="line-754"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403TemplateInvalidScript"><span class="hs-identifier hs-var">errMsg403TemplateInvalidScript</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682943657"><span class="hs-identifier hs-var">reason</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943658"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-755"></span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_CREATE_13 - Incorrect account index&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943656"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943656"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-757"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943655"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943655"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-758"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943654"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943654"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-774"></span><span>        </span><span id="local-6989586621682943653"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943653"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943656"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943654"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-775"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943653"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-776"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403WrongIndex"><span class="hs-identifier hs-var">errMsg403WrongIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943653"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_DELETE_01 - Delete of a shared wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943652"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943652"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-779"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943651"><span class="annot"><span class="annottext">walName :: Text
</span><a href="#local-6989586621682943651"><span class="hs-identifier hs-var hs-var">walName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-780"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943650"><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943650"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO (Text, Payload)
forall (m :: * -&gt; *) a.
(MonadIO m, ToJSON a, MonadFail m) =&gt;
a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var">getAccountWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943651"><span class="hs-identifier hs-var">walName</span></a></span><span>
</span><span id="line-781"></span><span>        </span><span id="local-6989586621682943648"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943648"><span class="hs-identifier hs-var">rInit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943652"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943650"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-782"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943648"><span class="hs-identifier hs-var">rInit</span></a></span><span>
</span><span id="line-783"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-784"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943647"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943647"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943648"><span class="hs-identifier hs-var">rInit</span></a></span><span>
</span><span id="line-785"></span><span>
</span><span id="line-786"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; String -&gt; IO a -&gt; m a
</span><a href="Test.Integration.Framework.DSL.html#eventually"><span class="hs-identifier hs-var">eventually</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Wallet state = Ready&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-787"></span><span>            </span><span id="local-6989586621682943646"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943646"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWallet"><span class="hs-identifier hs-var">getSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943652"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943647"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-788"></span><span>            </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet) SyncProgress
-&gt; (SyncProgress -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-789"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((SyncProgress -&gt; f SyncProgress)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (SyncProgress -&gt; f SyncProgress)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;state&quot;
  ((ApiT SyncProgress -&gt; f (ApiT SyncProgress))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT SyncProgress -&gt; f (ApiT SyncProgress))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943645"><span class="hs-var">#state</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT SyncProgress -&gt; f (ApiT SyncProgress))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((SyncProgress -&gt; f SyncProgress)
    -&gt; ApiT SyncProgress -&gt; f (ApiT SyncProgress))
-&gt; (SyncProgress -&gt; f SyncProgress)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((SyncProgress -&gt; f SyncProgress)
   -&gt; ApiT SyncProgress -&gt; f (ApiT SyncProgress))
(SyncProgress -&gt; f SyncProgress)
-&gt; ApiT SyncProgress -&gt; f (ApiT SyncProgress)
</span><a href="#local-6989586621682943644"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SyncProgress -&gt; SyncProgress -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">SyncProgress
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Ready</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943642"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943646"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span>        </span><span id="local-6989586621682943641"><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943641"><span class="hs-identifier hs-var">rDel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; ResourceT IO (Status, Either RequestException Value)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet -&gt; m (Status, Either RequestException Value)
</span><a href="Test.Integration.Framework.DSL.html#deleteSharedWallet"><span class="hs-identifier hs-var">deleteSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943652"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943647"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-794"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException Value) -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status204</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943641"><span class="hs-identifier hs-var">rDel</span></a></span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_01 - Add cosigner key in a pending shared wallet and transit it to the active shared wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943640"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943640"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-797"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621682943639"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943639"><span class="hs-identifier hs-var">accXPub0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943638"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943638"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621682943637"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943637"><span class="hs-identifier hs-var">accXPub1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682943636"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943636"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-798"></span><span>
</span><span id="line-799"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943635"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943635"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-815"></span><span>        </span><span id="local-6989586621682943634"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943634"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943640"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943635"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-816"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943634"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-817"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943633"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943633"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943632"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943632"><span class="hs-identifier hs-var">pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943634"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-818"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943631"><span class="annot"><span class="annottext">cosignerKeysPost :: ScriptTemplate
</span><a href="#local-6989586621682943631"><span class="hs-identifier hs-var hs-var">cosignerKeysPost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943632"><span class="hs-identifier hs-var">pendingWal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
-&gt; ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
    -&gt; ApiPendingSharedWallet
    -&gt; Const ScriptTemplate ApiPendingSharedWallet)
-&gt; ScriptTemplate
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;paymentScriptTemplate&quot;
  ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
   -&gt; ApiPendingSharedWallet
   -&gt; Const ScriptTemplate ApiPendingSharedWallet)
(ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
-&gt; ApiPendingSharedWallet
-&gt; Const ScriptTemplate ApiPendingSharedWallet
</span><a href="#local-6989586621682943630"><span class="hs-var">#paymentScriptTemplate</span></a></span><span>
</span><span id="line-819"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Map Cosigner XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">cosigners</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943631"><span class="hs-identifier hs-var">cosignerKeysPost</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub -&gt; Map Cosigner XPub -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Cosigner, XPub)] -&gt; Map Cosigner XPub
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943639"><span class="hs-identifier hs-var">accXPub0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-820"></span><span>
</span><span id="line-821"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943626"><span class="annot"><span class="annottext">payloadPatch :: Payload
</span><a href="#local-6989586621682943626"><span class="hs-identifier hs-var hs-var">payloadPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span>        </span><span id="local-6989586621682943625"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943625"><span class="hs-identifier hs-var">rPatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943640"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943633"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943626"><span class="hs-identifier hs-var">payloadPatch</span></a></span><span>
</span><span id="line-826"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943625"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-827"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943623"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943623"><span class="hs-identifier hs-var">activeWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943625"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-828"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943622"><span class="annot"><span class="annottext">cosignerKeysPatch :: ScriptTemplate
</span><a href="#local-6989586621682943622"><span class="hs-identifier hs-var hs-var">cosignerKeysPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943623"><span class="hs-identifier hs-var">activeWal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
    -&gt; ApiActiveSharedWallet
    -&gt; Const ScriptTemplate ApiActiveSharedWallet)
-&gt; ScriptTemplate
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;paymentScriptTemplate&quot;
  ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
   -&gt; ApiActiveSharedWallet
   -&gt; Const ScriptTemplate ApiActiveSharedWallet)
(ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
-&gt; ApiActiveSharedWallet
-&gt; Const ScriptTemplate ApiActiveSharedWallet
</span><a href="#local-6989586621682943621"><span class="hs-var">#paymentScriptTemplate</span></a></span><span>
</span><span id="line-829"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Map Cosigner XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">cosigners</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943622"><span class="hs-identifier hs-var">cosignerKeysPatch</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub -&gt; Map Cosigner XPub -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Cosigner, XPub)] -&gt; Map Cosigner XPub
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943639"><span class="hs-identifier hs-var">accXPub0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943637"><span class="hs-identifier hs-var">accXPub1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_02 - Add cosigner for delegation script template&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943620"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943620"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-832"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621682943619"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943619"><span class="hs-identifier hs-var">accXPub0</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943618"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943618"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621682943617"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943617"><span class="hs-identifier hs-var">accXPub1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621682943616"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943616"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-833"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943615"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943615"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    },
                &quot;delegation_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;any&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 },
                               { &quot;active_until&quot;: 100 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-860"></span><span>        </span><span id="local-6989586621682943614"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943614"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943620"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943615"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-861"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943614"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-862"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943613"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943613"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943612"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943612"><span class="hs-identifier hs-var">pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943614"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-863"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943611"><span class="annot"><span class="annottext">cosignerKeysPostInPayment :: ScriptTemplate
</span><a href="#local-6989586621682943611"><span class="hs-identifier hs-var hs-var">cosignerKeysPostInPayment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943612"><span class="hs-identifier hs-var">pendingWal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
-&gt; ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
    -&gt; ApiPendingSharedWallet
    -&gt; Const ScriptTemplate ApiPendingSharedWallet)
-&gt; ScriptTemplate
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;paymentScriptTemplate&quot;
  ((ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
   -&gt; ApiPendingSharedWallet
   -&gt; Const ScriptTemplate ApiPendingSharedWallet)
(ScriptTemplate -&gt; Const ScriptTemplate ScriptTemplate)
-&gt; ApiPendingSharedWallet
-&gt; Const ScriptTemplate ApiPendingSharedWallet
</span><a href="#local-6989586621682943610"><span class="hs-var">#paymentScriptTemplate</span></a></span><span>
</span><span id="line-864"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Map Cosigner XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">cosigners</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943611"><span class="hs-identifier hs-var">cosignerKeysPostInPayment</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub -&gt; Map Cosigner XPub -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Cosigner, XPub)] -&gt; Map Cosigner XPub
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943619"><span class="hs-identifier hs-var">accXPub0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-865"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682943609"><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943609"><span class="hs-identifier hs-var">cosignerKeysPostInDelegation</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943612"><span class="hs-identifier hs-var">pendingWal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiPendingSharedWallet
-&gt; ((Maybe ScriptTemplate
     -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
    -&gt; ApiPendingSharedWallet
    -&gt; Const (Maybe ScriptTemplate) ApiPendingSharedWallet)
-&gt; Maybe ScriptTemplate
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate
    -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
   -&gt; ApiPendingSharedWallet
   -&gt; Const (Maybe ScriptTemplate) ApiPendingSharedWallet)
(Maybe ScriptTemplate
 -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
-&gt; ApiPendingSharedWallet
-&gt; Const (Maybe ScriptTemplate) ApiPendingSharedWallet
</span><a href="#local-6989586621682943608"><span class="hs-var">#delegationScriptTemplate</span></a></span><span>
</span><span id="line-866"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Map Cosigner XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">cosigners</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943609"><span class="hs-identifier hs-var">cosignerKeysPostInDelegation</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub -&gt; Map Cosigner XPub -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Cosigner, XPub)] -&gt; Map Cosigner XPub
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943619"><span class="hs-identifier hs-var">accXPub0</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943607"><span class="annot"><span class="annottext">payloadPatch :: Payload
</span><a href="#local-6989586621682943607"><span class="hs-identifier hs-var hs-var">payloadPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-871"></span><span>
</span><span id="line-872"></span><span>        </span><span id="local-6989586621682943606"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943606"><span class="hs-identifier hs-var">rPatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943620"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943613"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Delegation</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943607"><span class="hs-identifier hs-var">payloadPatch</span></a></span><span>
</span><span id="line-873"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943606"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-874"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943604"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943604"><span class="hs-identifier hs-var">activeWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943606"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-875"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682943603"><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943603"><span class="hs-identifier hs-var">cosignerKeysPatch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943604"><span class="hs-identifier hs-var">activeWal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
-&gt; ((Maybe ScriptTemplate
     -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
    -&gt; ApiActiveSharedWallet
    -&gt; Const (Maybe ScriptTemplate) ApiActiveSharedWallet)
-&gt; Maybe ScriptTemplate
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate
    -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (Maybe ScriptTemplate) ApiActiveSharedWallet)
(Maybe ScriptTemplate
 -&gt; Const (Maybe ScriptTemplate) (Maybe ScriptTemplate))
-&gt; ApiActiveSharedWallet
-&gt; Const (Maybe ScriptTemplate) ApiActiveSharedWallet
</span><a href="#local-6989586621682943602"><span class="hs-var">#delegationScriptTemplate</span></a></span><span>
</span><span id="line-876"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Map Cosigner XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">cosigners</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682943603"><span class="hs-identifier hs-var">cosignerKeysPatch</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub -&gt; Map Cosigner XPub -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Cosigner, XPub)] -&gt; Map Cosigner XPub
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943619"><span class="hs-identifier hs-var">accXPub0</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8 -&gt; Cosigner
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">Cosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682943617"><span class="hs-identifier hs-var">accXPub1</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-877"></span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_03 - Cannot add cosigner key in an active shared wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943601"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943601"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-879"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943600"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943600"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682943599"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943599"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-880"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943598"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943598"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-895"></span><span>        </span><span id="local-6989586621682943597"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943597"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943601"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943598"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-896"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943597"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-897"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943596"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943596"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943595"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943595"><span class="hs-identifier hs-var">_activeWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943597"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-898"></span><span>
</span><span id="line-899"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943594"><span class="annot"><span class="annottext">payloadPatch :: Payload
</span><a href="#local-6989586621682943594"><span class="hs-identifier hs-var hs-var">payloadPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-902"></span><span>
</span><span id="line-903"></span><span>        </span><span id="local-6989586621682943593"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943593"><span class="hs-identifier hs-var">rPatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943601"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943596"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943594"><span class="hs-identifier hs-var">payloadPatch</span></a></span><span>
</span><span id="line-904"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943593"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-905"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403WalletAlreadyActive"><span class="hs-identifier hs-var">errMsg403WalletAlreadyActive</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943593"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-906"></span><span>
</span><span id="line-907"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_04 - Cannot add cosigner key when delegation script missing and cannot add already existent key to other cosigner&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943592"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943592"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-908"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943591"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943591"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682943590"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943590"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-909"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943589"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943589"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-925"></span><span>        </span><span id="local-6989586621682943588"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943588"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943592"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943589"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-926"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943588"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943587"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943587"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943586"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943586"><span class="hs-identifier hs-var">_pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943588"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943585"><span class="annot"><span class="annottext">payloadPatch :: Payload
</span><a href="#local-6989586621682943585"><span class="hs-identifier hs-var hs-var">payloadPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-932"></span><span>
</span><span id="line-933"></span><span>        </span><span id="local-6989586621682943584"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943584"><span class="hs-identifier hs-var">rPatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943592"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943587"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Delegation</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943585"><span class="hs-identifier hs-var">payloadPatch</span></a></span><span>
</span><span id="line-934"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943584"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-935"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403NoDelegationTemplate"><span class="hs-identifier hs-var">errMsg403NoDelegationTemplate</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943584"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-936"></span><span>
</span><span id="line-937"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_05 - Cannot create shared wallet when missing wallet's account public key in template&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943583"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943583"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-938"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943582"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943582"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682943581"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943581"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-939"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943580"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943580"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt1} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-955"></span><span>        </span><span id="local-6989586621682943579"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943579"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943583"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943580"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-956"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943579"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-957"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403CreateIllegal"><span class="hs-identifier hs-var">errMsg403CreateIllegal</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943579"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-958"></span><span>
</span><span id="line-959"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_06 - Can add the same cosigner key for delegation script template but not payment one&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943578"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-960"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943577"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943577"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682943576"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943576"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-961"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943575"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943575"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    },
                &quot;delegation_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;any&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 },
                               { &quot;active_until&quot;: 100 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-989"></span><span>        </span><span id="local-6989586621682943574"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943574"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943575"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-990"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943574"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-991"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943573"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943572"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943572"><span class="hs-identifier hs-var">_pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943574"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-992"></span><span>
</span><span id="line-993"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943571"><span class="annot"><span class="annottext">payloadPatch1 :: Payload
</span><a href="#local-6989586621682943571"><span class="hs-identifier hs-var hs-var">payloadPatch1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-996"></span><span>        </span><span id="local-6989586621682943570"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943570"><span class="hs-identifier hs-var">rPatch1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Delegation</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943571"><span class="hs-identifier hs-var">payloadPatch1</span></a></span><span>
</span><span id="line-997"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943570"><span class="hs-identifier hs-var">rPatch1</span></a></span><span>
</span><span id="line-998"></span><span>
</span><span id="line-999"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943569"><span class="annot"><span class="annottext">payloadPatch2 :: Payload
</span><a href="#local-6989586621682943569"><span class="hs-identifier hs-var hs-var">payloadPatch2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#0&quot;: #{accXPubTxt0}
                } |]</span></span><span>
</span><span id="line-1002"></span><span>        </span><span id="local-6989586621682943568"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943568"><span class="hs-identifier hs-var">rPatch2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943569"><span class="hs-identifier hs-var">payloadPatch2</span></a></span><span>
</span><span id="line-1003"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943568"><span class="hs-identifier hs-var">rPatch2</span></a></span><span>
</span><span id="line-1004"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403CannotUpdateThisCosigner"><span class="hs-identifier hs-var">errMsg403CannotUpdateThisCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943568"><span class="hs-identifier hs-var">rPatch2</span></a></span><span>
</span><span id="line-1005"></span><span>
</span><span id="line-1006"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943567"><span class="annot"><span class="annottext">payloadPatch3 :: Payload
</span><a href="#local-6989586621682943567"><span class="hs-identifier hs-var hs-var">payloadPatch3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt0}
                } |]</span></span><span>
</span><span id="line-1009"></span><span>        </span><span id="local-6989586621682943566"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943566"><span class="hs-identifier hs-var">rPatch3</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943567"><span class="hs-identifier hs-var">payloadPatch3</span></a></span><span>
</span><span id="line-1010"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943566"><span class="hs-identifier hs-var">rPatch3</span></a></span><span>
</span><span id="line-1011"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403KeyAlreadyPresent"><span class="hs-identifier hs-var">errMsg403KeyAlreadyPresent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CredentialType -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943566"><span class="hs-identifier hs-var">rPatch3</span></a></span><span>
</span><span id="line-1012"></span><span>
</span><span id="line-1013"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943565"><span class="annot"><span class="annottext">payloadPatch4 :: Payload
</span><a href="#local-6989586621682943565"><span class="hs-identifier hs-var hs-var">payloadPatch4</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#1&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-1016"></span><span>        </span><span id="local-6989586621682943564"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943564"><span class="hs-identifier hs-var">rPatch4</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Delegation</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943565"><span class="hs-identifier hs-var">payloadPatch4</span></a></span><span>
</span><span id="line-1017"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943564"><span class="hs-identifier hs-var">rPatch4</span></a></span><span>
</span><span id="line-1018"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403KeyAlreadyPresent"><span class="hs-identifier hs-var">errMsg403KeyAlreadyPresent</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CredentialType -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Delegation</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943564"><span class="hs-identifier hs-var">rPatch4</span></a></span><span>
</span><span id="line-1019"></span><span>
</span><span id="line-1020"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943563"><span class="annot"><span class="annottext">payloadPatch5 :: Payload
</span><a href="#local-6989586621682943563"><span class="hs-identifier hs-var hs-var">payloadPatch5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#7&quot;: #{accXPubTxt0}
                } |]</span></span><span>
</span><span id="line-1023"></span><span>        </span><span id="local-6989586621682943562"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943562"><span class="hs-identifier hs-var">rPatch5</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943578"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943573"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943563"><span class="hs-identifier hs-var">payloadPatch5</span></a></span><span>
</span><span id="line-1024"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943562"><span class="hs-identifier hs-var">rPatch5</span></a></span><span>
</span><span id="line-1025"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int -&gt; String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403NoSuchCosigner"><span class="hs-identifier hs-var">errMsg403NoSuchCosigner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CredentialType -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943562"><span class="hs-identifier hs-var">rPatch5</span></a></span><span>
</span><span id="line-1026"></span><span>
</span><span id="line-1027"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_PATCH_07 - Cannot update cosigner key in a pending shared wallet having the shared wallet's account key&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943561"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943561"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1028"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943560"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943560"><span class="hs-identifier hs-var">accXPubTxt0</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621682943559"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943559"><span class="hs-identifier hs-var">accXPubTxt1</span></a></span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1029"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943558"><span class="annot"><span class="annottext">payloadCreate :: Payload
</span><a href="#local-6989586621682943558"><span class="hs-identifier hs-var hs-var">payloadCreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt0},
                &quot;account_index&quot;: &quot;30H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt0} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-1045"></span><span>        </span><span id="local-6989586621682943557"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943557"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943561"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943558"><span class="hs-identifier hs-var">payloadCreate</span></a></span><span>
</span><span id="line-1046"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943557"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1047"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943556"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943556"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943555"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943555"><span class="hs-identifier hs-var">_pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943557"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943554"><span class="annot"><span class="annottext">payloadPatch :: Payload
</span><a href="#local-6989586621682943554"><span class="hs-identifier hs-var hs-var">payloadPatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;cosigner#0&quot;: #{accXPubTxt1}
                } |]</span></span><span>
</span><span id="line-1052"></span><span>        </span><span id="local-6989586621682943553"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943553"><span class="hs-identifier hs-var">rPatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; CredentialType
-&gt; Payload
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#patchSharedWallet"><span class="hs-identifier hs-var">patchSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943561"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943556"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">CredentialType
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Payment</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943554"><span class="hs-identifier hs-var">payloadPatch</span></a></span><span>
</span><span id="line-1053"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status403</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943553"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-1054"></span><span>        </span><span class="annot"><span class="annottext">String
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
String -&gt; (s, Either RequestException a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectErrorMessage"><span class="hs-identifier hs-var">expectErrorMessage</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="Test.Integration.Framework.TestData.html#errMsg403CannotUpdateThisCosigner"><span class="hs-identifier hs-var">errMsg403CannotUpdateThisCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943553"><span class="hs-identifier hs-var">rPatch</span></a></span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_KEYS_01 - Getting verification keys works for active shared wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943552"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943552"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1057"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943551"><span class="annot"><span class="annottext">walName :: Text
</span><a href="#local-6989586621682943551"><span class="hs-identifier hs-var hs-var">walName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-1058"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943550"><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943550"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO (Text, Payload)
forall (m :: * -&gt; *) a.
(MonadIO m, ToJSON a, MonadFail m) =&gt;
a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var">getAccountWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943551"><span class="hs-identifier hs-var">walName</span></a></span><span>
</span><span id="line-1059"></span><span>        </span><span id="local-6989586621682943549"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943549"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943552"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943550"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1060"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943549"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1061"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1062"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1063"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943548"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943548"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943547"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943547"><span class="hs-identifier hs-var">_activeWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943549"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943546"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943546"><span class="hs-identifier hs-var">paymentKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943552"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943548"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">UtxoExternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">30</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1066"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943544"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943544"><span class="hs-identifier hs-var">stakeKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943552"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943548"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943542"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943542"><span class="hs-identifier hs-var">paymentAddr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943546"><span class="hs-identifier hs-var">paymentKey</span></a></span><span>
</span><span id="line-1069"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;addr_shared_vk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943542"><span class="hs-identifier hs-var">paymentAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943540"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943540"><span class="hs-identifier hs-var">stakeAddr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943544"><span class="hs-identifier hs-var">stakeKey</span></a></span><span>
</span><span id="line-1072"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stake_shared_vk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943540"><span class="hs-identifier hs-var">stakeAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1073"></span><span>
</span><span id="line-1074"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_KEYS_02 - Getting verification keys works for pending shared wallet&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943539"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1075"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943538"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943538"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1076"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943537"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943537"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;,
                               &quot;cosigner#1&quot;,
                               { &quot;active_from&quot;: 120 }
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-1092"></span><span>        </span><span id="local-6989586621682943536"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943536"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943537"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1093"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943536"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1094"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1095"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1096"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943535"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682943534"><span class="annot"><span class="annottext">ApiPendingSharedWallet
</span><a href="#local-6989586621682943534"><span class="hs-identifier hs-var">_pendingWal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943536"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1097"></span><span>
</span><span id="line-1098"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943533"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943533"><span class="hs-identifier hs-var">paymentKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">UtxoExternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1099"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943532"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943532"><span class="hs-identifier hs-var">stakeKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1100"></span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943531"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943531"><span class="hs-identifier hs-var">paymentAddr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943533"><span class="hs-identifier hs-var">paymentKey</span></a></span><span>
</span><span id="line-1102"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;addr_shared_vk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943531"><span class="hs-identifier hs-var">paymentAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1103"></span><span>
</span><span id="line-1104"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943530"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943530"><span class="hs-identifier hs-var">stakeAddr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943532"><span class="hs-identifier hs-var">stakeKey</span></a></span><span>
</span><span id="line-1105"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stake_shared_vk&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943530"><span class="hs-identifier hs-var">stakeAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1106"></span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943529"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943529"><span class="hs-identifier hs-var">paymentKey'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">UtxoExternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943528"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943528"><span class="hs-identifier hs-var">stakeKey'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>
</span><span id="line-1110"></span><span>        </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943529"><span class="hs-identifier hs-var">paymentKey'</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
-&gt; ApiVerificationKeyShared -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943533"><span class="hs-identifier hs-var">paymentKey</span></a></span><span>
</span><span id="line-1111"></span><span>        </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943528"><span class="hs-identifier hs-var">stakeKey'</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
-&gt; ApiVerificationKeyShared -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943532"><span class="hs-identifier hs-var">stakeKey</span></a></span><span>
</span><span id="line-1112"></span><span>
</span><span id="line-1113"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943527"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943527"><span class="hs-identifier hs-var">paymentKeyH</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">UtxoExternal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943526"><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943526"><span class="hs-identifier hs-var">stakeKeyH</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; ResourceT
     IO (Status, Either RequestException ApiVerificationKeyShared)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; Role
-&gt; DerivationIndex
-&gt; Maybe Bool
-&gt; m (Status, Either RequestException ApiVerificationKeyShared)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWalletKey"><span class="hs-identifier hs-var">getSharedWalletKey</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943539"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943535"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>
</span><span id="line-1116"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943525"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943525"><span class="hs-identifier hs-var">paymentAddrH</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943527"><span class="hs-identifier hs-var">paymentKeyH</span></a></span><span>
</span><span id="line-1117"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;addr_shared_vkh&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943525"><span class="hs-identifier hs-var">paymentAddrH</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1118"></span><span>
</span><span id="line-1119"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621682943524"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943524"><span class="hs-identifier hs-var">stakeAddrH</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">toJSON</span></a></span><span> </span><span class="annot"><span class="annottext">ApiVerificationKeyShared
</span><a href="#local-6989586621682943526"><span class="hs-identifier hs-var">stakeKeyH</span></a></span><span>
</span><span id="line-1120"></span><span>        </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.isPrefixOf</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stake_shared_vkh&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943524"><span class="hs-identifier hs-var">stakeAddrH</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1121"></span><span>
</span><span id="line-1122"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_LIST_01 - Created a wallet can be listed&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943523"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943523"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1123"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943522"><span class="annot"><span class="annottext">walName :: Text
</span><a href="#local-6989586621682943522"><span class="hs-identifier hs-var hs-var">walName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-1124"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943521"><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943521"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO (Text, Payload)
forall (m :: * -&gt; *) a.
(MonadIO m, ToJSON a, MonadFail m) =&gt;
a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var">getAccountWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943522"><span class="hs-identifier hs-var">walName</span></a></span><span>
</span><span id="line-1125"></span><span>        </span><span id="local-6989586621682943520"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943520"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943523"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943521"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1126"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943520"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1127"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1128"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1129"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943519"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943519"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943520"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1130"></span><span>
</span><span id="line-1131"></span><span>        </span><span id="local-6989586621682943518"><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943518"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set Text
-&gt; Context
-&gt; ResourceT IO (Status, Either RequestException [ApiSharedWallet])
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Set Text
-&gt; Context -&gt; m (Status, Either RequestException [ApiSharedWallet])
</span><a href="Test.Integration.Framework.DSL.html#listFilteredSharedWallets"><span class="hs-identifier hs-var">listFilteredSharedWallets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Set Text
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943519"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT WalletId
-&gt; ((Text -&gt; Const Text Text)
    -&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId))
-&gt; Text
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Const Text Text)
-&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId)
forall s. HasType (ApiT WalletId) s =&gt; Lens' s Text
</span><a href="Test.Integration.Framework.DSL.html#walletId"><span class="hs-identifier hs-var">walletId</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943523"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1132"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; [(Status,
     Either
       RequestException
       [Either ApiPendingSharedWallet ApiActiveSharedWallet])
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ApiSharedWallet]
 -&gt; [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; Either RequestException [ApiSharedWallet]
-&gt; Either
     RequestException
     [Either ApiPendingSharedWallet ApiActiveSharedWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; [ApiSharedWallet]
-&gt; [Either ApiPendingSharedWallet ApiActiveSharedWallet]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943516"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException [ApiSharedWallet]
 -&gt; Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; (Status, Either RequestException [ApiSharedWallet])
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943518"><span class="hs-identifier hs-var">rl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-1134"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) (xs :: * -&gt; *) a.
(HasCallStack, MonadIO m, Foldable xs) =&gt;
Int -&gt; (Status, Either RequestException (xs a)) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListSize"><span class="hs-identifier hs-var">expectListSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1135"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1136"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Text -&gt; f Text)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Text -&gt; f Text)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; f (ApiT WalletName))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943515"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; f (ApiT WalletName))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Text -&gt; f Text) -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; (Text -&gt; f Text)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; f WalletName)
   -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
(WalletName -&gt; f WalletName)
-&gt; ApiT WalletName -&gt; f (ApiT WalletName)
</span><a href="#local-6989586621682943514"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; f WalletName)
 -&gt; ApiT WalletName -&gt; f (ApiT WalletName))
-&gt; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
-&gt; (Text -&gt; f Text)
-&gt; ApiT WalletName
-&gt; f (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot; ((Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName)
(Text -&gt; f Text) -&gt; WalletName -&gt; f WalletName
</span><a href="#local-6989586621682943513"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943522"><span class="hs-identifier hs-var">walName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet) Word32
-&gt; (Word32 -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1139"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Word32 -&gt; f Word32)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;addressPoolGap&quot;
  ((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943512"><span class="hs-var">#addressPoolGap</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Word32 -&gt; f Word32)
    -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((AddressPoolGap -&gt; f AddressPoolGap)
   -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
(AddressPoolGap -&gt; f AddressPoolGap)
-&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap)
</span><a href="#local-6989586621682943511"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((AddressPoolGap -&gt; f AddressPoolGap)
 -&gt; ApiT AddressPoolGap -&gt; f (ApiT AddressPoolGap))
-&gt; ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
-&gt; (Word32 -&gt; f Word32)
-&gt; ApiT AddressPoolGap
-&gt; f (ApiT AddressPoolGap)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getAddressPoolGap&quot;
  ((Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap)
(Word32 -&gt; f Word32) -&gt; AddressPoolGap -&gt; f AddressPoolGap
</span><a href="#local-6989586621682943510"><span class="hs-var">#getAddressPoolGap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; Word32 -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">20</span></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1142"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943509"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943508"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1143"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943507"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943506"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943505"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;reward&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943504"><span class="hs-var">#reward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943503"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;total&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943502"><span class="hs-var">#total</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (ApiT TokenMap)
-&gt; (ApiT TokenMap -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assets&quot;
  ((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943501"><span class="hs-var">#assets</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((ApiT TokenMap -&gt; f (ApiT TokenMap))
    -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
-&gt; (ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((ApiT TokenMap -&gt; f (ApiT TokenMap))
   -&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance)
(ApiT TokenMap -&gt; f (ApiT TokenMap))
-&gt; ApiWalletAssetsBalance -&gt; f ApiWalletAssetsBalance
</span><a href="#local-6989586621682943500"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiT TokenMap -&gt; ApiT TokenMap -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT TokenMap
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1147"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiWalletDelegation
-&gt; (ApiWalletDelegation -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegation&quot;
  ((ApiWalletDelegation -&gt; f ApiWalletDelegation)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletDelegation -&gt; f ApiWalletDelegation)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943499"><span class="hs-var">#delegation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWalletDelegation -&gt; ApiWalletDelegation -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">[(Maybe (ApiT PoolId), ApiEpochInfo)] -&gt; ApiWalletDelegation
</span><a href="Test.Integration.Framework.DSL.html#notDelegating"><span class="hs-identifier hs-var">notDelegating</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     (Maybe ScriptTemplate)
-&gt; (Maybe ScriptTemplate -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;delegationScriptTemplate&quot;
  ((Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(Maybe ScriptTemplate -&gt; f (Maybe ScriptTemplate))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943498"><span class="hs-var">#delegationScriptTemplate</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ScriptTemplate -&gt; Maybe ScriptTemplate -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal'
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     DerivationIndex
-&gt; (DerivationIndex -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      [Either ApiPendingSharedWallet ApiActiveSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;accountIndex&quot;
  ((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943497"><span class="hs-var">#accountIndex</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((DerivationIndex -&gt; f DerivationIndex)
    -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
-&gt; (DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((DerivationIndex -&gt; f DerivationIndex)
   -&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex))
(DerivationIndex -&gt; f DerivationIndex)
-&gt; ApiT DerivationIndex -&gt; f (ApiT DerivationIndex)
</span><a href="#local-6989586621682943496"><span class="hs-var">#getApiT</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DerivationIndex -&gt; DerivationIndex -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">2147483678</span></span><span class="hs-special">)</span><span>
</span><span id="line-1150"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1151"></span><span>
</span><span id="line-1152"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_LIST_01 - Wallets are listed from oldest to newest&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943495"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943495"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1153"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943494"><span class="annot"><span class="annottext">walNames :: [Text]
</span><a href="#local-6989586621682943494"><span class="hs-identifier hs-var hs-var">walNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;2&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;3&quot;</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1154"></span><span>        </span><span id="local-6989586621682943493"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943493"><span class="hs-identifier hs-var">wids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; (Text -&gt; ResourceT IO Text) -&gt; ResourceT IO [Text]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943494"><span class="hs-identifier hs-var">walNames</span></a></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; ResourceT IO Text) -&gt; ResourceT IO [Text])
-&gt; (Text -&gt; ResourceT IO Text) -&gt; ResourceT IO [Text]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943492"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943492"><span class="hs-identifier hs-var">walName</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1155"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943491"><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943491"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO (Text, Payload)
forall (m :: * -&gt; *) a.
(MonadIO m, ToJSON a, MonadFail m) =&gt;
a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var">getAccountWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943492"><span class="hs-identifier hs-var">walName</span></a></span><span>
</span><span id="line-1156"></span><span>            </span><span id="local-6989586621682943490"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943490"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943495"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943491"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1157"></span><span>            </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943490"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1158"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1159"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-1160"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943489"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943489"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943490"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1161"></span><span>            </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943489"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT WalletId
-&gt; ((Text -&gt; Const Text Text)
    -&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId))
-&gt; Text
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Const Text Text)
-&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId)
forall s. HasType (ApiT WalletId) s =&gt; Lens' s Text
</span><a href="Test.Integration.Framework.DSL.html#walletId"><span class="hs-identifier hs-var">walletId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1162"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943488"><span class="annot"><span class="annottext">name :: ApiSharedWallet -&gt; Maybe Text
</span><a href="#local-6989586621682943488"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiSharedWallet
-&gt; ((Text -&gt; Const (First Text) Text)
    -&gt; ApiSharedWallet -&gt; Const (First Text) ApiSharedWallet)
-&gt; Maybe Text
forall s a.
s
-&gt; ((a -&gt; Const (First a) a) -&gt; s -&gt; Const (First a) s) -&gt; Maybe a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet -&gt; Const (First Text) ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet -&gt; Const (First Text) ApiSharedWallet
</span><a href="#local-6989586621682943487"><span class="hs-var">#wallet</span></a></span><span> </span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet -&gt; Const (First Text) ApiSharedWallet)
-&gt; ((Text -&gt; Const (First Text) Text)
    -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Text -&gt; Const (First Text) Text)
-&gt; ApiSharedWallet
-&gt; Const (First Text) ApiSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; Const (First Text) ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; Const
     (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet
  -&gt; Const (First Text) ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Text -&gt; Const (First Text) Text)
    -&gt; ApiActiveSharedWallet
    -&gt; Const (First Text) ApiActiveSharedWallet)
-&gt; (Text -&gt; Const (First Text) Text)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; Const
     (First Text) (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;name&quot;
  ((ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
   -&gt; ApiActiveSharedWallet
   -&gt; Const (First Text) ApiActiveSharedWallet)
(ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
-&gt; ApiActiveSharedWallet
-&gt; Const (First Text) ApiActiveSharedWallet
</span><a href="#local-6989586621682943486"><span class="hs-var">#name</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
 -&gt; ApiActiveSharedWallet
 -&gt; Const (First Text) ApiActiveSharedWallet)
-&gt; ((Text -&gt; Const (First Text) Text)
    -&gt; ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
-&gt; (Text -&gt; Const (First Text) Text)
-&gt; ApiActiveSharedWallet
-&gt; Const (First Text) ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getApiT&quot;
  ((WalletName -&gt; Const (First Text) WalletName)
   -&gt; ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
(WalletName -&gt; Const (First Text) WalletName)
-&gt; ApiT WalletName -&gt; Const (First Text) (ApiT WalletName)
</span><a href="#local-6989586621682943485"><span class="hs-var">#getApiT</span></a></span><span> </span><span class="annot"><span class="annottext">((WalletName -&gt; Const (First Text) WalletName)
 -&gt; ApiT WalletName -&gt; Const (First Text) (ApiT WalletName))
-&gt; ((Text -&gt; Const (First Text) Text)
    -&gt; WalletName -&gt; Const (First Text) WalletName)
-&gt; (Text -&gt; Const (First Text) Text)
-&gt; ApiT WalletName
-&gt; Const (First Text) (ApiT WalletName)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;getWalletName&quot;
  ((Text -&gt; Const (First Text) Text)
   -&gt; WalletName -&gt; Const (First Text) WalletName)
(Text -&gt; Const (First Text) Text)
-&gt; WalletName -&gt; Const (First Text) WalletName
</span><a href="#local-6989586621682943484"><span class="hs-var">#getWalletName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1163"></span><span>        </span><span id="local-6989586621682943483"><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943483"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set Text
-&gt; Context
-&gt; ResourceT IO (Status, Either RequestException [ApiSharedWallet])
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Set Text
-&gt; Context -&gt; m (Status, Either RequestException [ApiSharedWallet])
</span><a href="Test.Integration.Framework.DSL.html#listFilteredSharedWallets"><span class="hs-identifier hs-var">listFilteredSharedWallets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Text] -&gt; Set Text
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621682943493"><span class="hs-identifier hs-var">wids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943495"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1164"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException [Maybe Text])
-&gt; [(Status, Either RequestException [Maybe Text])
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([ApiSharedWallet] -&gt; [Maybe Text])
-&gt; Either RequestException [ApiSharedWallet]
-&gt; Either RequestException [Maybe Text]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet -&gt; Maybe Text)
-&gt; [ApiSharedWallet] -&gt; [Maybe Text]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; Maybe Text
</span><a href="#local-6989586621682943488"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException [ApiSharedWallet]
 -&gt; Either RequestException [Maybe Text])
-&gt; (Status, Either RequestException [ApiSharedWallet])
-&gt; (Status, Either RequestException [Maybe Text])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943483"><span class="hs-identifier hs-var">rl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1165"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException [Maybe Text])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-1166"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Status, Either RequestException [Maybe Text])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) (xs :: * -&gt; *) a.
(HasCallStack, MonadIO m, Foldable xs) =&gt;
Int -&gt; (Status, Either RequestException (xs a)) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListSize"><span class="hs-identifier hs-var">expectListSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-1167"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal' (Maybe Text) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status, Either RequestException [Maybe Text])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Traversal' (Maybe Text) Text
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;1&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal' (Maybe Text) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status, Either RequestException [Maybe Text])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Traversal' (Maybe Text) Text
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;2&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1169"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; Traversal' (Maybe Text) Text
-&gt; (Text -&gt; IO ())
-&gt; (Status, Either RequestException [Maybe Text])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Int
-&gt; Traversal' s a
-&gt; (a -&gt; IO ())
-&gt; (Status, Either RequestException [s])
-&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListField"><span class="hs-identifier hs-var">expectListField</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Traversal' (Maybe Text) Text
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;3&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1170"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_LIST_02 - Deleted wallet not listed&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943481"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943481"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1173"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943480"><span class="annot"><span class="annottext">walName :: Text
</span><a href="#local-6989586621682943480"><span class="hs-identifier hs-var hs-var">walName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Shared Wallet&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-1174"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943479"><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943479"><span class="hs-identifier hs-var">payload</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ResourceT IO (Text, Payload)
forall (m :: * -&gt; *) a.
(MonadIO m, ToJSON a, MonadFail m) =&gt;
a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var">getAccountWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943480"><span class="hs-identifier hs-var">walName</span></a></span><span>
</span><span id="line-1175"></span><span>        </span><span id="local-6989586621682943478"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943478"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943481"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943479"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1176"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
-&gt; [(Status, Either RequestException ApiSharedWallet)
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943478"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1177"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1178"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1179"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943477"><span class="annot"><span class="annottext">wal :: ApiSharedWallet
</span><a href="#local-6989586621682943477"><span class="hs-identifier hs-var hs-var">wal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943478"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1180"></span><span>
</span><span id="line-1181"></span><span>        </span><span id="local-6989586621682943476"><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943476"><span class="hs-identifier hs-var">rDel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; ResourceT IO (Status, Either RequestException Value)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet -&gt; m (Status, Either RequestException Value)
</span><a href="Test.Integration.Framework.DSL.html#deleteSharedWallet"><span class="hs-identifier hs-var">deleteSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943481"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943477"><span class="hs-identifier hs-var">wal</span></a></span><span>
</span><span id="line-1182"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException Value) -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status204</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException Value)
</span><a href="#local-6989586621682943476"><span class="hs-identifier hs-var">rDel</span></a></span><span>
</span><span id="line-1183"></span><span>
</span><span id="line-1184"></span><span>        </span><span id="local-6989586621682943475"><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943475"><span class="hs-identifier hs-var">rl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set Text
-&gt; Context
-&gt; ResourceT IO (Status, Either RequestException [ApiSharedWallet])
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Set Text
-&gt; Context -&gt; m (Status, Either RequestException [ApiSharedWallet])
</span><a href="Test.Integration.Framework.DSL.html#listFilteredSharedWallets"><span class="hs-identifier hs-var">listFilteredSharedWallets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Set Text
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Set Text) -&gt; Text -&gt; Set Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet -&gt; ApiT WalletId
</span><a href="Test.Integration.Framework.DSL.html#getWalletIdFromSharedWallet"><span class="hs-identifier hs-var">getWalletIdFromSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943477"><span class="hs-identifier hs-var">wal</span></a></span><span> </span><span class="annot"><span class="annottext">ApiT WalletId
-&gt; ((Text -&gt; Const Text Text)
    -&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId))
-&gt; Text
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Const Text Text)
-&gt; ApiT WalletId -&gt; Const Text (ApiT WalletId)
forall s. HasType (ApiT WalletId) s =&gt; Lens' s Text
</span><a href="Test.Integration.Framework.DSL.html#walletId"><span class="hs-identifier hs-var">walletId</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943481"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1185"></span><span>        </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
-&gt; [(Status, Either RequestException [ApiSharedWallet])
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiSharedWallet])
</span><a href="#local-6989586621682943475"><span class="hs-identifier hs-var">rl</span></a></span><span>
</span><span id="line-1186"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException [ApiSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-1187"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; (Status, Either RequestException [ApiSharedWallet])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) (xs :: * -&gt; *) a.
(HasCallStack, MonadIO m, Foldable xs) =&gt;
Int -&gt; (Status, Either RequestException (xs a)) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectListSize"><span class="hs-identifier hs-var">expectListSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1188"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; ActionWith Context -&gt; SpecWith Context
forall ctx.
HasCallStack =&gt;
String -&gt; ActionWith ctx -&gt; SpecWith ctx
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">it</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SHARED_WALLETS_DISCOVER_01 - Shared wallets can discover its address&quot;</span></span><span> </span><span class="annot"><span class="annottext">(ActionWith Context -&gt; SpecWith Context)
-&gt; ActionWith Context -&gt; SpecWith Context
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682943474"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ResourceT IO () -&gt; IO ()
forall (m :: * -&gt; *) a. MonadUnliftIO m =&gt; ResourceT m a -&gt; m a
</span><a href="../../../../resourcet/html/src"><span class="hs-identifier hs-var">runResourceT</span></a></span><span> </span><span class="annot"><span class="annottext">(ResourceT IO () -&gt; IO ()) -&gt; ResourceT IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1191"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943473"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943473"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; ResourceT IO [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1192"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943472"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943472"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                &quot;name&quot;: &quot;Shared Wallet&quot;,
                &quot;account_public_key&quot;: #{accXPubTxt},
                &quot;account_index&quot;: &quot;10H&quot;,
                &quot;payment_script_template&quot;:
                    { &quot;cosigners&quot;:
                        { &quot;cosigner#0&quot;: #{accXPubTxt} },
                      &quot;template&quot;:
                          { &quot;all&quot;:
                             [ &quot;cosigner#0&quot;
                             ]
                          }
                    }
                } |]</span></span><span>
</span><span id="line-1206"></span><span>        </span><span id="local-6989586621682943471"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943471"><span class="hs-identifier hs-var">rPost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; Headers
-&gt; Payload
-&gt; ResourceT m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#postSharedWallet"><span class="hs-identifier hs-var">postSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943472"><span class="hs-identifier hs-var">payload</span></a></span><span>
</span><span id="line-1207"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943470"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943471"><span class="hs-identifier hs-var">rPost</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1208"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status201</span></a></span><span>
</span><span id="line-1209"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943469"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943468"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1210"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1211"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943467"><span class="annot"><span class="annottext">walShared :: ApiSharedWallet
</span><a href="#local-6989586621682943467"><span class="hs-identifier hs-var">walShared</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiSharedWallet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621682943466"><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943466"><span class="hs-identifier hs-var">wal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' ApiSharedWallet ApiSharedWallet
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; ApiSharedWallet
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' ApiSharedWallet ApiSharedWallet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943471"><span class="hs-identifier hs-var">rPost</span></a></span><span>
</span><span id="line-1212"></span><span>
</span><span id="line-1213"></span><span>        </span><span id="local-6989586621682943465"><span class="annot"><span class="annottext">(Status, Either RequestException [ApiAddress n])
</span><a href="#local-6989586621682943465"><span class="hs-identifier hs-var">rAddr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; ResourceT IO (Status, Either RequestException [ApiAddress n])
forall a (m :: * -&gt; *) s.
(FromJSON a, MonadIO m, MonadUnliftIO m,
 HasType (URI, Manager) s) =&gt;
s
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException a)
</span><a href="Test.Integration.Framework.Request.html#request"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1214"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiActiveSharedWallet -&gt; (ByteString, Text)
forall (style :: WalletStyle) w.
(HasType (ApiT WalletId) w, Discriminate style) =&gt;
w -&gt; (ByteString, Text)
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Link.listAddresses</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Shared</span></a></span><span> </span><span class="annot"><span class="annottext">ApiActiveSharedWallet
</span><a href="#local-6989586621682943466"><span class="hs-identifier hs-var">wal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="Test.Integration.Framework.Request.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-1215"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException [ApiAddress n])
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiAddress n])
</span><a href="#local-6989586621682943465"><span class="hs-identifier hs-var">rAddr</span></a></span><span>
</span><span id="line-1216"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943463"><span class="annot"><span class="annottext">sharedAddrs :: [ApiAddress n]
</span><a href="#local-6989586621682943463"><span class="hs-identifier hs-var hs-var">sharedAddrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' [ApiAddress n] [ApiAddress n]
-&gt; (Status, Either RequestException [ApiAddress n])
-&gt; [ApiAddress n]
forall s a.
HasCallStack =&gt;
Lens' s a -&gt; (Status, Either RequestException s) -&gt; a
</span><a href="Test.Integration.Framework.DSL.html#getFromResponse"><span class="hs-identifier hs-var">getFromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
Lens' [ApiAddress n] [ApiAddress n]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException [ApiAddress n])
</span><a href="#local-6989586621682943465"><span class="hs-identifier hs-var">rAddr</span></a></span><span>
</span><span id="line-1217"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943462"><span class="annot"><span class="annottext">destination :: (ApiT Address, Proxy n)
</span><a href="#local-6989586621682943462"><span class="hs-identifier hs-var hs-var">destination</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ApiAddress n]
</span><a href="#local-6989586621682943463"><span class="hs-identifier hs-var">sharedAddrs</span></a></span><span> </span><span class="annot"><span class="annottext">[ApiAddress n] -&gt; Int -&gt; ApiAddress n
forall a. [a] -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ApiAddress n
-&gt; (((ApiT Address, Proxy n)
     -&gt; Const (ApiT Address, Proxy n) (ApiT Address, Proxy n))
    -&gt; ApiAddress n -&gt; Const (ApiT Address, Proxy n) (ApiAddress n))
-&gt; (ApiT Address, Proxy n)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;id&quot;
  (((ApiT Address, Proxy n)
    -&gt; Const (ApiT Address, Proxy n) (ApiT Address, Proxy n))
   -&gt; ApiAddress n -&gt; Const (ApiT Address, Proxy n) (ApiAddress n))
((ApiT Address, Proxy n)
 -&gt; Const (ApiT Address, Proxy n) (ApiT Address, Proxy n))
-&gt; ApiAddress n -&gt; Const (ApiT Address, Proxy n) (ApiAddress n)
</span><a href="#local-6989586621682943460"><span class="hs-var">#id</span></a></span><span>
</span><span id="line-1218"></span><span>
</span><span id="line-1219"></span><span>        </span><span id="local-6989586621682943459"><span class="annot"><span class="annottext">ApiWallet
</span><a href="#local-6989586621682943459"><span class="hs-identifier hs-var">wShelley</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context -&gt; ResourceT IO ApiWallet
forall (m :: * -&gt; *). MonadIO m =&gt; Context -&gt; ResourceT m ApiWallet
</span><a href="Test.Integration.Framework.DSL.html#fixtureWallet"><span class="hs-identifier hs-var">fixtureWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1220"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943458"><span class="annot"><span class="annottext">amt :: Natural
</span><a href="#local-6989586621682943458"><span class="hs-identifier hs-var hs-var">amt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ApiEra -&gt; Natural
</span><a href="Test.Integration.Framework.DSL.html#minUTxOValue"><span class="hs-identifier hs-var">minUTxOValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Context -&gt; ApiEra
</span><a href="Test.Integration.Framework.Context.html#_mainEra"><span class="hs-identifier hs-var hs-var">_mainEra</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1221"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943456"><span class="annot"><span class="annottext">payloadTx :: Payload
</span><a href="#local-6989586621682943456"><span class="hs-identifier hs-var hs-var">payloadTx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json|{
                &quot;payments&quot;: [{
                    &quot;address&quot;: #{destination},
                    &quot;amount&quot;: {
                        &quot;quantity&quot;: #{amt},
                        &quot;unit&quot;: &quot;lovelace&quot;
                    }
                }],
                &quot;passphrase&quot;: #{fixturePassphrase}
            }|]</span></span><span>
</span><span id="line-1231"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiFee</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Quantity</span></a></span><span> </span><span id="local-6989586621682943454"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682943454"><span class="hs-identifier hs-var">feeMax</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Quantity &quot;lovelace&quot; Natural]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; (ByteString, Text) -&gt; Payload -&gt; ResourceT IO (Status, ApiFee)
forall a (m :: * -&gt; *).
(FromJSON a, MonadIO m, MonadUnliftIO m) =&gt;
Context -&gt; (ByteString, Text) -&gt; Payload -&gt; m (Status, a)
</span><a href="Test.Integration.Framework.Request.html#unsafeRequest"><span class="hs-identifier hs-var">unsafeRequest</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1232"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWallet -&gt; (ByteString, Text)
forall (style :: WalletStyle) w.
(HasCallStack, HasType (ApiT WalletId) w, Discriminate style) =&gt;
w -&gt; (ByteString, Text)
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Link.getTransactionFeeOld</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">ApiWallet
</span><a href="#local-6989586621682943459"><span class="hs-identifier hs-var">wShelley</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943456"><span class="hs-identifier hs-var">payloadTx</span></a></span><span>
</span><span id="line-1233"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943452"><span class="annot"><span class="annottext">ep :: ApiWallet -&gt; (ByteString, Text)
</span><a href="#local-6989586621682943452"><span class="hs-identifier hs-var hs-var">ep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall w.
(HasCallStack, HasType (ApiT WalletId) w, Discriminate 'Shelley) =&gt;
w -&gt; (ByteString, Text)
forall (style :: WalletStyle) w.
(HasCallStack, HasType (ApiT WalletId) w, Discriminate style) =&gt;
w -&gt; (ByteString, Text)
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Link.createTransactionOld</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Shelley</span></a></span><span>
</span><span id="line-1234"></span><span>        </span><span id="local-6989586621682943450"><span class="annot"><span class="annottext">(Status, Either RequestException (ApiTransaction n))
</span><a href="#local-6989586621682943450"><span class="hs-identifier hs-var">rTx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; ResourceT
     IO (Status, Either RequestException (ApiTransaction n))
forall a (m :: * -&gt; *) s.
(FromJSON a, MonadIO m, MonadUnliftIO m,
 HasType (URI, Manager) s) =&gt;
s
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException a)
</span><a href="Test.Integration.Framework.Request.html#request"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiTransaction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682943892"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWallet -&gt; (ByteString, Text)
</span><a href="#local-6989586621682943452"><span class="hs-identifier hs-var">ep</span></a></span><span> </span><span class="annot"><span class="annottext">ApiWallet
</span><a href="#local-6989586621682943459"><span class="hs-identifier hs-var">wShelley</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943456"><span class="hs-identifier hs-var">payloadTx</span></a></span><span>
</span><span id="line-1235"></span><span>        </span><span class="annot"><span class="annottext">Status
-&gt; (Status, Either RequestException (ApiTransaction n))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status202</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException (ApiTransaction n))
</span><a href="#local-6989586621682943450"><span class="hs-identifier hs-var">rTx</span></a></span><span>
</span><span id="line-1236"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO () -&gt; ResourceT IO ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; String -&gt; IO a -&gt; m a
</span><a href="Test.Integration.Framework.DSL.html#eventually"><span class="hs-identifier hs-var">eventually</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;wShelley balance is decreased&quot;</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ResourceT IO ()) -&gt; IO () -&gt; ResourceT IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1237"></span><span>            </span><span id="local-6989586621682943449"><span class="annot"><span class="annottext">(Status, Either RequestException ApiWallet)
</span><a href="#local-6989586621682943449"><span class="hs-identifier hs-var">ra</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; IO (Status, Either RequestException ApiWallet)
forall a (m :: * -&gt; *) s.
(FromJSON a, MonadIO m, MonadUnliftIO m,
 HasType (URI, Manager) s) =&gt;
s
-&gt; (ByteString, Text)
-&gt; Headers
-&gt; Payload
-&gt; m (Status, Either RequestException a)
</span><a href="Test.Integration.Framework.Request.html#request"><span class="hs-identifier hs-var">request</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">ApiWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span>
</span><span id="line-1238"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ApiWallet -&gt; (ByteString, Text)
forall (style :: WalletStyle) w.
(Discriminate style, HasType (ApiT WalletId) w) =&gt;
w -&gt; (ByteString, Text)
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Link.getWallet</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-type">Shelley</span></a></span><span> </span><span class="annot"><span class="annottext">ApiWallet
</span><a href="#local-6989586621682943459"><span class="hs-identifier hs-var">wShelley</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Headers
</span><a href="Test.Integration.Framework.Request.html#Default"><span class="hs-identifier hs-var">Default</span></a></span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="Test.Integration.Framework.Request.html#Empty"><span class="hs-identifier hs-var">Empty</span></a></span><span>
</span><span id="line-1239"></span><span>            </span><span class="annot"><span class="annottext">Traversal' ApiWallet (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status, Either RequestException ApiWallet)
-&gt; IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span>
</span><span id="line-1240"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiWallet -&gt; f ApiWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiWallet -&gt; f ApiWallet
</span><a href="#local-6989586621682943447"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiWallet -&gt; f ApiWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWallet
-&gt; f ApiWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943446"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1241"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural
</span><a href="Test.Integration.Framework.DSL.html#faucetAmt"><span class="hs-identifier hs-var">faucetAmt</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682943454"><span class="hs-identifier hs-var">feeMax</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Natural
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682943458"><span class="hs-identifier hs-var">amt</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiWallet)
</span><a href="#local-6989586621682943449"><span class="hs-identifier hs-var">ra</span></a></span><span>
</span><span id="line-1242"></span><span>
</span><span id="line-1243"></span><span>        </span><span id="local-6989586621682943445"><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943445"><span class="hs-identifier hs-var">rWal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Context
-&gt; ApiSharedWallet
-&gt; ResourceT IO (Status, Either RequestException ApiSharedWallet)
forall (m :: * -&gt; *).
(MonadIO m, MonadUnliftIO m) =&gt;
Context
-&gt; ApiSharedWallet
-&gt; m (Status, Either RequestException ApiSharedWallet)
</span><a href="Test.Integration.Framework.DSL.html#getSharedWallet"><span class="hs-identifier hs-var">getSharedWallet</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621682943474"><span class="hs-identifier hs-var">ctx</span></a></span><span> </span><span class="annot"><span class="annottext">ApiSharedWallet
</span><a href="#local-6989586621682943467"><span class="hs-identifier hs-var">walShared</span></a></span><span>
</span><span id="line-1244"></span><span>        </span><span class="annot"><span class="annottext">(Status,
 Either
   RequestException
   (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; [(Status,
     Either
       RequestException
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
    -&gt; ResourceT IO ()]
-&gt; ResourceT IO ()
forall a (m :: * -&gt; *).
(Show a, MonadUnliftIO m) =&gt;
a -&gt; [a -&gt; m ()] -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiSharedWallet
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet)
-&gt; Either RequestException ApiSharedWallet
-&gt; Either
     RequestException
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Either ApiPendingSharedWallet ApiActiveSharedWallet
  -&gt; Const
       (Either ApiPendingSharedWallet ApiActiveSharedWallet)
       (Either ApiPendingSharedWallet ApiActiveSharedWallet))
 -&gt; ApiSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      ApiSharedWallet)
-&gt; ApiSharedWallet
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;wallet&quot;
  ((Either ApiPendingSharedWallet ApiActiveSharedWallet
    -&gt; Const
         (Either ApiPendingSharedWallet ApiActiveSharedWallet)
         (Either ApiPendingSharedWallet ApiActiveSharedWallet))
   -&gt; ApiSharedWallet
   -&gt; Const
        (Either ApiPendingSharedWallet ApiActiveSharedWallet)
        ApiSharedWallet)
(Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; Const
      (Either ApiPendingSharedWallet ApiActiveSharedWallet)
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ApiSharedWallet
-&gt; Const
     (Either ApiPendingSharedWallet ApiActiveSharedWallet)
     ApiSharedWallet
</span><a href="#local-6989586621682943444"><span class="hs-var">#wallet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either RequestException ApiSharedWallet
 -&gt; Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; (Status, Either RequestException ApiSharedWallet)
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Status, Either RequestException ApiSharedWallet)
</span><a href="#local-6989586621682943445"><span class="hs-identifier hs-var">rWal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1245"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Status
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadUnliftIO m, Show a) =&gt;
Status -&gt; (Status, a) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectResponseCode"><span class="hs-identifier hs-var">expectResponseCode</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="../../../../http-types/html/src"><span class="hs-identifier hs-var">HTTP.status200</span></a></span><span>
</span><span id="line-1246"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Traversal'
  (Either ApiPendingSharedWallet ApiActiveSharedWallet)
  (Quantity &quot;lovelace&quot; Natural)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; IO ())
-&gt; (Status,
    Either
      RequestException
      (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ResourceT IO ()
forall (m :: * -&gt; *) a s.
(HasCallStack, MonadIO m, Show a) =&gt;
Traversal' s a
-&gt; (a -&gt; IO ()) -&gt; (Status, Either RequestException s) -&gt; m ()
</span><a href="Test.Integration.Framework.DSL.html#expectField"><span class="hs-identifier hs-var">expectField</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
 -&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
 -&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet))
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; Either ApiPendingSharedWallet ApiActiveSharedWallet
-&gt; f (Either ApiPendingSharedWallet ApiActiveSharedWallet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;balance&quot;
  ((ApiWalletBalance -&gt; f ApiWalletBalance)
   -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
(ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet
</span><a href="#local-6989586621682943443"><span class="hs-var">#balance</span></a></span><span> </span><span class="annot"><span class="annottext">((ApiWalletBalance -&gt; f ApiWalletBalance)
 -&gt; ApiActiveSharedWallet -&gt; f ApiActiveSharedWallet)
-&gt; ((Quantity &quot;lovelace&quot; Natural
     -&gt; f (Quantity &quot;lovelace&quot; Natural))
    -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
-&gt; (Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiActiveSharedWallet
-&gt; f ApiActiveSharedWallet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;available&quot;
  ((Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
   -&gt; ApiWalletBalance -&gt; f ApiWalletBalance)
(Quantity &quot;lovelace&quot; Natural -&gt; f (Quantity &quot;lovelace&quot; Natural))
-&gt; ApiWalletBalance -&gt; f ApiWalletBalance
</span><a href="#local-6989586621682943442"><span class="hs-var">#available</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Quantity &quot;lovelace&quot; Natural -&gt; Quantity &quot;lovelace&quot; Natural -&gt; IO ()
forall (m :: * -&gt; *) a.
(HasCallStack, MonadIO m, Show a, Eq a) =&gt;
a -&gt; a -&gt; m ()
</span><a href="../../../../hspec-expectations-lifted/html/src"><span class="hs-operator hs-var">`shouldBe`</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Quantity &quot;lovelace&quot; Natural
forall (unit :: Symbol) a. a -&gt; Quantity unit a
</span><a href="../../../../cardano-wallet-core/html/src"><span class="hs-identifier hs-var">Quantity</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682943458"><span class="hs-identifier hs-var">amt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1247"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-1248"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1249"></span><span>     </span><span id="local-6989586621682943649"><span class="annot"><span class="annottext">getAccountWallet :: a -&gt; m (Text, Payload)
</span><a href="#local-6989586621682943649"><span class="hs-identifier hs-var hs-var">getAccountWallet</span></a></span></span><span> </span><span id="local-6989586621682943441"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682943441"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1250"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682943440"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943440"><span class="hs-identifier hs-var">accXPubTxt</span></a></span></span><span class="hs-special">)</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[(XPub, Text)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO [(XPub, Text)] -&gt; m [(XPub, Text)]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO [(XPub, Text)] -&gt; m [(XPub, Text)])
-&gt; IO [(XPub, Text)] -&gt; m [(XPub, Text)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO [(XPub, Text)]
</span><a href="Test.Integration.Framework.DSL.html#genXPubs"><span class="hs-identifier hs-var">genXPubs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1251"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682943439"><span class="annot"><span class="annottext">payload :: Payload
</span><a href="#local-6989586621682943439"><span class="hs-identifier hs-var hs-var">payload</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Payload
</span><a href="Test.Integration.Framework.Request.html#Json"><span class="hs-identifier hs-var">Json</span></a></span><span> </span><span class="annot"><span class="">[json| {
                  &quot;name&quot;: #{name},
                  &quot;account_public_key&quot;: #{accXPubTxt},
                  &quot;account_index&quot;: &quot;30H&quot;,
                  &quot;payment_script_template&quot;:
                      { &quot;cosigners&quot;:
                          { &quot;cosigner#0&quot;: #{accXPubTxt} },
                        &quot;template&quot;:
                            { &quot;all&quot;:
                               [ &quot;cosigner#0&quot;,
                                 { &quot;active_from&quot;: 120 }
                               ]
                            }
                      }
                  } |]</span></span><span>
</span><span id="line-1266"></span><span>          </span><span class="annot"><span class="annottext">(Text, Payload) -&gt; m (Text, Payload)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682943440"><span class="hs-identifier hs-var">accXPubTxt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Payload
</span><a href="#local-6989586621682943439"><span class="hs-identifier hs-var">payload</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1267"></span></pre></body></html>