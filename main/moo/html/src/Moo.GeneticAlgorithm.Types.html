<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses, FlexibleInstances, GADTs, ExistentialQuantification #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Moo.GeneticAlgorithm.Types</span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-5"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Data structures</span></span><span>
</span><span id="line-6"></span><span>      </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier">Genome</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier">Objective</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier">Phenotype</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier">Population</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GenomeState"><span class="hs-identifier">GenomeState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#takeObjectiveValue"><span class="hs-identifier">takeObjectiveValue</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><span class="hs-comment">-- * GA operators</span></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ProblemType"><span class="hs-identifier">ProblemType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ObjectiveFunction"><span class="hs-identifier">ObjectiveFunction</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#SelectionOp"><span class="hs-identifier">SelectionOp</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier">CrossoverOp</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#MutationOp"><span class="hs-identifier">MutationOp</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Dummy operators</span></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#noMutation"><span class="hs-identifier">noMutation</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#noCrossover"><span class="hs-identifier">noCrossover</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Life cycle</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier">StepGA</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier">Cond</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#PopulationState"><span class="hs-identifier">PopulationState</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepResult"><span class="hs-identifier">StepResult</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Random</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../parallel/html/src"><span class="hs-identifier">Control.Parallel.Strategies</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../parallel/html/src"><span class="hs-identifier">parMap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../parallel/html/src"><span class="hs-identifier">rseq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | A genetic representation of an individual solution.</span><span>
</span><span id="line-32"></span><span class="hs-keyword">type</span><span> </span><span id="Genome"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-var">Genome</span></a></span></span><span> </span><span id="local-6989586621679067797"><span class="annot"><a href="#local-6989586621679067797"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | A measure of the observed performance. It may be called cost</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- for minimization problems, or fitness for maximization problems.</span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="Objective"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-var">Objective</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | A genome associated with its observed 'Objective' value.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="Phenotype"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier hs-var">Phenotype</span></a></span></span><span> </span><span id="local-6989586621679067796"><span class="annot"><a href="#local-6989586621679067796"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067796"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | An entire population of observed 'Phenotype's.</span><span>
</span><span id="line-42"></span><span class="hs-keyword">type</span><span> </span><span id="Population"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-var">Population</span></a></span></span><span> </span><span id="local-6989586621679067795"><span class="annot"><a href="#local-6989586621679067795"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier hs-type">Phenotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | 'takeGenome' extracts a raw genome from any type which embeds it.</span><span>
</span><span id="line-46"></span><span class="hs-keyword">class</span><span> </span><span id="GenomeState"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GenomeState"><span class="hs-identifier hs-var">GenomeState</span></a></span></span><span> </span><span id="local-6989586621679067852"><span class="annot"><a href="#local-6989586621679067852"><span class="hs-identifier hs-type">gt</span></a></span></span><span> </span><span id="local-6989586621679067851"><span class="annot"><a href="#local-6989586621679067851"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>    </span><span id="takeGenome"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#takeGenome"><span class="hs-identifier hs-type">takeGenome</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679067852"><span class="hs-identifier hs-type">gt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067851"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span id="local-6989586621679067792"><span id="local-6989586621679067793"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067793"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067792"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GenomeState"><span class="hs-identifier hs-type">GenomeState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067793"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679067792"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621679067789"><span class="annot"><span class="annottext">takeGenome :: Genome a1 -&gt; Genome a2
</span><a href="#local-6989586621679067789"><span class="hs-identifier hs-var hs-var hs-var hs-var">takeGenome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome a1 -&gt; Genome a2
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span id="local-6989586621679067786"><span id="local-6989586621679067787"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067787"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067786"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GenomeState"><span class="hs-identifier hs-type">GenomeState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier hs-type">Phenotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067787"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679067786"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>    </span><span id="local-6989586621679067784"><span class="annot"><span class="annottext">takeGenome :: Phenotype a1 -&gt; Genome a2
</span><a href="#local-6989586621679067784"><span class="hs-identifier hs-var hs-var hs-var hs-var">takeGenome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phenotype a1 -&gt; Genome a2
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span></span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span id="local-6989586621679067783"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#takeObjectiveValue"><span class="hs-identifier hs-type">takeObjectiveValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier hs-type">Phenotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067783"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span></span><span>
</span><span id="line-59"></span><span id="takeObjectiveValue"><span class="annot"><span class="annottext">takeObjectiveValue :: Phenotype a -&gt; Objective
</span><a href="Moo.GeneticAlgorithm.Types.html#takeObjectiveValue"><span class="hs-identifier hs-var hs-var">takeObjectiveValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phenotype a -&gt; Objective
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | A type of optimization problem: whether the objective function</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- has to be miminized, or maximized.</span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="ProblemType"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ProblemType"><span class="hs-identifier hs-var">ProblemType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Minimizing"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Minimizing"><span class="hs-identifier hs-var">Minimizing</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Maximizing"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Maximizing"><span class="hs-identifier hs-var">Maximizing</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067775"><span id="local-6989586621679067777"><span id="local-6989586621679067779"><span class="annot"><span class="annottext">Int -&gt; ProblemType -&gt; ShowS
[ProblemType] -&gt; ShowS
ProblemType -&gt; String
(Int -&gt; ProblemType -&gt; ShowS)
-&gt; (ProblemType -&gt; String)
-&gt; ([ProblemType] -&gt; ShowS)
-&gt; Show ProblemType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProblemType] -&gt; ShowS
$cshowList :: [ProblemType] -&gt; ShowS
show :: ProblemType -&gt; String
$cshow :: ProblemType -&gt; String
showsPrec :: Int -&gt; ProblemType -&gt; ShowS
$cshowsPrec :: Int -&gt; ProblemType -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067770"><span id="local-6989586621679067772"><span class="annot"><span class="annottext">ProblemType -&gt; ProblemType -&gt; Bool
(ProblemType -&gt; ProblemType -&gt; Bool)
-&gt; (ProblemType -&gt; ProblemType -&gt; Bool) -&gt; Eq ProblemType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ProblemType -&gt; ProblemType -&gt; Bool
$c/= :: ProblemType -&gt; ProblemType -&gt; Bool
== :: ProblemType -&gt; ProblemType -&gt; Bool
$c== :: ProblemType -&gt; ProblemType -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | A function to evaluate a genome should be an instance of</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- 'ObjectiveFunction' class. It may be called a cost function for</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- minimization problems, or a fitness function for maximization</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- problems.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Some genetic algorithm operators, like 'rouletteSelect', require</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- the 'Objective' to be non-negative.</span><span>
</span><span id="line-72"></span><span class="hs-keyword">class</span><span> </span><span id="ObjectiveFunction"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ObjectiveFunction"><span class="hs-identifier hs-var">ObjectiveFunction</span></a></span></span><span> </span><span id="local-6989586621679067831"><span class="annot"><a href="#local-6989586621679067831"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679067830"><span class="annot"><a href="#local-6989586621679067830"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>    </span><span id="evalObjective"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#evalObjective"><span class="hs-identifier hs-type">evalObjective</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679067831"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067830"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067830"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Evaluate fitness (cost) values genome per genome in parallel.</span><span>
</span><span id="line-76"></span><span id="local-6989586621679067766"><span id="local-6989586621679067767"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067767"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067766"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ObjectiveFunction"><span class="hs-identifier hs-type">ObjectiveFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067767"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679067766"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-78"></span><span>        </span><span id="local-6989586621679067763"><span class="annot"><span class="annottext">evalObjective :: (Genome a1 -&gt; Objective) -&gt; [Genome a2] -&gt; Population a2
</span><a href="#local-6989586621679067763"><span class="hs-identifier hs-var hs-var hs-var hs-var">evalObjective</span></a></span></span><span> </span><span id="local-6989586621679067762"><span class="annot"><span class="annottext">Genome a1 -&gt; Objective
</span><a href="#local-6989586621679067762"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679067761"><span class="annot"><span class="annottext">[Genome a2]
</span><a href="#local-6989586621679067761"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Strategy (Genome a1, Objective)
-&gt; (Genome a1 -&gt; (Genome a1, Objective))
-&gt; [Genome a1]
-&gt; [(Genome a1, Objective)]
forall b a. Strategy b -&gt; (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">parMap</span></a></span><span> </span><span class="annot"><span class="annottext">Strategy (Genome a1, Objective)
forall a. Strategy a
</span><a href="../../../../parallel/html/src"><span class="hs-identifier hs-var">rseq</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679067760"><span class="annot"><span class="annottext">Genome a1
</span><a href="#local-6989586621679067760"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome a1
</span><a href="#local-6989586621679067760"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Genome a1 -&gt; Objective
</span><a href="#local-6989586621679067762"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a1
</span><a href="#local-6989586621679067760"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Genome a1]
[Genome a2]
</span><a href="#local-6989586621679067761"><span class="hs-identifier hs-var">gs</span></a></span></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | Evaluate all fitness (cost) values at once.</span><span>
</span><span id="line-81"></span><span id="local-6989586621679067758"><span id="local-6989586621679067759"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067759"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067758"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ObjectiveFunction"><span class="hs-identifier hs-type">ObjectiveFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067759"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679067758"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>        </span><span id="local-6989586621679067756"><span class="annot"><span class="annottext">evalObjective :: ([Genome a1] -&gt; [Objective]) -&gt; [Genome a2] -&gt; Population a2
</span><a href="#local-6989586621679067756"><span class="hs-identifier hs-var hs-var hs-var hs-var">evalObjective</span></a></span></span><span> </span><span id="local-6989586621679067755"><span class="annot"><span class="annottext">[Genome a1] -&gt; [Objective]
</span><a href="#local-6989586621679067755"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679067754"><span class="annot"><span class="annottext">[Genome a2]
</span><a href="#local-6989586621679067754"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Genome a2] -&gt; [Objective] -&gt; Population a2
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a2]
</span><a href="#local-6989586621679067754"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Genome a1] -&gt; [Objective]
</span><a href="#local-6989586621679067755"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a1]
[Genome a2]
</span><a href="#local-6989586621679067754"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Evaluate fitness (cost) of all genomes, possibly changing their</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- order.</span><span>
</span><span id="line-87"></span><span id="local-6989586621679067752"><span id="local-6989586621679067753"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067753"><span class="hs-identifier hs-type">a1</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067752"><span class="hs-identifier hs-type">a2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ObjectiveFunction"><span class="hs-identifier hs-type">ObjectiveFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067753"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067753"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679067752"><span class="hs-identifier hs-type">a2</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>        </span><span id="local-6989586621679067750"><span class="annot"><span class="annottext">evalObjective :: ([Genome a1] -&gt; [(Genome a1, Objective)])
-&gt; [Genome a2] -&gt; Population a2
</span><a href="#local-6989586621679067750"><span class="hs-identifier hs-var hs-var hs-var hs-var">evalObjective</span></a></span></span><span> </span><span id="local-6989586621679067749"><span class="annot"><span class="annottext">[Genome a1] -&gt; [(Genome a1, Objective)]
</span><a href="#local-6989586621679067749"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679067748"><span class="annot"><span class="annottext">[Genome a2]
</span><a href="#local-6989586621679067748"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Genome a1] -&gt; [(Genome a1, Objective)]
</span><a href="#local-6989586621679067749"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a1]
[Genome a2]
</span><a href="#local-6989586621679067748"><span class="hs-identifier hs-var">gs</span></a></span></span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | A selection operator selects a subset (probably with repetition)</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- of genomes for reproduction via crossover and mutation.</span><span>
</span><span id="line-93"></span><span class="hs-keyword">type</span><span> </span><span id="SelectionOp"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#SelectionOp"><span class="hs-identifier hs-var">SelectionOp</span></a></span></span><span> </span><span id="local-6989586621679067747"><span class="annot"><a href="#local-6989586621679067747"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067747"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067747"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | A crossover operator takes some /parent/ genomes and returns some</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- /children/ along with the remaining parents. Many crossover</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- operators use only two parents, but some require three (like UNDX)</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- or more. Crossover operator should consume as many parents as</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- necessary and stop when the list of parents is empty.</span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span id="CrossoverOp"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-var">CrossoverOp</span></a></span></span><span> </span><span id="local-6989586621679067745"><span class="annot"><a href="#local-6989586621679067745"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | A mutation operator takes a genome and returns an altered copy of it.</span><span>
</span><span id="line-103"></span><span class="hs-keyword">type</span><span> </span><span id="MutationOp"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#MutationOp"><span class="hs-identifier hs-var">MutationOp</span></a></span></span><span> </span><span id="local-6989586621679067744"><span class="annot"><a href="#local-6989586621679067744"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067744"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067744"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Don't crossover.</span><span>
</span><span id="line-106"></span><span id="local-6989586621679067743"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#noCrossover"><span class="hs-identifier hs-type">noCrossover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-type">CrossoverOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067743"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-107"></span><span id="noCrossover"><span class="annot"><span class="annottext">noCrossover :: CrossoverOp a
</span><a href="Moo.GeneticAlgorithm.Types.html#noCrossover"><span class="hs-identifier hs-var hs-var">noCrossover</span></a></span></span><span> </span><span id="local-6989586621679067742"><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679067742"><span class="hs-identifier hs-var">genomes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome a], [Genome a])
-&gt; RandT PureMT Identity ([Genome a], [Genome a])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679067742"><span class="hs-identifier hs-var">genomes</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Don't mutate.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679067741"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#noMutation"><span class="hs-identifier hs-type">noMutation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#MutationOp"><span class="hs-identifier hs-type">MutationOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067741"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-111"></span><span id="noMutation"><span class="annot"><span class="annottext">noMutation :: MutationOp a
</span><a href="Moo.GeneticAlgorithm.Types.html#noMutation"><span class="hs-identifier hs-var hs-var">noMutation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MutationOp a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | A single step of the genetic algorithm. See also 'nextGeneration'.</span><span>
</span><span id="line-115"></span><span class="hs-keyword">type</span><span> </span><span id="StepGA"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier hs-var">StepGA</span></a></span></span><span> </span><span id="local-6989586621679067740"><span class="annot"><a href="#local-6989586621679067740"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679067739"><span class="annot"><a href="#local-6989586621679067739"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067739"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ stop condition</span><span>
</span><span id="line-116"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#PopulationState"><span class="hs-identifier hs-type">PopulationState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067739"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ population of the current generation</span><span>
</span><span id="line-117"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067740"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepResult"><span class="hs-identifier hs-type">StepResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067739"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ population of the next generation</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Iterations stop when the condition evaluates as @True@.</span><span>
</span><span id="line-121"></span><span class="hs-keyword">data</span><span> </span><span id="Cond"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-var">Cond</span></a></span></span><span> </span><span id="local-6989586621679067738"><span class="annot"><a href="#local-6989586621679067738"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>      </span><span id="Generations"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Generations"><span class="hs-identifier hs-var">Generations</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>                   </span><span class="hs-comment">-- ^ stop after @n@ generations</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="IfObjective"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#IfObjective"><span class="hs-identifier hs-var">IfObjective</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ stop when objective values satisfy the @predicate@</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679067735"><span class="annot"><a href="#local-6989586621679067735"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067735"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="GensNoChange"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GensNoChange"><span class="hs-identifier hs-var">GensNoChange</span></a></span></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="c%27maxgens"><span class="annot"><span class="annottext">Cond a -&gt; Int
</span><a href="Moo.GeneticAlgorithm.Types.html#c%27maxgens"><span class="hs-identifier hs-var hs-var">c'maxgens</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>                 </span><span class="hs-comment">-- ^ max number of generations for an indicator to be the same</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="c%27indicator"><span class="annot"><span class="annottext">()
</span><a href="Moo.GeneticAlgorithm.Types.html#c%27indicator"><span class="hs-identifier hs-var hs-var">c'indicator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Objective"><span class="hs-identifier hs-type">Objective</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067735"><span class="hs-identifier hs-type">b</span></a></span><span>  </span><span class="hs-comment">-- ^ stall indicator function</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="c%27counter"><span class="annot"><span class="annottext">()
</span><a href="Moo.GeneticAlgorithm.Types.html#c%27counter"><span class="hs-identifier hs-var hs-var">c'counter</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067735"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ a counter (initially @Nothing@)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">}</span><span>                                 </span><span class="hs-comment">-- ^ terminate when evolution stalls</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Or"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Or"><span class="hs-identifier hs-var">Or</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>              </span><span class="hs-comment">-- ^ stop when at least one of two conditions holds</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="And"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#And"><span class="hs-identifier hs-var">And</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Cond"><span class="hs-identifier hs-type">Cond</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067738"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- ^ stop when both conditions hold</span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">{-| On life cycle of the genetic algorithm:

&gt;
&gt;   [ start ]
&gt;       |
&gt;       v
&gt;   (genomes) --&gt; [calculate objective] --&gt; (evaluated genomes) --&gt; [ stop ]
&gt;       ^  ^                                       |
&gt;       |  |                                       |
&gt;       |  `-----------.                           |
&gt;       |               \                          v
&gt;   [ mutate ]        (elite) &lt;-------------- [ select ]
&gt;       ^                                          |
&gt;       |                                          |
&gt;       |                                          |
&gt;       |                                          v
&gt;   (genomes) &lt;----- [ crossover ] &lt;-------- (evaluted genomes)
&gt;

PopulationState can represent either @genomes@ or @evaluated genomed@.
-}</span><span>
</span><span id="line-154"></span><span class="hs-keyword">type</span><span> </span><span id="PopulationState"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#PopulationState"><span class="hs-identifier hs-var">PopulationState</span></a></span></span><span> </span><span id="local-6989586621679067728"><span class="annot"><a href="#local-6989586621679067728"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067728"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Phenotype"><span class="hs-identifier hs-type">Phenotype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067728"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | A data type to distinguish the last and intermediate steps results.</span><span>
</span><span id="line-158"></span><span class="hs-keyword">data</span><span> </span><span id="StepResult"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepResult"><span class="hs-identifier hs-var">StepResult</span></a></span></span><span> </span><span id="local-6989586621679067727"><span class="annot"><a href="#local-6989586621679067727"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="StopGA"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StopGA"><span class="hs-identifier hs-var">StopGA</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679067727"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="ContinueGA"><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ContinueGA"><span class="hs-identifier hs-var">ContinueGA</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679067727"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067719"><span id="local-6989586621679067721"><span id="local-6989586621679067723"><span class="annot"><span class="annottext">Int -&gt; StepResult a -&gt; ShowS
[StepResult a] -&gt; ShowS
StepResult a -&gt; String
(Int -&gt; StepResult a -&gt; ShowS)
-&gt; (StepResult a -&gt; String)
-&gt; ([StepResult a] -&gt; ShowS)
-&gt; Show (StepResult a)
forall a. Show a =&gt; Int -&gt; StepResult a -&gt; ShowS
forall a. Show a =&gt; [StepResult a] -&gt; ShowS
forall a. Show a =&gt; StepResult a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [StepResult a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [StepResult a] -&gt; ShowS
show :: StepResult a -&gt; String
$cshow :: forall a. Show a =&gt; StepResult a -&gt; String
showsPrec :: Int -&gt; StepResult a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; StepResult a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span></pre></body></html>