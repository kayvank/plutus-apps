<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Moo.GeneticAlgorithm.Constraints</span><span>
</span><span id="line-2"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-3"></span><span>      </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier">ConstraintFunction</span></a></span><span>
</span><span id="line-4"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier">Constraint</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#isFeasible"><span class="hs-identifier">isFeasible</span></a></span><span>
</span><span id="line-6"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Simple equalities and inequalities</span></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C."><span class="hs-operator">(.&lt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D."><span class="hs-operator">(.&lt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E."><span class="hs-operator">(.&gt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E%3D."><span class="hs-operator">(.&gt;=.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3D%3D."><span class="hs-operator">(.==.)</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Double inequalities</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier">LeftHandSideInequality</span></a></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C"><span class="hs-operator">(.&lt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D"><span class="hs-operator">(.&lt;=)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#%3C."><span class="hs-operator">(&lt;.)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#%3C%3D."><span class="hs-operator">(&lt;=.)</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Constrained initalization</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedGenomes"><span class="hs-identifier">getConstrainedGenomes</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedBinaryGenomes"><span class="hs-identifier">getConstrainedBinaryGenomes</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Constrained selection</span></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withDeathPenalty"><span class="hs-identifier">withDeathPenalty</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withFinalDeathPenalty"><span class="hs-identifier">withFinalDeathPenalty</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withConstraints"><span class="hs-identifier">withConstraints</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#numberOfViolations"><span class="hs-identifier">numberOfViolations</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#degreeOfViolation"><span class="hs-identifier">degreeOfViolation</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Types</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Random</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Utilities.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Utilities</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Utilities.html#getRandomGenomes"><span class="hs-identifier">getRandomGenomes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Selection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#withPopulationTransform"><span class="hs-identifier">withPopulationTransform</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#bestFirst"><span class="hs-identifier">bestFirst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">type</span><span> </span><span id="ConstraintFunction"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-var">ConstraintFunction</span></a></span></span><span> </span><span id="local-6989586621679069254"><span class="annot"><a href="#local-6989586621679069254"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679069253"><span class="annot"><a href="#local-6989586621679069253"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069253"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- Defining a constraint as a pair of function and its boundary value</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- (vs just a boolean valued function) allows for estimating the</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- degree of constraint violation when necessary.</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Define constraints using '.&lt;.', '.&lt;=.', '.&gt;.', '.&gt;=.', and '.==.'</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- operators, with a 'ConstraintFunction' on the left hand side.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- For double inequality constraints use pairs of '.&lt;', '&lt;.' and</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- '.&lt;=', '&lt;=.' respectively, with a 'ConstraintFunction' in the middle.</span><span>
</span><span id="line-41"></span><span class="hs-comment">--</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- Examples:</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- function .&gt;=. lowerBound</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- lowerBound .&lt;= function &lt;=. upperBound</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-48"></span><span class="hs-keyword">data</span><span> </span><span id="Constraint"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-var">Constraint</span></a></span></span><span> </span><span id="local-6989586621679069381"><span class="annot"><a href="#local-6989586621679069381"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679069380"><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="LessThan"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThan"><span class="hs-identifier hs-var">LessThan</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-comment">-- ^ strict inequality constraint,</span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-comment">-- function value is less than the constraint value</span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="LessThanOrEqual"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThanOrEqual"><span class="hs-identifier hs-var">LessThanOrEqual</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- ^ non-strict inequality constraint,</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-comment">-- function value is less than or equal to the constraint value</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Equal"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">-- ^ equality constraint,</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- function value is equal to the constraint value</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="InInterval"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#InInterval"><span class="hs-identifier hs-var">InInterval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069381"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069380"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- ^ double inequality, boolean flags indicate if the</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">-- bound is inclusive.</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span id="local-6989586621679069247"><span id="local-6989586621679069248"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C."><span class="hs-operator hs-type">(.&lt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069248"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069248"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069248"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069248"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-64"></span><span id=".%3C."><span class="annot"><span class="annottext">.&lt;. :: ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C."><span class="hs-operator hs-var hs-var">(.&lt;.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; b -&gt; Constraint a b
forall a b. ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LessThan"><span class="hs-identifier hs-var">LessThan</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679069245"><span id="local-6989586621679069246"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D."><span class="hs-operator hs-type">(.&lt;=.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069246"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069245"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069246"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069246"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069245"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069246"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-67"></span><span id=".%3C%3D."><span class="annot"><span class="annottext">.&lt;=. :: ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D."><span class="hs-operator hs-var hs-var">(.&lt;=.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; b -&gt; Constraint a b
forall a b. ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LessThanOrEqual"><span class="hs-identifier hs-var">LessThanOrEqual</span></a></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span id="local-6989586621679069243"><span id="local-6989586621679069244"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E."><span class="hs-operator hs-type">(.&gt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069244"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069244"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069244"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-70"></span><span id=".%3E."><span class="annot"><span class="annottext">.&gt;. :: ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E."><span class="hs-operator hs-var hs-var">(.&gt;.)</span></a></span></span><span> </span><span id="local-6989586621679069242"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069242"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069241"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069241"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; b -&gt; Constraint a b
forall a b. ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LessThan"><span class="hs-identifier hs-var">LessThan</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; ConstraintFunction a b -&gt; ConstraintFunction a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069242"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069241"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span id="local-6989586621679069238"><span id="local-6989586621679069239"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E%3D."><span class="hs-operator hs-type">(.&gt;=.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069239"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069239"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069239"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069238"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069239"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-73"></span><span id=".%3E%3D."><span class="annot"><span class="annottext">.&gt;=. :: ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3E%3D."><span class="hs-operator hs-var hs-var">(.&gt;=.)</span></a></span></span><span> </span><span id="local-6989586621679069237"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069237"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069236"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069236"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; b -&gt; Constraint a b
forall a b. ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LessThanOrEqual"><span class="hs-identifier hs-var">LessThanOrEqual</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; b) -&gt; ConstraintFunction a b -&gt; ConstraintFunction a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069237"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">negate</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069236"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span id="local-6989586621679069234"><span id="local-6989586621679069235"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3D%3D."><span class="hs-operator hs-type">(.==.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069235"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069235"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069235"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069235"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-76"></span><span id=".%3D%3D."><span class="annot"><span class="annottext">.==. :: ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3D%3D."><span class="hs-operator hs-var hs-var">(.==.)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; b -&gt; Constraint a b
forall a b. ConstraintFunction a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#Equal"><span class="hs-identifier hs-var">Equal</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- Left hand side of the double inequality defined in the form:</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- @lowerBound .&lt;= function &lt;=. upperBound@.</span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="LeftHandSideInequality"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-var">LeftHandSideInequality</span></a></span></span><span> </span><span id="local-6989586621679069364"><span class="annot"><a href="#local-6989586621679069364"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679069363"><span class="annot"><a href="#local-6989586621679069363"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="LeftHandSideInequality"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-var">LeftHandSideInequality</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069364"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069363"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069363"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- ^ boolean flag indicates if the bound is inclusive</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679069231"><span id="local-6989586621679069232"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D"><span class="hs-operator hs-type">(.&lt;=)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069232"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069232"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069232"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069231"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069232"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-86"></span><span id="local-6989586621679069230"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069230"><span class="hs-identifier hs-var">lval</span></a></span></span><span> </span><span id=".%3C%3D"><span class="annot"><span class="annottext">.&lt;= :: b -&gt; ConstraintFunction a b -&gt; LeftHandSideInequality a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C%3D"><span class="hs-operator hs-var hs-var">.&lt;=</span></a></span></span><span> </span><span id="local-6989586621679069229"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069229"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; (Bool, b) -&gt; LeftHandSideInequality a b
forall a b.
ConstraintFunction a b -&gt; (Bool, b) -&gt; LeftHandSideInequality a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-var">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069229"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069230"><span class="hs-identifier hs-var">lval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679069227"><span id="local-6989586621679069228"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C"><span class="hs-operator hs-type">(.&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069228"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069228"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#ConstraintFunction"><span class="hs-identifier hs-type">ConstraintFunction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069228"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069227"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069228"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-89"></span><span id="local-6989586621679069226"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069226"><span class="hs-identifier hs-var">lval</span></a></span></span><span> </span><span id=".%3C"><span class="annot"><span class="annottext">.&lt; :: b -&gt; ConstraintFunction a b -&gt; LeftHandSideInequality a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#.%3C"><span class="hs-operator hs-var hs-var">.&lt;</span></a></span></span><span> </span><span id="local-6989586621679069225"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069225"><span class="hs-identifier hs-var">f</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; (Bool, b) -&gt; LeftHandSideInequality a b
forall a b.
ConstraintFunction a b -&gt; (Bool, b) -&gt; LeftHandSideInequality a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-var">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069225"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069226"><span class="hs-identifier hs-var">lval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span id="local-6989586621679069223"><span id="local-6989586621679069224"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#%3C."><span class="hs-operator hs-type">(&lt;.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069224"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069224"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069224"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069223"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069224"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-92"></span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span id="local-6989586621679069222"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069222"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069221"><span class="annot"><span class="annottext">(Bool, b)
</span><a href="#local-6989586621679069221"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="%3C."><span class="annot"><span class="annottext">&lt;. :: LeftHandSideInequality a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#%3C."><span class="hs-operator hs-var hs-var">&lt;.</span></a></span></span><span> </span><span id="local-6989586621679069220"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069220"><span class="hs-identifier hs-var">rval</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; (Bool, b) -&gt; (Bool, b) -&gt; Constraint a b
forall a b.
ConstraintFunction a b -&gt; (Bool, b) -&gt; (Bool, b) -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#InInterval"><span class="hs-identifier hs-var">InInterval</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069222"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, b)
</span><a href="#local-6989586621679069221"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069220"><span class="hs-identifier hs-var">rval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679069218"><span id="local-6989586621679069219"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#%3C%3D."><span class="hs-operator hs-type">(&lt;=.)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069219"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069219"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069219"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069219"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-95"></span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LeftHandSideInequality"><span class="hs-identifier hs-type">LeftHandSideInequality</span></a></span><span> </span><span id="local-6989586621679069217"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069217"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069216"><span class="annot"><span class="annottext">(Bool, b)
</span><a href="#local-6989586621679069216"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span id="%3C%3D."><span class="annot"><span class="annottext">&lt;=. :: LeftHandSideInequality a b -&gt; b -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#%3C%3D."><span class="hs-operator hs-var hs-var">&lt;=.</span></a></span></span><span> </span><span id="local-6989586621679069215"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069215"><span class="hs-identifier hs-var">rval</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b -&gt; (Bool, b) -&gt; (Bool, b) -&gt; Constraint a b
forall a b.
ConstraintFunction a b -&gt; (Bool, b) -&gt; (Bool, b) -&gt; Constraint a b
</span><a href="Moo.GeneticAlgorithm.Constraints.html#InInterval"><span class="hs-identifier hs-var">InInterval</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069217"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool, b)
</span><a href="#local-6989586621679069216"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069215"><span class="hs-identifier hs-var">rval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Returns @True@ if a @genome@ represents a feasible solution</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- with respect to the @constraint@.</span><span>
</span><span id="line-101"></span><span id="local-6989586621679069342"><span id="local-6989586621679069343"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-identifier hs-type">satisfiesConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069343"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069342"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ @genome@</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069343"><span class="hs-identifier hs-type">b</span></a></span><span>  </span><span class="hs-comment">-- ^ @constraint@</span><span>
</span><span id="line-104"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span><span>
</span><span id="line-105"></span><span id="satisfiesConstraint"><span class="annot"><span class="annottext">satisfiesConstraint :: Genome a -&gt; Constraint a b -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-identifier hs-var hs-var">satisfiesConstraint</span></a></span></span><span> </span><span id="local-6989586621679069213"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069213"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThan"><span class="hs-identifier hs-type">LessThan</span></a></span><span> </span><span id="local-6989586621679069212"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069212"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069211"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069211"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069212"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069213"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069211"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-identifier hs-var">satisfiesConstraint</span></a></span><span> </span><span id="local-6989586621679069209"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069209"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThanOrEqual"><span class="hs-identifier hs-type">LessThanOrEqual</span></a></span><span> </span><span id="local-6989586621679069208"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069208"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069207"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069207"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069208"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069209"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069207"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-107"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-identifier hs-var">satisfiesConstraint</span></a></span><span> </span><span id="local-6989586621679069205"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069205"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Equal"><span class="hs-identifier hs-type">Equal</span></a></span><span> </span><span id="local-6989586621679069204"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069204"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069203"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069203"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069204"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069205"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069203"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-108"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-identifier hs-var">satisfiesConstraint</span></a></span><span> </span><span id="local-6989586621679069202"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069202"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#InInterval"><span class="hs-identifier hs-type">InInterval</span></a></span><span> </span><span id="local-6989586621679069201"><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069201"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069200"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069200"><span class="hs-identifier hs-var">inclusive1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679069199"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069199"><span class="hs-identifier hs-var">v1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069198"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069198"><span class="hs-identifier hs-var">inclusive2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679069197"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069197"><span class="hs-identifier hs-var">v2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069196"><span class="annot"><span class="annottext">v' :: b
</span><a href="#local-6989586621679069196"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConstraintFunction a b
</span><a href="#local-6989586621679069201"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069202"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679069195"><span class="annot"><span class="annottext">c1 :: Bool
</span><a href="#local-6989586621679069195"><span class="hs-identifier hs-var hs-var">c1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069200"><span class="hs-identifier hs-var">inclusive1</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069199"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069196"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069199"><span class="hs-identifier hs-var">v1</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069196"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span id="local-6989586621679069194"><span class="annot"><span class="annottext">c2 :: Bool
</span><a href="#local-6989586621679069194"><span class="hs-identifier hs-var hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069198"><span class="hs-identifier hs-var">inclusive2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069196"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069197"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069196"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679069197"><span class="hs-identifier hs-var">v2</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069195"><span class="hs-identifier hs-var">c1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069194"><span class="hs-identifier hs-var">c2</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Returns @True@ if a @genome@ represents a feasible solution,</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- i.e. satisfies all @constraints@.</span><span>
</span><span id="line-118"></span><span id="local-6989586621679069330"><span id="local-6989586621679069331"><span id="local-6989586621679069332"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#isFeasible"><span class="hs-identifier hs-type">isFeasible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#GenomeState"><span class="hs-identifier hs-type">GenomeState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069332"><span class="hs-identifier hs-type">gt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069331"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069330"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069331"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069330"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-120"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069332"><span class="hs-identifier hs-type">gt</span></a></span><span>                </span><span class="hs-comment">-- ^ genome</span><span>
</span><span id="line-121"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span></span></span><span>
</span><span id="line-122"></span><span id="isFeasible"><span class="annot"><span class="annottext">isFeasible :: [Constraint a b] -&gt; gt -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#isFeasible"><span class="hs-identifier hs-var hs-var">isFeasible</span></a></span></span><span> </span><span id="local-6989586621679069192"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069192"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069191"><span class="annot"><span class="annottext">gt
</span><a href="#local-6989586621679069191"><span class="hs-identifier hs-var">genome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Constraint a b -&gt; Bool) -&gt; [Constraint a b] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">gt -&gt; Genome a
forall gt a. GenomeState gt a =&gt; gt -&gt; Genome a
</span><a href="Moo.GeneticAlgorithm.Types.html#takeGenome"><span class="hs-identifier hs-var">takeGenome</span></a></span><span> </span><span class="annot"><span class="annottext">gt
</span><a href="#local-6989586621679069191"><span class="hs-identifier hs-var">genome</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Constraint a b -&gt; Bool
forall b a. Real b =&gt; Genome a -&gt; Constraint a b -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-operator hs-var">`satisfiesConstraint`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069192"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Generate @n@ feasible random genomes with individual genome elements</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- bounded by @ranges@.</span><span>
</span><span id="line-127"></span><span id="local-6989586621679069326"><span id="local-6989586621679069327"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedGenomes"><span class="hs-identifier hs-type">getConstrainedGenomes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069326"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069326"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>                </span><span class="hs-comment">-- ^ @n@, how many genomes to generate</span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- ^ ranges for individual genome elements</span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ random feasible genomes</span></span></span><span>
</span><span id="line-132"></span><span id="getConstrainedGenomes"><span class="annot"><span class="annottext">getConstrainedGenomes :: [Constraint a b] -&gt; Int -&gt; [(a, a)] -&gt; Rand [Genome a]
</span><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedGenomes"><span class="hs-identifier hs-var hs-var">getConstrainedGenomes</span></a></span></span><span> </span><span id="local-6989586621679069188"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069188"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069187"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679069186"><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679069186"><span class="hs-identifier hs-var">ranges</span></a></span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069187"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Genome a] -&gt; Rand [Genome a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679069185"><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069185"><span class="hs-identifier hs-var">candidates</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [(a, a)] -&gt; Rand [Genome a]
forall a. (Random a, Ord a) =&gt; Int -&gt; [(a, a)] -&gt; Rand [Genome a]
</span><a href="Moo.GeneticAlgorithm.Utilities.html#getRandomGenomes"><span class="hs-identifier hs-var">getRandomGenomes</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069187"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679069186"><span class="hs-identifier hs-var">ranges</span></a></span><span>
</span><span id="line-136"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069184"><span class="annot"><span class="annottext">feasible :: [Genome a]
</span><a href="#local-6989586621679069184"><span class="hs-identifier hs-var hs-var">feasible</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Genome a -&gt; Bool) -&gt; [Genome a] -&gt; [Genome a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; Bool
forall gt a b.
(GenomeState gt a, Real b) =&gt;
[Constraint a b] -&gt; gt -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#isFeasible"><span class="hs-identifier hs-var">isFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069188"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069185"><span class="hs-identifier hs-var">candidates</span></a></span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069183"><span class="annot"><span class="annottext">found :: Int
</span><a href="#local-6989586621679069183"><span class="hs-identifier hs-var hs-var">found</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Genome a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069184"><span class="hs-identifier hs-var">feasible</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679069181"><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069181"><span class="hs-identifier hs-var">more</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Int -&gt; [(a, a)] -&gt; Rand [Genome a]
forall a b.
(Random a, Ord a, Real b) =&gt;
[Constraint a b] -&gt; Int -&gt; [(a, a)] -&gt; Rand [Genome a]
</span><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedGenomes"><span class="hs-identifier hs-var">getConstrainedGenomes</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069188"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069187"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069183"><span class="hs-identifier hs-var">found</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, a)]
</span><a href="#local-6989586621679069186"><span class="hs-identifier hs-var">ranges</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">[Genome a] -&gt; Rand [Genome a]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">([Genome a] -&gt; Rand [Genome a]) -&gt; [Genome a] -&gt; Rand [Genome a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069184"><span class="hs-identifier hs-var">feasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a] -&gt; [Genome a] -&gt; [Genome a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome a]
</span><a href="#local-6989586621679069181"><span class="hs-identifier hs-var">more</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Generate @n@ feasible random binary genomes.</span><span>
</span><span id="line-143"></span><span id="local-6989586621679069180"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedBinaryGenomes"><span class="hs-identifier hs-type">getConstrainedBinaryGenomes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069180"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069180"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>                  </span><span class="hs-comment">-- ^ @n@, how many genomes to generate</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>                  </span><span class="hs-comment">-- ^ @L@, genome length</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">]</span><span>   </span><span class="hs-comment">-- ^ random feasible genomes</span></span><span>
</span><span id="line-148"></span><span id="getConstrainedBinaryGenomes"><span class="annot"><span class="annottext">getConstrainedBinaryGenomes :: [Constraint Bool b] -&gt; Int -&gt; Int -&gt; Rand [Genome Bool]
</span><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedBinaryGenomes"><span class="hs-identifier hs-var hs-var">getConstrainedBinaryGenomes</span></a></span></span><span> </span><span id="local-6989586621679069179"><span class="annot"><span class="annottext">[Constraint Bool b]
</span><a href="#local-6989586621679069179"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069178"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069178"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679069177"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069177"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">[Constraint Bool b] -&gt; Int -&gt; [(Bool, Bool)] -&gt; Rand [Genome Bool]
forall a b.
(Random a, Ord a, Real b) =&gt;
[Constraint a b] -&gt; Int -&gt; [(a, a)] -&gt; Rand [Genome a]
</span><a href="Moo.GeneticAlgorithm.Constraints.html#getConstrainedGenomes"><span class="hs-identifier hs-var">getConstrainedGenomes</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint Bool b]
</span><a href="#local-6989586621679069179"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069178"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Bool, Bool) -&gt; [(Bool, Bool)]
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679069177"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | A simple estimate of the degree of (in)feasibility.</span><span>
</span><span id="line-153"></span><span class="hs-comment">--</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- Count the number of constraint violations. Return @0@ if the solution is feasible.</span><span>
</span><span id="line-155"></span><span id="local-6989586621679069174"><span id="local-6989586621679069175"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#numberOfViolations"><span class="hs-identifier hs-type">numberOfViolations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069175"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>                   </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069174"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069175"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-157"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069174"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ genome</span><span>
</span><span id="line-158"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>  </span><span class="hs-comment">-- ^ the number of violated constraints</span></span></span><span>
</span><span id="line-159"></span><span id="numberOfViolations"><span class="annot"><span class="annottext">numberOfViolations :: [Constraint a b] -&gt; Genome a -&gt; Int
</span><a href="Moo.GeneticAlgorithm.Constraints.html#numberOfViolations"><span class="hs-identifier hs-var hs-var">numberOfViolations</span></a></span></span><span> </span><span id="local-6989586621679069173"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069173"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069172"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069172"><span class="hs-identifier hs-var">genome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069171"><span class="annot"><span class="annottext">satisfied :: Genome Bool
</span><a href="#local-6989586621679069171"><span class="hs-identifier hs-var hs-var">satisfied</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Constraint a b -&gt; Bool) -&gt; [Constraint a b] -&gt; Genome Bool
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069172"><span class="hs-identifier hs-var">genome</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Constraint a b -&gt; Bool
forall b a. Real b =&gt; Genome a -&gt; Constraint a b -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#satisfiesConstraint"><span class="hs-operator hs-var">`satisfiesConstraint`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069173"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Genome Bool -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome Bool -&gt; Int) -&gt; Genome Bool -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Genome Bool -&gt; Genome Bool
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Bool
</span><a href="#local-6989586621679069171"><span class="hs-identifier hs-var">satisfied</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | An estimate of the degree of (in)feasibility.</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- Given @f_j@ is the excess of @j@-th constraint function value,</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- return @sum |f_j|^beta@.  For strict inequality constraints, return</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- @sum (|f_j|^beta + eta)@.  Return @0.0@ if the solution is</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- feasible.</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span id="local-6989586621679069169"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#degreeOfViolation"><span class="hs-identifier hs-type">degreeOfViolation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ beta, single violation exponent</span><span>
</span><span id="line-172"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ eta, equality penalty in strict inequalities</span><span>
</span><span id="line-173"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069169"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ constrains</span><span>
</span><span id="line-174"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069169"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ genome</span><span>
</span><span id="line-175"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>    </span><span class="hs-comment">-- ^ total degree of violation</span></span><span>
</span><span id="line-176"></span><span id="degreeOfViolation"><span class="annot"><span class="annottext">degreeOfViolation :: Double -&gt; Double -&gt; [Constraint a Double] -&gt; Genome a -&gt; Double
</span><a href="Moo.GeneticAlgorithm.Constraints.html#degreeOfViolation"><span class="hs-identifier hs-var hs-var">degreeOfViolation</span></a></span></span><span> </span><span id="local-6989586621679069168"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span></span><span> </span><span id="local-6989586621679069167"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069167"><span class="hs-identifier hs-var">eta</span></a></span></span><span> </span><span id="local-6989586621679069166"><span class="annot"><span class="annottext">[Constraint a Double]
</span><a href="#local-6989586621679069166"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069165"><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069165"><span class="hs-identifier hs-var">genome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">([Double] -&gt; Double) -&gt; [Double] -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Constraint a Double -&gt; Double)
-&gt; [Constraint a Double] -&gt; [Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Constraint a Double -&gt; Double
</span><a href="#local-6989586621679069163"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a Double]
</span><a href="#local-6989586621679069166"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679069163"><span class="annot"><span class="annottext">violation :: Constraint a Double -&gt; Double
</span><a href="#local-6989586621679069163"><span class="hs-identifier hs-var hs-var">violation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThan"><span class="hs-identifier hs-type">LessThan</span></a></span><span> </span><span id="local-6989586621679069162"><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069162"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069161"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069161"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069160"><span class="annot"><span class="annottext">v' :: Double
</span><a href="#local-6989586621679069160"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069162"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069165"><span class="hs-identifier hs-var">genome</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069160"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069161"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-182"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-183"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069160"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069161"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069167"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="annot"><a href="#local-6989586621679069163"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#LessThanOrEqual"><span class="hs-identifier hs-type">LessThanOrEqual</span></a></span><span> </span><span id="local-6989586621679069156"><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069156"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069155"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069155"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069154"><span class="annot"><span class="annottext">v' :: Double
</span><a href="#local-6989586621679069154"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069156"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069165"><span class="hs-identifier hs-var">genome</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069154"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069155"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-187"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-188"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069154"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069155"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="#local-6989586621679069163"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Equal"><span class="hs-identifier hs-type">Equal</span></a></span><span> </span><span id="local-6989586621679069153"><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069153"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679069152"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069152"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069151"><span class="annot"><span class="annottext">v' :: Double
</span><a href="#local-6989586621679069151"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069153"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069165"><span class="hs-identifier hs-var">genome</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069151"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069152"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-193"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069151"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069152"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="#local-6989586621679069163"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#InInterval"><span class="hs-identifier hs-type">InInterval</span></a></span><span> </span><span id="local-6989586621679069150"><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069150"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069149"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069149"><span class="hs-identifier hs-var">incleft</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069148"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069148"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679069147"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069147"><span class="hs-identifier hs-var">incright</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679069146"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069146"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069145"><span class="annot"><span class="annottext">v' :: Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var hs-var">v'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome a -&gt; Double
</span><a href="#local-6989586621679069150"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069165"><span class="hs-identifier hs-var">genome</span></a></span><span>
</span><span id="line-196"></span><span>            </span><span id="local-6989586621679069144"><span class="annot"><span class="annottext">leftok :: Bool
</span><a href="#local-6989586621679069144"><span class="hs-identifier hs-var hs-var">leftok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069149"><span class="hs-identifier hs-var">incleft</span></a></span><span>
</span><span id="line-197"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069148"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-198"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069148"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-199"></span><span>            </span><span id="local-6989586621679069143"><span class="annot"><span class="annottext">rightok :: Bool
</span><a href="#local-6989586621679069143"><span class="hs-identifier hs-var hs-var">rightok</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069147"><span class="hs-identifier hs-var">incright</span></a></span><span>
</span><span id="line-200"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069146"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-201"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069146"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069144"><span class="hs-identifier hs-var">leftok</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069143"><span class="hs-identifier hs-var">rightok</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-204"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069148"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-205"></span><span>                            </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Bool -&gt; Int) -&gt; Bool -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int) -&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Double) -&gt; Bool -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069149"><span class="hs-identifier hs-var">incleft</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069167"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069145"><span class="hs-identifier hs-var">v'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069146"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069168"><span class="hs-identifier hs-var">beta</span></a></span><span>
</span><span id="line-207"></span><span>                            </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Bool -&gt; Int) -&gt; Bool -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Int) -&gt; (Bool -&gt; Bool) -&gt; Bool -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Double) -&gt; Bool -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679069147"><span class="hs-identifier hs-var">incright</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069167"><span class="hs-identifier hs-var">eta</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Modify objective function in such a way that 1) any feasible</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- solution is preferred to any infeasible solution, 2) among two</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- feasible solutions the one having better objective function value</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- is preferred, 3) among two infeasible solution the one having</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- smaller constraint violation is preferred.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Reference: Deb, K. (2000). An efficient constraint handling method</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- for genetic algorithms. Computer methods in applied mechanics and</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- engineering, 186(2), 311-338.</span><span>
</span><span id="line-219"></span><span id="local-6989586621679069137"><span id="local-6989586621679069138"><span id="local-6989586621679069139"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withConstraints"><span class="hs-identifier hs-type">withConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069139"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069138"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069137"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069139"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>                      </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069137"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069139"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069137"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069138"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ non-negative degree of violation,</span><span>
</span><span id="line-222"></span><span>                                             </span><span class="hs-comment">-- see 'numberOfViolations' and 'degreeOfViolation'</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ProblemType"><span class="hs-identifier hs-type">ProblemType</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#SelectionOp"><span class="hs-identifier hs-type">SelectionOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069137"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#SelectionOp"><span class="hs-identifier hs-type">SelectionOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069137"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-226"></span><span id="withConstraints"><span class="annot"><span class="annottext">withConstraints :: [Constraint a b]
-&gt; ([Constraint a b] -&gt; Genome a -&gt; c)
-&gt; ProblemType
-&gt; SelectionOp a
-&gt; SelectionOp a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#withConstraints"><span class="hs-identifier hs-var hs-var">withConstraints</span></a></span></span><span> </span><span id="local-6989586621679069136"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069136"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069135"><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; c
</span><a href="#local-6989586621679069135"><span class="hs-identifier hs-var">violation</span></a></span></span><span> </span><span id="local-6989586621679069134"><span class="annot"><span class="annottext">ProblemType
</span><a href="#local-6989586621679069134"><span class="hs-identifier hs-var">ptype</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">(Population a -&gt; Population a) -&gt; SelectionOp a -&gt; SelectionOp a
forall a.
(Population a -&gt; Population a) -&gt; SelectionOp a -&gt; SelectionOp a
</span><a href="Moo.GeneticAlgorithm.Selection.html#withPopulationTransform"><span class="hs-identifier hs-var">withPopulationTransform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b]
-&gt; ([Constraint a b] -&gt; Genome a -&gt; c)
-&gt; ProblemType
-&gt; Population a
-&gt; Population a
forall b c a.
(Real b, Real c) =&gt;
[Constraint a b]
-&gt; ([Constraint a b] -&gt; Genome a -&gt; c)
-&gt; ProblemType
-&gt; Population a
-&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#penalizeInfeasible"><span class="hs-identifier hs-var">penalizeInfeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069136"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; c
</span><a href="#local-6989586621679069135"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="#local-6989586621679069134"><span class="hs-identifier hs-var">ptype</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span id="local-6989586621679069300"><span id="local-6989586621679069301"><span id="local-6989586621679069302"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#penalizeInfeasible"><span class="hs-identifier hs-type">penalizeInfeasible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069302"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069301"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069302"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069302"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069300"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679069301"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ProblemType"><span class="hs-identifier hs-type">ProblemType</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069300"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069300"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-236"></span><span id="penalizeInfeasible"><span class="annot"><span class="annottext">penalizeInfeasible :: [Constraint a b]
-&gt; ([Constraint a b] -&gt; Genome a -&gt; c)
-&gt; ProblemType
-&gt; Population a
-&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#penalizeInfeasible"><span class="hs-identifier hs-var hs-var">penalizeInfeasible</span></a></span></span><span> </span><span id="local-6989586621679069132"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069132"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621679069131"><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; c
</span><a href="#local-6989586621679069131"><span class="hs-identifier hs-var">violation</span></a></span></span><span> </span><span id="local-6989586621679069130"><span class="annot"><span class="annottext">ProblemType
</span><a href="#local-6989586621679069130"><span class="hs-identifier hs-var">ptype</span></a></span></span><span> </span><span id="local-6989586621679069129"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069129"><span class="hs-identifier hs-var">phenotypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069128"><span class="annot"><span class="annottext">worst :: Double
</span><a href="#local-6989586621679069128"><span class="hs-identifier hs-var hs-var">worst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phenotype a -&gt; Double
forall a. Phenotype a -&gt; Double
</span><a href="Moo.GeneticAlgorithm.Types.html#takeObjectiveValue"><span class="hs-identifier hs-var">takeObjectiveValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Phenotype a -&gt; Double)
-&gt; (Population a -&gt; Phenotype a) -&gt; Population a -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Population a -&gt; Phenotype a
forall a. [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">head</span></a></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Phenotype a)
-&gt; (Population a -&gt; Population a) -&gt; Population a -&gt; Phenotype a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType -&gt; Population a -&gt; Population a
forall a. ProblemType -&gt; Population a -&gt; Population a
</span><a href="#local-6989586621679069125"><span class="hs-identifier hs-var">worstFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="#local-6989586621679069130"><span class="hs-identifier hs-var">ptype</span></a></span><span> </span><span class="annot"><span class="annottext">(Population a -&gt; Double) -&gt; Population a -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069129"><span class="hs-identifier hs-var">phenotypes</span></a></span><span>
</span><span id="line-238"></span><span>            </span><span id="local-6989586621679069124"><span class="annot"><span class="annottext">penalize :: Phenotype a -&gt; Phenotype a
</span><a href="#local-6989586621679069124"><span class="hs-identifier hs-var hs-var">penalize</span></a></span></span><span> </span><span id="local-6989586621679069123"><span class="annot"><span class="annottext">Phenotype a
</span><a href="#local-6989586621679069123"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679069122"><span class="annot"><span class="annottext">g :: Genome a
</span><a href="#local-6989586621679069122"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Phenotype a -&gt; Genome a
forall gt a. GenomeState gt a =&gt; gt -&gt; Genome a
</span><a href="Moo.GeneticAlgorithm.Types.html#takeGenome"><span class="hs-identifier hs-var">takeGenome</span></a></span><span> </span><span class="annot"><span class="annottext">Phenotype a
</span><a href="#local-6989586621679069123"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-239"></span><span>                             </span><span id="local-6989586621679069121"><span class="annot"><span class="annottext">v :: Double
</span><a href="#local-6989586621679069121"><span class="hs-identifier hs-var hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Double
forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Double)
-&gt; (Genome a -&gt; Rational) -&gt; Genome a -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toRational</span></a></span><span> </span><span class="annot"><span class="annottext">(c -&gt; Rational) -&gt; (Genome a -&gt; c) -&gt; Genome a -&gt; Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; c
</span><a href="#local-6989586621679069131"><span class="hs-identifier hs-var">violation</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069132"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome a -&gt; Double) -&gt; Genome a -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069122"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-240"></span><span>                         </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069121"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                             </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome a
</span><a href="#local-6989586621679069122"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069128"><span class="hs-identifier hs-var">worst</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679069120"><span class="hs-operator hs-var">`worsen`</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679069121"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                             </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Phenotype a
</span><a href="#local-6989586621679069123"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">(Phenotype a -&gt; Phenotype a) -&gt; Population a -&gt; Population a
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Phenotype a -&gt; Phenotype a
</span><a href="#local-6989586621679069124"><span class="hs-identifier hs-var">penalize</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069129"><span class="hs-identifier hs-var">phenotypes</span></a></span><span>
</span><span id="line-244"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679069125"><span class="annot"><span class="annottext">worstFirst :: ProblemType -&gt; Population a -&gt; Population a
</span><a href="#local-6989586621679069125"><span class="hs-identifier hs-var hs-var">worstFirst</span></a></span></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="Moo.GeneticAlgorithm.Types.html#Minimizing"><span class="hs-identifier hs-var">Minimizing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProblemType -&gt; Population a -&gt; Population a
forall a. ProblemType -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Selection.html#bestFirst"><span class="hs-identifier hs-var">bestFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="Moo.GeneticAlgorithm.Types.html#Maximizing"><span class="hs-identifier hs-var">Maximizing</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="#local-6989586621679069125"><span class="hs-identifier hs-var">worstFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="Moo.GeneticAlgorithm.Types.html#Maximizing"><span class="hs-identifier hs-var">Maximizing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProblemType -&gt; Population a -&gt; Population a
forall a. ProblemType -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Selection.html#bestFirst"><span class="hs-identifier hs-var">bestFirst</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="Moo.GeneticAlgorithm.Types.html#Minimizing"><span class="hs-identifier hs-var">Minimizing</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679069120"><span class="annot"><span class="annottext">worsen :: a -&gt; a -&gt; a
</span><a href="#local-6989586621679069120"><span class="hs-identifier hs-var hs-var">worsen</span></a></span></span><span> </span><span id="local-6989586621679069117"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069117"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679069116"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069116"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="#local-6989586621679069130"><span class="hs-identifier hs-var">ptype</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType -&gt; ProblemType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">ProblemType
</span><a href="Moo.GeneticAlgorithm.Types.html#Minimizing"><span class="hs-identifier hs-var">Minimizing</span></a></span><span>
</span><span id="line-249"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069117"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069116"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-250"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069117"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679069116"><span class="hs-identifier hs-var">delta</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Kill all infeasible solutions after every step of the genetic algorithm.</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- &#8220;Death penalty is very popular within the evolution strategies community,</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- but it is limited to problems in which the feasible search space is convex</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- and constitutes a reasonably large portion of the whole search space,&#8221; --</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- (Coello 1999).</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Coello, C. A. C., &amp; Carlos, A. (1999). A survey of constraint</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- handling techniques used with evolutionary algorithms.</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Lania-RI-99-04, Laboratorio Nacional de Inform&#225;tica Avanzada.</span><span>
</span><span id="line-263"></span><span id="local-6989586621679069113"><span id="local-6989586621679069114"><span id="local-6989586621679069115"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withDeathPenalty"><span class="hs-identifier hs-type">withDeathPenalty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069115"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069114"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069113"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069114"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ constraints</span><span>
</span><span id="line-265"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier hs-type">StepGA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069113"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ unconstrained step</span><span>
</span><span id="line-266"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier hs-type">StepGA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069115"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069113"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ constrained step</span></span></span></span><span>
</span><span id="line-267"></span><span id="withDeathPenalty"><span class="annot"><span class="annottext">withDeathPenalty :: [Constraint a b] -&gt; StepGA m a -&gt; StepGA m a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#withDeathPenalty"><span class="hs-identifier hs-var hs-var">withDeathPenalty</span></a></span></span><span> </span><span id="local-6989586621679069112"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069112"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679069111"><span class="annot"><span class="annottext">StepGA m a
</span><a href="#local-6989586621679069111"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679069110"><span class="annot"><span class="annottext">Cond a
</span><a href="#local-6989586621679069110"><span class="hs-identifier hs-var">stop</span></a></span></span><span> </span><span id="local-6989586621679069109"><span class="annot"><span class="annottext">PopulationState a
</span><a href="#local-6989586621679069109"><span class="hs-identifier hs-var">popstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>      </span><span id="local-6989586621679069108"><span class="annot"><span class="annottext">StepResult (Population a)
</span><a href="#local-6989586621679069108"><span class="hs-identifier hs-var">stepresult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StepGA m a
</span><a href="#local-6989586621679069111"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Cond a
</span><a href="#local-6989586621679069110"><span class="hs-identifier hs-var">stop</span></a></span><span> </span><span class="annot"><span class="annottext">PopulationState a
</span><a href="#local-6989586621679069109"><span class="hs-identifier hs-var">popstate</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a)
</span><a href="#local-6989586621679069108"><span class="hs-identifier hs-var">stepresult</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StopGA"><span class="hs-identifier hs-type">StopGA</span></a></span><span> </span><span id="local-6989586621679069106"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069106"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a) -&gt; m (StepResult (Population a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a -&gt; StepResult (Population a)
forall a. a -&gt; StepResult a
</span><a href="Moo.GeneticAlgorithm.Types.html#StopGA"><span class="hs-identifier hs-var">StopGA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Population a -&gt; Population a
forall b a.
Real b =&gt;
[Constraint a b] -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#filterFeasible"><span class="hs-identifier hs-var">filterFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069112"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069106"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ContinueGA"><span class="hs-identifier hs-type">ContinueGA</span></a></span><span> </span><span id="local-6989586621679069103"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069103"><span class="hs-identifier hs-var">pop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a) -&gt; m (StepResult (Population a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a -&gt; StepResult (Population a)
forall a. a -&gt; StepResult a
</span><a href="Moo.GeneticAlgorithm.Types.html#ContinueGA"><span class="hs-identifier hs-var">ContinueGA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Population a -&gt; Population a
forall b a.
Real b =&gt;
[Constraint a b] -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#filterFeasible"><span class="hs-identifier hs-var">filterFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069112"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069103"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Kill all infeasible solutions once after the last step of the</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- genetic algorithm. See also 'withDeathPenalty'.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679069100"><span id="local-6989586621679069101"><span id="local-6989586621679069102"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#withFinalDeathPenalty"><span class="hs-identifier hs-type">withFinalDeathPenalty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069101"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>                      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069100"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069101"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ constriants</span><span>
</span><span id="line-279"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier hs-type">StepGA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069100"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ unconstrained step</span><span>
</span><span id="line-280"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StepGA"><span class="hs-identifier hs-type">StepGA</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069102"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069100"><span class="hs-identifier hs-type">a</span></a></span><span>        </span><span class="hs-comment">-- ^ constrained step</span></span></span></span><span>
</span><span id="line-281"></span><span id="withFinalDeathPenalty"><span class="annot"><span class="annottext">withFinalDeathPenalty :: [Constraint a b] -&gt; StepGA m a -&gt; StepGA m a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#withFinalDeathPenalty"><span class="hs-identifier hs-var hs-var">withFinalDeathPenalty</span></a></span></span><span> </span><span id="local-6989586621679069099"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069099"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679069098"><span class="annot"><span class="annottext">StepGA m a
</span><a href="#local-6989586621679069098"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-glyph">\</span><span id="local-6989586621679069097"><span class="annot"><span class="annottext">Cond a
</span><a href="#local-6989586621679069097"><span class="hs-identifier hs-var">stop</span></a></span></span><span> </span><span id="local-6989586621679069096"><span class="annot"><span class="annottext">PopulationState a
</span><a href="#local-6989586621679069096"><span class="hs-identifier hs-var">popstate</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621679069095"><span class="annot"><span class="annottext">StepResult (Population a)
</span><a href="#local-6989586621679069095"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StepGA m a
</span><a href="#local-6989586621679069098"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Cond a
</span><a href="#local-6989586621679069097"><span class="hs-identifier hs-var">stop</span></a></span><span> </span><span class="annot"><span class="annottext">PopulationState a
</span><a href="#local-6989586621679069096"><span class="hs-identifier hs-var">popstate</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a)
</span><a href="#local-6989586621679069095"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#ContinueGA"><span class="hs-identifier hs-type">ContinueGA</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a) -&gt; m (StepResult (Population a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">StepResult (Population a)
</span><a href="#local-6989586621679069095"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#StopGA"><span class="hs-identifier hs-type">StopGA</span></a></span><span> </span><span id="local-6989586621679069094"><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069094"><span class="hs-identifier hs-var">pop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">StepResult (Population a) -&gt; m (StepResult (Population a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Population a -&gt; StepResult (Population a)
forall a. a -&gt; StepResult a
</span><a href="Moo.GeneticAlgorithm.Types.html#StopGA"><span class="hs-identifier hs-var">StopGA</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Population a -&gt; Population a
forall b a.
Real b =&gt;
[Constraint a b] -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#filterFeasible"><span class="hs-identifier hs-var">filterFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069099"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Population a
</span><a href="#local-6989586621679069094"><span class="hs-identifier hs-var">pop</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621679069280"><span id="local-6989586621679069281"><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#filterFeasible"><span class="hs-identifier hs-type">filterFeasible</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069281"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Constraints.html#Constraint"><span class="hs-identifier hs-type">Constraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069280"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069281"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069280"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Population"><span class="hs-identifier hs-type">Population</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679069280"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-290"></span><span id="filterFeasible"><span class="annot"><span class="annottext">filterFeasible :: [Constraint a b] -&gt; Population a -&gt; Population a
</span><a href="Moo.GeneticAlgorithm.Constraints.html#filterFeasible"><span class="hs-identifier hs-var hs-var">filterFeasible</span></a></span></span><span> </span><span id="local-6989586621679069093"><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069093"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Phenotype a -&gt; Bool) -&gt; Population a -&gt; Population a
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Constraint a b] -&gt; Genome a -&gt; Bool
forall gt a b.
(GenomeState gt a, Real b) =&gt;
[Constraint a b] -&gt; gt -&gt; Bool
</span><a href="Moo.GeneticAlgorithm.Constraints.html#isFeasible"><span class="hs-identifier hs-var">isFeasible</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraint a b]
</span><a href="#local-6989586621679069093"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome a -&gt; Bool)
-&gt; (Phenotype a -&gt; Genome a) -&gt; Phenotype a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Phenotype a -&gt; Genome a
forall gt a. GenomeState gt a =&gt; gt -&gt; Genome a
</span><a href="Moo.GeneticAlgorithm.Types.html#takeGenome"><span class="hs-identifier hs-var">takeGenome</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span></pre></body></html>