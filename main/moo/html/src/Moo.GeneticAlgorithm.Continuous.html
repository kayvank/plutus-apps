<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-unused-imports #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">{- |

Continuous (real-coded) genetic algorithms. Candidate solutions are
represented as lists of real variables.

-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Moo.GeneticAlgorithm.Continuous</span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-13"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Types</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Initialization</span></span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Utilities.html#getRandomGenomes"><span class="hs-identifier">getRandomGenomes</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#uniformGenomes"><span class="hs-identifier">uniformGenomes</span></a></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Selection</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#rouletteSelect"><span class="hs-identifier">rouletteSelect</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#stochasticUniversalSampling"><span class="hs-identifier">stochasticUniversalSampling</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#tournamentSelect"><span class="hs-identifier">tournamentSelect</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Scaling and niching</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#withPopulationTransform"><span class="hs-identifier">withPopulationTransform</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#withScale"><span class="hs-identifier">withScale</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#rankScale"><span class="hs-identifier">rankScale</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#withFitnessSharing"><span class="hs-identifier">withFitnessSharing</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distance1"><span class="hs-identifier">distance1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distance2"><span class="hs-identifier">distance2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distanceInf"><span class="hs-identifier">distanceInf</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Sorting</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html#bestFirst"><span class="hs-identifier">bestFirst</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Crossover</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Neighborhood-based operators</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#blendCrossover"><span class="hs-identifier">blendCrossover</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier">unimodalCrossover</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossoverRP"><span class="hs-identifier">unimodalCrossoverRP</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#simulatedBinaryCrossover"><span class="hs-identifier">simulatedBinaryCrossover</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Crossover.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Crossover</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Mutation</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#gaussianMutate"><span class="hs-identifier">gaussianMutate</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Control</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Random</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Run.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Run</span></a></span><span>
</span><span id="line-47"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">replicateM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">genericLength</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">foldl'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Crossover.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Crossover</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.LinAlg.html"><span class="hs-identifier">Moo.GeneticAlgorithm.LinAlg</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Random</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Selection.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Selection</span></a></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Types</span></a></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Run.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Run</span></a></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Utilities.html"><span class="hs-identifier">Moo.GeneticAlgorithm.Utilities</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Moo.GeneticAlgorithm.Utilities.html#getRandomGenomes"><span class="hs-identifier">getRandomGenomes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Generate at most @popsize@ genomes uniformly distributed in @ranges@.</span><span>
</span><span id="line-62"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#uniformGenomes"><span class="hs-identifier hs-type">uniformGenomes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#Genome"><span class="hs-identifier hs-type">Genome</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span id="uniformGenomes"><span class="annot"><span class="annottext">uniformGenomes :: Int -&gt; [(Double, Double)] -&gt; [Genome Double]
</span><a href="Moo.GeneticAlgorithm.Continuous.html#uniformGenomes"><span class="hs-identifier hs-var hs-var">uniformGenomes</span></a></span></span><span> </span><span id="local-6989586621679068984"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068984"><span class="hs-identifier hs-var">popsize</span></a></span></span><span> </span><span id="local-6989586621679068983"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679068983"><span class="hs-identifier hs-var">ranges</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068982"><span class="annot"><span class="annottext">dims :: Genome Double
</span><a href="#local-6989586621679068982"><span class="hs-identifier hs-var hs-var">dims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Double) -&gt; [(Double, Double)] -&gt; Genome Double
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double) -&gt; (Double, Double) -&gt; Double
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">subtract</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679068983"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>        </span><span id="local-6989586621679068979"><span class="annot"><span class="annottext">ndims :: Int
</span><a href="#local-6989586621679068979"><span class="hs-identifier hs-var hs-var">ndims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068982"><span class="hs-identifier hs-var">dims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-66"></span><span>        </span><span id="local-6989586621679068977"><span class="annot"><span class="annottext">vol :: Double
</span><a href="#local-6989586621679068977"><span class="hs-identifier hs-var hs-var">vol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Double
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">product</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068982"><span class="hs-identifier hs-var">dims</span></a></span><span>
</span><span id="line-67"></span><span>        </span><span id="local-6989586621679068975"><span class="annot"><span class="annottext">mdim :: Double
</span><a href="#local-6989586621679068975"><span class="hs-identifier hs-var hs-var">mdim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068977"><span class="hs-identifier hs-var">vol</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068979"><span class="hs-identifier hs-var">ndims</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span id="local-6989586621679068972"><span class="annot"><span class="annottext">msamples :: Double
</span><a href="#local-6989586621679068972"><span class="hs-identifier hs-var hs-var">msamples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068984"><span class="hs-identifier hs-var">popsize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068979"><span class="hs-identifier hs-var">ndims</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-69"></span><span>        </span><span id="local-6989586621679068971"><span class="annot"><span class="annottext">ptsPerDim :: [Int]
</span><a href="#local-6989586621679068971"><span class="hs-identifier hs-var hs-var">ptsPerDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Genome Double -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679068970"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068970"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">round</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068970"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068972"><span class="hs-identifier hs-var">msamples</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068975"><span class="hs-identifier hs-var">mdim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068982"><span class="hs-identifier hs-var">dims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-70"></span><span>        </span><span id="local-6989586621679068967"><span class="annot"><span class="annottext">ptsInLastDims :: Int
</span><a href="#local-6989586621679068967"><span class="hs-identifier hs-var hs-var">ptsInLastDims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">product</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Int) -&gt; [Int] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679068971"><span class="hs-identifier hs-var">ptsPerDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-71"></span><span>        </span><span id="local-6989586621679068965"><span class="annot"><span class="annottext">ptsInFirstDim :: Int
</span><a href="#local-6989586621679068965"><span class="hs-identifier hs-var hs-var">ptsInFirstDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068984"><span class="hs-identifier hs-var">popsize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068967"><span class="hs-identifier hs-var">ptsInLastDims</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-72"></span><span>        </span><span id="local-6989586621679068963"><span class="annot"><span class="annottext">ptsPerDim' :: [Int]
</span><a href="#local-6989586621679068963"><span class="hs-identifier hs-var hs-var">ptsPerDim'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068965"><span class="hs-identifier hs-var">ptsInFirstDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; [Int]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679068971"><span class="hs-identifier hs-var">ptsPerDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-73"></span><span>        </span><span id="local-6989586621679068962"><span class="annot"><span class="annottext">linspaces :: [Genome Double]
</span><a href="#local-6989586621679068962"><span class="hs-identifier hs-var hs-var">linspaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Int -&gt; Genome Double)
-&gt; [(Double, Double)] -&gt; [Int] -&gt; [Genome Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Int -&gt; Genome Double
</span><a href="#local-6989586621679068960"><span class="hs-identifier hs-var">linspace</span></a></span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679068983"><span class="hs-identifier hs-var">ranges</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679068963"><span class="hs-identifier hs-var">ptsPerDim'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Genome Double] -&gt; [Genome Double] -&gt; [Genome Double]
</span><a href="#local-6989586621679068959"><span class="hs-identifier hs-var">sproduct</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068962"><span class="hs-identifier hs-var">linspaces</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="#local-6989586621679068960"><span class="hs-identifier hs-type">linspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679068960"><span class="annot"><span class="annottext">linspace :: (Double, Double) -&gt; Int -&gt; Genome Double
</span><a href="#local-6989586621679068960"><span class="hs-identifier hs-var hs-var">linspace</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068958"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068958"><span class="hs-identifier hs-var">lo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068957"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068957"><span class="hs-identifier hs-var">hi</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679068956"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068956"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; [Int] -&gt; Genome Double
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679068955"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068955"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068955"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068957"><span class="hs-identifier hs-var">hi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068958"><span class="hs-identifier hs-var">lo</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068956"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068956"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span>    </span><span class="annot"><a href="#local-6989586621679068959"><span class="hs-identifier hs-type">sproduct</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621679068959"><span class="annot"><span class="annottext">sproduct :: [Genome Double] -&gt; [Genome Double] -&gt; [Genome Double]
</span><a href="#local-6989586621679068959"><span class="hs-identifier hs-var hs-var">sproduct</span></a></span></span><span> </span><span id="local-6989586621679068954"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068954"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068954"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="#local-6989586621679068959"><span class="hs-identifier hs-var">sproduct</span></a></span><span> </span><span id="local-6989586621679068953"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068953"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068952"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068952"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068951"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068951"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>           </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068950"><span class="annot"><span class="annottext">gs' :: [Genome Double]
</span><a href="#local-6989586621679068950"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068949"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068948"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679068948"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068948"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068953"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068949"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068949"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068952"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-82"></span><span>           </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">[Genome Double] -&gt; [Genome Double] -&gt; [Genome Double]
</span><a href="#local-6989586621679068959"><span class="hs-identifier hs-var">sproduct</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068950"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068951"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | 1-norm distance: @sum |x_i - y-i|@.</span><span>
</span><span id="line-86"></span><span id="local-6989586621679068947"><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distance1"><span class="hs-identifier hs-type">distance1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Num</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068947"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679068947"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-87"></span><span id="distance1"><span class="annot"><span class="annottext">distance1 :: [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.Continuous.html#distance1"><span class="hs-identifier hs-var hs-var">distance1</span></a></span></span><span> </span><span id="local-6989586621679068946"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068946"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679068945"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068945"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [a] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068946"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068945"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | 2-norm distance: @(sum (x_i - y_i)^2)^(1/2)@.</span><span>
</span><span id="line-91"></span><span id="local-6989586621679068941"><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distance2"><span class="hs-identifier hs-type">distance2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Floating</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679068941"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-92"></span><span id="distance2"><span class="annot"><span class="annottext">distance2 :: [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.Continuous.html#distance2"><span class="hs-identifier hs-var hs-var">distance2</span></a></span></span><span> </span><span id="local-6989586621679068940"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068940"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679068939"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068939"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; ([a] -&gt; a) -&gt; [a] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sum</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int -&gt; a
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [a] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068940"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068939"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Infinity norm distance: @max |x_i - y_i|@.</span><span>
</span><span id="line-96"></span><span id="local-6989586621679068936"><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#distanceInf"><span class="hs-identifier hs-type">distanceInf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Real</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679068936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679068936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679068936"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-97"></span><span id="distanceInf"><span class="annot"><span class="annottext">distanceInf :: [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.Continuous.html#distanceInf"><span class="hs-identifier hs-var hs-var">distanceInf</span></a></span></span><span> </span><span id="local-6989586621679068935"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068935"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679068934"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068934"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [a] -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; a) -&gt; [a] -&gt; [a] -&gt; [a]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068935"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068934"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Blend crossover (BLX-alpha) for continuous genetic algorithms.  For</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- each component let @x@ and @y@ be its values in the first and the</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- second parent respectively. Choose corresponding component values</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- of the children independently from the uniform distribution in the</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- range (L,U), where @L = min (x,y) - alpha * d@, @U = max</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- (x,y) + alpha * d@, and @d = abs (x - y)@. @alpha@ is usually</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- 0.5. Takahashi in [10.1109/CEC.2001.934452] suggests 0.366.</span><span>
</span><span id="line-107"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#blendCrossover"><span class="hs-identifier hs-type">blendCrossover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-comment">-- ^ @alpha@, range expansion parameter</span><span>
</span><span id="line-108"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-type">CrossoverOp</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-109"></span><span id="blendCrossover"><span class="annot"><span class="annottext">blendCrossover :: Double -&gt; CrossoverOp Double
</span><a href="Moo.GeneticAlgorithm.Continuous.html#blendCrossover"><span class="hs-identifier hs-var hs-var">blendCrossover</span></a></span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#blendCrossover"><span class="hs-identifier hs-var">blendCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679068932"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068932"><span class="hs-identifier hs-var">celibate</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068932"><span class="hs-identifier hs-var">celibate</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#blendCrossover"><span class="hs-identifier hs-var">blendCrossover</span></a></span><span> </span><span id="local-6989586621679068931"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068931"><span class="hs-identifier hs-var">alpha</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068930"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068930"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068929"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068929"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068928"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068928"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679068927"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068927"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679068926"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068926"><span class="hs-identifier hs-var">ys'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)] -&gt; (Genome Double, Genome Double)
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Double, Double)] -&gt; (Genome Double, Genome Double))
-&gt; RandT PureMT Identity [(Double, Double)]
-&gt; RandT PureMT Identity (Genome Double, Genome Double)
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`liftM`</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; RandT PureMT Identity (Double, Double))
-&gt; [(Double, Double)] -&gt; RandT PureMT Identity [(Double, Double)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
-&gt; (Double, Double) -&gt; RandT PureMT Identity (Double, Double)
forall b.
(Random b, Num b, Ord b) =&gt;
b -&gt; (b, b) -&gt; RandT PureMT Identity (b, b)
</span><a href="#local-6989586621679068923"><span class="hs-identifier hs-var">blx</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068931"><span class="hs-identifier hs-var">alpha</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; [(Double, Double)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068930"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068929"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068927"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068926"><span class="hs-identifier hs-var">ys'</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068928"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679068923"><span class="annot"><span class="annottext">blx :: b -&gt; (b, b) -&gt; RandT PureMT Identity (b, b)
</span><a href="#local-6989586621679068923"><span class="hs-identifier hs-var hs-var">blx</span></a></span></span><span> </span><span id="local-6989586621679068922"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068922"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068921"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068921"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679068920"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068920"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068919"><span class="annot"><span class="annottext">l :: b
</span><a href="#local-6989586621679068919"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">min</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068920"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068922"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068917"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-117"></span><span>            </span><span id="local-6989586621679068916"><span class="annot"><span class="annottext">u :: b
</span><a href="#local-6989586621679068916"><span class="hs-identifier hs-var hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">max</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068920"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068922"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068917"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-118"></span><span>            </span><span id="local-6989586621679068917"><span class="annot"><span class="annottext">d :: b
</span><a href="#local-6989586621679068917"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; b
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068921"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068920"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>          </span><span id="local-6989586621679068913"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068913"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(b, b) -&gt; Rand b
forall a. Random a =&gt; (a, a) -&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068919"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068916"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>          </span><span id="local-6989586621679068911"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068911"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(b, b) -&gt; Rand b
forall a. Random a =&gt; (a, a) -&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068919"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068916"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">(b, b) -&gt; RandT PureMT Identity (b, b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068913"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679068911"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Unimodal normal distributed crossover (UNDX) for continuous</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- genetic algorithms. Recommended parameters according to [ISBN</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- 978-3-540-43330-9] are @sigma_xi = 0.5@, @sigma_eta =</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- 0.35/sqrt(n)@, where @n@ is the number of variables (dimensionality</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- of the search space). UNDX mixes three parents, producing normally</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- distributed children along the line between first two parents, and using</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- the third parent to build a supplementary orthogonal correction</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- component.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- UNDX preserves the mean of the offspring, and also the</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- covariance matrix of the offspring if @sigma_xi^2 = 0.25@.  By</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- preserving distribution of the offspring, /the UNDX can efficiently</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- search in along the valleys where parents are distributed in</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- functions with strong epistasis among parameters/ (idem).</span><span>
</span><span id="line-138"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-type">unimodalCrossover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ @sigma_xi@, the standard deviation of</span><span>
</span><span id="line-139"></span><span>                            </span><span class="hs-comment">-- the mix between two principal parents</span><span>
</span><span id="line-140"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ @sigma_eta@, the standard deviation</span><span>
</span><span id="line-141"></span><span>                            </span><span class="hs-comment">-- of the single orthogonal component</span><span>
</span><span id="line-142"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-type">CrossoverOp</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-143"></span><span id="unimodalCrossover"><span class="annot"><span class="annottext">unimodalCrossover :: Double -&gt; Double -&gt; CrossoverOp Double
</span><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-var hs-var">unimodalCrossover</span></a></span></span><span> </span><span id="local-6989586621679068910"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068910"><span class="hs-identifier hs-var">sigma_xi</span></a></span></span><span> </span><span id="local-6989586621679068909"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068909"><span class="hs-identifier hs-var">sigma_eta</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068908"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068907"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068907"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068906"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068906"><span class="hs-identifier hs-var">x3</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068905"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068905"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068904"><span class="annot"><span class="annottext">d :: Genome Double
</span><a href="#local-6989586621679068904"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068907"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span><span>  </span><span class="hs-comment">-- vector between parents</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068902"><span class="annot"><span class="annottext">x_mean :: Genome Double
</span><a href="#local-6989586621679068902"><span class="hs-identifier hs-var hs-var">x_mean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#plus"><span class="hs-operator hs-var">`plus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068907"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- parents' average</span><span>
</span><span id="line-146"></span><span>   </span><span class="hs-comment">-- distance to the 3rd parent in the orthogonal subspace</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068899"><span class="annot"><span class="annottext">dist3 :: Double
</span><a href="#local-6989586621679068899"><span class="hs-identifier hs-var hs-var">dist3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068898"><span class="annot"><span class="annottext">v31 :: Genome Double
</span><a href="#local-6989586621679068898"><span class="hs-identifier hs-var hs-var">v31</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068906"><span class="hs-identifier hs-var">x3</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-149"></span><span>              </span><span id="local-6989586621679068897"><span class="annot"><span class="annottext">v21 :: Genome Double
</span><a href="#local-6989586621679068897"><span class="hs-identifier hs-var hs-var">v21</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068907"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-150"></span><span>              </span><span id="local-6989586621679068896"><span class="annot"><span class="annottext">base :: Double
</span><a href="#local-6989586621679068896"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Double
forall a. (Num a, Floating a) =&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#norm2"><span class="hs-identifier hs-var">norm2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068897"><span class="hs-identifier hs-var">v21</span></a></span><span>
</span><span id="line-151"></span><span>              </span><span class="hs-comment">-- twice the triangle area</span><span>
</span><span id="line-152"></span><span>              </span><span id="local-6989586621679068894"><span class="annot"><span class="annottext">area :: Double
</span><a href="#local-6989586621679068894"><span class="hs-identifier hs-var hs-var">area</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#dot"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068898"><span class="hs-identifier hs-var">v31</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068898"><span class="hs-identifier hs-var">v31</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#dot"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068897"><span class="hs-identifier hs-var">v21</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068897"><span class="hs-identifier hs-var">v21</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#dot"><span class="hs-identifier hs-var">dot</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068897"><span class="hs-identifier hs-var">v21</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068898"><span class="hs-identifier hs-var">v31</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Double -&gt; Int -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">^</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-glyph">::</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>              </span><span id="local-6989586621679068892"><span class="annot"><span class="annottext">h :: Double
</span><a href="#local-6989586621679068892"><span class="hs-identifier hs-var hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068894"><span class="hs-identifier hs-var">area</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068896"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-154"></span><span>          </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isNaN</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068892"><span class="hs-identifier hs-var">h</span></a></span><span>    </span><span class="hs-comment">-- if x1 and x2 coincide</span><span>
</span><span id="line-155"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Double
forall a. (Num a, Floating a) =&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#norm2"><span class="hs-identifier hs-var">norm2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068898"><span class="hs-identifier hs-var">v31</span></a></span><span>
</span><span id="line-156"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068892"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068890"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068908"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679068889"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068889"><span class="hs-identifier hs-var">parCorr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679068888"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068888"><span class="hs-identifier hs-var">orthCorrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Double
forall a. (Num a, Floating a) =&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#norm2"><span class="hs-identifier hs-var">norm2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068904"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-6</span></span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- distinct parents</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068886"><span class="annot"><span class="annottext">exs :: [Genome Double]
</span><a href="#local-6989586621679068886"><span class="hs-identifier hs-var hs-var">exs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Genome Double] -&gt; [Genome Double]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">([Genome Double] -&gt; [Genome Double])
-&gt; (Genome Double -&gt; [Genome Double])
-&gt; Genome Double
-&gt; [Genome Double]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; [Genome Double]
</span><a href="#local-6989586621679068885"><span class="hs-identifier hs-var">mkBasis</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome Double -&gt; [Genome Double])
-&gt; Genome Double -&gt; [Genome Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068904"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; RandT PureMT Identity (Genome Double)
</span><a href="#local-6989586621679068884"><span class="hs-identifier hs-var">getNormals</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">RandT PureMT Identity (Genome Double)
-&gt; (Genome Double
    -&gt; RandT PureMT Identity (Genome Double, [Genome Double]))
-&gt; RandT PureMT Identity (Genome Double, [Genome Double])
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679068883"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068883"><span class="hs-identifier hs-var">xi</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068882"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068882"><span class="hs-identifier hs-var">etas</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-164"></span><span>              </span><span id="local-6989586621679068881"><span class="annot"><span class="annottext">xi' :: Double
</span><a href="#local-6989586621679068881"><span class="hs-identifier hs-var hs-var">xi'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068910"><span class="hs-identifier hs-var">sigma_xi</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068883"><span class="hs-identifier hs-var">xi</span></a></span><span>
</span><span id="line-165"></span><span>              </span><span id="local-6989586621679068880"><span class="annot"><span class="annottext">parCorr :: Genome Double
</span><a href="#local-6989586621679068880"><span class="hs-identifier hs-var hs-var">parCorr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068881"><span class="hs-identifier hs-var">xi'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068904"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-166"></span><span>              </span><span id="local-6989586621679068879"><span class="annot"><span class="annottext">etas' :: Genome Double
</span><a href="#local-6989586621679068879"><span class="hs-identifier hs-var hs-var">etas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Genome Double -&gt; Genome Double
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068899"><span class="hs-identifier hs-var">dist3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068909"><span class="hs-identifier hs-var">sigma_eta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068882"><span class="hs-identifier hs-var">etas</span></a></span><span>
</span><span id="line-167"></span><span>              </span><span id="local-6989586621679068878"><span class="annot"><span class="annottext">orthCorrs :: [Genome Double]
</span><a href="#local-6989586621679068878"><span class="hs-identifier hs-var hs-var">orthCorrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Genome Double -&gt; Genome Double)
-&gt; Genome Double -&gt; [Genome Double] -&gt; [Genome Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068879"><span class="hs-identifier hs-var">etas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068886"><span class="hs-identifier hs-var">exs</span></a></span><span>
</span><span id="line-168"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(Genome Double, [Genome Double])
-&gt; RandT PureMT Identity (Genome Double, [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068880"><span class="hs-identifier hs-var">parCorr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068878"><span class="hs-identifier hs-var">orthCorrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>          </span><span class="annot"><span class="annottext">Genome Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; RandT PureMT Identity (Genome Double, [Genome Double])
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Parameters too short&quot;</span></span><span>
</span><span id="line-170"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- identical parents, direction d is undefined</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068876"><span class="annot"><span class="annottext">exs :: [Genome Double]
</span><a href="#local-6989586621679068876"><span class="hs-identifier hs-var hs-var">exs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Genome Double) -&gt; [Int] -&gt; [Genome Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Genome Double
forall a. Fractional a =&gt; Int -&gt; Int -&gt; [a]
</span><a href="#local-6989586621679068875"><span class="hs-identifier hs-var">basisVector</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>        </span><span id="local-6989586621679068874"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068874"><span class="hs-identifier hs-var">etas</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; RandT PureMT Identity (Genome Double)
</span><a href="#local-6989586621679068884"><span class="hs-identifier hs-var">getNormals</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068873"><span class="annot"><span class="annottext">etas' :: Genome Double
</span><a href="#local-6989586621679068873"><span class="hs-identifier hs-var hs-var">etas'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Genome Double -&gt; Genome Double
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068899"><span class="hs-identifier hs-var">dist3</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068909"><span class="hs-identifier hs-var">sigma_eta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068874"><span class="hs-identifier hs-var">etas</span></a></span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068872"><span class="annot"><span class="annottext">orthCorrs :: [Genome Double]
</span><a href="#local-6989586621679068872"><span class="hs-identifier hs-var hs-var">orthCorrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Genome Double -&gt; Genome Double)
-&gt; Genome Double -&gt; [Genome Double] -&gt; [Genome Double]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-identifier hs-var">scale</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068873"><span class="hs-identifier hs-var">etas'</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068876"><span class="hs-identifier hs-var">exs</span></a></span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068871"><span class="annot"><span class="annottext">zeroCorr :: Genome Double
</span><a href="#local-6989586621679068871"><span class="hs-identifier hs-var hs-var">zeroCorr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Genome Double
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068890"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">(Genome Double, [Genome Double])
-&gt; RandT PureMT Identity (Genome Double, [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068871"><span class="hs-identifier hs-var">zeroCorr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068872"><span class="hs-identifier hs-var">orthCorrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068869"><span class="annot"><span class="annottext">totalCorr :: Genome Double
</span><a href="#local-6989586621679068869"><span class="hs-identifier hs-var hs-var">totalCorr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Genome Double -&gt; Genome Double -&gt; Genome Double)
-&gt; Genome Double -&gt; [Genome Double] -&gt; Genome Double
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#plus"><span class="hs-identifier hs-var">plus</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068889"><span class="hs-identifier hs-var">parCorr</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068888"><span class="hs-identifier hs-var">orthCorrs</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068867"><span class="annot"><span class="annottext">child1 :: Genome Double
</span><a href="#local-6989586621679068867"><span class="hs-identifier hs-var hs-var">child1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068902"><span class="hs-identifier hs-var">x_mean</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068869"><span class="hs-identifier hs-var">totalCorr</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068866"><span class="annot"><span class="annottext">child2 :: Genome Double
</span><a href="#local-6989586621679068866"><span class="hs-identifier hs-var hs-var">child2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068902"><span class="hs-identifier hs-var">x_mean</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#plus"><span class="hs-operator hs-var">`plus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068869"><span class="hs-identifier hs-var">totalCorr</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- drop only two parents of the three, to keep the number of children the same</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068867"><span class="hs-identifier hs-var">child1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068866"><span class="hs-identifier hs-var">child2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068906"><span class="hs-identifier hs-var">x3</span></a></span><span class="annot"><span class="annottext">Genome Double -&gt; [Genome Double] -&gt; [Genome Double]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068905"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">-- generate a list of n normally distributed random vars</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679068884"><span class="annot"><span class="annottext">getNormals :: Int -&gt; RandT PureMT Identity (Genome Double)
</span><a href="#local-6989586621679068884"><span class="hs-identifier hs-var hs-var">getNormals</span></a></span></span><span> </span><span id="local-6989586621679068865"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068865"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>      </span><span id="local-6989586621679068864"><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679068864"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; RandT PureMT Identity (Double, Double)
-&gt; RandT PureMT Identity [(Double, Double)]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicateM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068865"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`div`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RandT PureMT Identity (Double, Double)
</span><a href="Moo.GeneticAlgorithm.Random.html#getNormal2"><span class="hs-identifier hs-var">getNormal2</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="annottext">Genome Double -&gt; RandT PureMT Identity (Genome Double)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome Double -&gt; RandT PureMT Identity (Genome Double))
-&gt; (Genome Double -&gt; Genome Double)
-&gt; Genome Double
-&gt; RandT PureMT Identity (Genome Double)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Genome Double -&gt; Genome Double
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068865"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome Double -&gt; RandT PureMT Identity (Genome Double))
-&gt; Genome Double -&gt; RandT PureMT Identity (Genome Double)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Genome Double)
-&gt; [(Double, Double)] -&gt; Genome Double
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">concatMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679068860"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068860"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679068859"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068859"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068860"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068859"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Double, Double)]
</span><a href="#local-6989586621679068864"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- i-th basis vector in n-dimensional space</span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679068875"><span class="annot"><span class="annottext">basisVector :: Int -&gt; Int -&gt; [a]
</span><a href="#local-6989586621679068875"><span class="hs-identifier hs-var hs-var">basisVector</span></a></span></span><span> </span><span id="local-6989586621679068858"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068858"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679068857"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068857"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; [a]
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068858"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068857"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.0</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; [a]
forall a. Int -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068857"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- generate orthonormal bases starting from direction dir0</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="#local-6989586621679068885"><span class="hs-identifier hs-type">mkBasis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679068885"><span class="annot"><span class="annottext">mkBasis :: Genome Double -&gt; [Genome Double]
</span><a href="#local-6989586621679068885"><span class="hs-identifier hs-var hs-var">mkBasis</span></a></span></span><span> </span><span id="local-6989586621679068856"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068856"><span class="hs-identifier hs-var">dir0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068855"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679068855"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068856"><span class="hs-identifier hs-var">dir0</span></a></span><span>
</span><span id="line-193"></span><span>            </span><span id="local-6989586621679068854"><span class="annot"><span class="annottext">dims :: [Int]
</span><a href="#local-6989586621679068854"><span class="hs-identifier hs-var hs-var">dims</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068855"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-194"></span><span>            </span><span id="local-6989586621679068853"><span class="annot"><span class="annottext">ixs :: [Genome Double]
</span><a href="#local-6989586621679068853"><span class="hs-identifier hs-var hs-var">ixs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Genome Double) -&gt; [Int] -&gt; [Genome Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Genome Double
forall a. Fractional a =&gt; Int -&gt; Int -&gt; [a]
</span><a href="#local-6989586621679068875"><span class="hs-identifier hs-var">basisVector</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679068855"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679068854"><span class="hs-identifier hs-var">dims</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">(Genome Double -&gt; Genome Double)
-&gt; [Genome Double] -&gt; [Genome Double]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double
forall a. (Num a, Floating a, Fractional a) =&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#normalize"><span class="hs-identifier hs-var">normalize</span></a></span><span> </span><span class="annot"><span class="annottext">([Genome Double] -&gt; [Genome Double])
-&gt; ([Genome Double] -&gt; [Genome Double])
-&gt; [Genome Double]
-&gt; [Genome Double]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double] -&gt; [Genome Double]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">([Genome Double] -&gt; [Genome Double])
-&gt; [Genome Double] -&gt; [Genome Double]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Genome Double -&gt; [Genome Double] -&gt; [Genome Double])
-&gt; [Genome Double] -&gt; [Genome Double] -&gt; [Genome Double]
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; [Genome Double] -&gt; [Genome Double]
forall a. (Ord a, Floating a) =&gt; [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="#local-6989586621679068850"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068856"><span class="hs-identifier hs-var">dir0</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068853"><span class="hs-identifier hs-var">ixs</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-197"></span><span>        </span><span id="local-6989586621679068850"><span class="annot"><span class="annottext">build :: [a] -&gt; [[a]] -&gt; [[a]]
</span><a href="#local-6989586621679068850"><span class="hs-identifier hs-var hs-var">build</span></a></span></span><span> </span><span id="local-6989586621679068849"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068849"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679068848"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068848"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-198"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068847"><span class="annot"><span class="annottext">projs :: [[a]]
</span><a href="#local-6989586621679068847"><span class="hs-identifier hs-var hs-var">projs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [[a]] -&gt; [[a]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. (Num a, Fractional a) =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#proj"><span class="hs-identifier hs-var">proj</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068849"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068848"><span class="hs-identifier hs-var">exs</span></a></span><span>
</span><span id="line-199"></span><span>                </span><span id="local-6989586621679068845"><span class="annot"><span class="annottext">rem :: [a]
</span><a href="#local-6989586621679068845"><span class="hs-identifier hs-var hs-var">rem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a] -&gt; [a]) -&gt; [a] -&gt; [[a]] -&gt; [a]
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldl'</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-identifier hs-var">minus</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068849"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068847"><span class="hs-identifier hs-var">projs</span></a></span><span>
</span><span id="line-200"></span><span>            </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. (Num a, Floating a) =&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#norm2"><span class="hs-identifier hs-var">norm2</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068845"><span class="hs-identifier hs-var">rem</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1e-6</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([a] -&gt; a) -&gt; [[a]] -&gt; [a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; a
forall a. (Num a, Floating a) =&gt; [a] -&gt; a
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#norm2"><span class="hs-identifier hs-var">norm2</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068848"><span class="hs-identifier hs-var">exs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068848"><span class="hs-identifier hs-var">exs</span></a></span><span>   </span><span class="hs-comment">-- skip this vector, as linear depenent with dir0</span><span>
</span><span id="line-202"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679068845"><span class="hs-identifier hs-var">rem</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]] -&gt; [[a]]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679068848"><span class="hs-identifier hs-var">exs</span></a></span><span>  </span><span class="hs-comment">-- add to the list of orthogonalized vectors</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-var">unimodalCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-var">unimodalCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068843"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068843"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068842"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068842"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068843"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068842"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- FIXME the last two</span><span>
</span><span id="line-205"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-var">unimodalCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679068841"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068841"><span class="hs-identifier hs-var">celibate</span></a></span></span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068841"><span class="hs-identifier hs-var">celibate</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Run 'unimodalCrossover' with default recommended parameters.</span><span>
</span><span id="line-208"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossoverRP"><span class="hs-identifier hs-type">unimodalCrossoverRP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-type">CrossoverOp</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-209"></span><span id="unimodalCrossoverRP"><span class="annot"><span class="annottext">unimodalCrossoverRP :: CrossoverOp Double
</span><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossoverRP"><span class="hs-identifier hs-var hs-var">unimodalCrossoverRP</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossoverRP"><span class="hs-identifier hs-var">unimodalCrossoverRP</span></a></span><span> </span><span id="local-6989586621679068840"><span class="annot"><span class="annottext">parents :: [Genome Double]
</span><a href="#local-6989586621679068840"><span class="hs-identifier hs-var">parents</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679068839"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068839"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="annot"><span class="annottext">[Genome Double]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068838"><span class="annot"><span class="annottext">n :: Double
</span><a href="#local-6989586621679068838"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Double
forall i a. Num i =&gt; [a] -&gt; i
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">genericLength</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068839"><span class="hs-identifier hs-var">x1</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span id="local-6989586621679068837"><span class="annot"><span class="annottext">sigma_xi :: Double
</span><a href="#local-6989586621679068837"><span class="hs-identifier hs-var hs-var">sigma_xi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621679068836"><span class="annot"><span class="annottext">sigma_eta :: Double
</span><a href="#local-6989586621679068836"><span class="hs-identifier hs-var hs-var">sigma_eta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.35</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068838"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; CrossoverOp Double
</span><a href="Moo.GeneticAlgorithm.Continuous.html#unimodalCrossover"><span class="hs-identifier hs-var">unimodalCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068837"><span class="hs-identifier hs-var">sigma_xi</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068836"><span class="hs-identifier hs-var">sigma_eta</span></a></span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068840"><span class="hs-identifier hs-var">parents</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Simulated binary crossover (SBX) operator for continuous genetic</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- algorithms. SBX preserves the average of the parents and has a</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- spread factor distribution similar to single-point crossover of the</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- binary genetic algorithms. If @n &gt; 0@, then the heighest</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- probability density is assigned to the same distance between</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- children as that of the parents.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- The performance of real-coded genetic algorithm with SBX is similar</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- to that of binary GA with a single-point crossover. For details see</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- Simulated Binary Crossover for Continuous Search Space (1995) Agrawal etal.</span><span>
</span><span id="line-226"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#simulatedBinaryCrossover"><span class="hs-identifier hs-type">simulatedBinaryCrossover</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ non-negative distribution</span><span>
</span><span id="line-227"></span><span>                                   </span><span class="hs-comment">-- parameter @n@, usually in the</span><span>
</span><span id="line-228"></span><span>                                   </span><span class="hs-comment">-- range from 2 to 5; for small</span><span>
</span><span id="line-229"></span><span>                                   </span><span class="hs-comment">-- values of @n@ children far away</span><span>
</span><span id="line-230"></span><span>                                   </span><span class="hs-comment">-- from the parents are more likely</span><span>
</span><span id="line-231"></span><span>                                   </span><span class="hs-comment">-- to be chosen.</span><span>
</span><span id="line-232"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#CrossoverOp"><span class="hs-identifier hs-type">CrossoverOp</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-233"></span><span id="simulatedBinaryCrossover"><span class="annot"><span class="annottext">simulatedBinaryCrossover :: Double -&gt; CrossoverOp Double
</span><a href="Moo.GeneticAlgorithm.Continuous.html#simulatedBinaryCrossover"><span class="hs-identifier hs-var hs-var">simulatedBinaryCrossover</span></a></span></span><span> </span><span id="local-6989586621679068835"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068835"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679068834"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068834"><span class="hs-identifier hs-var">x1</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068833"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068833"><span class="hs-identifier hs-var">x2</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679068832"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068832"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-comment">-- let pdf beta | beta &gt;  1.0 = 0.5*(n+1)/beta**(n+2)</span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-comment">--              | beta &gt;= 0.0 = 0.5*(n+1)*beta**n</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-comment">--              | otherwise   = 0.0   -- beta &lt; 0</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068831"><span class="annot"><span class="annottext">cdf :: Double -&gt; Double
</span><a href="#local-6989586621679068831"><span class="hs-identifier hs-var hs-var">cdf</span></a></span></span><span> </span><span id="local-6989586621679068830"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068830"><span class="hs-identifier hs-var">beta</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068830"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span>
</span><span id="line-238"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068830"><span class="hs-identifier hs-var">beta</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068830"><span class="hs-identifier hs-var">beta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068835"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">/</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068830"><span class="hs-identifier hs-var">beta</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">**</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068835"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- beta &gt; 1.0</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679068828"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068828"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a></span><span>  </span><span class="hs-comment">-- uniform random variable in [0,1]</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-comment">-- solve cdf(beta) = u with absolute residual less than eps &gt; 0</span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068826"><span class="annot"><span class="annottext">solve :: Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068826"><span class="hs-identifier hs-var hs-var">solve</span></a></span></span><span> </span><span id="local-6989586621679068825"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068825"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span id="local-6989586621679068824"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068824"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068823"><span class="hs-identifier hs-var">solve'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679068822"><span class="hs-identifier hs-var">upperB</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-244"></span><span>          </span><span id="local-6989586621679068822"><span class="annot"><span class="annottext">upperB :: Double -&gt; Double
</span><a href="#local-6989586621679068822"><span class="hs-identifier hs-var hs-var">upperB</span></a></span></span><span> </span><span id="local-6989586621679068821"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068821"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679068831"><span class="hs-identifier hs-var">cdf</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068821"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068824"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679068822"><span class="hs-identifier hs-var">upperB</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068821"><span class="hs-identifier hs-var">b</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068821"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-246"></span><span>          </span><span id="local-6989586621679068823"><span class="annot"><span class="annottext">solve' :: Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068823"><span class="hs-identifier hs-var hs-var">solve'</span></a></span></span><span> </span><span id="local-6989586621679068820"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068820"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span id="local-6989586621679068819"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068819"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>              </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068818"><span class="annot"><span class="annottext">b :: Double
</span><a href="#local-6989586621679068818"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068820"><span class="hs-identifier hs-var">b1</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068819"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>                  </span><span id="local-6989586621679068817"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679068817"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="#local-6989586621679068831"><span class="hs-identifier hs-var">cdf</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068818"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068824"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-249"></span><span>              </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Num a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">abs</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068817"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068825"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-250"></span><span>                  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068818"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-251"></span><span>                  </span><span class="hs-keyword">else</span><span>
</span><span id="line-252"></span><span>                      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068817"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-253"></span><span>                      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068823"><span class="hs-identifier hs-var">solve'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068820"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068818"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-254"></span><span>                      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068823"><span class="hs-identifier hs-var">solve'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068818"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068819"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068816"><span class="annot"><span class="annottext">beta :: Double
</span><a href="#local-6989586621679068816"><span class="hs-identifier hs-var hs-var">beta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><a href="#local-6989586621679068826"><span class="hs-identifier hs-var">solve</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-6</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068828"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068815"><span class="annot"><span class="annottext">xmean :: Genome Double
</span><a href="#local-6989586621679068815"><span class="hs-identifier hs-var hs-var">xmean</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068834"><span class="hs-identifier hs-var">x1</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#plus"><span class="hs-operator hs-var">`plus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068833"><span class="hs-identifier hs-var">x2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068814"><span class="annot"><span class="annottext">deltax :: Genome Double
</span><a href="#local-6989586621679068814"><span class="hs-identifier hs-var hs-var">deltax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068816"><span class="hs-identifier hs-var">beta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; a -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#scale"><span class="hs-operator hs-var">`scale`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068833"><span class="hs-identifier hs-var">x2</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068834"><span class="hs-identifier hs-var">x1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068813"><span class="annot"><span class="annottext">c1 :: Genome Double
</span><a href="#local-6989586621679068813"><span class="hs-identifier hs-var hs-var">c1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068815"><span class="hs-identifier hs-var">xmean</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#plus"><span class="hs-operator hs-var">`plus`</span></a></span><span>  </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068814"><span class="hs-identifier hs-var">deltax</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679068812"><span class="annot"><span class="annottext">c2 :: Genome Double
</span><a href="#local-6989586621679068812"><span class="hs-identifier hs-var hs-var">c2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068815"><span class="hs-identifier hs-var">xmean</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double -&gt; Genome Double -&gt; Genome Double
forall a. Num a =&gt; [a] -&gt; [a] -&gt; [a]
</span><a href="Moo.GeneticAlgorithm.LinAlg.html#minus"><span class="hs-operator hs-var">`minus`</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068814"><span class="hs-identifier hs-var">deltax</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068813"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068812"><span class="hs-identifier hs-var">c2</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068832"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#simulatedBinaryCrossover"><span class="hs-identifier hs-var">simulatedBinaryCrossover</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679068811"><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068811"><span class="hs-identifier hs-var">celibates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Genome Double], [Genome Double])
-&gt; RandT PureMT Identity ([Genome Double], [Genome Double])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Genome Double]
</span><a href="#local-6989586621679068811"><span class="hs-identifier hs-var">celibates</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- |For every variable in the genome with probability @p@ replace its</span><span>
</span><span id="line-265"></span><span class="hs-comment">-- value @v@ with @v + sigma*N(0,1)@, where @N(0,1)@ is a normally</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- distributed random variable with mean equal 0 and variance equal 1.</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- With probability @(1 - p)^n@, where @n@ is the number</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- of variables, the genome remains unaffected.</span><span>
</span><span id="line-269"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Continuous.html#gaussianMutate"><span class="hs-identifier hs-type">gaussianMutate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ probability @p@</span><span>
</span><span id="line-270"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>  </span><span class="hs-comment">-- ^ @sigma@</span><span>
</span><span id="line-271"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Types.html#MutationOp"><span class="hs-identifier hs-type">MutationOp</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-272"></span><span id="gaussianMutate"><span class="annot"><span class="annottext">gaussianMutate :: Double
-&gt; Double -&gt; Genome Double -&gt; RandT PureMT Identity (Genome Double)
</span><a href="Moo.GeneticAlgorithm.Continuous.html#gaussianMutate"><span class="hs-identifier hs-var hs-var">gaussianMutate</span></a></span></span><span> </span><span id="local-6989586621679068809"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068809"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679068808"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068808"><span class="hs-identifier hs-var">sigma</span></a></span></span><span> </span><span id="local-6989586621679068807"><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068807"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Rand Double)
-&gt; Genome Double -&gt; RandT PureMT Identity (Genome Double)
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Rand Double
</span><a href="#local-6989586621679068806"><span class="hs-identifier hs-var">mutate</span></a></span><span> </span><span class="annot"><span class="annottext">Genome Double
</span><a href="#local-6989586621679068807"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679068806"><span class="annot"><span class="annottext">mutate :: Double -&gt; Rand Double
</span><a href="#local-6989586621679068806"><span class="hs-identifier hs-var hs-var">mutate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; (Double -&gt; Rand Double) -&gt; Double -&gt; Rand Double
forall a. Double -&gt; (a -&gt; Rand a) -&gt; a -&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#withProbability"><span class="hs-identifier hs-var">withProbability</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068809"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; Rand Double) -&gt; Double -&gt; Rand Double)
-&gt; (Double -&gt; Rand Double) -&gt; Double -&gt; Rand Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679068804"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068804"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>               </span><span id="local-6989586621679068803"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068803"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getNormal"><span class="hs-identifier hs-var">getNormal</span></a></span><span>
</span><span id="line-276"></span><span>               </span><span class="annot"><span class="annottext">Double -&gt; Rand Double
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068804"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068808"><span class="hs-identifier hs-var">sigma</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679068803"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span></pre></body></html>