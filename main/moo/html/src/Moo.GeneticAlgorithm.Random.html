<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- | Some extra facilities to work with 'Rand' monad and 'PureMT'
     random number generator.
-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Moo.GeneticAlgorithm.Random</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-7"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Random numbers from given range</span></span><span>
</span><span id="line-8"></span><span>      </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier">getRandom</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Probability distributions</span></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getNormal2"><span class="hs-identifier">getNormal2</span></a></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getNormal"><span class="hs-identifier">getNormal</span></a></span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Random samples and shuffles</span></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#randomSample"><span class="hs-identifier">randomSample</span></a></span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#randomSampleIndices"><span class="hs-identifier">randomSampleIndices</span></a></span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#shuffle"><span class="hs-identifier">shuffle</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Building blocks</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#withProbability"><span class="hs-identifier">withProbability</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports from random number generator packages</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getBool"><span class="hs-identifier">getBool</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getInt"><span class="hs-identifier">getInt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getWord"><span class="hs-identifier">getWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getInt64"><span class="hs-identifier">getInt64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getWord64"><span class="hs-identifier">getWord64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier">getDouble</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">runRand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">evalRand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../mersenne-random-pure64/html/src"><span class="hs-identifier">newPureMT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">liftRand</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier">Rand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier">Random</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../mersenne-random-pure64/html/src"><span class="hs-identifier">PureMT</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">liftM</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">Control.Monad.Random.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MonadRandom</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">Control.Monad.Random.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">liftRand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">runRand</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">evalRand</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Complex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Complex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier">System.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier">RandomGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier">Random</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mersenne-random-pure64/html/src"><span class="hs-identifier">System.Random.Mersenne.Pure64</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../random-shuffle/html/src"><span class="hs-identifier">System.Random.Shuffle</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">type</span><span> </span><span id="Rand"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-var">Rand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom.Rand</span></a></span><span> </span><span class="annot"><a href="../../../../mersenne-random-pure64/html/src"><span class="hs-identifier hs-type">PureMT</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | Yield a new randomly selected value of type @a@ in the range @(lo, hi)@.</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- See 'System.Random.randomR' for details.</span><span>
</span><span id="line-40"></span><span id="local-6989586621679067543"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getRandomR"><span class="hs-identifier hs-type">getRandomR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067543"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067543"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067543"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-41"></span><span id="getRandomR"><span class="annot"><span class="annottext">getRandomR :: (a, a) -&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandomR"><span class="hs-identifier hs-var hs-var">getRandomR</span></a></span></span><span> </span><span id="local-6989586621679067542"><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679067542"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PureMT -&gt; (a, PureMT)) -&gt; Rand a
forall g a. (g -&gt; (a, g)) -&gt; Rand g a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">liftRand</span></a></span><span> </span><span class="annot"><span class="annottext">((PureMT -&gt; (a, PureMT)) -&gt; Rand a)
-&gt; (PureMT -&gt; (a, PureMT)) -&gt; Rand a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067541"><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067541"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a, a) -&gt; PureMT -&gt; (a, PureMT)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="annot"><span class="annottext">(a, a)
</span><a href="#local-6989586621679067542"><span class="hs-identifier hs-var">range</span></a></span><span> </span><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067541"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- | Yield a new randomly selected value of type @a@.</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- See 'System.Random.random' for details.</span><span>
</span><span id="line-45"></span><span id="local-6989586621679067612"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-type">getRandom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">Random</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067612"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067612"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-46"></span><span id="getRandom"><span class="annot"><span class="annottext">getRandom :: Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var hs-var">getRandom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PureMT -&gt; (a, PureMT)) -&gt; Rand a
forall g a. (g -&gt; (a, g)) -&gt; Rand g a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">liftRand</span></a></span><span> </span><span class="annot"><span class="annottext">PureMT -&gt; (a, PureMT)
forall a g. (Random a, RandomGen g) =&gt; g -&gt; (a, g)
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">random</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getBool"><span class="hs-identifier hs-type">getBool</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-49"></span><span id="getBool"><span class="annot"><span class="annottext">getBool :: Rand Bool
</span><a href="Moo.GeneticAlgorithm.Random.html#getBool"><span class="hs-identifier hs-var hs-var">getBool</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Bool
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-50"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-type">getDouble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-51"></span><span id="getDouble"><span class="annot"><span class="annottext">getDouble :: Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-var hs-var">getDouble</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Double
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-52"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getWord"><span class="hs-identifier hs-type">getWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Word</span></a></span><span>
</span><span id="line-53"></span><span id="getWord"><span class="annot"><span class="annottext">getWord :: Rand Word
</span><a href="Moo.GeneticAlgorithm.Random.html#getWord"><span class="hs-identifier hs-var hs-var">getWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Word
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getInt"><span class="hs-identifier hs-type">getInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-55"></span><span id="getInt"><span class="annot"><span class="annottext">getInt :: Rand Int
</span><a href="Moo.GeneticAlgorithm.Random.html#getInt"><span class="hs-identifier hs-var hs-var">getInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Int
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getInt64"><span class="hs-identifier hs-type">getInt64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Int64</span></a></span><span>
</span><span id="line-57"></span><span id="getInt64"><span class="annot"><span class="annottext">getInt64 :: Rand Int64
</span><a href="Moo.GeneticAlgorithm.Random.html#getInt64"><span class="hs-identifier hs-var hs-var">getInt64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Int64
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-58"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getWord64"><span class="hs-identifier hs-type">getWord64</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-59"></span><span id="getWord64"><span class="annot"><span class="annottext">getWord64 :: Rand Word64
</span><a href="Moo.GeneticAlgorithm.Random.html#getWord64"><span class="hs-identifier hs-var hs-var">getWord64</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rand Word64
forall a. Random a =&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Yield two randomly selected values which follow standard</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- normal distribution.</span><span>
</span><span id="line-63"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getNormal2"><span class="hs-identifier hs-type">getNormal2</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span id="getNormal2"><span class="annot"><span class="annottext">getNormal2 :: Rand (Double, Double)
</span><a href="Moo.GeneticAlgorithm.Random.html#getNormal2"><span class="hs-identifier hs-var hs-var">getNormal2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- Box-Muller method</span><span>
</span><span id="line-66"></span><span>  </span><span id="local-6989586621679067538"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067538"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679067537"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067537"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067536"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067536"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-type">:+</span></a></span><span> </span><span id="local-6989586621679067534"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067534"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Complex Double -&gt; Complex Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">exp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Complex Double
forall a. a -&gt; a -&gt; Complex a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">:+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
forall a. Floating a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pi</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067537"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679067530"><span class="annot"><span class="annottext">r :: Double
</span><a href="#local-6989586621679067530"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">log</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067538"><span class="hs-identifier hs-var">u</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Rand (Double, Double)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067530"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067536"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067530"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067534"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Yield one randomly selected value from standard normal distribution.</span><span>
</span><span id="line-73"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#getNormal"><span class="hs-identifier hs-type">getNormal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-74"></span><span id="getNormal"><span class="annot"><span class="annottext">getNormal :: Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getNormal"><span class="hs-identifier hs-var hs-var">getNormal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double) -&gt; Double
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double) -&gt; Double)
-&gt; Rand (Double, Double) -&gt; Rand Double
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`liftM`</span></a></span><span> </span><span class="annot"><span class="annottext">Rand (Double, Double)
</span><a href="Moo.GeneticAlgorithm.Random.html#getNormal2"><span class="hs-identifier hs-var">getNormal2</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Take at most n random elements from the list. Preserve order.</span><span>
</span><span id="line-77"></span><span id="local-6989586621679067527"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#randomSample"><span class="hs-identifier hs-type">randomSample</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-78"></span><span id="randomSample"><span class="annot"><span class="annottext">randomSample :: Int -&gt; [a] -&gt; Rand [a]
</span><a href="Moo.GeneticAlgorithm.Random.html#randomSample"><span class="hs-identifier hs-var hs-var">randomSample</span></a></span></span><span> </span><span id="local-6989586621679067526"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067525"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="annottext">(PureMT -&gt; ([a], PureMT)) -&gt; Rand [a]
forall g a. (g -&gt; (a, g)) -&gt; Rand g a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">liftRand</span></a></span><span> </span><span class="annot"><span class="annottext">((PureMT -&gt; ([a], PureMT)) -&gt; Rand [a])
-&gt; (PureMT -&gt; ([a], PureMT)) -&gt; Rand [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067524"><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067524"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PureMT -&gt; Int -&gt; Int -&gt; [a] -&gt; [a] -&gt; ([a], PureMT)
forall t a.
RandomGen t =&gt;
t -&gt; Int -&gt; Int -&gt; [a] -&gt; [a] -&gt; ([a], t)
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067524"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067526"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067525"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679067523"><span class="annot"><span class="annottext">select :: t -&gt; Int -&gt; Int -&gt; [a] -&gt; [a] -&gt; ([a], t)
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span id="local-6989586621679067521"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679067520"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067520"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067521"><span class="hs-identifier hs-var">rng</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span id="local-6989586621679067518"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">rng</span></a></span></span><span> </span><span id="local-6989586621679067517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067516"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679067515"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679067514"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var">acc</span></a></span></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">rng</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067512"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067512"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067511"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067511"><span class="hs-identifier hs-var">rng'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; t -&gt; (Int, t)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067518"><span class="hs-identifier hs-var">rng</span></a></span><span>
</span><span id="line-86"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679067510"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067510"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679067509"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067509"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067512"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067515"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-87"></span><span>            </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">t -&gt; Int -&gt; Int -&gt; [a] -&gt; [a] -&gt; ([a], t)
</span><a href="#local-6989586621679067523"><span class="hs-identifier hs-var">select</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067511"><span class="hs-identifier hs-var">rng'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067517"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067516"><span class="hs-identifier hs-var">m</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067512"><span class="hs-identifier hs-var">k</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067509"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067510"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067514"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | Select @sampleSize@ numbers in the range from @0@ to @(populationSize-1)@.</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The function works best when @sampleSize@ is much smaller than @populationSize@.</span><span>
</span><span id="line-91"></span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#randomSampleIndices"><span class="hs-identifier hs-type">randomSampleIndices</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-92"></span><span id="randomSampleIndices"><span class="annot"><span class="annottext">randomSampleIndices :: Int -&gt; Int -&gt; Rand [Int]
</span><a href="Moo.GeneticAlgorithm.Random.html#randomSampleIndices"><span class="hs-identifier hs-var hs-var">randomSampleIndices</span></a></span></span><span> </span><span id="local-6989586621679067507"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">sampleSize</span></a></span></span><span> </span><span id="local-6989586621679067506"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067506"><span class="hs-identifier hs-var">populationSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">(PureMT -&gt; ([Int], PureMT)) -&gt; Rand [Int]
forall g a. (g -&gt; (a, g)) -&gt; Rand g a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">liftRand</span></a></span><span> </span><span class="annot"><span class="annottext">((PureMT -&gt; ([Int], PureMT)) -&gt; Rand [Int])
-&gt; (PureMT -&gt; ([Int], PureMT)) -&gt; Rand [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067505"><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067504"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067504"><span class="hs-identifier hs-var">sampleSet</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067503"><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067503"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PureMT -&gt; Int -&gt; Set Int -&gt; (Set Int, PureMT)
forall a t.
(Ord a, Num a, RandomGen t) =&gt;
t -&gt; a -&gt; Set Int -&gt; (Set Int, t)
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var">buildSampleSet</span></a></span><span> </span><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067505"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067507"><span class="hs-identifier hs-var">sampleSize</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int -&gt; [Int]
forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067504"><span class="hs-identifier hs-var">sampleSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067503"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>    </span><span id="local-6989586621679067502"><span class="annot"><span class="annottext">buildSampleSet :: t -&gt; a -&gt; Set Int -&gt; (Set Int, t)
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var hs-var">buildSampleSet</span></a></span></span><span> </span><span id="local-6989586621679067499"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679067498"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067497"><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067497"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-98"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067496"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067496"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067495"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067495"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; t -&gt; (Int, t)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067506"><span class="hs-identifier hs-var">populationSize</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067499"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-101"></span><span>            </span><span class="hs-keyword">in</span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067496"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Set Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">t -&gt; a -&gt; Set Int -&gt; (Set Int, t)
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var">buildSampleSet</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067495"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067497"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-103"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">t -&gt; a -&gt; Set Int -&gt; (Set Int, t)
</span><a href="#local-6989586621679067502"><span class="hs-identifier hs-var">buildSampleSet</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679067495"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067498"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Set Int -&gt; Set Int
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067496"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Set Int
</span><a href="#local-6989586621679067497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Randomly reorder the list.</span><span>
</span><span id="line-106"></span><span id="local-6989586621679067492"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#shuffle"><span class="hs-identifier hs-type">shuffle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-107"></span><span id="shuffle"><span class="annot"><span class="annottext">shuffle :: [a] -&gt; Rand [a]
</span><a href="Moo.GeneticAlgorithm.Random.html#shuffle"><span class="hs-identifier hs-var hs-var">shuffle</span></a></span></span><span> </span><span id="local-6989586621679067491"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067491"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(PureMT -&gt; ([a], PureMT)) -&gt; Rand [a]
forall g a. (g -&gt; (a, g)) -&gt; Rand g a
</span><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-var">liftRand</span></a></span><span> </span><span class="annot"><span class="annottext">((PureMT -&gt; ([a], PureMT)) -&gt; Rand [a])
-&gt; (PureMT -&gt; ([a], PureMT)) -&gt; Rand [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679067490"><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067490"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; PureMT -&gt; ([a], PureMT)
forall gen a. RandomGen gen =&gt; [a] -&gt; Int -&gt; gen -&gt; ([a], gen)
</span><a href="Moo.GeneticAlgorithm.Random.html#randomShuffle"><span class="hs-identifier hs-var">randomShuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067491"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067491"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PureMT
</span><a href="#local-6989586621679067490"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Given a sequence (e1,...en) to shuffle, its length, and a random</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- generator, compute the corresponding permutation of the input</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- sequence, return the permutation and the new state of the</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- random generator.</span><span>
</span><span id="line-113"></span><span id="local-6989586621679067582"><span id="local-6989586621679067583"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#randomShuffle"><span class="hs-identifier hs-type">randomShuffle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067583"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067583"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679067582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067583"><span class="hs-identifier hs-type">gen</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-114"></span><span id="randomShuffle"><span class="annot"><span class="annottext">randomShuffle :: [a] -&gt; Int -&gt; gen -&gt; ([a], gen)
</span><a href="Moo.GeneticAlgorithm.Random.html#randomShuffle"><span class="hs-identifier hs-var hs-var">randomShuffle</span></a></span></span><span> </span><span id="local-6989586621679067488"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067488"><span class="hs-identifier hs-var">elements</span></a></span></span><span> </span><span id="local-6989586621679067487"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067487"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679067486"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067486"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067485"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679067485"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067484"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067484"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; gen -&gt; ([Int], gen)
forall gen. RandomGen gen =&gt; Int -&gt; gen -&gt; ([Int], gen)
</span><a href="#local-6989586621679067483"><span class="hs-identifier hs-var">rseq</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067487"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067486"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [Int] -&gt; [a]
forall a. [a] -&gt; [Int] -&gt; [a]
</span><a href="../../../../random-shuffle/html/src"><span class="hs-identifier hs-var">S.shuffle</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679067488"><span class="hs-identifier hs-var">elements</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679067485"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067484"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- | The sequence (r1,...r[n-1]) of numbers such that r[i] is an</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- independent sample from a uniform random distribution</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- [0..n-i]</span><span>
</span><span id="line-121"></span><span>  </span><span id="local-6989586621679067579"><span class="annot"><a href="#local-6989586621679067483"><span class="hs-identifier hs-type">rseq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067579"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067579"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067579"><span class="hs-identifier hs-type">gen</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-122"></span><span>  </span><span id="local-6989586621679067483"><span class="annot"><span class="annottext">rseq :: Int -&gt; gen -&gt; ([Int], gen)
</span><a href="#local-6989586621679067483"><span class="hs-identifier hs-var hs-var">rseq</span></a></span></span><span> </span><span id="local-6989586621679067481"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679067480"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([gen] -&gt; gen) -&gt; ([Int], [gen]) -&gt; ([Int], gen)
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="#local-6989586621679067479"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">[gen] -&gt; gen
</span><a href="#local-6989586621679067478"><span class="hs-identifier hs-var">lastGen</span></a></span><span> </span><span class="annot"><span class="annottext">(([Int], [gen]) -&gt; ([Int], gen))
-&gt; ([(Int, gen)] -&gt; ([Int], [gen])) -&gt; [(Int, gen)] -&gt; ([Int], gen)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Int, gen)] -&gt; ([Int], [gen])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Int, gen)] -&gt; ([Int], gen)) -&gt; [(Int, gen)] -&gt; ([Int], gen)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; gen -&gt; [(Int, gen)]
forall gen. RandomGen gen =&gt; Int -&gt; gen -&gt; [(Int, gen)]
</span><a href="#local-6989586621679067475"><span class="hs-identifier hs-var">rseq'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067481"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621679067568"><span class="annot"><a href="#local-6989586621679067475"><span class="hs-identifier hs-type">rseq'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../random/html/src"><span class="hs-identifier hs-type">RandomGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067568"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067568"><span class="hs-identifier hs-type">gen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067568"><span class="hs-identifier hs-type">gen</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-125"></span><span>        </span><span id="local-6989586621679067475"><span class="annot"><span class="annottext">rseq' :: Int -&gt; gen -&gt; [(Int, gen)]
</span><a href="#local-6989586621679067475"><span class="hs-identifier hs-var hs-var">rseq'</span></a></span></span><span> </span><span id="local-6989586621679067474"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679067473"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067473"><span class="hs-identifier hs-var">gen</span></a></span></span><span>
</span><span id="line-126"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067472"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067472"><span class="hs-identifier hs-var">j</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679067471"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067471"><span class="hs-identifier hs-var">gen'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; gen -&gt; (Int, gen)
forall a g. (Random a, RandomGen g) =&gt; (a, a) -&gt; g -&gt; (a, g)
</span><a href="../../../../random/html/src"><span class="hs-identifier hs-var">randomR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067473"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-128"></span><span>                        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067472"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067471"><span class="hs-identifier hs-var">gen'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int, gen) -&gt; [(Int, gen)] -&gt; [(Int, gen)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; gen -&gt; [(Int, gen)]
forall gen. RandomGen gen =&gt; Int -&gt; gen -&gt; [(Int, gen)]
</span><a href="#local-6989586621679067475"><span class="hs-identifier hs-var">rseq'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679067474"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067471"><span class="hs-identifier hs-var">gen'</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-comment">-- apply a function on the second element of a pair</span><span>
</span><span id="line-130"></span><span>        </span><span id="local-6989586621679067574"><span id="local-6989586621679067575"><span id="local-6989586621679067576"><span class="annot"><a href="#local-6989586621679067479"><span class="hs-identifier hs-type">second</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067576"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679067575"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067574"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067576"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067574"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679067575"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679067479"><span class="annot"><span class="annottext">second :: (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
</span><a href="#local-6989586621679067479"><span class="hs-identifier hs-var hs-var">second</span></a></span></span><span> </span><span id="local-6989586621679067470"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679067470"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067469"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067469"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679067468"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067468"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067469"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679067470"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679067468"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>        </span><span class="hs-comment">-- the last returned random number generator</span><span>
</span><span id="line-133"></span><span>        </span><span id="local-6989586621679067478"><span class="annot"><span class="annottext">lastGen :: [gen] -&gt; gen
</span><a href="#local-6989586621679067478"><span class="hs-identifier hs-var hs-var">lastGen</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067480"><span class="hs-identifier hs-var">g</span></a></span><span>   </span><span class="hs-comment">-- didn't use the generator yet</span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><a href="#local-6989586621679067478"><span class="hs-identifier hs-var">lastGen</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679067467"><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067467"><span class="hs-identifier hs-var">lst</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">gen
</span><a href="#local-6989586621679067467"><span class="hs-identifier hs-var">lst</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="#local-6989586621679067478"><span class="hs-identifier hs-var">lastGen</span></a></span><span> </span><span id="local-6989586621679067466"><span class="annot"><span class="annottext">[gen]
</span><a href="#local-6989586621679067466"><span class="hs-identifier hs-var">gens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[gen] -&gt; gen
</span><a href="#local-6989586621679067478"><span class="hs-identifier hs-var">lastGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [gen] -&gt; [gen]
forall a. Int -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[gen]
</span><a href="#local-6989586621679067466"><span class="hs-identifier hs-var">gens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- |Modify value with probability @p@. Return the unchanged value with probability @1-p@.</span><span>
</span><span id="line-138"></span><span id="local-6989586621679067465"><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#withProbability"><span class="hs-identifier hs-type">withProbability</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679067465"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Moo.GeneticAlgorithm.Random.html#Rand"><span class="hs-identifier hs-type">Rand</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679067465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-139"></span><span id="withProbability"><span class="annot"><span class="annottext">withProbability :: Double -&gt; (a -&gt; Rand a) -&gt; a -&gt; Rand a
</span><a href="Moo.GeneticAlgorithm.Random.html#withProbability"><span class="hs-identifier hs-var hs-var">withProbability</span></a></span></span><span> </span><span id="local-6989586621679067464"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067464"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679067463"><span class="annot"><span class="annottext">a -&gt; Rand a
</span><a href="#local-6989586621679067463"><span class="hs-identifier hs-var">modify</span></a></span></span><span> </span><span id="local-6989586621679067462"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067462"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679067461"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067461"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rand Double
</span><a href="Moo.GeneticAlgorithm.Random.html#getDouble"><span class="hs-identifier hs-var">getDouble</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067461"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679067464"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-142"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rand a
</span><a href="#local-6989586621679067463"><span class="hs-identifier hs-var">modify</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067462"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-143"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Rand a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679067462"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-144"></span></pre></body></html>