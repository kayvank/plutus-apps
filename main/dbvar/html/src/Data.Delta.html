<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_JOyzrfNfpe20ayhttBCnwx"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">{- HLINT ignore &quot;Use newtype instead of data&quot; -}</span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.Delta</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Synopsis</span></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-comment">-- | Delta encodings.</span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-comment">-- The type constraint 'Delta'@ delta@ means that the type @delta@</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-comment">-- is a delta encoding of the corresponding base type 'Base'@ delta@.</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-comment">-- Delta encodings can be transformed into each other using an 'Embedding'.</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Delta encodings</span></span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#NoChange"><span class="hs-identifier">NoChange</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier">Replace</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaList"><span class="hs-identifier">DeltaList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier">DeltaSet1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier">DeltaSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#mkDeltaSet"><span class="hs-identifier">mkDeltaSet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#deltaSetToList"><span class="hs-identifier">deltaSetToList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#deltaSetFromList"><span class="hs-identifier">deltaSetFromList</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Embedding of types and delta encodings</span></span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><span class="hs-comment">-- $Embedding</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="../../../../semigroupoids/html/src"><span class="hs-identifier">Data.Semigroupoid</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier">Embedding'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#mkEmbedding"><span class="hs-identifier">mkEmbedding</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#fromEmbedding"><span class="hs-identifier">fromEmbedding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#pair"><span class="hs-identifier">pair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#liftUpdates"><span class="hs-identifier">liftUpdates</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#replaceFromApply"><span class="hs-identifier">replaceFromApply</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#inject"><span class="hs-identifier">inject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#project"><span class="hs-identifier">project</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier">Machine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#idle"><span class="hs-identifier">idle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#pairMachine"><span class="hs-identifier">pairMachine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#fromState"><span class="hs-identifier">fromState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Exception</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">SomeException</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Either</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromRight</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../semigroupoids/html/src"><span class="hs-identifier">Data.Semigroupoid</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../semigroupoids/html/src"><span class="hs-identifier">Semigroupoid</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">{-------------------------------------------------------------------------------
    Delta encodings
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | Type class for delta encodings.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">class</span><span> </span><span id="Delta"><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-var">Delta</span></a></span></span><span> </span><span id="local-6989586621679209469"><span class="annot"><a href="#local-6989586621679209469"><span class="hs-identifier hs-type">delta</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-comment">-- | Base type for which @delta@ represents a delta encoding.</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-comment">-- This is implemented as a type family, so that we can have</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-comment">-- multiple delta encodings for the same base type.</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- FIXME: Better name for 'Base'? It's sooo generic.</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- Pier, dock, ground, anchor, site, &#8230;</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span id="local-6989586621679209469"><span class="annot"><a href="#local-6989586621679209469"><span class="hs-identifier hs-type">delta</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-comment">-- | Apply a delta encoding to the base type.</span><span>
</span><span id="line-65"></span><span>    </span><span id="apply"><span class="annot"><a href="Data.Delta.html#apply"><span class="hs-identifier hs-type">apply</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679209469"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209469"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209469"><span class="hs-identifier hs-type">delta</span></a></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Trivial delta encoding for the type @a@ that admits no change at all.</span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="NoChange"><span class="annot"><a href="Data.Delta.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a></span></span><span> </span><span id="local-6989586621679209299"><span class="annot"><a href="#local-6989586621679209299"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NoChange"><span class="annot"><a href="Data.Delta.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a></span></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209294"><span id="local-6989586621679209296"><span class="annot"><span class="annottext">NoChange a -&gt; NoChange a -&gt; Bool
(NoChange a -&gt; NoChange a -&gt; Bool)
-&gt; (NoChange a -&gt; NoChange a -&gt; Bool) -&gt; Eq (NoChange a)
forall a. NoChange a -&gt; NoChange a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NoChange a -&gt; NoChange a -&gt; Bool
$c/= :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
== :: NoChange a -&gt; NoChange a -&gt; Bool
$c== :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209278"><span id="local-6989586621679209280"><span id="local-6989586621679209282"><span id="local-6989586621679209284"><span id="local-6989586621679209286"><span id="local-6989586621679209288"><span id="local-6989586621679209290"><span class="annot"><span class="annottext">Eq (NoChange a)
Eq (NoChange a)
-&gt; (NoChange a -&gt; NoChange a -&gt; Ordering)
-&gt; (NoChange a -&gt; NoChange a -&gt; Bool)
-&gt; (NoChange a -&gt; NoChange a -&gt; Bool)
-&gt; (NoChange a -&gt; NoChange a -&gt; Bool)
-&gt; (NoChange a -&gt; NoChange a -&gt; Bool)
-&gt; (NoChange a -&gt; NoChange a -&gt; NoChange a)
-&gt; (NoChange a -&gt; NoChange a -&gt; NoChange a)
-&gt; Ord (NoChange a)
NoChange a -&gt; NoChange a -&gt; Bool
NoChange a -&gt; NoChange a -&gt; Ordering
NoChange a -&gt; NoChange a -&gt; NoChange a
forall a. Eq (NoChange a)
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. NoChange a -&gt; NoChange a -&gt; Bool
forall a. NoChange a -&gt; NoChange a -&gt; Ordering
forall a. NoChange a -&gt; NoChange a -&gt; NoChange a
min :: NoChange a -&gt; NoChange a -&gt; NoChange a
$cmin :: forall a. NoChange a -&gt; NoChange a -&gt; NoChange a
max :: NoChange a -&gt; NoChange a -&gt; NoChange a
$cmax :: forall a. NoChange a -&gt; NoChange a -&gt; NoChange a
&gt;= :: NoChange a -&gt; NoChange a -&gt; Bool
$c&gt;= :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
&gt; :: NoChange a -&gt; NoChange a -&gt; Bool
$c&gt; :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
&lt;= :: NoChange a -&gt; NoChange a -&gt; Bool
$c&lt;= :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
&lt; :: NoChange a -&gt; NoChange a -&gt; Bool
$c&lt; :: forall a. NoChange a -&gt; NoChange a -&gt; Bool
compare :: NoChange a -&gt; NoChange a -&gt; Ordering
$ccompare :: forall a. NoChange a -&gt; NoChange a -&gt; Ordering
$cp1Ord :: forall a. Eq (NoChange a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209271"><span id="local-6989586621679209273"><span id="local-6989586621679209275"><span class="annot"><span class="annottext">Int -&gt; NoChange a -&gt; ShowS
[NoChange a] -&gt; ShowS
NoChange a -&gt; String
(Int -&gt; NoChange a -&gt; ShowS)
-&gt; (NoChange a -&gt; String)
-&gt; ([NoChange a] -&gt; ShowS)
-&gt; Show (NoChange a)
forall a. Int -&gt; NoChange a -&gt; ShowS
forall a. [NoChange a] -&gt; ShowS
forall a. NoChange a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NoChange a] -&gt; ShowS
$cshowList :: forall a. [NoChange a] -&gt; ShowS
show :: NoChange a -&gt; String
$cshow :: forall a. NoChange a -&gt; String
showsPrec :: Int -&gt; NoChange a -&gt; ShowS
$cshowsPrec :: forall a. Int -&gt; NoChange a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span id="local-6989586621679209269"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#NoChange"><span class="hs-identifier hs-type">NoChange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209269"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#NoChange"><span class="hs-identifier hs-type">NoChange</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209269"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679209269"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span id="local-6989586621679209266"><span class="annot"><span class="annottext">apply :: NoChange a -&gt; Base (NoChange a) -&gt; Base (NoChange a)
</span><a href="#local-6989586621679209266"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="annot"><span class="annottext">NoChange a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679209265"><span class="annot"><span class="annottext">Base (NoChange a)
</span><a href="#local-6989586621679209265"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base (NoChange a)
</span><a href="#local-6989586621679209265"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | Trivial delta encoding for the type @a@ that replaces the value wholesale.</span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="Replace"><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-var">Replace</span></a></span></span><span> </span><span id="local-6989586621679209335"><span class="annot"><a href="#local-6989586621679209335"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Replace"><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-var">Replace</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679209335"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209260"><span id="local-6989586621679209262"><span class="annot"><span class="annottext">Replace a -&gt; Replace a -&gt; Bool
(Replace a -&gt; Replace a -&gt; Bool)
-&gt; (Replace a -&gt; Replace a -&gt; Bool) -&gt; Eq (Replace a)
forall a. Eq a =&gt; Replace a -&gt; Replace a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Replace a -&gt; Replace a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Replace a -&gt; Replace a -&gt; Bool
== :: Replace a -&gt; Replace a -&gt; Bool
$c== :: forall a. Eq a =&gt; Replace a -&gt; Replace a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209245"><span id="local-6989586621679209247"><span id="local-6989586621679209249"><span id="local-6989586621679209251"><span id="local-6989586621679209253"><span id="local-6989586621679209255"><span id="local-6989586621679209257"><span class="annot"><span class="annottext">Eq (Replace a)
Eq (Replace a)
-&gt; (Replace a -&gt; Replace a -&gt; Ordering)
-&gt; (Replace a -&gt; Replace a -&gt; Bool)
-&gt; (Replace a -&gt; Replace a -&gt; Bool)
-&gt; (Replace a -&gt; Replace a -&gt; Bool)
-&gt; (Replace a -&gt; Replace a -&gt; Bool)
-&gt; (Replace a -&gt; Replace a -&gt; Replace a)
-&gt; (Replace a -&gt; Replace a -&gt; Replace a)
-&gt; Ord (Replace a)
Replace a -&gt; Replace a -&gt; Bool
Replace a -&gt; Replace a -&gt; Ordering
Replace a -&gt; Replace a -&gt; Replace a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Replace a)
forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Bool
forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Ordering
forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Replace a
min :: Replace a -&gt; Replace a -&gt; Replace a
$cmin :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Replace a
max :: Replace a -&gt; Replace a -&gt; Replace a
$cmax :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Replace a
&gt;= :: Replace a -&gt; Replace a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Bool
&gt; :: Replace a -&gt; Replace a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Bool
&lt;= :: Replace a -&gt; Replace a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Bool
&lt; :: Replace a -&gt; Replace a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Bool
compare :: Replace a -&gt; Replace a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; Replace a -&gt; Replace a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (Replace a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209239"><span id="local-6989586621679209241"><span id="local-6989586621679209243"><span class="annot"><span class="annottext">Int -&gt; Replace a -&gt; ShowS
[Replace a] -&gt; ShowS
Replace a -&gt; String
(Int -&gt; Replace a -&gt; ShowS)
-&gt; (Replace a -&gt; String)
-&gt; ([Replace a] -&gt; ShowS)
-&gt; Show (Replace a)
forall a. Show a =&gt; Int -&gt; Replace a -&gt; ShowS
forall a. Show a =&gt; [Replace a] -&gt; ShowS
forall a. Show a =&gt; Replace a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Replace a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [Replace a] -&gt; ShowS
show :: Replace a -&gt; String
$cshow :: forall a. Show a =&gt; Replace a -&gt; String
showsPrec :: Int -&gt; Replace a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; Replace a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679209238"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-type">Replace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-type">Replace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209238"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679209238"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621679209236"><span class="annot"><span class="annottext">apply :: Replace a -&gt; Base (Replace a) -&gt; Base (Replace a)
</span><a href="#local-6989586621679209236"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-type">Replace</span></a></span><span> </span><span id="local-6989586621679209235"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209235"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Base (Replace a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
Base (Replace a)
</span><a href="#local-6989586621679209235"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">-- | Combine replacements. The first argument takes precedence.</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- In this way, 'apply' becomes a 'Semigroup' morphism.</span><span>
</span><span id="line-85"></span><span id="local-6989586621679209234"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679209229"><span id="local-6989586621679209231"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-type">Replace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209234"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621679209227"><span class="annot"><span class="annottext">Replace a
</span><a href="#local-6989586621679209227"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679209226"><span class="annot"><span class="annottext">&lt;&gt; :: Replace a -&gt; Replace a -&gt; Replace a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><span class="annottext">Replace a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Replace a
</span><a href="#local-6989586621679209227"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | A delta can be optionally applied.</span><span>
</span><span id="line-89"></span><span id="local-6989586621679209225"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209225"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209225"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209225"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209225"><span class="hs-identifier hs-type">delta</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span id="local-6989586621679209223"><span class="annot"><span class="annottext">apply :: Maybe delta -&gt; Base (Maybe delta) -&gt; Base (Maybe delta)
</span><a href="#local-6989586621679209223"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Base delta -&gt; Base delta)
-&gt; (delta -&gt; Base delta -&gt; Base delta)
-&gt; Maybe delta
-&gt; Base delta
-&gt; Base delta
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Base delta -&gt; Base delta
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">delta -&gt; Base delta -&gt; Base delta
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | A list of deltas can be applied like a single delta.</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- This overloading of 'apply' is very convenient.</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- Order is important: The 'head' of the list is applied __last__.</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- This way, we have a morphism to the 'Endo' 'Monoid':</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt; apply []         = id</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt; apply (d1 &lt;&gt; d2) = apply d1 . apply d2</span><span>
</span><span id="line-101"></span><span id="local-6989586621679209220"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209220"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679209220"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679209220"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209220"><span class="hs-identifier hs-type">delta</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679209218"><span class="annot"><span class="annottext">apply :: [delta] -&gt; Base [delta] -&gt; Base [delta]
</span><a href="#local-6989586621679209218"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679209217"><span class="annot"><span class="annottext">[delta]
</span><a href="#local-6989586621679209217"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679209216"><span class="annot"><span class="annottext">Base [delta]
</span><a href="#local-6989586621679209216"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(delta -&gt; Base delta -&gt; Base delta)
-&gt; Base delta -&gt; [delta] -&gt; Base delta
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">delta -&gt; Base delta -&gt; Base delta
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Base delta
Base [delta]
</span><a href="#local-6989586621679209216"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[delta]
</span><a href="#local-6989586621679209217"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | For convenience, a nonempty list of deltas</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- can be applied like a list of deltas.</span><span>
</span><span id="line-107"></span><span id="local-6989586621679209214"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209214"><span class="hs-identifier hs-type">delta</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209214"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209214"><span class="hs-identifier hs-type">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209214"><span class="hs-identifier hs-type">delta</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span id="local-6989586621679209212"><span class="annot"><span class="annottext">apply :: NonEmpty delta -&gt; Base (NonEmpty delta) -&gt; Base (NonEmpty delta)
</span><a href="#local-6989586621679209212"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679209211"><span class="annot"><span class="annottext">NonEmpty delta
</span><a href="#local-6989586621679209211"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679209210"><span class="annot"><span class="annottext">Base (NonEmpty delta)
</span><a href="#local-6989586621679209210"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(delta -&gt; Base delta -&gt; Base delta)
-&gt; Base delta -&gt; NonEmpty delta -&gt; Base delta
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">delta -&gt; Base delta -&gt; Base delta
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">Base delta
Base (NonEmpty delta)
</span><a href="#local-6989586621679209210"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty delta
</span><a href="#local-6989586621679209211"><span class="hs-identifier hs-var">ds</span></a></span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | A pair of deltas represents a delta for a pair.</span><span>
</span><span id="line-112"></span><span id="local-6989586621679209208"><span id="local-6989586621679209209"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209209"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209208"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209209"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209208"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209209"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209208"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209209"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209208"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679209206"><span class="annot"><span class="annottext">apply :: (d1, d2) -&gt; Base (d1, d2) -&gt; Base (d1, d2)
</span><a href="#local-6989586621679209206"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209205"><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209205"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209204"><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209204"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209203"><span class="annot"><a href="#local-6989586621679209203"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209202"><span class="annot"><a href="#local-6989586621679209202"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d1 -&gt; Base d1 -&gt; Base d1
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209205"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Base d1
</span><a href="#local-6989586621679209203"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d2 -&gt; Base d2 -&gt; Base d2
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209204"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Base d2
</span><a href="#local-6989586621679209202"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | A triple of deltas represents a delta for a triple.</span><span>
</span><span id="line-117"></span><span id="local-6989586621679209199"><span id="local-6989586621679209200"><span id="local-6989586621679209201"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209201"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209200"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209199"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209201"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209200"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209199"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209201"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209200"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209199"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209201"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209200"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209199"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span id="local-6989586621679209197"><span class="annot"><span class="annottext">apply :: (d1, d2, d3) -&gt; Base (d1, d2, d3) -&gt; Base (d1, d2, d3)
</span><a href="#local-6989586621679209197"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209196"><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209196"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209195"><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209195"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209194"><span class="annot"><span class="annottext">d3
</span><a href="#local-6989586621679209194"><span class="hs-identifier hs-var">d3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209193"><span class="annot"><a href="#local-6989586621679209193"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209192"><span class="annot"><a href="#local-6989586621679209192"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209191"><span class="annot"><a href="#local-6989586621679209191"><span class="hs-identifier hs-var">a3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d1 -&gt; Base d1 -&gt; Base d1
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209196"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Base d1
</span><a href="#local-6989586621679209193"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d2 -&gt; Base d2 -&gt; Base d2
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209195"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Base d2
</span><a href="#local-6989586621679209192"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d3 -&gt; Base d3 -&gt; Base d3
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d3
</span><a href="#local-6989586621679209194"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Base d3
</span><a href="#local-6989586621679209191"><span class="hs-identifier hs-var">a3</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | A 4-tuple of deltas represents a delta for a 4-tuple.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679209187"><span id="local-6989586621679209188"><span id="local-6989586621679209189"><span id="local-6989586621679209190"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209190"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209189"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209188"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209187"><span class="hs-identifier hs-type">d4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209190"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209189"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209188"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209187"><span class="hs-identifier hs-type">d4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209190"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209189"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209188"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209187"><span class="hs-identifier hs-type">d4</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209190"><span class="hs-identifier hs-type">d1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209189"><span class="hs-identifier hs-type">d2</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209188"><span class="hs-identifier hs-type">d3</span></a></span><span class="hs-special">,</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209187"><span class="hs-identifier hs-type">d4</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679209185"><span class="annot"><span class="annottext">apply :: (d1, d2, d3, d4) -&gt; Base (d1, d2, d3, d4) -&gt; Base (d1, d2, d3, d4)
</span><a href="#local-6989586621679209185"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209184"><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209184"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209183"><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209183"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209182"><span class="annot"><span class="annottext">d3
</span><a href="#local-6989586621679209182"><span class="hs-identifier hs-var">d3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209181"><span class="annot"><span class="annottext">d4
</span><a href="#local-6989586621679209181"><span class="hs-identifier hs-var">d4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209180"><span class="annot"><a href="#local-6989586621679209180"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209179"><span class="annot"><a href="#local-6989586621679209179"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209178"><span class="annot"><a href="#local-6989586621679209178"><span class="hs-identifier hs-var">a3</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209177"><span class="annot"><a href="#local-6989586621679209177"><span class="hs-identifier hs-var">a4</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">d1 -&gt; Base d1 -&gt; Base d1
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d1
</span><a href="#local-6989586621679209184"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Base d1
</span><a href="#local-6989586621679209180"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d2 -&gt; Base d2 -&gt; Base d2
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d2
</span><a href="#local-6989586621679209183"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Base d2
</span><a href="#local-6989586621679209179"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d3 -&gt; Base d3 -&gt; Base d3
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d3
</span><a href="#local-6989586621679209182"><span class="hs-identifier hs-var">d3</span></a></span><span> </span><span class="annot"><span class="annottext">Base d3
</span><a href="#local-6989586621679209178"><span class="hs-identifier hs-var">a3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d4 -&gt; Base d4 -&gt; Base d4
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">d4
</span><a href="#local-6989586621679209181"><span class="hs-identifier hs-var">d4</span></a></span><span> </span><span class="annot"><span class="annottext">Base d4
</span><a href="#local-6989586621679209177"><span class="hs-identifier hs-var">a4</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | Delta encoding for lists where a list of elements is prepended.</span><span>
</span><span id="line-128"></span><span class="hs-keyword">data</span><span> </span><span id="DeltaList"><span class="annot"><a href="Data.Delta.html#DeltaList"><span class="hs-identifier hs-var">DeltaList</span></a></span></span><span> </span><span id="local-6989586621679209176"><span class="annot"><a href="#local-6989586621679209176"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Append"><span class="annot"><a href="Data.Delta.html#Append"><span class="hs-identifier hs-var">Append</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679209176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209171"><span id="local-6989586621679209173"><span class="annot"><span class="annottext">DeltaList a -&gt; DeltaList a -&gt; Bool
(DeltaList a -&gt; DeltaList a -&gt; Bool)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Bool) -&gt; Eq (DeltaList a)
forall a. Eq a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c/= :: forall a. Eq a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
== :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c== :: forall a. Eq a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209156"><span id="local-6989586621679209158"><span id="local-6989586621679209160"><span id="local-6989586621679209162"><span id="local-6989586621679209164"><span id="local-6989586621679209166"><span id="local-6989586621679209168"><span class="annot"><span class="annottext">Eq (DeltaList a)
Eq (DeltaList a)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Ordering)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Bool)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Bool)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Bool)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; Bool)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; DeltaList a)
-&gt; (DeltaList a -&gt; DeltaList a -&gt; DeltaList a)
-&gt; Ord (DeltaList a)
DeltaList a -&gt; DeltaList a -&gt; Bool
DeltaList a -&gt; DeltaList a -&gt; Ordering
DeltaList a -&gt; DeltaList a -&gt; DeltaList a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (DeltaList a)
forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Ordering
forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; DeltaList a
min :: DeltaList a -&gt; DeltaList a -&gt; DeltaList a
$cmin :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; DeltaList a
max :: DeltaList a -&gt; DeltaList a -&gt; DeltaList a
$cmax :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; DeltaList a
&gt;= :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
&gt; :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
&lt;= :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
&lt; :: DeltaList a -&gt; DeltaList a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Bool
compare :: DeltaList a -&gt; DeltaList a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; DeltaList a -&gt; DeltaList a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (DeltaList a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209150"><span id="local-6989586621679209152"><span id="local-6989586621679209154"><span class="annot"><span class="annottext">Int -&gt; DeltaList a -&gt; ShowS
[DeltaList a] -&gt; ShowS
DeltaList a -&gt; String
(Int -&gt; DeltaList a -&gt; ShowS)
-&gt; (DeltaList a -&gt; String)
-&gt; ([DeltaList a] -&gt; ShowS)
-&gt; Show (DeltaList a)
forall a. Show a =&gt; Int -&gt; DeltaList a -&gt; ShowS
forall a. Show a =&gt; [DeltaList a] -&gt; ShowS
forall a. Show a =&gt; DeltaList a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DeltaList a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [DeltaList a] -&gt; ShowS
show :: DeltaList a -&gt; String
$cshow :: forall a. Show a =&gt; DeltaList a -&gt; String
showsPrec :: Int -&gt; DeltaList a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; DeltaList a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span id="local-6989586621679209149"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaList"><span class="hs-identifier hs-type">DeltaList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaList"><span class="hs-identifier hs-type">DeltaList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679209149"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679209147"><span class="annot"><span class="annottext">apply :: DeltaList a -&gt; Base (DeltaList a) -&gt; Base (DeltaList a)
</span><a href="#local-6989586621679209147"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Append"><span class="hs-identifier hs-type">Append</span></a></span><span> </span><span id="local-6989586621679209146"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679209146"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679209145"><span class="annot"><span class="annottext">Base (DeltaList a)
</span><a href="#local-6989586621679209145"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679209146"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
Base (DeltaList a)
</span><a href="#local-6989586621679209145"><span class="hs-identifier hs-var">ys</span></a></span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Delta encoding for 'Set' where a single element is deleted or added.</span><span>
</span><span id="line-136"></span><span class="hs-keyword">data</span><span> </span><span id="DeltaSet1"><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier hs-var">DeltaSet1</span></a></span></span><span> </span><span id="local-6989586621679209417"><span class="annot"><a href="#local-6989586621679209417"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Insert"><span class="annot"><a href="Data.Delta.html#Insert"><span class="hs-identifier hs-var">Insert</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679209417"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Delete"><span class="annot"><a href="Data.Delta.html#Delete"><span class="hs-identifier hs-var">Delete</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679209417"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209139"><span id="local-6989586621679209141"><span class="annot"><span class="annottext">DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
(DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool) -&gt; Eq (DeltaSet1 a)
forall a. Eq a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c/= :: forall a. Eq a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
== :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c== :: forall a. Eq a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209124"><span id="local-6989586621679209126"><span id="local-6989586621679209128"><span id="local-6989586621679209130"><span id="local-6989586621679209132"><span id="local-6989586621679209134"><span id="local-6989586621679209136"><span class="annot"><span class="annottext">Eq (DeltaSet1 a)
Eq (DeltaSet1 a)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Ordering)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a)
-&gt; (DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a)
-&gt; Ord (DeltaSet1 a)
DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
DeltaSet1 a -&gt; DeltaSet1 a -&gt; Ordering
DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (DeltaSet1 a)
forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Ordering
forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
min :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
$cmin :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
max :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
$cmax :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; DeltaSet1 a
&gt;= :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
&gt; :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
&lt;= :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
&lt; :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
$c&lt; :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Bool
compare :: DeltaSet1 a -&gt; DeltaSet1 a -&gt; Ordering
$ccompare :: forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet1 a -&gt; Ordering
$cp1Ord :: forall a. Ord a =&gt; Eq (DeltaSet1 a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209118"><span id="local-6989586621679209120"><span id="local-6989586621679209122"><span class="annot"><span class="annottext">Int -&gt; DeltaSet1 a -&gt; ShowS
[DeltaSet1 a] -&gt; ShowS
DeltaSet1 a -&gt; String
(Int -&gt; DeltaSet1 a -&gt; ShowS)
-&gt; (DeltaSet1 a -&gt; String)
-&gt; ([DeltaSet1 a] -&gt; ShowS)
-&gt; Show (DeltaSet1 a)
forall a. Show a =&gt; Int -&gt; DeltaSet1 a -&gt; ShowS
forall a. Show a =&gt; [DeltaSet1 a] -&gt; ShowS
forall a. Show a =&gt; DeltaSet1 a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DeltaSet1 a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [DeltaSet1 a] -&gt; ShowS
show :: DeltaSet1 a -&gt; String
$cshow :: forall a. Show a =&gt; DeltaSet1 a -&gt; String
showsPrec :: Int -&gt; DeltaSet1 a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; DeltaSet1 a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621679209117"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209117"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier hs-type">DeltaSet1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209117"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier hs-type">DeltaSet1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209117"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209117"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679209115"><span class="annot"><span class="annottext">apply :: DeltaSet1 a -&gt; Base (DeltaSet1 a) -&gt; Base (DeltaSet1 a)
</span><a href="#local-6989586621679209115"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Insert"><span class="hs-identifier hs-type">Insert</span></a></span><span> </span><span id="local-6989586621679209114"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209114"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209114"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delete"><span class="hs-identifier hs-type">Delete</span></a></span><span> </span><span id="local-6989586621679209112"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209112"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209112"><span class="hs-identifier hs-var">a</span></a></span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Delta encoding for a 'Set' where</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- collections of elements are inserted or deleted.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="DeltaSet"><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span></span><span> </span><span id="local-6989586621679209421"><span class="annot"><a href="#local-6989586621679209421"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DeltaSet"><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="inserts"><span class="annot"><span class="annottext">DeltaSet a -&gt; Set a
</span><a href="Data.Delta.html#inserts"><span class="hs-identifier hs-var hs-var">inserts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209421"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="deletes"><span class="annot"><span class="annottext">DeltaSet a -&gt; Set a
</span><a href="Data.Delta.html#deletes"><span class="hs-identifier hs-var hs-var">deletes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209421"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209104"><span id="local-6989586621679209106"><span class="annot"><span class="annottext">DeltaSet a -&gt; DeltaSet a -&gt; Bool
(DeltaSet a -&gt; DeltaSet a -&gt; Bool)
-&gt; (DeltaSet a -&gt; DeltaSet a -&gt; Bool) -&gt; Eq (DeltaSet a)
forall a. Eq a =&gt; DeltaSet a -&gt; DeltaSet a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DeltaSet a -&gt; DeltaSet a -&gt; Bool
$c/= :: forall a. Eq a =&gt; DeltaSet a -&gt; DeltaSet a -&gt; Bool
== :: DeltaSet a -&gt; DeltaSet a -&gt; Bool
$c== :: forall a. Eq a =&gt; DeltaSet a -&gt; DeltaSet a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- INVARIANT: The two sets are always disjoint.</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span id="local-6989586621679209103"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209103"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209103"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Base"><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-var">Base</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209103"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209103"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679209101"><span class="annot"><span class="annottext">apply :: DeltaSet a -&gt; Base (DeltaSet a) -&gt; Base (DeltaSet a)
</span><a href="#local-6989586621679209101"><span class="hs-identifier hs-var hs-var hs-var hs-var">apply</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span id="local-6989586621679209100"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209100"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679209099"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209099"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679209098"><span class="annot"><span class="annottext">Base (DeltaSet a)
</span><a href="#local-6989586621679209098"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209100"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
Base (DeltaSet a)
</span><a href="#local-6989586621679209098"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209099"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Delta to get from the second argument to the first argument.</span><span>
</span><span id="line-157"></span><span id="local-6989586621679209095"><span class="annot"><a href="Data.Delta.html#mkDeltaSet"><span class="hs-identifier hs-type">mkDeltaSet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209095"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209095"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209095"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209095"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-158"></span><span id="mkDeltaSet"><span class="annot"><span class="annottext">mkDeltaSet :: Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#mkDeltaSet"><span class="hs-identifier hs-var hs-var">mkDeltaSet</span></a></span></span><span> </span><span id="local-6989586621679209094"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209094"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span id="local-6989586621679209093"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209093"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209094"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209093"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209093"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209094"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Flatten a 'DeltaSet' to a list of 'DeltaSet1'.</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- In the result list, the set of @a@ appearing as 'Insert'@ a@</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- is /disjoint/ from the set of @a@ appearing as 'Delete'@ a@.</span><span>
</span><span id="line-165"></span><span id="local-6989586621679209092"><span class="annot"><a href="Data.Delta.html#deltaSetToList"><span class="hs-identifier hs-type">deltaSetToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209092"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier hs-type">DeltaSet1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209092"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-166"></span><span id="deltaSetToList"><span class="annot"><span class="annottext">deltaSetToList :: DeltaSet a -&gt; [DeltaSet1 a]
</span><a href="Data.Delta.html#deltaSetToList"><span class="hs-identifier hs-var hs-var">deltaSetToList</span></a></span></span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span class="hs-special">{</span><span id="local-6989586621679209091"><span class="annot"><span class="annottext">Set a
inserts :: Set a
inserts :: forall a. DeltaSet a -&gt; Set a
</span><a href="#local-6989586621679209091"><span class="hs-identifier hs-var hs-var">inserts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209090"><span class="annot"><span class="annottext">Set a
deletes :: Set a
deletes :: forall a. DeltaSet a -&gt; Set a
</span><a href="#local-6989586621679209090"><span class="hs-identifier hs-var hs-var">deletes</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">(a -&gt; DeltaSet1 a) -&gt; [a] -&gt; [DeltaSet1 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; DeltaSet1 a
forall a. a -&gt; DeltaSet1 a
</span><a href="Data.Delta.html#Insert"><span class="hs-identifier hs-var">Insert</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a -&gt; [a]
forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209091"><span class="hs-identifier hs-var">inserts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DeltaSet1 a] -&gt; [DeltaSet1 a] -&gt; [DeltaSet1 a]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; DeltaSet1 a) -&gt; [a] -&gt; [DeltaSet1 a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; DeltaSet1 a
forall a. a -&gt; DeltaSet1 a
</span><a href="Data.Delta.html#Delete"><span class="hs-identifier hs-var">Delete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a -&gt; [a]
forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209090"><span class="hs-identifier hs-var">deletes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Collect insertions or deletions of elements into a 'DeltaSet'.</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- To save space, combinations of 'Insert' and 'Delete'</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- for the same element are simplified when possible.</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- These simplifications always preserve the property</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &gt; apply (deltaSetFromList ds) = apply ds</span><span>
</span><span id="line-176"></span><span id="local-6989586621679209088"><span class="annot"><a href="Data.Delta.html#deltaSetFromList"><span class="hs-identifier hs-type">deltaSetFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209088"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.Delta.html#DeltaSet1"><span class="hs-identifier hs-type">DeltaSet1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209088"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209088"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-177"></span><span id="deltaSetFromList"><span class="annot"><span class="annottext">deltaSetFromList :: [DeltaSet1 a] -&gt; DeltaSet a
</span><a href="Data.Delta.html#deltaSetFromList"><span class="hs-identifier hs-var hs-var">deltaSetFromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DeltaSet1 a -&gt; DeltaSet a -&gt; DeltaSet a)
-&gt; DeltaSet a -&gt; [DeltaSet1 a] -&gt; DeltaSet a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">DeltaSet1 a -&gt; DeltaSet a -&gt; DeltaSet a
forall a. Ord a =&gt; DeltaSet1 a -&gt; DeltaSet a -&gt; DeltaSet a
</span><a href="#local-6989586621679209087"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">DeltaSet a
forall a. DeltaSet a
</span><a href="#local-6989586621679209086"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679209086"><span class="annot"><span class="annottext">empty :: DeltaSet a
</span><a href="#local-6989586621679209086"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621679209087"><span class="annot"><span class="annottext">step :: DeltaSet1 a -&gt; DeltaSet a -&gt; DeltaSet a
</span><a href="#local-6989586621679209087"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Insert"><span class="hs-identifier hs-type">Insert</span></a></span><span> </span><span id="local-6989586621679209084"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209084"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span id="local-6989586621679209083"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209083"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679209082"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209082"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209084"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209083"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209084"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209082"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621679209087"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delete"><span class="hs-identifier hs-type">Delete</span></a></span><span> </span><span id="local-6989586621679209081"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209081"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span id="local-6989586621679209080"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209080"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679209079"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209079"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209081"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209080"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209081"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209079"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">{- Note [DeltaSet1 Cancellations]

The following cancellation laws hold:

  apply [Insert a, Delete a] = apply (Insert a)
  apply [Insert a, Insert a] = apply (Insert a)
  apply [Delete a, Insert a] = apply (Delete a)
  apply [Delete a, Delete a] = apply (Delete a)

-}</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | 'apply' distributes over '(&lt;&gt;)'.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679209078"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679209073"><span id="local-6989586621679209075"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209078"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209078"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span id="local-6989586621679209072"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209072"><span class="hs-identifier hs-var">i1</span></a></span></span><span> </span><span id="local-6989586621679209071"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209071"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679209070"><span class="annot"><span class="annottext">&lt;&gt; :: DeltaSet a -&gt; DeltaSet a -&gt; DeltaSet a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span id="local-6989586621679209069"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209069"><span class="hs-identifier hs-var">i2</span></a></span></span><span> </span><span id="local-6989586621679209068"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209068"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209072"><span class="hs-identifier hs-var">i1</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209069"><span class="hs-identifier hs-var">i2</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209071"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209071"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.union`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209068"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Set.difference`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679209072"><span class="hs-identifier hs-var">i1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-comment">-- This takes into account [DeltaSet1 Cancellations]</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span id="local-6989586621679209067"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679209061"><span id="local-6989586621679209063"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-type">DeltaSet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679209059"><span class="annot"><span class="annottext">mempty :: DeltaSet a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; Set a -&gt; DeltaSet a
forall a. Set a -&gt; Set a -&gt; DeltaSet a
</span><a href="Data.Delta.html#DeltaSet"><span class="hs-identifier hs-var">DeltaSet</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.empty</span></a></span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">{-------------------------------------------------------------------------------
    Embedding
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-207"></span><span class="hs-comment">{- $Embedding

An 'Embedding'@ da db@ embeds one type and its delta encoding @da@
into another type and its delta encoding @db@.

For reasons of efficiency, 'Embedding' is an abstract type.
It is constructed using the 'Embedding'' type, which has
three components.

* 'write' embeds values from the type @a = Base da@
    into the type @b = Base bd@.
* 'load' attempts to retrieve the value of type @a@
    from the type @b@, but does not necessarily succeed.
* 'update' maps a delta encoding @da@ to a delta encoding @db@.
    For this mapping, the value of type @a@ and a corresponding
    value of type @b@ are provided;
    the delta encodings of types @da@ and @db@ are
    relative to these values.

The embedding of one type into the other is characterized by the following
properties:

* The embedding need __not__ be __surjective__:
    The type @b@ may contain many values that do not correspond to
    a value of type @a@. Hence, 'load' has an 'Either' result.
    (See Note [EitherSomeException] for the choice of exception type.)
    However, retrieving a written value always succeeds, we have

        &gt; load . write = Right

* The embedding is __redundant__:
    The type @b@ may contain multiple values that correspond to
    one and the same @a@.
    This is why the 'update' function expects the type @b@ as argument,
    so that the right delta encoding can be computed.
    Put differently, we often have

        &gt; write a &#8800; b   where Right a = load b

* The embedding of delta encoding __commutes with 'apply'__.
    We have

        &gt; Just (apply da a) = load (apply (update a b da) b)
        &gt;     where Right a = load b

    However, since the embedding is redundant, we often have

        &gt; apply (update a (write a) da) (write a) &#8800; write (apply da a)
-}</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | Specification of an embedding of a type @a@ with delta encoding @da@</span><span>
</span><span id="line-258"></span><span class="hs-comment">-- into the type @b@ with delta encoding @db@.</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- See [the discussion of @Embedding@](#g:3) for a more detailed description.</span><span>
</span><span id="line-260"></span><span class="hs-keyword">data</span><span> </span><span id="Embedding%27"><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-var">Embedding'</span></a></span></span><span> </span><span id="local-6989586621679209058"><span class="annot"><a href="#local-6989586621679209058"><span class="hs-identifier hs-type">da</span></a></span></span><span> </span><span id="local-6989586621679209057"><span class="annot"><a href="#local-6989586621679209057"><span class="hs-identifier hs-type">db</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>    </span><span id="local-6989586621679209055"><span id="local-6989586621679209056"><span id="local-6989586621679209381"><span id="local-6989586621679209382"><span id="Embedding%27"><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-var">Embedding'</span></a></span></span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209382"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209381"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209382"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209055"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209381"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="load"><span class="annot"><span class="annottext">()
</span><a href="Data.Delta.html#load"><span class="hs-identifier hs-var hs-var">load</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679209055"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209056"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="write"><span class="annot"><span class="annottext">()
</span><a href="Data.Delta.html#write"><span class="hs-identifier hs-var hs-var">write</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679209056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679209055"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-265"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="update"><span class="annot"><span class="annottext">()
</span><a href="Data.Delta.html#update"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679209056"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679209055"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679209382"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679209381"><span class="hs-identifier hs-type">db</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209382"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209381"><span class="hs-identifier hs-type">db</span></a></span></span></span></span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | 'Embedding' with efficient composition 'o'.</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- To construct an embedding, use 'mkEmbedding'.</span><span>
</span><span id="line-270"></span><span class="hs-keyword">data</span><span> </span><span id="Embedding"><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-var">Embedding</span></a></span></span><span> </span><span id="local-6989586621679209395"><span class="annot"><a href="#local-6989586621679209395"><span class="hs-identifier hs-type">da</span></a></span></span><span> </span><span id="local-6989586621679209394"><span class="annot"><a href="#local-6989586621679209394"><span class="hs-identifier hs-type">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Embedding"><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-var">Embedding</span></a></span></span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="inject"><span class="annot"><span class="annottext">Embedding da db -&gt; Base da -&gt; Machine da db
</span><a href="Data.Delta.html#inject"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209395"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209395"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209394"><span class="hs-identifier hs-type">db</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="project"><span class="annot"><span class="annottext">Embedding da db
-&gt; Base db -&gt; Either SomeException (Base da, Machine da db)
</span><a href="Data.Delta.html#project"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209394"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209395"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209395"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209394"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Construct 'Embedding' with efficient composition</span><span>
</span><span id="line-276"></span><span id="local-6989586621679209048"><span id="local-6989586621679209049"><span class="annot"><a href="Data.Delta.html#mkEmbedding"><span class="hs-identifier hs-type">mkEmbedding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209049"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209048"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209049"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209048"><span class="hs-identifier hs-type">db</span></a></span></span></span><span>
</span><span id="line-277"></span><span id="mkEmbedding"><span class="annot"><span class="annottext">mkEmbedding :: Embedding' da db -&gt; Embedding da db
</span><a href="Data.Delta.html#mkEmbedding"><span class="hs-identifier hs-var hs-var">mkEmbedding</span></a></span></span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span class="hs-special">{</span><span id="local-6989586621679209047"><span class="annot"><span class="annottext">b -&gt; Either SomeException a
load :: b -&gt; Either SomeException a
load :: ()
</span><a href="#local-6989586621679209047"><span class="hs-identifier hs-var hs-var">load</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209046"><span class="annot"><span class="annottext">a -&gt; b
write :: a -&gt; b
write :: ()
</span><a href="#local-6989586621679209046"><span class="hs-identifier hs-var hs-var">write</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209045"><span class="annot"><span class="annottext">a -&gt; b -&gt; da -&gt; db
update :: a -&gt; b -&gt; da -&gt; db
update :: ()
</span><a href="#local-6989586621679209045"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Embedding :: forall da db.
(Base da -&gt; Machine da db)
-&gt; (Base db -&gt; Either SomeException (Base da, Machine da db))
-&gt; Embedding da db
</span><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">inject :: Base da -&gt; Machine da db
</span><a href="Data.Delta.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Machine da db
</span><a href="#local-6989586621679209044"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Machine da db) -&gt; (a -&gt; b) -&gt; a -&gt; Machine da db
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679209046"><span class="hs-identifier hs-var">write</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">project :: Base db -&gt; Either SomeException (Base da, Machine da db)
</span><a href="Data.Delta.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679209042"><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679209042"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Machine da db
</span><a href="#local-6989586621679209044"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">b
Base db
</span><a href="#local-6989586621679209042"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; (a, Machine da db))
-&gt; Either SomeException a
-&gt; Either SomeException (a, Machine da db)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Either SomeException a
</span><a href="#local-6989586621679209047"><span class="hs-identifier hs-var">load</span></a></span><span> </span><span class="annot"><span class="annottext">b
Base db
</span><a href="#local-6989586621679209042"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679209044"><span class="annot"><span class="annottext">start :: b -&gt; Machine da db
</span><a href="#local-6989586621679209044"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679209040"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679209040"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Base da, da) -&gt; (Base db, ()) -&gt; (db, ()))
-&gt; (Base db, ()) -&gt; Machine da db
forall db da s.
Delta db =&gt;
((Base da, da) -&gt; (Base db, s) -&gt; (db, s))
-&gt; (Base db, s) -&gt; Machine da db
</span><a href="Data.Delta.html#fromState"><span class="hs-identifier hs-var">fromState</span></a></span><span> </span><span class="annot"><span class="annottext">(a, da) -&gt; (b, ()) -&gt; (db, ())
(Base da, da) -&gt; (Base db, ()) -&gt; (db, ())
</span><a href="#local-6989586621679209039"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
Base db
</span><a href="#local-6989586621679209040"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679209039"><span class="annot"><span class="annottext">step :: (a, da) -&gt; (b, ()) -&gt; (db, ())
</span><a href="#local-6989586621679209039"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209038"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209037"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679209037"><span class="hs-identifier hs-var">da</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679209036"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679209036"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">()
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b -&gt; da -&gt; db
</span><a href="#local-6989586621679209045"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679209038"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679209036"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679209037"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Extract 'load', 'write', and 'update' functions</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- from an efficient 'Embedding'.</span><span>
</span><span id="line-287"></span><span id="local-6989586621679209034"><span id="local-6989586621679209035"><span class="annot"><a href="Data.Delta.html#fromEmbedding"><span class="hs-identifier hs-type">fromEmbedding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209035"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209034"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209035"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209034"><span class="hs-identifier hs-type">db</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209035"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209034"><span class="hs-identifier hs-type">db</span></a></span></span></span><span>
</span><span id="line-288"></span><span id="fromEmbedding"><span class="annot"><span class="annottext">fromEmbedding :: Embedding da db -&gt; Embedding' da db
</span><a href="Data.Delta.html#fromEmbedding"><span class="hs-identifier hs-var hs-var">fromEmbedding</span></a></span></span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span class="hs-special">{</span><span id="local-6989586621679209033"><span class="annot"><span class="annottext">Base da -&gt; Machine da db
inject :: Base da -&gt; Machine da db
inject :: forall da db. Embedding da db -&gt; Base da -&gt; Machine da db
</span><a href="#local-6989586621679209033"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679209032"><span class="annot"><span class="annottext">Base db -&gt; Either SomeException (Base da, Machine da db)
project :: Base db -&gt; Either SomeException (Base da, Machine da db)
project :: forall da db.
Embedding da db
-&gt; Base db -&gt; Either SomeException (Base da, Machine da db)
</span><a href="#local-6989586621679209032"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Embedding' :: forall da db a b.
(Delta da, Delta db, a ~ Base da, b ~ Base db) =&gt;
(b -&gt; Either SomeException a)
-&gt; (a -&gt; b) -&gt; (a -&gt; b -&gt; da -&gt; db) -&gt; Embedding' da db
</span><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">load :: Base db -&gt; Either SomeException (Base da)
</span><a href="Data.Delta.html#load"><span class="hs-identifier hs-var">load</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Base da, Machine da db) -&gt; Base da)
-&gt; Either SomeException (Base da, Machine da db)
-&gt; Either SomeException (Base da)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(Base da, Machine da db) -&gt; Base da
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Either SomeException (Base da, Machine da db)
 -&gt; Either SomeException (Base da))
-&gt; (Base db -&gt; Either SomeException (Base da, Machine da db))
-&gt; Base db
-&gt; Either SomeException (Base da)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Base db -&gt; Either SomeException (Base da, Machine da db)
</span><a href="#local-6989586621679209032"><span class="hs-identifier hs-var">project</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">write :: Base da -&gt; Base db
</span><a href="Data.Delta.html#write"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine da db -&gt; Base db
forall da db. Machine da db -&gt; Base db
</span><a href="Data.Delta.html#state_"><span class="hs-identifier hs-var hs-var">state_</span></a></span><span> </span><span class="annot"><span class="annottext">(Machine da db -&gt; Base db)
-&gt; (Base da -&gt; Machine da db) -&gt; Base da -&gt; Base db
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Base da -&gt; Machine da db
</span><a href="#local-6989586621679209033"><span class="hs-identifier hs-var">inject</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">update :: Base da -&gt; Base db -&gt; da -&gt; db
</span><a href="Data.Delta.html#update"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679209030"><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679209030"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679209029"><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679209029"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679209028"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679209028"><span class="hs-identifier hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">,</span><span id="local-6989586621679209027"><span class="annot"><span class="annottext">Machine da db
</span><a href="#local-6989586621679209027"><span class="hs-identifier hs-var">mab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either SomeException (Base da, Machine da db)
-&gt; (Base da, Machine da db)
forall a b. Either a b -&gt; b
</span><a href="#local-6989586621679209026"><span class="hs-identifier hs-var">from</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base db -&gt; Either SomeException (Base da, Machine da db)
</span><a href="#local-6989586621679209032"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679209029"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679209025"><span class="annot"><span class="annottext">db
</span><a href="#local-6989586621679209025"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Machine da db
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine da db -&gt; (Base da, da) -&gt; (db, Machine da db)
forall da db. Machine da db -&gt; (Base da, da) -&gt; (db, Machine da db)
</span><a href="Data.Delta.html#step_"><span class="hs-identifier hs-var hs-var">step_</span></a></span><span> </span><span class="annot"><span class="annottext">Machine da db
</span><a href="#local-6989586621679209027"><span class="hs-identifier hs-var">mab</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679209030"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679209028"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">db
</span><a href="#local-6989586621679209025"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679209026"><span class="annot"><span class="annottext">from :: Either a b -&gt; b
</span><a href="#local-6989586621679209026"><span class="hs-identifier hs-var hs-var">from</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Either a b -&gt; b
forall b a. b -&gt; Either a b -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; b
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Embedding: 'load' violates expected laws&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Efficient composition of 'Embedding'</span><span>
</span><span id="line-300"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../semigroupoids/html/src"><span class="hs-identifier hs-type">Semigroupoid</span></a></span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span id="local-6989586621679209020"><span class="annot"><span class="annottext">Base j -&gt; Machine j k1
</span><a href="#local-6989586621679209020"><span class="hs-identifier hs-var">inject2</span></a></span></span><span> </span><span id="local-6989586621679209019"><span class="annot"><span class="annottext">Base k1 -&gt; Either SomeException (Base j, Machine j k1)
</span><a href="#local-6989586621679209019"><span class="hs-identifier hs-var">project2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679209018"><span class="annot"><span class="annottext">o :: Embedding j k1 -&gt; Embedding i j -&gt; Embedding i k1
</span><a href="../../../../semigroupoids/html/src"><span class="hs-operator hs-var hs-var hs-var hs-var">`o`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span id="local-6989586621679209016"><span class="annot"><span class="annottext">Base i -&gt; Machine i j
</span><a href="#local-6989586621679209016"><span class="hs-identifier hs-var">inject1</span></a></span></span><span> </span><span id="local-6989586621679209015"><span class="annot"><span class="annottext">Base j -&gt; Either SomeException (Base i, Machine i j)
</span><a href="#local-6989586621679209015"><span class="hs-identifier hs-var">project1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-302"></span><span>        </span><span class="annot"><span class="annottext">Embedding :: forall da db.
(Base da -&gt; Machine da db)
-&gt; (Base db -&gt; Either SomeException (Base da, Machine da db))
-&gt; Embedding da db
</span><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">Base i -&gt; Machine i k1
inject :: Base i -&gt; Machine i k1
inject :: Base i -&gt; Machine i k1
</span><a href="#local-6989586621679209014"><span class="hs-identifier hs-var hs-var">inject</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Base k1 -&gt; Either SomeException (Base i, Machine i k1)
project :: Base k1 -&gt; Either SomeException (Base i, Machine i k1)
project :: Base k1 -&gt; Either SomeException (Base i, Machine i k1)
</span><a href="#local-6989586621679209013"><span class="hs-identifier hs-var hs-var">project</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-303"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621679209014"><span class="annot"><span class="annottext">inject :: Base i -&gt; Machine i k1
</span><a href="#local-6989586621679209014"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span id="local-6989586621679209012"><span class="annot"><span class="annottext">Base i
</span><a href="#local-6989586621679209012"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679209011"><span class="annot"><span class="annottext">mab :: Machine i j
</span><a href="#local-6989586621679209011"><span class="hs-identifier hs-var hs-var">mab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base i -&gt; Machine i j
</span><a href="#local-6989586621679209016"><span class="hs-identifier hs-var">inject1</span></a></span><span> </span><span class="annot"><span class="annottext">Base i
</span><a href="#local-6989586621679209012"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-306"></span><span>                </span><span id="local-6989586621679209010"><span class="annot"><span class="annottext">mbc :: Machine j k1
</span><a href="#local-6989586621679209010"><span class="hs-identifier hs-var hs-var">mbc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base j -&gt; Machine j k1
</span><a href="#local-6989586621679209020"><span class="hs-identifier hs-var">inject2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Machine i j -&gt; Base j
forall da db. Machine da db -&gt; Base db
</span><a href="Data.Delta.html#state_"><span class="hs-identifier hs-var hs-var">state_</span></a></span><span> </span><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679209011"><span class="hs-identifier hs-var">mab</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Machine j k1
</span><a href="#local-6989586621679209010"><span class="hs-identifier hs-var">mbc</span></a></span><span> </span><span class="annot"><span class="annottext">Machine j k1 -&gt; Machine i j -&gt; Machine i k1
forall k (c :: k -&gt; k -&gt; *) (j :: k) (k1 :: k) (i :: k).
Semigroupoid c =&gt;
c j k1 -&gt; c i j -&gt; c i k1
</span><a href="../../../../semigroupoids/html/src"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679209011"><span class="hs-identifier hs-var">mab</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span id="local-6989586621679209013"><span class="annot"><span class="annottext">project :: Base k1 -&gt; Either SomeException (Base i, Machine i k1)
</span><a href="#local-6989586621679209013"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span id="local-6989586621679209009"><span class="annot"><span class="annottext">Base k1
</span><a href="#local-6989586621679209009"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679209008"><span class="annot"><span class="annottext">Base j
</span><a href="#local-6989586621679209008"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209007"><span class="annot"><span class="annottext">Machine j k1
</span><a href="#local-6989586621679209007"><span class="hs-identifier hs-var">mbc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Base k1 -&gt; Either SomeException (Base j, Machine j k1)
</span><a href="#local-6989586621679209019"><span class="hs-identifier hs-var">project2</span></a></span><span> </span><span class="annot"><span class="annottext">Base k1
</span><a href="#local-6989586621679209009"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679209006"><span class="annot"><span class="annottext">Base i
</span><a href="#local-6989586621679209006"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679209005"><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679209005"><span class="hs-identifier hs-var">mab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Base j -&gt; Either SomeException (Base i, Machine i j)
</span><a href="#local-6989586621679209015"><span class="hs-identifier hs-var">project1</span></a></span><span> </span><span class="annot"><span class="annottext">Base j
</span><a href="#local-6989586621679209008"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="annot"><span class="annottext">(Base i, Machine i k1)
-&gt; Either SomeException (Base i, Machine i k1)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base i
</span><a href="#local-6989586621679209006"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Machine j k1
</span><a href="#local-6989586621679209007"><span class="hs-identifier hs-var">mbc</span></a></span><span> </span><span class="annot"><span class="annottext">Machine j k1 -&gt; Machine i j -&gt; Machine i k1
forall k (c :: k -&gt; k -&gt; *) (j :: k) (k1 :: k) (i :: k).
Semigroupoid c =&gt;
c j k1 -&gt; c i j -&gt; c i k1
</span><a href="../../../../semigroupoids/html/src"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679209005"><span class="hs-identifier hs-var">mab</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | A pair of 'Embedding's gives an embedding of pairs.</span><span>
</span><span id="line-314"></span><span id="local-6989586621679209001"><span id="local-6989586621679209002"><span id="local-6989586621679209003"><span id="local-6989586621679209004"><span class="annot"><a href="Data.Delta.html#pair"><span class="hs-identifier hs-type">pair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209004"><span class="hs-identifier hs-type">da1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209003"><span class="hs-identifier hs-type">db1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209002"><span class="hs-identifier hs-type">da2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209001"><span class="hs-identifier hs-type">db2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209004"><span class="hs-identifier hs-type">da1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209002"><span class="hs-identifier hs-type">da2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209003"><span class="hs-identifier hs-type">db1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209001"><span class="hs-identifier hs-type">db2</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-315"></span><span id="pair"><span class="annot"><span class="annottext">pair :: Embedding da1 db1
-&gt; Embedding da2 db2 -&gt; Embedding (da1, da2) (db1, db2)
</span><a href="Data.Delta.html#pair"><span class="hs-identifier hs-var hs-var">pair</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span id="local-6989586621679209000"><span class="annot"><span class="annottext">Base da1 -&gt; Machine da1 db1
</span><a href="#local-6989586621679209000"><span class="hs-identifier hs-var">inject1</span></a></span></span><span> </span><span id="local-6989586621679208999"><span class="annot"><span class="annottext">Base db1 -&gt; Either SomeException (Base da1, Machine da1 db1)
</span><a href="#local-6989586621679208999"><span class="hs-identifier hs-var">project1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span id="local-6989586621679208998"><span class="annot"><span class="annottext">Base da2 -&gt; Machine da2 db2
</span><a href="#local-6989586621679208998"><span class="hs-identifier hs-var">inject2</span></a></span></span><span> </span><span id="local-6989586621679208997"><span class="annot"><span class="annottext">Base db2 -&gt; Either SomeException (Base da2, Machine da2 db2)
</span><a href="#local-6989586621679208997"><span class="hs-identifier hs-var">project2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">Embedding :: forall da db.
(Base da -&gt; Machine da db)
-&gt; (Base db -&gt; Either SomeException (Base da, Machine da db))
-&gt; Embedding da db
</span><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">(Base da1, Base da2) -&gt; Machine (da1, da2) (db1, db2)
Base (da1, da2) -&gt; Machine (da1, da2) (db1, db2)
inject :: (Base da1, Base da2) -&gt; Machine (da1, da2) (db1, db2)
inject :: Base (da1, da2) -&gt; Machine (da1, da2) (db1, db2)
</span><a href="#local-6989586621679208996"><span class="hs-identifier hs-var hs-var">inject</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">(Base db1, Base db2)
-&gt; Either
     SomeException ((Base da1, Base da2), Machine (da1, da2) (db1, db2))
Base (db1, db2)
-&gt; Either
     SomeException (Base (da1, da2), Machine (da1, da2) (db1, db2))
project :: (Base db1, Base db2)
-&gt; Either
     SomeException ((Base da1, Base da2), Machine (da1, da2) (db1, db2))
project :: Base (db1, db2)
-&gt; Either
     SomeException (Base (da1, da2), Machine (da1, da2) (db1, db2))
</span><a href="#local-6989586621679208995"><span class="hs-identifier hs-var hs-var">project</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679208996"><span class="annot"><span class="annottext">inject :: (Base da1, Base da2) -&gt; Machine (da1, da2) (db1, db2)
</span><a href="#local-6989586621679208996"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208994"><span class="annot"><span class="annottext">Base da1
</span><a href="#local-6989586621679208994"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208993"><span class="annot"><span class="annottext">Base da2
</span><a href="#local-6989586621679208993"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
forall da1 db1 da2 db2.
Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
</span><a href="Data.Delta.html#pairMachine"><span class="hs-identifier hs-var">pairMachine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da1 -&gt; Machine da1 db1
</span><a href="#local-6989586621679209000"><span class="hs-identifier hs-var">inject1</span></a></span><span> </span><span class="annot"><span class="annottext">Base da1
</span><a href="#local-6989586621679208994"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da2 -&gt; Machine da2 db2
</span><a href="#local-6989586621679208998"><span class="hs-identifier hs-var">inject2</span></a></span><span> </span><span class="annot"><span class="annottext">Base da2
</span><a href="#local-6989586621679208993"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>    </span><span id="local-6989586621679208995"><span class="annot"><span class="annottext">project :: (Base db1, Base db2)
-&gt; Either
     SomeException ((Base da1, Base da2), Machine (da1, da2) (db1, db2))
</span><a href="#local-6989586621679208995"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208992"><span class="annot"><span class="annottext">Base db1
</span><a href="#local-6989586621679208992"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208991"><span class="annot"><span class="annottext">Base db2
</span><a href="#local-6989586621679208991"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208990"><span class="annot"><span class="annottext">Base da1
</span><a href="#local-6989586621679208990"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208989"><span class="annot"><span class="annottext">Machine da1 db1
</span><a href="#local-6989586621679208989"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Base db1 -&gt; Either SomeException (Base da1, Machine da1 db1)
</span><a href="#local-6989586621679208999"><span class="hs-identifier hs-var">project1</span></a></span><span> </span><span class="annot"><span class="annottext">Base db1
</span><a href="#local-6989586621679208992"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208988"><span class="annot"><span class="annottext">Base da2
</span><a href="#local-6989586621679208988"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208987"><span class="annot"><span class="annottext">Machine da2 db2
</span><a href="#local-6989586621679208987"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Base db2 -&gt; Either SomeException (Base da2, Machine da2 db2)
</span><a href="#local-6989586621679208997"><span class="hs-identifier hs-var">project2</span></a></span><span> </span><span class="annot"><span class="annottext">Base db2
</span><a href="#local-6989586621679208991"><span class="hs-identifier hs-var">b2</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span class="annot"><span class="annottext">((Base da1, Base da2), Machine (da1, da2) (db1, db2))
-&gt; Either
     SomeException ((Base da1, Base da2), Machine (da1, da2) (db1, db2))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da1
</span><a href="#local-6989586621679208990"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Base da2
</span><a href="#local-6989586621679208988"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
forall da1 db1 da2 db2.
Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
</span><a href="Data.Delta.html#pairMachine"><span class="hs-identifier hs-var">pairMachine</span></a></span><span> </span><span class="annot"><span class="annottext">Machine da1 db1
</span><a href="#local-6989586621679208989"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Machine da2 db2
</span><a href="#local-6989586621679208987"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Lift a sequence of updates through an 'Embedding'.</span><span>
</span><span id="line-326"></span><span id="local-6989586621679208985"><span id="local-6989586621679208986"><span class="annot"><a href="Data.Delta.html#liftUpdates"><span class="hs-identifier hs-type">liftUpdates</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208986"><span class="hs-identifier hs-type">da</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208986"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208985"><span class="hs-identifier hs-type">db</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679208986"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ List of deltas to apply. The 'head' is applied /last/.</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208986"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-comment">-- ^ Base value to apply the deltas to.</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208985"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679208985"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-comment">-- ^ (Final base value, updates that were applied ('head' is /last/)).</span></span></span><span>
</span><span id="line-333"></span><span id="liftUpdates"><span class="annot"><span class="annottext">liftUpdates :: Embedding da db -&gt; [da] -&gt; Base da -&gt; (Base db, [db])
</span><a href="Data.Delta.html#liftUpdates"><span class="hs-identifier hs-var hs-var">liftUpdates</span></a></span></span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span class="hs-special">{</span><span id="local-6989586621679208984"><span class="annot"><span class="annottext">Base da -&gt; Machine da db
inject :: Base da -&gt; Machine da db
inject :: forall da db. Embedding da db -&gt; Base da -&gt; Machine da db
</span><a href="#local-6989586621679208984"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679208983"><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679208983"><span class="hs-identifier hs-var">das0</span></a></span></span><span> </span><span id="local-6989586621679208982"><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208982"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208981"><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208981"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208980"><span class="annot"><span class="annottext">[db]
</span><a href="#local-6989586621679208980"><span class="hs-identifier hs-var">dbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine da db -&gt; Base da -&gt; [da] -&gt; (Base db, [db])
forall delta a.
Delta delta =&gt;
Machine delta a -&gt; Base delta -&gt; [delta] -&gt; (Base a, [a])
</span><a href="#local-6989586621679208979"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da -&gt; Machine da db
</span><a href="#local-6989586621679208984"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208982"><span class="hs-identifier hs-var">a0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208982"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[da] -&gt; [da]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[da]
</span><a href="#local-6989586621679208983"><span class="hs-identifier hs-var">das0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208981"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[db] -&gt; [db]
forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[db]
</span><a href="#local-6989586621679208980"><span class="hs-identifier hs-var">dbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>    </span><span id="local-6989586621679208979"><span class="annot"><span class="annottext">go :: Machine delta a -&gt; Base delta -&gt; [delta] -&gt; (Base a, [a])
</span><a href="#local-6989586621679208979"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679208977"><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208977"><span class="hs-identifier hs-var">machine1</span></a></span></span><span> </span><span class="annot"><span class="annottext">Base delta
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Machine delta a -&gt; Base a
forall da db. Machine da db -&gt; Base db
</span><a href="Data.Delta.html#state_"><span class="hs-identifier hs-var hs-var">state_</span></a></span><span> </span><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208977"><span class="hs-identifier hs-var">machine1</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><a href="#local-6989586621679208979"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679208976"><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208976"><span class="hs-identifier hs-var">machine1</span></a></span></span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679208975"><span class="annot"><span class="annottext">Base delta
</span><a href="#local-6989586621679208975"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208974"><span class="annot"><span class="annottext">delta
</span><a href="#local-6989586621679208974"><span class="hs-identifier hs-var">da</span></a></span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679208973"><span class="annot"><span class="annottext">[delta]
</span><a href="#local-6989586621679208973"><span class="hs-identifier hs-var">das</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base a
</span><a href="#local-6989586621679208972"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208971"><span class="hs-identifier hs-var">db</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679208970"><span class="hs-identifier hs-var">dbs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208972"><span class="annot"><span class="annottext">Base a
</span><a href="#local-6989586621679208972"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">,</span><span id="local-6989586621679208970"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679208970"><span class="hs-identifier hs-var">dbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine delta a -&gt; Base delta -&gt; [delta] -&gt; (Base a, [a])
</span><a href="#local-6989586621679208979"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208969"><span class="hs-identifier hs-var">machine2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">delta -&gt; Base delta -&gt; Base delta
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">delta
</span><a href="#local-6989586621679208974"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Base delta
</span><a href="#local-6989586621679208975"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[delta]
</span><a href="#local-6989586621679208973"><span class="hs-identifier hs-var">das</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208971"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208971"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208969"><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208969"><span class="hs-identifier hs-var">machine2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Machine delta a -&gt; (Base delta, delta) -&gt; (a, Machine delta a)
forall da db. Machine da db -&gt; (Base da, da) -&gt; (db, Machine da db)
</span><a href="Data.Delta.html#step_"><span class="hs-identifier hs-var hs-var">step_</span></a></span><span> </span><span class="annot"><span class="annottext">Machine delta a
</span><a href="#local-6989586621679208976"><span class="hs-identifier hs-var">machine1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base delta
</span><a href="#local-6989586621679208975"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">delta
</span><a href="#local-6989586621679208974"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">-- | Having an 'apply' function is equivalent to the existence</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- of a canonical embedding into the trivial 'Replace' delta encoding.</span><span>
</span><span id="line-344"></span><span id="local-6989586621679208967"><span id="local-6989586621679208968"><span class="annot"><a href="Data.Delta.html#replaceFromApply"><span class="hs-identifier hs-type">replaceFromApply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208968"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679208967"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208968"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208968"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-type">Replace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679208967"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-345"></span><span id="replaceFromApply"><span class="annot"><span class="annottext">replaceFromApply :: Embedding' da (Replace a)
</span><a href="Data.Delta.html#replaceFromApply"><span class="hs-identifier hs-var hs-var">replaceFromApply</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Embedding' :: forall da db a b.
(Delta da, Delta db, a ~ Base da, b ~ Base db) =&gt;
(b -&gt; Either SomeException a)
-&gt; (a -&gt; b) -&gt; (a -&gt; b -&gt; da -&gt; db) -&gt; Embedding' da db
</span><a href="Data.Delta.html#Embedding%27"><span class="hs-identifier hs-type">Embedding'</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">load :: a -&gt; Either SomeException a
</span><a href="Data.Delta.html#load"><span class="hs-identifier hs-var">load</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either SomeException a
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">write :: a -&gt; a
</span><a href="Data.Delta.html#write"><span class="hs-identifier hs-var">write</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">update :: a -&gt; a -&gt; da -&gt; Replace a
</span><a href="Data.Delta.html#update"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679208966"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679208966"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679208965"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679208965"><span class="hs-identifier hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Replace a
forall a. a -&gt; Replace a
</span><a href="Data.Delta.html#Replace"><span class="hs-identifier hs-var">Replace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">da -&gt; Base da -&gt; Base da
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679208965"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">a
Base da
</span><a href="#local-6989586621679208966"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">{-
-- | Use the 'update' function of an 'Embedding' to convert
-- one delta encoding to another.
--
-- This function assumes that the 'Embedding' argument satisfies
-- @load = Just@ and @write = id@.
applyWithEmbedding
    :: (Delta db, a ~ Base db)
    =&gt; Embedding da db -&gt; (da -&gt; a -&gt; a)
applyWithEmbedding e delta1 a = apply (update e a delta1) a
-}</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">{-------------------------------------------------------------------------------
    Machine (state machines) with efficient composition
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | Strict pair.</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- If a value of this type is in WHNF, so are the two components.</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- data StrictPair a b = !a :*: !b</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- infixr 1 :*:</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | A state machine that maps deltas to deltas.</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- This machine always carries a state of type 'Base'@ db@ around.</span><span>
</span><span id="line-373"></span><span class="hs-keyword">data</span><span> </span><span id="Machine"><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span></span><span> </span><span id="local-6989586621679209373"><span class="annot"><a href="#local-6989586621679209373"><span class="hs-identifier hs-type">da</span></a></span></span><span> </span><span id="local-6989586621679209372"><span class="annot"><a href="#local-6989586621679209372"><span class="hs-identifier hs-type">db</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Machine"><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="state_"><span class="annot"><span class="annottext">Machine da db -&gt; Base db
</span><a href="Data.Delta.html#state_"><span class="hs-identifier hs-var hs-var">state_</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209372"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="step_"><span class="annot"><span class="annottext">Machine da db -&gt; (Base da, da) -&gt; (db, Machine da db)
</span><a href="Data.Delta.html#step_"><span class="hs-identifier hs-var hs-var">step_</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209373"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209373"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209372"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209373"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209372"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Composition of 'Machine'</span><span>
</span><span id="line-379"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../semigroupoids/html/src"><span class="hs-identifier hs-type">Semigroupoid</span></a></span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span id="local-6989586621679208962"><span class="annot"><span class="annottext">Base k1
</span><a href="#local-6989586621679208962"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679208961"><span class="annot"><span class="annottext">(Base j, j) -&gt; (k1, Machine j k1)
</span><a href="#local-6989586621679208961"><span class="hs-identifier hs-var">fbc</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679208960"><span class="annot"><span class="annottext">o :: Machine j k1 -&gt; Machine i j -&gt; Machine i k1
</span><a href="#local-6989586621679208960"><span class="hs-operator hs-var hs-var hs-var hs-var">`o`</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span id="local-6989586621679208959"><span class="annot"><span class="annottext">Base j
</span><a href="#local-6989586621679208959"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679208958"><span class="annot"><span class="annottext">(Base i, i) -&gt; (j, Machine i j)
</span><a href="#local-6989586621679208958"><span class="hs-identifier hs-var">fab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base k1 -&gt; ((Base i, i) -&gt; (k1, Machine i k1)) -&gt; Machine i k1
forall da db.
Base db -&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
</span><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span><span> </span><span class="annot"><span class="annottext">Base k1
</span><a href="#local-6989586621679208962"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(((Base i, i) -&gt; (k1, Machine i k1)) -&gt; Machine i k1)
-&gt; ((Base i, i) -&gt; (k1, Machine i k1)) -&gt; Machine i k1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679208957"><span class="annot"><span class="annottext">(Base i, i)
</span><a href="#local-6989586621679208957"><span class="hs-identifier hs-var">ada</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Base i, i) -&gt; (j, Machine i j)
</span><a href="#local-6989586621679208958"><span class="hs-identifier hs-var">fab</span></a></span><span> </span><span class="annot"><span class="annottext">(Base i, i)
</span><a href="#local-6989586621679208957"><span class="hs-identifier hs-var">ada</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679208956"><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679208956"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208955"><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679208955"><span class="hs-identifier hs-var">mab</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Base j, j) -&gt; (k1, Machine j k1)
</span><a href="#local-6989586621679208961"><span class="hs-identifier hs-var">fbc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base j
</span><a href="#local-6989586621679208959"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">j
</span><a href="#local-6989586621679208956"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-383"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679208954"><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621679208954"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208953"><span class="annot"><span class="annottext">Machine j k1
</span><a href="#local-6989586621679208953"><span class="hs-identifier hs-var">mbc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k1
</span><a href="#local-6989586621679208954"><span class="hs-identifier hs-var">dc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Machine j k1
</span><a href="#local-6989586621679208953"><span class="hs-identifier hs-var">mbc</span></a></span><span> </span><span class="annot"><span class="annottext">Machine j k1 -&gt; Machine i j -&gt; Machine i k1
forall k (c :: k -&gt; k -&gt; *) (j :: k) (k1 :: k) (i :: k).
Semigroupoid c =&gt;
c j k1 -&gt; c i j -&gt; c i k1
</span><a href="../../../../semigroupoids/html/src"><span class="hs-operator hs-var">`o`</span></a></span><span> </span><span class="annot"><span class="annottext">Machine i j
</span><a href="#local-6989586621679208955"><span class="hs-identifier hs-var">mab</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span class="hs-comment">-- | Identity machine starting from a base type.</span><span>
</span><span id="line-386"></span><span id="local-6989586621679209323"><span class="annot"><a href="Data.Delta.html#idle"><span class="hs-identifier hs-type">idle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209323"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209323"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209323"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209323"><span class="hs-identifier hs-type">da</span></a></span></span><span>
</span><span id="line-387"></span><span id="idle"><span class="annot"><span class="annottext">idle :: Base da -&gt; Machine da da
</span><a href="Data.Delta.html#idle"><span class="hs-identifier hs-var hs-var">idle</span></a></span></span><span> </span><span id="local-6989586621679208952"><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208952"><span class="hs-identifier hs-var">a0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base da -&gt; ((Base da, da) -&gt; (da, Machine da da)) -&gt; Machine da da
forall da db.
Base db -&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
</span><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span><span> </span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208952"><span class="hs-identifier hs-var">a0</span></a></span><span> </span><span class="annot"><span class="annottext">(((Base da, da) -&gt; (da, Machine da da)) -&gt; Machine da da)
-&gt; ((Base da, da) -&gt; (da, Machine da da)) -&gt; Machine da da
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679208951"><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208951"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208950"><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679208950"><span class="hs-identifier hs-var">da</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679208949"><span class="annot"><span class="annottext">a2 :: Base da
</span><a href="#local-6989586621679208949"><span class="hs-identifier hs-var hs-var">a2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">da -&gt; Base da -&gt; Base da
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679208950"><span class="hs-identifier hs-var">da</span></a></span><span> </span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208951"><span class="hs-identifier hs-var">a1</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">da
</span><a href="#local-6989586621679208950"><span class="hs-identifier hs-var">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Base da -&gt; Machine da da
forall da. Delta da =&gt; Base da -&gt; Machine da da
</span><a href="Data.Delta.html#idle"><span class="hs-identifier hs-var">idle</span></a></span><span> </span><span class="annot"><span class="annottext">Base da
</span><a href="#local-6989586621679208949"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">-- | Pair two 'Machine'.</span><span>
</span><span id="line-390"></span><span id="local-6989586621679209346"><span id="local-6989586621679209347"><span id="local-6989586621679209348"><span id="local-6989586621679209349"><span class="annot"><a href="Data.Delta.html#pairMachine"><span class="hs-identifier hs-type">pairMachine</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209349"><span class="hs-identifier hs-type">da1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209348"><span class="hs-identifier hs-type">db1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209347"><span class="hs-identifier hs-type">da2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209346"><span class="hs-identifier hs-type">db2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209349"><span class="hs-identifier hs-type">da1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209347"><span class="hs-identifier hs-type">da2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209348"><span class="hs-identifier hs-type">db1</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679209346"><span class="hs-identifier hs-type">db2</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-392"></span><span id="pairMachine"><span class="annot"><span class="annottext">pairMachine :: Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
</span><a href="Data.Delta.html#pairMachine"><span class="hs-identifier hs-var hs-var">pairMachine</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span id="local-6989586621679208948"><span class="annot"><span class="annottext">Base db1
</span><a href="#local-6989586621679208948"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span id="local-6989586621679208947"><span class="annot"><span class="annottext">(Base da1, da1) -&gt; (db1, Machine da1 db1)
</span><a href="#local-6989586621679208947"><span class="hs-identifier hs-var">step1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span id="local-6989586621679208946"><span class="annot"><span class="annottext">Base db2
</span><a href="#local-6989586621679208946"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621679208945"><span class="annot"><span class="annottext">(Base da2, da2) -&gt; (db2, Machine da2 db2)
</span><a href="#local-6989586621679208945"><span class="hs-identifier hs-var">step2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">Base (db1, db2)
-&gt; ((Base (da1, da2), (da1, da2))
    -&gt; ((db1, db2), Machine (da1, da2) (db1, db2)))
-&gt; Machine (da1, da2) (db1, db2)
forall da db.
Base db -&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
</span><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base db1
</span><a href="#local-6989586621679208948"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Base db2
</span><a href="#local-6989586621679208946"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(((Base (da1, da2), (da1, da2))
  -&gt; ((db1, db2), Machine (da1, da2) (db1, db2)))
 -&gt; Machine (da1, da2) (db1, db2))
-&gt; ((Base (da1, da2), (da1, da2))
    -&gt; ((db1, db2), Machine (da1, da2) (db1, db2)))
-&gt; Machine (da1, da2) (db1, db2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679208944"><span class="annot"><a href="#local-6989586621679208944"><span class="hs-identifier hs-var">a1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208943"><span class="annot"><a href="#local-6989586621679208943"><span class="hs-identifier hs-var">a2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208942"><span class="annot"><span class="annottext">da1
</span><a href="#local-6989586621679208942"><span class="hs-identifier hs-var">da1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208941"><span class="annot"><span class="annottext">da2
</span><a href="#local-6989586621679208941"><span class="hs-identifier hs-var">da2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-394"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208940"><span class="annot"><span class="annottext">db1
</span><a href="#local-6989586621679208940"><span class="hs-identifier hs-var">db1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208939"><span class="annot"><span class="annottext">Machine da1 db1
</span><a href="#local-6989586621679208939"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Base da1, da1) -&gt; (db1, Machine da1 db1)
</span><a href="#local-6989586621679208947"><span class="hs-identifier hs-var">step1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da1
</span><a href="#local-6989586621679208944"><span class="hs-identifier hs-var">a1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">da1
</span><a href="#local-6989586621679208942"><span class="hs-identifier hs-var">da1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679208938"><span class="annot"><span class="annottext">db2
</span><a href="#local-6989586621679208938"><span class="hs-identifier hs-var">db2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679208937"><span class="annot"><span class="annottext">Machine da2 db2
</span><a href="#local-6989586621679208937"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Base da2, da2) -&gt; (db2, Machine da2 db2)
</span><a href="#local-6989586621679208945"><span class="hs-identifier hs-var">step2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base da2
</span><a href="#local-6989586621679208943"><span class="hs-identifier hs-var">a2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">da2
</span><a href="#local-6989586621679208941"><span class="hs-identifier hs-var">da2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">db1
</span><a href="#local-6989586621679208940"><span class="hs-identifier hs-var">db1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">db2
</span><a href="#local-6989586621679208938"><span class="hs-identifier hs-var">db2</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
forall da1 db1 da2 db2.
Machine da1 db1 -&gt; Machine da2 db2 -&gt; Machine (da1, da2) (db1, db2)
</span><a href="Data.Delta.html#pairMachine"><span class="hs-identifier hs-var">pairMachine</span></a></span><span> </span><span class="annot"><span class="annottext">Machine da1 db1
</span><a href="#local-6989586621679208939"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Machine da2 db2
</span><a href="#local-6989586621679208937"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | Create a 'Machine' from a specific state 's',</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- and the built-in state 'Base'@ db@.</span><span>
</span><span id="line-400"></span><span id="local-6989586621679209385"><span id="local-6989586621679209386"><span id="local-6989586621679209387"><span class="annot"><a href="Data.Delta.html#fromState"><span class="hs-identifier hs-type">fromState</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.Delta.html#Delta"><span class="hs-identifier hs-type">Delta</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209387"><span class="hs-identifier hs-type">db</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209386"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209386"><span class="hs-identifier hs-type">da</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209387"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209385"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679209387"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209385"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Delta.html#Base"><span class="hs-identifier hs-type">Base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209387"><span class="hs-identifier hs-type">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679209385"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-type">Machine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209386"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679209387"><span class="hs-identifier hs-type">db</span></a></span></span></span></span><span>
</span><span id="line-405"></span><span id="fromState"><span class="annot"><span class="annottext">fromState :: ((Base da, da) -&gt; (Base db, s) -&gt; (db, s))
-&gt; (Base db, s) -&gt; Machine da db
</span><a href="Data.Delta.html#fromState"><span class="hs-identifier hs-var hs-var">fromState</span></a></span></span><span> </span><span id="local-6989586621679208936"><span class="annot"><span class="annottext">(Base da, da) -&gt; (Base db, s) -&gt; (db, s)
</span><a href="#local-6989586621679208936"><span class="hs-identifier hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679208935"><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208935"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208934"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679208934"><span class="hs-identifier hs-var">s0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Base db -&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
forall da db.
Base db -&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
</span><a href="Data.Delta.html#Machine"><span class="hs-identifier hs-var">Machine</span></a></span><span> </span><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208935"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db)
-&gt; ((Base da, da) -&gt; (db, Machine da db)) -&gt; Machine da db
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679208933"><span class="annot"><span class="annottext">(Base da, da)
</span><a href="#local-6989586621679208933"><span class="hs-identifier hs-var">ada</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(Base da, da) -&gt; (Base db, s) -&gt; (db, s)
</span><a href="#local-6989586621679208936"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">(Base da, da)
</span><a href="#local-6989586621679208933"><span class="hs-identifier hs-var">ada</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208935"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679208934"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-407"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679208932"><span class="annot"><span class="annottext">db
</span><a href="#local-6989586621679208932"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679208931"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679208931"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">db
</span><a href="#local-6989586621679208932"><span class="hs-identifier hs-var">db</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">((Base da, da) -&gt; (Base db, s) -&gt; (db, s))
-&gt; (Base db, s) -&gt; Machine da db
forall db da s.
Delta db =&gt;
((Base da, da) -&gt; (Base db, s) -&gt; (db, s))
-&gt; (Base db, s) -&gt; Machine da db
</span><a href="Data.Delta.html#fromState"><span class="hs-identifier hs-var">fromState</span></a></span><span> </span><span class="annot"><span class="annottext">(Base da, da) -&gt; (Base db, s) -&gt; (db, s)
</span><a href="#local-6989586621679208936"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">db -&gt; Base db -&gt; Base db
forall delta. Delta delta =&gt; delta -&gt; Base delta -&gt; Base delta
</span><a href="Data.Delta.html#apply"><span class="hs-identifier hs-var">apply</span></a></span><span> </span><span class="annot"><span class="annottext">db
</span><a href="#local-6989586621679208932"><span class="hs-identifier hs-var">db</span></a></span><span> </span><span class="annot"><span class="annottext">Base db
</span><a href="#local-6989586621679208935"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679208931"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span></pre></body></html>