<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cardano.Pool.Rank</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cardano-wallet-core-2022.7.1: The Wallet Backend for a Cardano node.</span><ul class="links" id="page-menu"><li><a href="src/Cardano.Pool.Rank.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; 2022 IOHK</td></tr><tr><th>License</th><td>Apache-2.0</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Pool.Rank</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Pool information</a></li><li><a href="#g:2">Ranking formulas</a></li><li><a href="#g:3">Redelegation warning</a></li><li><a href="#g:4">Legacy metrics</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides tools to estimate pool rewards
 for the purpose of ranking pools.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:RewardInfoPool">RewardInfoPool</a> = <a href="#v:RewardInfoPool">RewardInfoPool</a> {<ul class="subs"><li><a href="#v:stakeRelative">stakeRelative</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></li><li><a href="#v:ownerPledge">ownerPledge</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li><a href="#v:ownerStake">ownerStake</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li><a href="#v:ownerStakeRelative">ownerStakeRelative</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></li><li><a href="#v:cost">cost</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li><a href="#v:margin">margin</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></li><li><a href="#v:performanceEstimate">performanceEstimate</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Double" title="Distribution.Compat.Prelude.Internal">Double</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:RewardParams">RewardParams</a> = <a href="#v:RewardParams">RewardParams</a> {<ul class="subs"><li><a href="#v:nOpt">nOpt</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a></li><li><a href="#v:a0">a0</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Rational" title="Distribution.Compat.Prelude.Internal">Rational</a></li><li><a href="#v:r">r</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li><a href="#v:totalStake">totalStake</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li></ul>}</li><li class="src short"><span class="keyword">data</span> <a href="#t:StakePoolsSummary">StakePoolsSummary</a> = <a href="#v:StakePoolsSummary">StakePoolsSummary</a> {<ul class="subs"><li><a href="#v:rewardParams">rewardParams</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></li><li><a href="#v:pools">pools</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> <a href="Cardano-Wallet-Primitive-Types.html#t:PoolId" title="Cardano.Wallet.Primitive.Types">PoolId</a> <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></li></ul>}</li><li class="src short"><a href="#v:poolSaturation">poolSaturation</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Double" title="Distribution.Compat.Prelude.Internal">Double</a></li><li class="src short"><a href="#v:optimalRewards">optimalRewards</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Rational" title="Distribution.Compat.Prelude.Internal">Rational</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li class="src short"><a href="#v:currentROS">currentROS</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></li><li class="src short"><a href="#v:saturationROS">saturationROS</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:RedelegationWarning">RedelegationWarning</a><ul class="subs"><li>= <a href="#v:AllGood">AllGood</a></li><li>| <a href="#v:TooFewBlocks">TooFewBlocks</a></li><li>| <a href="#v:OtherPoolsBetter">OtherPoolsBetter</a></li></ul></li><li class="src short"><a href="#v:redelegationWarning">redelegationWarning</a> :: <a href="Cardano-Wallet-Primitive-Types.html#t:EpochNo" title="Cardano.Wallet.Primitive.Types">EpochNo</a> -&gt; (<a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a>) -&gt; <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:EpochNo" title="Cardano.Wallet.Primitive.Types">EpochNo</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a></li><li class="src short"><a href="#v:nonMyopicMemberReward">nonMyopicMemberReward</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li class="src short"><a href="#v:desirability">desirability</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:PoolScore">PoolScore</a> = <a href="#v:PoolScore">PoolScore</a> {<ul class="subs"><li><a href="#v:_desirability">_desirability</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li><li><a href="#v:_nonMyopicMemberReward">_nonMyopicMemberReward</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></li></ul>}</li><li class="src short"><a href="#v:scorePools">scorePools</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Ord" title="Distribution.Compat.Prelude.Internal">Ord</a> poolId =&gt; <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> poolId (<a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, a) -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> poolId (<a href="Cardano-Pool-Rank.html#t:PoolScore" title="Cardano.Pool.Rank">PoolScore</a>, <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, a)</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Pool information</h1></a><div class="doc"><p>NOTE [RewardEpochs]</p><p>We need to be careful to show the right information at the right time
in order prevent manipulation of the proof-of-stake (PoS) protocol.</p><p>In particular, we need to show those pool costs, margins, and owner stakes
that will affect the rewards for a delegation choice made at the present moment.</p><p>The reward cycle is illustrated in Section 11.2 of SL-D1, here a brief sketch.</p><pre>                    mark   set     go
                  +------.------.------
                  |
    |e0----|e1----|e2----|e3----|e4----|e5----|
              ^
          we are here
</pre><p>We imagine that we are in epoch <em>e1</em>, and choose to delegate to a pool.
At the end of epoch <em>e1</em>, a snapshot of the stake distribution will be taken.
This snapshot will be labeled &quot;mark&quot; during epoch <em>e2</em>, &quot;set&quot; during epoch <em>e3</em>,
and &quot;go&quot; during epoch <em>e4</em>.
Blocks will be produced randomly according to this stake distribution when
it is labeled &quot;set&quot;, i.e. in epoch <em>e3</em>.
Rewards for this block production will be computed when this stake
distribution is labeled &quot;go&quot;, i.e. during epoch <em>e4</em>, and these rewards will
paid out at the beginning of epoch <em>e5</em>.</p><p>The owner stake is part of the snapshot taken at the end of epoch <em>e1</em>.
If the pool is newly registered, its cost, margin and pledge are also
immediately available in epoch <em>e1</em>. However, if a pool re-registers,
the changes to its cost, margin and pledge will not be visible until the
next epoch; put differently, the rewards for the stake snapshot taken
at the end of epoch <em>e1</em> will only depend on changes to cost, margin,
and pledge that the pool owner initiated in epoch <em>e0</em>.
This prevents pool owners from duping delegators by changing pool costs
during an epoch. However, the pool owner could still choose to undelegate
his stake, and fail to meet his pledge at the end of epoch <em>e1</em>,
which results in zero rewards paid out at the beginning of <em>e5</em>.</p><p>To summarize, in order to make an informed delegation choice
during epoch <em>e1</em>, the delegator needs to know <code><a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></code> where</p><ul><li><code><a href="Cardano-Pool-Rank.html#v:stakeRelative" title="Cardano.Pool.Rank">stakeRelative</a></code>, <code><a href="Cardano-Pool-Rank.html#v:ownerStake" title="Cardano.Pool.Rank">ownerStake</a></code>, and <code><a href="Cardano-Pool-Rank.html#v:ownerStakeRelative" title="Cardano.Pool.Rank">ownerStakeRelative</a></code> are
   taken at the time of decision (in epoch <em>e1</em>).</li><li><code><a href="Cardano-Pool-Rank.html#v:ownerPledge" title="Cardano.Pool.Rank">ownerPledge</a></code>, <code><a href="Cardano-Pool-Rank.html#v:margin" title="Cardano.Pool.Rank">margin</a></code>, <code><a href="Cardano-Pool-Rank.html#v:cost" title="Cardano.Pool.Rank">cost</a></code> are the values of the last pool
   registration certificate
   from epoch <em>e0</em> in case of an update,
   or from epoch <em>e1</em> in case of a newly created pool.</li></ul><p>For the <code><a href="Cardano-Pool-Rank.html#v:performanceEstimate" title="Cardano.Pool.Rank">performanceEstimate</a></code>, it's best to estimate it from recent pool
block production using functions provided here.</p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RewardInfoPool" class="def">RewardInfoPool</a> <a href="src/Cardano.Pool.Rank.html#RewardInfoPool" class="link">Source</a> <a href="#t:RewardInfoPool" class="selflink">#</a></p><div class="doc"><p>Information need for the computation of rewards, such as the
 stake currently delegated to a pool, or the pool cost and margin.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RewardInfoPool" class="def">RewardInfoPool</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:stakeRelative" class="def">stakeRelative</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></dfn><div class="doc"><p>sigma = pool stake / total stake</p></div></li><li><dfn class="src"><a id="v:ownerPledge" class="def">ownerPledge</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc"><p>pledge of pool owner(s)</p></div></li><li><dfn class="src"><a id="v:ownerStake" class="def">ownerStake</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc"><p>absolute stake delegated by pool owner(s)</p></div></li><li><dfn class="src"><a id="v:ownerStakeRelative" class="def">ownerStakeRelative</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></dfn><div class="doc"><p>s = owner stake / total stake</p></div></li><li><dfn class="src"><a id="v:cost" class="def">cost</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:margin" class="def">margin</a> :: <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:performanceEstimate" class="def">performanceEstimate</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Double" title="Distribution.Compat.Prelude.Internal">Double</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RewardInfoPool">Instances</h4><details id="i:RewardInfoPool" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardInfoPool:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></span> <a href="src/Cardano.Pool.Rank.html#line-66" class="link">Source</a> <a href="#t:RewardInfoPool" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardInfoPool:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardInfoPool:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></span> <a href="src/Cardano.Pool.Rank.html#line-66" class="link">Source</a> <a href="#t:RewardInfoPool" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardInfoPool:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardInfoPool:Buildable:3"></span> <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></span> <a href="src/Cardano.Pool.Rank.html#line-68" class="link">Source</a> <a href="#t:RewardInfoPool" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardInfoPool:Buildable:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../fmt/html/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="../../formatting/html/src" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RewardParams" class="def">RewardParams</a> <a href="src/Cardano.Pool.Rank.html#RewardParams" class="link">Source</a> <a href="#t:RewardParams" class="selflink">#</a></p><div class="doc"><p>Global parameters used for computing rewards</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:RewardParams" class="def">RewardParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:nOpt" class="def">nOpt</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a></dfn><div class="doc"><p>desired number of stake pools</p></div></li><li><dfn class="src"><a id="v:a0" class="def">a0</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Rational" title="Distribution.Compat.Prelude.Internal">Rational</a></dfn><div class="doc"><p>influence of the pool owner's pledge on rewards</p></div></li><li><dfn class="src"><a id="v:r" class="def">r</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc"><p>Total rewards available for the given epoch</p></div></li><li><dfn class="src"><a id="v:totalStake" class="def">totalStake</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc"><p>Maximum lovelace supply minus treasury</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RewardParams">Instances</h4><details id="i:RewardParams" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardParams:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></span> <a href="src/Cardano.Pool.Rank.html#line-89" class="link">Source</a> <a href="#t:RewardParams" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardParams:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardParams:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></span> <a href="src/Cardano.Pool.Rank.html#line-89" class="link">Source</a> <a href="#t:RewardParams" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardParams:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a>] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RewardParams:Buildable:3"></span> <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></span> <a href="src/Cardano.Pool.Rank.html#line-92" class="link">Source</a> <a href="#t:RewardParams" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RewardParams:Buildable:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="../../fmt/html/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="../../formatting/html/src" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:StakePoolsSummary" class="def">StakePoolsSummary</a> <a href="src/Cardano.Pool.Rank.html#StakePoolsSummary" class="link">Source</a> <a href="#t:StakePoolsSummary" class="selflink">#</a></p><div class="doc"><p>Summary of stake distribution and stake pools obtained from network.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:StakePoolsSummary" class="def">StakePoolsSummary</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:rewardParams" class="def">rewardParams</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:pools" class="def">pools</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> <a href="Cardano-Wallet-Primitive-Types.html#t:PoolId" title="Cardano.Wallet.Primitive.Types">PoolId</a> <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:StakePoolsSummary">Instances</h4><details id="i:StakePoolsSummary" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:StakePoolsSummary:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a></span> <a href="src/Cardano.Pool.Rank.html#line-162" class="link">Source</a> <a href="#t:StakePoolsSummary" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:StakePoolsSummary:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:StakePoolsSummary:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a></span> <a href="src/Cardano.Pool.Rank.html#line-162" class="link">Source</a> <a href="#t:StakePoolsSummary" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:StakePoolsSummary:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a>] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:StakePoolsSummary:Buildable:3"></span> <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a></span> <a href="src/Cardano.Pool.Rank.html#line-164" class="link">Source</a> <a href="#t:StakePoolsSummary" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:StakePoolsSummary:Buildable:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a> -&gt; <a href="../../fmt/html/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="../../formatting/html/src" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Ranking formulas</h1></a><div class="top"><p class="src"><a id="v:poolSaturation" class="def">poolSaturation</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Double" title="Distribution.Compat.Prelude.Internal">Double</a> <a href="src/Cardano.Pool.Rank.html#poolSaturation" class="link">Source</a> <a href="#v:poolSaturation" class="selflink">#</a></p><div class="doc"><p>The saturation of a pool is the ratio of the current pool stake
 to the fully saturated stake.</p></div></div><div class="top"><p class="src"><a id="v:optimalRewards" class="def">optimalRewards</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Rational" title="Distribution.Compat.Prelude.Internal">Rational</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> <a href="src/Cardano.Pool.Rank.html#optimalRewards" class="link">Source</a> <a href="#v:optimalRewards" class="selflink">#</a></p><div class="doc"><p>Optimal rewards for a stake pool
 according to Eq.(2) of Section 5.5.3 in SL-D1.</p><pre>optimalRewards s sigma</pre><p>NOTE: This computation uses <code><a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Double" title="Distribution.Compat.Prelude.Internal">Double</a></code> internally
 and is only suitable for the purpose of ranking,
 not for computing actual monetary rewards.</p></div></div><div class="top"><p class="src"><a id="v:currentROS" class="def">currentROS</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a> <a href="src/Cardano.Pool.Rank.html#currentROS" class="link">Source</a> <a href="#v:currentROS" class="selflink">#</a></p><div class="doc"><p>The yearly rate of return per unit of stake,
 assuming that the pool's stake remains at the same level.
 Rewards compound every epoch.</p></div></div><div class="top"><p class="src"><a id="v:saturationROS" class="def">saturationROS</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Data-Quantity.html#t:Percentage" title="Data.Quantity">Percentage</a> <a href="src/Cardano.Pool.Rank.html#saturationROS" class="link">Source</a> <a href="#v:saturationROS" class="selflink">#</a></p><div class="doc"><p>The (yearly) return per unit of stake
 for a pool that has reached saturation.</p></div></div><a href="#g:3" id="g:3"><h1>Redelegation warning</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:RedelegationWarning" class="def">RedelegationWarning</a> <a href="src/Cardano.Pool.Rank.html#RedelegationWarning" class="link">Source</a> <a href="#t:RedelegationWarning" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:AllGood" class="def">AllGood</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:TooFewBlocks" class="def">TooFewBlocks</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:OtherPoolsBetter" class="def">OtherPoolsBetter</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:RedelegationWarning">Instances</h4><details id="i:RedelegationWarning" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RedelegationWarning:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a></span> <a href="src/Cardano.Pool.Rank.html#line-328" class="link">Source</a> <a href="#t:RedelegationWarning" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RedelegationWarning:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RedelegationWarning:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a></span> <a href="src/Cardano.Pool.Rank.html#line-328" class="link">Source</a> <a href="#t:RedelegationWarning" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RedelegationWarning:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a>] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:RedelegationWarning:Buildable:3"></span> <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a></span> <a href="src/Cardano.Pool.Rank.html#line-332" class="link">Source</a> <a href="#t:RedelegationWarning" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:RedelegationWarning:Buildable:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Pool-Rank.html">Cardano.Pool.Rank</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a> -&gt; <a href="../../fmt/html/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="../../formatting/html/src" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:redelegationWarning" class="def">redelegationWarning</a> <a href="src/Cardano.Pool.Rank.html#redelegationWarning" class="link">Source</a> <a href="#v:redelegationWarning" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Cardano-Wallet-Primitive-Types.html#t:EpochNo" title="Cardano.Wallet.Primitive.Types">EpochNo</a></td><td class="doc"><p>Epoch when delegation was made</p></td></tr><tr><td class="src">-&gt; (<a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a>)</td><td class="doc"><p>( Info about the pool that we delegate to
   , absolute stake that we delegate )</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a></td><td class="doc"><p>Current summary of all stake pools (for comparison)</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:EpochNo" title="Cardano.Wallet.Primitive.Types">EpochNo</a></td><td class="doc"><p>Current epoch</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Pool-Rank.html#t:RedelegationWarning" title="Cardano.Pool.Rank">RedelegationWarning</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Compute redelegation warning from current pool performance.</p><p>Note: This function uses the <code><a href="Cardano-Pool-Rank.html#v:performanceEstimate" title="Cardano.Pool.Rank">performanceEstimate</a></code> for the pool
 that we delegate to, but ignores this fields for the argument
 <code><a href="Cardano-Pool-Rank.html#t:StakePoolsSummary" title="Cardano.Pool.Rank">StakePoolsSummary</a></code>.</p></div></div><a href="#g:4" id="g:4"><h1>Legacy metrics</h1></a><div class="top"><p class="src"><a id="v:nonMyopicMemberReward" class="def">nonMyopicMemberReward</a> <a href="src/Cardano.Pool.Rank.html#nonMyopicMemberReward" class="link">Source</a> <a href="#v:nonMyopicMemberReward" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a></td><td class="doc"><p>The pool ranks in the top <code>nOpt</code> pools</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></td><td class="doc"><p>stake that the member wants to delegate</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Non-Myopic Pool Member Rewards
 according to Eq.(3) of Section 5.6.4 in SL-D1.</p></div></div><div class="top"><p class="src"><a id="v:desirability" class="def">desirability</a> :: <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a> -&gt; <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> <a href="src/Cardano.Pool.Rank.html#desirability" class="link">Source</a> <a href="#v:desirability" class="selflink">#</a></p><div class="doc"><p>The desirabilty of a pool is equal to the total
 member rewards at saturation
 IF the owner meets their pledge.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:PoolScore" class="def">PoolScore</a> <a href="src/Cardano.Pool.Rank.html#PoolScore" class="link">Source</a> <a href="#t:PoolScore" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:PoolScore" class="def">PoolScore</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:_desirability" class="def">_desirability</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:_nonMyopicMemberReward" class="def">_nonMyopicMemberReward</a> :: <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div></div><div class="top"><p class="src"><a id="v:scorePools" class="def">scorePools</a> <a href="src/Cardano.Pool.Rank.html#scorePools" class="link">Source</a> <a href="#v:scorePools" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Ord" title="Distribution.Compat.Prelude.Internal">Ord</a> poolId</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Pool-Rank.html#t:RewardParams" title="Cardano.Pool.Rank">RewardParams</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> poolId (<a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, a)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a></td><td class="doc"><p>Stake that the user wants to delegate</p></td></tr><tr><td class="src">-&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> poolId (<a href="Cardano-Pool-Rank.html#t:PoolScore" title="Cardano.Pool.Rank">PoolScore</a>, <a href="Cardano-Pool-Rank.html#t:RewardInfoPool" title="Cardano.Pool.Rank">RewardInfoPool</a>, a)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Compute the desirability and non-myopic rewards for all pools.</p><p>To compute the non-myopic rewards, we need to know all pools
 in order to rank them by desirability,
 and we need to know the stake that the user wants to delegate.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>