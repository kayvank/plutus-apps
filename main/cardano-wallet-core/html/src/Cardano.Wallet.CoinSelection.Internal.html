<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24maxtag_I2tgJ7W2hPjG9fiZvr2BnM"><span id="%24tag2con_I2tgJ7W2hPjG9fiZvr2BnM"><span id="%24con2tag_I2tgJ7W2hPjG9fiZvr2BnM"></span></span></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright: &#169; 2021 IOHK</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License: Apache-2.0</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- This module provides INTERNAL functions and types for coin selection.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- It is recommended to import from 'Cardano.Wallet.CoinSelection' instead.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Performing selections</span></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelection"><span class="hs-identifier">performSelection</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier">Selection</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier">SelectionConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier">SelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier">SelectionParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier">SelectionSkeleton</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Output preparation</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsWith"><span class="hs-identifier">prepareOutputsWith</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier">SelectionOutputError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Verification of post conditions</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier">VerificationResult</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Verification of selections and selection errors</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelection"><span class="hs-identifier">verifySelection</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionError"><span class="hs-identifier">verifySelectionError</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Selection deltas</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionDelta"><span class="hs-identifier">SelectionDelta</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaAllAssets"><span class="hs-identifier">selectionDeltaAllAssets</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaCoin"><span class="hs-identifier">selectionDeltaCoin</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasValidSurplus"><span class="hs-identifier">selectionHasValidSurplus</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCost"><span class="hs-identifier">selectionMinimumCost</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionSurplusCoin"><span class="hs-identifier">selectionSurplusCoin</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Selection collateral</span></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier">SelectionCollateralError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralRequirement"><span class="hs-identifier">SelectionCollateralRequirement</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateral"><span class="hs-identifier">selectionCollateral</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier">selectionCollateralRequired</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasSufficientCollateral"><span class="hs-identifier">selectionHasSufficientCollateral</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCollateral"><span class="hs-identifier">selectionMinimumCollateral</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Internal types and functions</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#ComputeMinimumCollateralParams"><span class="hs-identifier">ComputeMinimumCollateralParams</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#computeMinimumCollateral"><span class="hs-identifier">computeMinimumCollateral</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier">toBalanceConstraintsParams</span></a></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../lattices/html/src"><span class="hs-identifier">Algebra.PartialOrd</span></a></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../lattices/html/src"><span class="hs-identifier">PartialOrd</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Balance</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionBalanceError"><span class="hs-identifier">SelectionBalanceError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionDelta"><span class="hs-identifier">SelectionDelta</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier">SelectionLimit</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier">SelectionSkeleton</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier">SelectionStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Context</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier">SelectionContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Coin</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier">TokenBundle</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenMap</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier">AssetId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier">TokenMap</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenQuantity.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenQuantity</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenQuantity.html#TokenQuantity"><span class="hs-identifier">TokenQuantity</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Tx</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeAssessment"><span class="hs-identifier">TokenBundleSizeAssessment</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html#txOutMaxTokenQuantity"><span class="hs-identifier">txOutMaxTokenQuantity</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.UTxOSelection</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html#UTxOSelection"><span class="hs-identifier">UTxOSelection</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;=&lt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">Control.Monad.Random.Class</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier">MonadRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Control.Monad.Random.Extra.html"><span class="hs-identifier">Control.Monad.Random.Extra</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Control.Monad.Random.Extra.html#NonRandom"><span class="hs-identifier">NonRandom</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">runExceptT</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">withExceptT</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&amp;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;&amp;&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">Data.Generics.Internal.VL.Lens</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">over</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">set</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">view</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-operator">(^.)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../generic-lens/html/src"><span class="hs-identifier">Data.Generics.Labels</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Map</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Ratio</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(%)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">All</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mtimesDefault</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">HasCallStack</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Numeric.Natural</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Natural</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Balance</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Balance</span></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Collateral</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Collateral</span></span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TokenBundle</span></span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenMap</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TokenMap</span></span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.UTxOSelection</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxOSelection</span></span><span>
</span><span id="line-131"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">F</span></span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Types</span><span>
</span><span id="line-137"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- | Specifies all constraints required for coin selection.</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- Selection constraints:</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">--    - are dependent on the current set of protocol parameters.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">--    - are not specific to a given selection.</span><span>
</span><span id="line-146"></span><span class="hs-comment">--</span><span>
</span><span id="line-147"></span><span class="hs-comment">--    - place limits on the coin selection algorithm, enabling it to produce</span><span>
</span><span id="line-148"></span><span class="hs-comment">--      selections that are acceptable to the ledger.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span id="local-6989586621682436141"><span id="local-6989586621682436142"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionConstraints"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-var">SelectionConstraints</span></a></span></span><span> </span><span id="local-6989586621682436475"><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SelectionConstraints"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-var">SelectionConstraints</span></a></span></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AassessTokenBundleSize%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; TokenBundle -&gt; TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassessTokenBundleSize%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">assessTokenBundleSize</span></a></span></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeAssessment"><span class="hs-identifier hs-type">TokenBundleSizeAssessment</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-comment">-- ^ Assesses the size of a token bundle relative to the upper limit of</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-comment">-- what can be included in a transaction output. See documentation for</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-comment">-- the 'TokenBundleSizeAssessor' type to learn about the expected</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-comment">-- properties of this field.</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcertificateDepositAmount%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcertificateDepositAmount%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">certificateDepositAmount</span></a></span></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-comment">-- ^ Amount that should be taken from/returned back to the wallet for</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-comment">-- each stake key registration/de-registration in the transaction.</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcomputeMinimumAdaQuantity%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Address ctx -&gt; TokenMap -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeMinimumAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">computeMinimumAdaQuantity</span></a></span></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-comment">-- ^ Computes the minimum ada quantity required for a given output.</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AisBelowMinimumAdaQuantity%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Address ctx -&gt; TokenBundle -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AisBelowMinimumAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">isBelowMinimumAdaQuantity</span></a></span></span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-comment">-- ^ Returns 'True' if the given 'TokenBundle' has a 'Coin' value that is</span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-comment">-- below the minimum required.</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcomputeMinimumCost%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; SelectionSkeleton ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeMinimumCost%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">computeMinimumCost</span></a></span></span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-comment">-- ^ Computes the minimum cost of a given selection skeleton.</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcomputeSelectionLimit%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeSelectionLimit%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">computeSelectionLimit</span></a></span></span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-comment">-- ^ Computes an upper bound for the number of ordinary inputs to</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-comment">-- select, given a current set of outputs.</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumCollateralInputCount%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumCollateralInputCount%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">maximumCollateralInputCount</span></a></span></span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-comment">-- ^ Specifies an inclusive upper bound on the number of unique inputs</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-comment">-- that can be selected as collateral.</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AminimumCollateralPercentage%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Natural
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumCollateralPercentage%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">minimumCollateralPercentage</span></a></span></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-comment">-- ^ Specifies the minimum required amount of collateral as a</span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-comment">-- percentage of the total transaction fee.</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumOutputAdaQuantity%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumOutputAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">maximumOutputAdaQuantity</span></a></span></span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-comment">-- ^ Specifies the largest ada quantity that can appear in the token</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-comment">-- bundle of an output.</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumOutputTokenQuantity%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; TokenQuantity
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumOutputTokenQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">maximumOutputTokenQuantity</span></a></span></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenQuantity.html#TokenQuantity"><span class="hs-identifier hs-type">TokenQuantity</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-comment">-- ^ Specifies the largest non-ada quantity that can appear in the</span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-comment">-- token bundle of an output.</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumLengthChangeAddress%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumLengthChangeAddress%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">maximumLengthChangeAddress</span></a></span></span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnullAddress%3ASelectionConstraints"><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AnullAddress%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">nullAddress</span></a></span></span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436475"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionConstraints ctx -&gt; Rep (SelectionConstraints ctx) x)
-&gt; (forall x.
    Rep (SelectionConstraints ctx) x -&gt; SelectionConstraints ctx)
-&gt; Generic (SelectionConstraints ctx)
forall x.
Rep (SelectionConstraints ctx) x -&gt; SelectionConstraints ctx
forall x.
SelectionConstraints ctx -&gt; Rep (SelectionConstraints ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionConstraints ctx) x -&gt; SelectionConstraints ctx
forall ctx x.
SelectionConstraints ctx -&gt; Rep (SelectionConstraints ctx) x
$cto :: forall ctx x.
Rep (SelectionConstraints ctx) x -&gt; SelectionConstraints ctx
$cfrom :: forall ctx x.
SelectionConstraints ctx -&gt; Rep (SelectionConstraints ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Specifies all parameters that are specific to a given selection.</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span id="local-6989586621682436123"><span id="local-6989586621682436124"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionParams"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-var">SelectionParams</span></a></span></span><span> </span><span id="local-6989586621682436313"><span class="annot"><a href="#local-6989586621682436313"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SelectionParams"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-var">SelectionParams</span></a></span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AassetsToBurn%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToBurn%3ASelectionParams"><span class="hs-identifier hs-var hs-var">assetsToBurn</span></a></span></span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-comment">-- ^ Specifies a set of assets to burn.</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AassetsToMint%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToMint%3ASelectionParams"><span class="hs-identifier hs-var hs-var">assetsToMint</span></a></span></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="hs-comment">-- ^ Specifies a set of assets to mint.</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AextraCoinIn%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinIn%3ASelectionParams"><span class="hs-identifier hs-var hs-var">extraCoinIn</span></a></span></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-209"></span><span>       </span><span class="hs-comment">-- ^ Specifies extra 'Coin' in.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AextraCoinOut%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinOut%3ASelectionParams"><span class="hs-identifier hs-var hs-var">extraCoinOut</span></a></span></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-comment">-- ^ Specifies extra 'Coin' out.</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AoutputsToCover%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AoutputsToCover%3ASelectionParams"><span class="hs-identifier hs-var hs-var">outputsToCover</span></a></span></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436313"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-comment">-- ^ Specifies a set of outputs that must be paid for.</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3ArewardWithdrawal%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3ArewardWithdrawal%3ASelectionParams"><span class="hs-identifier hs-var hs-var">rewardWithdrawal</span></a></span></span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-218"></span><span>        </span><span class="hs-comment">-- ^ Specifies the value of a withdrawal from a reward account.</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcertificateDepositsTaken%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Natural
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcertificateDepositsTaken%3ASelectionParams"><span class="hs-identifier hs-var hs-var">certificateDepositsTaken</span></a></span></span><span>
</span><span id="line-220"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-comment">-- ^ Number of deposits for stake key registrations.</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcertificateDepositsReturned%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Natural
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcertificateDepositsReturned%3ASelectionParams"><span class="hs-identifier hs-var hs-var">certificateDepositsReturned</span></a></span></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span class="hs-comment">-- ^ Number of deposits from stake key de-registrations.</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcollateralRequirement%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; SelectionCollateralRequirement
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralRequirement%3ASelectionParams"><span class="hs-identifier hs-var hs-var">collateralRequirement</span></a></span></span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralRequirement"><span class="hs-identifier hs-type">SelectionCollateralRequirement</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="hs-comment">-- ^ Specifies the collateral requirement for this selection.</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AutxoAvailableForCollateral%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Map (UTxO ctx) Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AutxoAvailableForCollateral%3ASelectionParams"><span class="hs-identifier hs-var hs-var">utxoAvailableForCollateral</span></a></span></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436313"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-comment">-- ^ Specifies a set of UTxOs that are available for selection as</span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-comment">-- collateral inputs.</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-comment">-- This set is allowed to intersect with 'utxoAvailableForInputs',</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-comment">-- since the ledger does not require that these sets are disjoint.</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AutxoAvailableForInputs%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; UTxOSelection (UTxO ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AutxoAvailableForInputs%3ASelectionParams"><span class="hs-identifier hs-var hs-var">utxoAvailableForInputs</span></a></span></span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html#UTxOSelection"><span class="hs-identifier hs-type">UTxOSelection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436313"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-comment">-- ^ Specifies a set of UTxOs that are available for selection as</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-comment">-- ordinary inputs and optionally, a subset that has already been</span><span>
</span><span id="line-239"></span><span>        </span><span class="hs-comment">-- selected.</span><span>
</span><span id="line-240"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span>        </span><span class="hs-comment">-- Further entries from this set will be selected to cover any deficit.</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AselectionStrategy%3ASelectionParams"><span class="annot"><span class="annottext">SelectionParams ctx -&gt; SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectionStrategy%3ASelectionParams"><span class="hs-identifier hs-var hs-var">selectionStrategy</span></a></span></span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier hs-type">SelectionStrategy</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-comment">-- ^ Specifies which selection strategy to use. See 'SelectionStrategy'.</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x. SelectionParams ctx -&gt; Rep (SelectionParams ctx) x)
-&gt; (forall x. Rep (SelectionParams ctx) x -&gt; SelectionParams ctx)
-&gt; Generic (SelectionParams ctx)
forall x. Rep (SelectionParams ctx) x -&gt; SelectionParams ctx
forall x. SelectionParams ctx -&gt; Rep (SelectionParams ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x. Rep (SelectionParams ctx) x -&gt; SelectionParams ctx
forall ctx x. SelectionParams ctx -&gt; Rep (SelectionParams ctx) x
$cto :: forall ctx x. Rep (SelectionParams ctx) x -&gt; SelectionParams ctx
$cfrom :: forall ctx x. SelectionParams ctx -&gt; Rep (SelectionParams ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span id="local-6989586621682436103"><span id="local-6989586621682436105"><span id="local-6989586621682436107"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436107"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436107"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-249"></span><span id="local-6989586621682436095"><span id="local-6989586621682436097"><span id="local-6989586621682436099"><span id="local-6989586621682436101"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436101"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436101"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Indicates that an error occurred while performing a coin selection.</span><span>
</span><span id="line-252"></span><span class="hs-comment">--</span><span>
</span><span id="line-253"></span><span class="hs-keyword">data</span><span> </span><span id="SelectionError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-var">SelectionError</span></a></span></span><span> </span><span id="local-6989586621682436519"><span class="annot"><a href="#local-6989586621682436519"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SelectionBalanceErrorOf"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionBalanceErrorOf"><span class="hs-identifier hs-var">SelectionBalanceErrorOf</span></a></span></span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionBalanceError"><span class="hs-identifier hs-type">SelectionBalanceError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436519"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SelectionCollateralErrorOf"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralErrorOf"><span class="hs-identifier hs-var">SelectionCollateralErrorOf</span></a></span></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-type">SelectionCollateralError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436519"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SelectionOutputErrorOf"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputErrorOf"><span class="hs-identifier hs-var">SelectionOutputErrorOf</span></a></span></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-type">SelectionOutputError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436519"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span id="local-6989586621682436086"><span id="local-6989586621682436088"><span id="local-6989586621682436090"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436090"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436090"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-262"></span><span id="local-6989586621682436079"><span id="local-6989586621682436081"><span id="local-6989586621682436083"><span id="local-6989586621682436085"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436085"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436085"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-comment">-- | Represents an unsuccessful attempt to select collateral.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span id="local-6989586621682436077"><span id="local-6989586621682436078"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionCollateralError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-var">SelectionCollateralError</span></a></span></span><span> </span><span id="local-6989586621682436480"><span class="annot"><a href="#local-6989586621682436480"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SelectionCollateralError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-var">SelectionCollateralError</span></a></span></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AlargestCombinationAvailable%3ASelectionCollateralError"><span class="annot"><span class="annottext">SelectionCollateralError ctx -&gt; Map (UTxO ctx) Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AlargestCombinationAvailable%3ASelectionCollateralError"><span class="hs-identifier hs-var hs-var">largestCombinationAvailable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436480"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-comment">-- ^ The largest combination of coins available.</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AminimumSelectionAmount%3ASelectionCollateralError"><span class="annot"><span class="annottext">SelectionCollateralError ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumSelectionAmount%3ASelectionCollateralError"><span class="hs-identifier hs-var hs-var">minimumSelectionAmount</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-comment">-- ^ A lower bound on the sum of coins to be selected as collateral.</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionCollateralError ctx
 -&gt; Rep (SelectionCollateralError ctx) x)
-&gt; (forall x.
    Rep (SelectionCollateralError ctx) x
    -&gt; SelectionCollateralError ctx)
-&gt; Generic (SelectionCollateralError ctx)
forall x.
Rep (SelectionCollateralError ctx) x
-&gt; SelectionCollateralError ctx
forall x.
SelectionCollateralError ctx
-&gt; Rep (SelectionCollateralError ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionCollateralError ctx) x
-&gt; SelectionCollateralError ctx
forall ctx x.
SelectionCollateralError ctx
-&gt; Rep (SelectionCollateralError ctx) x
$cto :: forall ctx x.
Rep (SelectionCollateralError ctx) x
-&gt; SelectionCollateralError ctx
$cfrom :: forall ctx x.
SelectionCollateralError ctx
-&gt; Rep (SelectionCollateralError ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span id="local-6989586621682436067"><span id="local-6989586621682436069"><span id="local-6989586621682436071"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436071"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-type">SelectionCollateralError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436071"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-275"></span><span id="local-6989586621682436060"><span id="local-6989586621682436062"><span id="local-6989586621682436064"><span id="local-6989586621682436066"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436066"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-type">SelectionCollateralError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436066"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Represents a balanced selection.</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span id="local-6989586621682436058"><span id="local-6989586621682436059"></span></span><span class="hs-keyword">data</span><span> </span><span id="Selection"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-var">Selection</span></a></span></span><span> </span><span id="local-6989586621682436441"><span class="annot"><a href="#local-6989586621682436441"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Selection"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-var">Selection</span></a></span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Ainputs%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; NonEmpty (UTxO ctx, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Ainputs%3ASelection"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436441"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-comment">-- ^ Selected inputs.</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Acollateral%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; [(UTxO ctx, Coin)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Acollateral%3ASelection"><span class="hs-identifier hs-var hs-var">collateral</span></a></span></span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436441"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-285"></span><span>        </span><span class="hs-comment">-- ^ Selected collateral inputs.</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aoutputs%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aoutputs%3ASelection"><span class="hs-identifier hs-var hs-var">outputs</span></a></span></span><span>
</span><span id="line-287"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436441"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-288"></span><span>        </span><span class="hs-comment">-- ^ User-specified outputs</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Achange%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; [TokenBundle]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Achange%3ASelection"><span class="hs-identifier hs-var hs-var">change</span></a></span></span><span>
</span><span id="line-290"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-comment">-- ^ Generated change outputs.</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AassetsToMint%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToMint%3ASelection"><span class="hs-identifier hs-var hs-var">assetsToMint</span></a></span></span><span>
</span><span id="line-293"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span>
</span><span id="line-294"></span><span>        </span><span class="hs-comment">-- ^ Assets to mint.</span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AassetsToBurn%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToBurn%3ASelection"><span class="hs-identifier hs-var hs-var">assetsToBurn</span></a></span></span><span>
</span><span id="line-296"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span class="hs-comment">-- ^ Assets to burn.</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AextraCoinSource%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinSource%3ASelection"><span class="hs-identifier hs-var hs-var">extraCoinSource</span></a></span></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-comment">-- ^ An extra source of ada.</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AextraCoinSink%3ASelection"><span class="annot"><span class="annottext">Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinSink%3ASelection"><span class="hs-identifier hs-var hs-var">extraCoinSink</span></a></span></span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-comment">-- ^ An extra sink for ada.</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x. Selection ctx -&gt; Rep (Selection ctx) x)
-&gt; (forall x. Rep (Selection ctx) x -&gt; Selection ctx)
-&gt; Generic (Selection ctx)
forall x. Rep (Selection ctx) x -&gt; Selection ctx
forall x. Selection ctx -&gt; Rep (Selection ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x. Rep (Selection ctx) x -&gt; Selection ctx
forall ctx x. Selection ctx -&gt; Rep (Selection ctx) x
$cto :: forall ctx x. Rep (Selection ctx) x -&gt; Selection ctx
$cfrom :: forall ctx x. Selection ctx -&gt; Rep (Selection ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span id="local-6989586621682436042"><span id="local-6989586621682436044"><span id="local-6989586621682436046"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436046"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436046"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-308"></span><span id="local-6989586621682436035"><span id="local-6989586621682436037"><span id="local-6989586621682436039"><span id="local-6989586621682436041"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436041"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436041"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- | Provides a context for functions related to 'performSelection'.</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">type</span><span> </span><span id="PerformSelection"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-var">PerformSelection</span></a></span></span><span> </span><span id="local-6989586621682436034"><span class="annot"><a href="#local-6989586621682436034"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682436033"><span class="annot"><a href="#local-6989586621682436033"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span id="local-6989586621682436032"><span class="annot"><a href="#local-6989586621682436032"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436033"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436033"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436033"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436034"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436032"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- Performing a selection</span><span>
</span><span id="line-319"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Performs a coin selection.</span><span>
</span><span id="line-322"></span><span class="hs-comment">--</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- This function has the following responsibilities:</span><span>
</span><span id="line-324"></span><span class="hs-comment">--</span><span>
</span><span id="line-325"></span><span class="hs-comment">--  - selecting inputs from the UTxO set to pay for user-specified outputs;</span><span>
</span><span id="line-326"></span><span class="hs-comment">--  - selecting inputs from the UTxO set to pay for collateral;</span><span>
</span><span id="line-327"></span><span class="hs-comment">--  - producing change outputs to return excess value to the wallet;</span><span>
</span><span id="line-328"></span><span class="hs-comment">--  - balancing a selection to pay for the transaction fee.</span><span>
</span><span id="line-329"></span><span class="hs-comment">--</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- This function guarantees that given a set of 'SelectionConstraints' @cs@</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- and 'SelectionParams' @ps@:</span><span>
</span><span id="line-332"></span><span class="hs-comment">--</span><span>
</span><span id="line-333"></span><span class="hs-comment">--  - if creation of a selection succeeds, a value @s@ of type 'Selection'</span><span>
</span><span id="line-334"></span><span class="hs-comment">--    will be returned for which the following property holds:</span><span>
</span><span id="line-335"></span><span class="hs-comment">--</span><span>
</span><span id="line-336"></span><span class="hs-comment">--      &gt;&gt;&gt; verifySelection cs ps s == VerificationSuccess</span><span>
</span><span id="line-337"></span><span class="hs-comment">--</span><span>
</span><span id="line-338"></span><span class="hs-comment">--  - if creation of a selection fails, a value @e@ of type 'SelectionError'</span><span>
</span><span id="line-339"></span><span class="hs-comment">--    will be returned for which the following property holds:</span><span>
</span><span id="line-340"></span><span class="hs-comment">--</span><span>
</span><span id="line-341"></span><span class="hs-comment">--      &gt;&gt;&gt; verifySelectionError cs ps e == VerificationSuccess</span><span>
</span><span id="line-342"></span><span class="hs-comment">--</span><span>
</span><span id="line-343"></span><span id="local-6989586621682436030"><span id="local-6989586621682436031"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelection"><span class="hs-identifier hs-type">performSelection</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436031"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436030"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-type">PerformSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436031"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436030"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436030"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-346"></span><span id="performSelection"><span class="annot"><span class="annottext">performSelection :: PerformSelection m ctx (Selection ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelection"><span class="hs-identifier hs-var hs-var">performSelection</span></a></span></span><span> </span><span id="local-6989586621682436029"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436029"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PerformSelection m ctx (Selection ctx)
forall (m :: * -&gt; *) ctx.
(HasCallStack, MonadRandom m, SelectionContext ctx) =&gt;
PerformSelection m ctx (Selection ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionInner"><span class="hs-identifier hs-var">performSelectionInner</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436029"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionParams ctx
 -&gt; ExceptT (SelectionError ctx) m (Selection ctx))
-&gt; (SelectionParams ctx
    -&gt; ExceptT (SelectionError ctx) m (SelectionParams ctx))
-&gt; SelectionParams ctx
-&gt; ExceptT (SelectionError ctx) m (Selection ctx)
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">PerformSelection m ctx (SelectionParams ctx)
forall (m :: * -&gt; *) ctx.
Applicative m =&gt;
PerformSelection m ctx (SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputs"><span class="hs-identifier hs-var">prepareOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436029"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span id="local-6989586621682436548"><span id="local-6989586621682436550"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionInner"><span class="hs-identifier hs-type">performSelectionInner</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436550"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436548"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-type">PerformSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436550"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436548"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436548"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-351"></span><span id="performSelectionInner"><span class="annot"><span class="annottext">performSelectionInner :: PerformSelection m ctx (Selection ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionInner"><span class="hs-identifier hs-var hs-var">performSelectionInner</span></a></span></span><span> </span><span id="local-6989586621682436026"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436026"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682436025"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436025"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-352"></span><span>    </span><span id="local-6989586621682436024"><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682436024"><span class="hs-identifier hs-var">balanceResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">PerformSelection m ctx (SelectionResult ctx)
forall (m :: * -&gt; *) ctx.
(HasCallStack, MonadRandom m, SelectionContext ctx) =&gt;
PerformSelection m ctx (SelectionResult ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionBalance"><span class="hs-identifier hs-var">performSelectionBalance</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436026"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436025"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621682436022"><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
</span><a href="#local-6989586621682436022"><span class="hs-identifier hs-var">collateralResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
-&gt; PerformSelection m ctx (SelectionResult (UTxO ctx))
forall (m :: * -&gt; *) ctx.
(Applicative m, SelectionContext ctx) =&gt;
SelectionResult ctx
-&gt; PerformSelection m ctx (SelectionResult (UTxO ctx))
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionCollateral"><span class="hs-identifier hs-var">performSelectionCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682436024"><span class="hs-identifier hs-var">balanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436026"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436025"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="annot"><span class="annottext">Selection ctx -&gt; ExceptT (SelectionError ctx) m (Selection ctx)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Selection ctx -&gt; ExceptT (SelectionError ctx) m (Selection ctx))
-&gt; Selection ctx -&gt; ExceptT (SelectionError ctx) m (Selection ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
-&gt; SelectionResult ctx
-&gt; SelectionResult (UTxO ctx)
-&gt; Selection ctx
forall ctx.
SelectionParams ctx
-&gt; SelectionResult ctx
-&gt; SelectionResult (UTxO ctx)
-&gt; Selection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#mkSelection"><span class="hs-identifier hs-var">mkSelection</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436025"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682436024"><span class="hs-identifier hs-var">balanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
</span><a href="#local-6989586621682436022"><span class="hs-identifier hs-var">collateralResult</span></a></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span id="local-6989586621682436541"><span id="local-6989586621682436542"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputs"><span class="hs-identifier hs-type">prepareOutputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436542"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-type">PerformSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436542"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436541"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436541"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-357"></span><span id="prepareOutputs"><span class="annot"><span class="annottext">prepareOutputs :: PerformSelection m ctx (SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputs"><span class="hs-identifier hs-var hs-var">prepareOutputs</span></a></span></span><span> </span><span id="local-6989586621682436019"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436019"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682436018"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436018"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><span class="annottext">(SelectionOutputError ctx -&gt; SelectionError ctx)
-&gt; ExceptT (SelectionOutputError ctx) m (SelectionParams ctx)
-&gt; ExceptT (SelectionError ctx) m (SelectionParams ctx)
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputError ctx -&gt; SelectionError ctx
forall ctx. SelectionOutputError ctx -&gt; SelectionError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputErrorOf"><span class="hs-identifier hs-var">SelectionOutputErrorOf</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT (SelectionOutputError ctx) m (SelectionParams ctx)
 -&gt; ExceptT (SelectionError ctx) m (SelectionParams ctx))
-&gt; ExceptT (SelectionOutputError ctx) m (SelectionParams ctx)
-&gt; ExceptT (SelectionError ctx) m (SelectionParams ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either (SelectionOutputError ctx) (SelectionParams ctx))
-&gt; ExceptT (SelectionOutputError ctx) m (SelectionParams ctx)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either (SelectionOutputError ctx) (SelectionParams ctx))
 -&gt; ExceptT (SelectionOutputError ctx) m (SelectionParams ctx))
-&gt; m (Either (SelectionOutputError ctx) (SelectionParams ctx))
-&gt; ExceptT (SelectionOutputError ctx) m (SelectionParams ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either (SelectionOutputError ctx) (SelectionParams ctx)
-&gt; m (Either (SelectionOutputError ctx) (SelectionParams ctx))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (SelectionOutputError ctx) (SelectionParams ctx)
 -&gt; m (Either (SelectionOutputError ctx) (SelectionParams ctx)))
-&gt; Either (SelectionOutputError ctx) (SelectionParams ctx)
-&gt; m (Either (SelectionOutputError ctx) (SelectionParams ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall ctx.
SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsInternal"><span class="hs-identifier hs-var">prepareOutputsInternal</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436019"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(([(Address ctx, TokenBundle)]
  -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
 -&gt; SelectionParams ctx
 -&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; [(Address ctx, TokenBundle)]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputsToCover&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; SelectionParams ctx
   -&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; SelectionParams ctx
-&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx)
</span><a href="#local-6989586621682436015"><span class="hs-var">#outputsToCover</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436018"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><span class="annottext">Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
-&gt; ([(Address ctx, TokenBundle)] -&gt; SelectionParams ctx)
-&gt; Either (SelectionOutputError ctx) (SelectionParams ctx)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682436014"><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682436014"><span class="hs-identifier hs-var">outputsToCover</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436018"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
outputsToCover :: [(Address ctx, TokenBundle)]
$sel:outputsToCover:SelectionParams :: [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682436014"><span class="hs-identifier hs-var hs-var">outputsToCover</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span id="local-6989586621682436536"><span id="local-6989586621682436537"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionBalance"><span class="hs-identifier hs-type">performSelectionBalance</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../MonadRandom/html/src"><span class="hs-identifier hs-type">MonadRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436537"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436536"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-type">PerformSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436536"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436536"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-365"></span><span id="performSelectionBalance"><span class="annot"><span class="annottext">performSelectionBalance :: PerformSelection m ctx (SelectionResult ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionBalance"><span class="hs-identifier hs-var hs-var">performSelectionBalance</span></a></span></span><span> </span><span id="local-6989586621682436013"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436013"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682436012"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436012"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><span class="annottext">(SelectionBalanceError ctx -&gt; SelectionError ctx)
-&gt; ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx)
-&gt; ExceptT (SelectionError ctx) m (SelectionResult ctx)
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionBalanceError ctx -&gt; SelectionError ctx
forall ctx. SelectionBalanceError ctx -&gt; SelectionError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionBalanceErrorOf"><span class="hs-identifier hs-var">SelectionBalanceErrorOf</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx)
 -&gt; ExceptT (SelectionError ctx) m (SelectionResult ctx))
-&gt; ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx)
-&gt; ExceptT (SelectionError ctx) m (SelectionResult ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
-&gt; ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx)
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
 -&gt; ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx))
-&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
-&gt; ExceptT (SelectionBalanceError ctx) m (SelectionResult ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="annot"><span class="annottext">(SelectionConstraints ctx
 -&gt; SelectionParamsOf [] ctx
 -&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx)))
-&gt; (SelectionConstraints ctx, SelectionParamsOf [] ctx)
-&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParamsOf [] ctx
-&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
forall (m :: * -&gt; *) ctx.
(HasCallStack, MonadRandom m, SelectionContext ctx) =&gt;
PerformSelection m [] ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#performSelection"><span class="hs-identifier hs-var">Balance.performSelection</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints ctx, SelectionParamsOf [] ctx)
 -&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx)))
-&gt; (SelectionConstraints ctx, SelectionParamsOf [] ctx)
-&gt; m (Either (SelectionBalanceError ctx) (SelectionResult ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParamsOf [] ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436013"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436012"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span id="local-6989586621682436533"><span id="local-6989586621682436534"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionCollateral"><span class="hs-identifier hs-type">performSelectionCollateral</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436534"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436533"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436533"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#PerformSelection"><span class="hs-identifier hs-type">PerformSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436534"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436533"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionResult"><span class="hs-identifier hs-type">Collateral.SelectionResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436533"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-373"></span><span id="performSelectionCollateral"><span class="annot"><span class="annottext">performSelectionCollateral :: SelectionResult ctx
-&gt; PerformSelection m ctx (SelectionResult (UTxO ctx))
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelectionCollateral"><span class="hs-identifier hs-var hs-var">performSelectionCollateral</span></a></span></span><span> </span><span id="local-6989586621682436009"><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682436009"><span class="hs-identifier hs-var">balanceResult</span></a></span></span><span> </span><span id="local-6989586621682436008"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436008"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682436007"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436007"><span class="hs-identifier hs-var">ps</span></a></span></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Bool
forall ctx. SelectionParams ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier hs-var">selectionCollateralRequired</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436007"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">(SelectionCollateralError (UTxO ctx) -&gt; SelectionError ctx)
-&gt; ExceptT
     (SelectionCollateralError (UTxO ctx))
     m
     (SelectionResult (UTxO ctx))
-&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx))
forall (m :: * -&gt; *) e e' a.
Functor m =&gt;
(e -&gt; e') -&gt; ExceptT e m a -&gt; ExceptT e' m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">withExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError (UTxO ctx) -&gt; SelectionError ctx
forall ctx.
SelectionCollateralError (UTxO ctx) -&gt; SelectionError ctx
</span><a href="#local-6989586621682436006"><span class="hs-identifier hs-var">mkCollateralError</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   (SelectionCollateralError (UTxO ctx))
   m
   (SelectionResult (UTxO ctx))
 -&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx)))
-&gt; ExceptT
     (SelectionCollateralError (UTxO ctx))
     m
     (SelectionResult (UTxO ctx))
-&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either
     (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
-&gt; ExceptT
     (SelectionCollateralError (UTxO ctx))
     m
     (SelectionResult (UTxO ctx))
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either
      (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
 -&gt; ExceptT
      (SelectionCollateralError (UTxO ctx))
      m
      (SelectionResult (UTxO ctx)))
-&gt; m (Either
        (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
-&gt; ExceptT
     (SelectionCollateralError (UTxO ctx))
     m
     (SelectionResult (UTxO ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either
  (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
-&gt; m (Either
        (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either
   (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
 -&gt; m (Either
         (SelectionCollateralError (UTxO ctx))
         (SelectionResult (UTxO ctx))))
-&gt; Either
     (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
-&gt; m (Either
        (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><span class="annottext">(SelectionConstraints
 -&gt; SelectionParams (UTxO ctx)
 -&gt; Either
      (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
-&gt; Either
     (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints
-&gt; SelectionParams (UTxO ctx)
-&gt; Either
     (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
forall u. Ord u =&gt; PerformSelection u
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#performSelection"><span class="hs-identifier hs-var">Collateral.performSelection</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints, SelectionParams (UTxO ctx))
 -&gt; Either
      (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx)))
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
-&gt; Either
     (SelectionCollateralError (UTxO ctx)) (SelectionResult (UTxO ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">SelectionResult ctx
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
forall ctx.
SelectionResult ctx
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toCollateralConstraintsParams"><span class="hs-identifier hs-var">toCollateralConstraintsParams</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682436009"><span class="hs-identifier hs-var">balanceResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682436008"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682436007"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">m (Either (SelectionError ctx) (SelectionResult (UTxO ctx)))
-&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx))
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either (SelectionError ctx) (SelectionResult (UTxO ctx)))
 -&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx)))
-&gt; m (Either (SelectionError ctx) (SelectionResult (UTxO ctx)))
-&gt; ExceptT (SelectionError ctx) m (SelectionResult (UTxO ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either (SelectionError ctx) (SelectionResult (UTxO ctx))
-&gt; m (Either (SelectionError ctx) (SelectionResult (UTxO ctx)))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (SelectionError ctx) (SelectionResult (UTxO ctx))
 -&gt; m (Either (SelectionError ctx) (SelectionResult (UTxO ctx))))
-&gt; Either (SelectionError ctx) (SelectionResult (UTxO ctx))
-&gt; m (Either (SelectionError ctx) (SelectionResult (UTxO ctx)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
-&gt; Either (SelectionError ctx) (SelectionResult (UTxO ctx))
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
forall u. SelectionResult u
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#selectionResultEmpty"><span class="hs-identifier hs-var">Collateral.selectionResultEmpty</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621682436491"><span class="annot"><a href="#local-6989586621682436006"><span class="hs-identifier hs-type">mkCollateralError</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionCollateralError"><span class="hs-identifier hs-type">Collateral.SelectionCollateralError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436491"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436491"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621682436006"><span class="annot"><span class="annottext">mkCollateralError :: SelectionCollateralError (UTxO ctx) -&gt; SelectionError ctx
</span><a href="#local-6989586621682436006"><span class="hs-identifier hs-var hs-var">mkCollateralError</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionCollateralError"><span class="hs-identifier hs-type">Collateral.SelectionCollateralError</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682436000"><span id="local-6989586621682436001"><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
Coin
$sel:minimumSelectionAmount:SelectionCollateralError :: forall u. SelectionCollateralError u -&gt; Coin
$sel:largestCombinationAvailable:SelectionCollateralError :: forall u. SelectionCollateralError u -&gt; Map u Coin
minimumSelectionAmount :: Coin
largestCombinationAvailable :: Map (UTxO ctx) Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#%24sel%3AminimumSelectionAmount%3ASelectionCollateralError"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><span class="annottext">SelectionCollateralError ctx -&gt; SelectionError ctx
forall ctx. SelectionCollateralError ctx -&gt; SelectionError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralErrorOf"><span class="hs-identifier hs-var">SelectionCollateralErrorOf</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span class="annot"><span class="annottext">SelectionCollateralError :: forall ctx.
Map (UTxO ctx) Coin -&gt; Coin -&gt; SelectionCollateralError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-type">SelectionCollateralError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
Coin
minimumSelectionAmount :: Coin
largestCombinationAvailable :: Map (UTxO ctx) Coin
$sel:minimumSelectionAmount:SelectionCollateralError :: Coin
$sel:largestCombinationAvailable:SelectionCollateralError :: Map (UTxO ctx) Coin
</span><a href="#local-6989586621682436000"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Returns a selection's ordinary outputs and change outputs in a single list.</span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- Since change outputs do not have addresses at the point of generation,</span><span>
</span><span id="line-391"></span><span class="hs-comment">-- this function assigns all change outputs with a dummy change address</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- of the maximum possible length.</span><span>
</span><span id="line-393"></span><span class="hs-comment">--</span><span>
</span><span id="line-394"></span><span id="local-6989586621682436362"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionAllOutputs"><span class="hs-identifier hs-type">selectionAllOutputs</span></a></span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436362"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436362"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436362"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-398"></span><span id="selectionAllOutputs"><span class="annot"><span class="annottext">selectionAllOutputs :: SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionAllOutputs"><span class="hs-identifier hs-var hs-var">selectionAllOutputs</span></a></span></span><span> </span><span id="local-6989586621682435996"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435996"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435995"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435995"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
-&gt; [(Address ctx, TokenBundle)] -&gt; [(Address ctx, TokenBundle)]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435995"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; (([(Address ctx, TokenBundle)]
     -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
    -&gt; Selection ctx
    -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
-&gt; [(Address ctx, TokenBundle)]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputs&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; Selection ctx
   -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; Selection ctx
-&gt; Const [(Address ctx, TokenBundle)] (Selection ctx)
</span><a href="#local-6989586621682435994"><span class="hs-var">#outputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435995"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; (([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
    -&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx))
-&gt; [TokenBundle]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;change&quot;
  (([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
   -&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx))
([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
-&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx)
</span><a href="#local-6989586621682435993"><span class="hs-var">#change</span></a></span><span> </span><span class="annot"><span class="annottext">[TokenBundle]
-&gt; (TokenBundle -&gt; (Address ctx, TokenBundle))
-&gt; [(Address ctx, TokenBundle)]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; Address ctx
forall ctx. SelectionConstraints ctx -&gt; Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumLengthChangeAddress%3ASelectionConstraints"><span class="hs-identifier hs-var hs-var">maximumLengthChangeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435996"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-comment">-- | Creates constraints and parameters for 'Balance.performSelection'.</span><span>
</span><span id="line-403"></span><span class="hs-comment">--</span><span>
</span><span id="line-404"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-type">toBalanceConstraintsParams</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436497"><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-406"></span><span>       </span><span class="hs-special">(</span><span>        </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span>         </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionConstraints"><span class="hs-identifier hs-type">Balance.SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionParams"><span class="hs-identifier hs-type">Balance.SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span id="toBalanceConstraintsParams"><span class="annot"><span class="annottext">toBalanceConstraintsParams :: (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var hs-var">toBalanceConstraintsParams</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435992"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435991"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435990"><span class="hs-identifier hs-var">balanceConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435989"><span class="hs-identifier hs-var">balanceParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621682435990"><span class="annot"><span class="annottext">balanceConstraints :: SelectionConstraints ctx
</span><a href="#local-6989586621682435990"><span class="hs-identifier hs-var hs-var">balanceConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints :: forall ctx.
(TokenBundle -&gt; TokenBundleSizeAssessment)
-&gt; (Address ctx -&gt; TokenMap -&gt; Coin)
-&gt; (SelectionSkeleton ctx -&gt; Coin)
-&gt; ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; Address ctx
-&gt; Coin
-&gt; TokenQuantity
-&gt; Address ctx
-&gt; SelectionConstraints ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionConstraints"><span class="hs-identifier hs-type">Balance.SelectionConstraints</span></a></span><span>
</span><span id="line-412"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:computeMinimumAdaQuantity:SelectionConstraints :: Address ctx -&gt; TokenMap -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AcomputeMinimumAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var">computeMinimumAdaQuantity</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-413"></span><span>            </span><span class="annot"><span class="annottext">(((Address ctx -&gt; TokenMap -&gt; Coin)
  -&gt; Const
       (Address ctx -&gt; TokenMap -&gt; Coin)
       (Address ctx -&gt; TokenMap -&gt; Coin))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Address ctx -&gt; TokenMap -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenMap -&gt; Coin)
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin)
         (Address ctx -&gt; TokenMap -&gt; Coin))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
((Address ctx -&gt; TokenMap -&gt; Coin)
 -&gt; Const
      (Address ctx -&gt; TokenMap -&gt; Coin)
      (Address ctx -&gt; TokenMap -&gt; Coin))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435986"><span class="hs-var">#computeMinimumAdaQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:computeMinimumCost:SelectionConstraints :: SelectionSkeleton ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AcomputeMinimumCost%3ASelectionConstraints"><span class="hs-identifier hs-var">computeMinimumCost</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-415"></span><span>            </span><span class="annot"><span class="annottext">(((SelectionSkeleton ctx -&gt; Coin)
  -&gt; Const
       (SelectionSkeleton ctx -&gt; Coin) (SelectionSkeleton ctx -&gt; Coin))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      (SelectionSkeleton ctx -&gt; Coin) (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; SelectionSkeleton ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeMinimumCost&quot;
  (((SelectionSkeleton ctx -&gt; Coin)
    -&gt; Const
         (SelectionSkeleton ctx -&gt; Coin) (SelectionSkeleton ctx -&gt; Coin))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (SelectionSkeleton ctx -&gt; Coin) (SelectionConstraints ctx))
((SelectionSkeleton ctx -&gt; Coin)
 -&gt; Const
      (SelectionSkeleton ctx -&gt; Coin) (SelectionSkeleton ctx -&gt; Coin))
-&gt; SelectionConstraints ctx
-&gt; Const (SelectionSkeleton ctx -&gt; Coin) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435984"><span class="hs-var">#computeMinimumCost</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-416"></span><span>                </span><span class="annot"><span class="annottext">(SelectionSkeleton ctx -&gt; Coin)
-&gt; ((SelectionSkeleton ctx -&gt; Coin)
    -&gt; SelectionSkeleton ctx -&gt; Coin)
-&gt; SelectionSkeleton ctx
-&gt; Coin
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionSkeleton ctx -&gt; Coin) -&gt; SelectionSkeleton ctx -&gt; Coin
</span><a href="#local-6989586621682435983"><span class="hs-identifier hs-var">adjustComputeMinimumCost</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:computeSelectionLimit:SelectionConstraints :: [(Address ctx, TokenBundle)] -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AcomputeSelectionLimit%3ASelectionConstraints"><span class="hs-identifier hs-var">computeSelectionLimit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-418"></span><span>            </span><span class="annot"><span class="annottext">((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
  -&gt; Const
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeSelectionLimit&quot;
  ((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; Const
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
        (SelectionConstraints ctx))
(([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
-&gt; SelectionConstraints ctx
-&gt; Const
     ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435981"><span class="hs-var">#computeSelectionLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-419"></span><span>                </span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; (([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
</span><a href="#local-6989586621682435980"><span class="hs-identifier hs-var">adjustComputeSelectionLimit</span></a></span><span>
</span><span id="line-420"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assessTokenBundleSize:SelectionConstraints :: TokenBundle -&gt; TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AassessTokenBundleSize%3ASelectionConstraints"><span class="hs-identifier hs-var">assessTokenBundleSize</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-421"></span><span>            </span><span class="annot"><span class="annottext">(((TokenBundle -&gt; TokenBundleSizeAssessment)
  -&gt; Const
       (TokenBundle -&gt; TokenBundleSizeAssessment)
       (TokenBundle -&gt; TokenBundleSizeAssessment))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      (TokenBundle -&gt; TokenBundleSizeAssessment)
      (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx
-&gt; TokenBundle
-&gt; TokenBundleSizeAssessment
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assessTokenBundleSize&quot;
  (((TokenBundle -&gt; TokenBundleSizeAssessment)
    -&gt; Const
         (TokenBundle -&gt; TokenBundleSizeAssessment)
         (TokenBundle -&gt; TokenBundleSizeAssessment))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (TokenBundle -&gt; TokenBundleSizeAssessment)
        (SelectionConstraints ctx))
((TokenBundle -&gt; TokenBundleSizeAssessment)
 -&gt; Const
      (TokenBundle -&gt; TokenBundleSizeAssessment)
      (TokenBundle -&gt; TokenBundleSizeAssessment))
-&gt; SelectionConstraints ctx
-&gt; Const
     (TokenBundle -&gt; TokenBundleSizeAssessment)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435978"><span class="hs-var">#assessTokenBundleSize</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:maximumOutputAdaQuantity:SelectionConstraints :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AmaximumOutputAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var">maximumOutputAdaQuantity</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-423"></span><span>            </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionConstraints ctx
 -&gt; Const Coin (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumOutputAdaQuantity&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionConstraints ctx
   -&gt; Const Coin (SelectionConstraints ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionConstraints ctx
-&gt; Const Coin (SelectionConstraints ctx)
</span><a href="#local-6989586621682435976"><span class="hs-var">#maximumOutputAdaQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:maximumOutputTokenQuantity:SelectionConstraints :: TokenQuantity
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AmaximumOutputTokenQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var">maximumOutputTokenQuantity</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-425"></span><span>            </span><span class="annot"><span class="annottext">((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
 -&gt; SelectionConstraints ctx
 -&gt; Const TokenQuantity (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; TokenQuantity
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumOutputTokenQuantity&quot;
  ((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
   -&gt; SelectionConstraints ctx
   -&gt; Const TokenQuantity (SelectionConstraints ctx))
(TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
-&gt; SelectionConstraints ctx
-&gt; Const TokenQuantity (SelectionConstraints ctx)
</span><a href="#local-6989586621682435974"><span class="hs-var">#maximumOutputTokenQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:maximumLengthChangeAddress:SelectionConstraints :: Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AmaximumLengthChangeAddress%3ASelectionConstraints"><span class="hs-identifier hs-var">maximumLengthChangeAddress</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-427"></span><span>            </span><span class="annot"><span class="annottext">((Address ctx -&gt; Const (Address ctx) (Address ctx))
 -&gt; SelectionConstraints ctx
 -&gt; Const (Address ctx) (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Address ctx
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumLengthChangeAddress&quot;
  ((Address ctx -&gt; Const (Address ctx) (Address ctx))
   -&gt; SelectionConstraints ctx
   -&gt; Const (Address ctx) (SelectionConstraints ctx))
(Address ctx -&gt; Const (Address ctx) (Address ctx))
-&gt; SelectionConstraints ctx
-&gt; Const (Address ctx) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435972"><span class="hs-var">#maximumLengthChangeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-428"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nullAddress:SelectionConstraints :: Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AnullAddress%3ASelectionConstraints"><span class="hs-identifier hs-var">nullAddress</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>            </span><span class="annot"><span class="annottext">((Address ctx -&gt; Const (Address ctx) (Address ctx))
 -&gt; SelectionConstraints ctx
 -&gt; Const (Address ctx) (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Address ctx
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;nullAddress&quot;
  ((Address ctx -&gt; Const (Address ctx) (Address ctx))
   -&gt; SelectionConstraints ctx
   -&gt; Const (Address ctx) (SelectionConstraints ctx))
(Address ctx -&gt; Const (Address ctx) (Address ctx))
-&gt; SelectionConstraints ctx
-&gt; Const (Address ctx) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435970"><span class="hs-var">#nullAddress</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-431"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><a href="#local-6989586621682435983"><span class="hs-identifier hs-type">adjustComputeMinimumCost</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>        </span><span id="local-6989586621682435983"><span class="annot"><span class="annottext">adjustComputeMinimumCost :: (SelectionSkeleton ctx -&gt; Coin) -&gt; SelectionSkeleton ctx -&gt; Coin
</span><a href="#local-6989586621682435983"><span class="hs-identifier hs-var hs-var">adjustComputeMinimumCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-436"></span><span>            </span><span class="annot"><span class="annottext">SelectionParams ctx
-&gt; ((SelectionSkeleton ctx -&gt; Coin)
    -&gt; SelectionSkeleton ctx -&gt; Coin)
-&gt; (SelectionSkeleton ctx -&gt; Coin)
-&gt; SelectionSkeleton ctx
-&gt; Coin
forall ctx a. SelectionParams ctx -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#whenCollateralRequired"><span class="hs-identifier hs-var">whenCollateralRequired</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SelectionSkeleton ctx -&gt; Coin)
-&gt; (SelectionSkeleton ctx -&gt; SelectionSkeleton ctx)
-&gt; SelectionSkeleton ctx
-&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionSkeleton ctx -&gt; SelectionSkeleton ctx
</span><a href="#local-6989586621682435967"><span class="hs-identifier hs-var">adjustSelectionSkeleton</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-438"></span><span>            </span><span class="hs-comment">-- When collateral is required, we reserve space for collateral</span><span>
</span><span id="line-439"></span><span>            </span><span class="hs-comment">-- inputs ahead of time by adding the maximum allowed number of</span><span>
</span><span id="line-440"></span><span>            </span><span class="hs-comment">-- collateral inputs (defined by 'maximumCollateralInputCount')</span><span>
</span><span id="line-441"></span><span>            </span><span class="hs-comment">-- to the skeleton input count.</span><span>
</span><span id="line-442"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-443"></span><span>            </span><span class="hs-comment">-- This ensures that the collateral inputs are already paid for</span><span>
</span><span id="line-444"></span><span>            </span><span class="hs-comment">-- when 'Balance.performSelection' is generating change outputs.</span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-comment">-- In many cases, the maximum allowed number of collateral inputs</span><span>
</span><span id="line-447"></span><span>            </span><span class="hs-comment">-- will be greater than the number eventually required, which will</span><span>
</span><span id="line-448"></span><span>            </span><span class="hs-comment">-- lead to a fee that is slightly higher than necessary.</span><span>
</span><span id="line-449"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-450"></span><span>            </span><span class="hs-comment">-- However, since the maximum number of collateral inputs is very</span><span>
</span><span id="line-451"></span><span>            </span><span class="hs-comment">-- small, and since the marginal cost of a single extra input is</span><span>
</span><span id="line-452"></span><span>            </span><span class="hs-comment">-- relatively small, this fee increase is likely to be very small.</span><span>
</span><span id="line-453"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-454"></span><span>            </span><span class="annot"><a href="#local-6989586621682435967"><span class="hs-identifier hs-type">adjustSelectionSkeleton</span></a></span><span>
</span><span id="line-455"></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-456"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span id="local-6989586621682435967"><span class="annot"><span class="annottext">adjustSelectionSkeleton :: SelectionSkeleton ctx -&gt; SelectionSkeleton ctx
</span><a href="#local-6989586621682435967"><span class="hs-identifier hs-var hs-var">adjustSelectionSkeleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Identity Int)
 -&gt; SelectionSkeleton ctx -&gt; Identity (SelectionSkeleton ctx))
-&gt; (Int -&gt; Int) -&gt; SelectionSkeleton ctx -&gt; SelectionSkeleton ctx
forall a b s t.
((a -&gt; Identity b) -&gt; s -&gt; Identity t) -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">over</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;skeletonInputCount&quot;
  ((Int -&gt; Identity Int)
   -&gt; SelectionSkeleton ctx -&gt; Identity (SelectionSkeleton ctx))
(Int -&gt; Identity Int)
-&gt; SelectionSkeleton ctx -&gt; Identity (SelectionSkeleton ctx)
</span><a href="#local-6989586621682435966"><span class="hs-var">#skeletonInputCount</span></a></span><span>
</span><span id="line-458"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Const Int Int)
 -&gt; SelectionConstraints ctx
 -&gt; Const Int (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Int
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumCollateralInputCount&quot;
  ((Int -&gt; Const Int Int)
   -&gt; SelectionConstraints ctx
   -&gt; Const Int (SelectionConstraints ctx))
(Int -&gt; Const Int Int)
-&gt; SelectionConstraints ctx -&gt; Const Int (SelectionConstraints ctx)
</span><a href="#local-6989586621682435964"><span class="hs-var">#maximumCollateralInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span>        </span><span class="annot"><a href="#local-6989586621682435980"><span class="hs-identifier hs-type">adjustComputeSelectionLimit</span></a></span><span>
</span><span id="line-461"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436497"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621682435980"><span class="annot"><span class="annottext">adjustComputeSelectionLimit :: ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
</span><a href="#local-6989586621682435980"><span class="hs-identifier hs-var hs-var">adjustComputeSelectionLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>            </span><span class="annot"><span class="annottext">SelectionParams ctx
-&gt; (([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall ctx a. SelectionParams ctx -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#whenCollateralRequired"><span class="hs-identifier hs-var">whenCollateralRequired</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SelectionLimit -&gt; SelectionLimit)
-&gt; ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; SelectionLimit
</span><a href="#local-6989586621682435963"><span class="hs-identifier hs-var">adjustSelectionLimit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-466"></span><span>            </span><span class="hs-comment">-- When collateral is required, we reserve space for collateral</span><span>
</span><span id="line-467"></span><span>            </span><span class="hs-comment">-- inputs ahead of time by subtracting the maximum allowed number</span><span>
</span><span id="line-468"></span><span>            </span><span class="hs-comment">-- of collateral inputs (defined by 'maximumCollateralInputCount')</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-comment">-- from the selection limit.</span><span>
</span><span id="line-470"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-471"></span><span>            </span><span class="hs-comment">-- This ensures that when we come to perform collateral selection,</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-comment">-- there is still space available.</span><span>
</span><span id="line-473"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-474"></span><span>            </span><span class="annot"><a href="#local-6989586621682435963"><span class="hs-identifier hs-type">adjustSelectionLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-475"></span><span>            </span><span id="local-6989586621682435963"><span class="annot"><span class="annottext">adjustSelectionLimit :: SelectionLimit -&gt; SelectionLimit
</span><a href="#local-6989586621682435963"><span class="hs-identifier hs-var hs-var">adjustSelectionLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SelectionLimit -&gt; Int -&gt; SelectionLimit)
-&gt; Int -&gt; SelectionLimit -&gt; SelectionLimit
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; Int -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#reduceSelectionLimitBy"><span class="hs-identifier hs-var">Balance.reduceSelectionLimitBy</span></a></span><span>
</span><span id="line-476"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int -&gt; Const Int Int)
 -&gt; SelectionConstraints ctx
 -&gt; Const Int (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Int
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumCollateralInputCount&quot;
  ((Int -&gt; Const Int Int)
   -&gt; SelectionConstraints ctx
   -&gt; Const Int (SelectionConstraints ctx))
(Int -&gt; Const Int Int)
-&gt; SelectionConstraints ctx -&gt; Const Int (SelectionConstraints ctx)
</span><a href="#local-6989586621682435960"><span class="hs-var">#maximumCollateralInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621682435989"><span class="annot"><span class="annottext">balanceParams :: SelectionParams ctx
</span><a href="#local-6989586621682435989"><span class="hs-identifier hs-var hs-var">balanceParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionParams :: forall (f :: * -&gt; *) ctx.
f (Address ctx, TokenBundle)
-&gt; UTxOSelection (UTxO ctx)
-&gt; Coin
-&gt; Coin
-&gt; TokenMap
-&gt; TokenMap
-&gt; SelectionStrategy
-&gt; SelectionParamsOf f ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionParams"><span class="hs-identifier hs-type">Balance.SelectionParams</span></a></span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToBurn:SelectionParams :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AassetsToBurn%3ASelectionParams"><span class="hs-identifier hs-var">assetsToBurn</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>            </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToBurn&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx)
</span><a href="#local-6989586621682435957"><span class="hs-var">#assetsToBurn</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToMint:SelectionParams :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AassetsToMint%3ASelectionParams"><span class="hs-identifier hs-var">assetsToMint</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-482"></span><span>            </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToMint&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; SelectionParams ctx -&gt; Const TokenMap (SelectionParams ctx)
</span><a href="#local-6989586621682435955"><span class="hs-var">#assetsToMint</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-483"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSource:SelectionParams :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AextraCoinSource%3ASelectionParams"><span class="hs-identifier hs-var">extraCoinSource</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-484"></span><span>            </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;rewardWithdrawal&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx)
</span><a href="#local-6989586621682435953"><span class="hs-var">#rewardWithdrawal</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinIn&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx)
</span><a href="#local-6989586621682435952"><span class="hs-var">#extraCoinIn</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-485"></span><span>            </span><span class="annot"><span class="annottext">Natural -&gt; Coin -&gt; Coin
forall b a. (Integral b, Monoid a) =&gt; b -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mtimesDefault</span></a></span><span>
</span><span id="line-486"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Natural -&gt; Const Natural Natural)
 -&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Natural
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;certificateDepositsReturned&quot;
  ((Natural -&gt; Const Natural Natural)
   -&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx))
(Natural -&gt; Const Natural Natural)
-&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx)
</span><a href="#local-6989586621682435951"><span class="hs-var">#certificateDepositsReturned</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionConstraints ctx
 -&gt; Const Coin (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;certificateDepositAmount&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionConstraints ctx
   -&gt; Const Coin (SelectionConstraints ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionConstraints ctx
-&gt; Const Coin (SelectionConstraints ctx)
</span><a href="#local-6989586621682435950"><span class="hs-var">#certificateDepositAmount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSink:SelectionParams :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AextraCoinSink%3ASelectionParams"><span class="hs-identifier hs-var">extraCoinSink</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinOut&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionParams ctx -&gt; Const Coin (SelectionParams ctx)
</span><a href="#local-6989586621682435948"><span class="hs-var">#extraCoinOut</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Coin
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span>
</span><span id="line-489"></span><span>            </span><span class="annot"><span class="annottext">Natural -&gt; Coin -&gt; Coin
forall b a. (Integral b, Monoid a) =&gt; b -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mtimesDefault</span></a></span><span>
</span><span id="line-490"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Natural -&gt; Const Natural Natural)
 -&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Natural
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;certificateDepositsTaken&quot;
  ((Natural -&gt; Const Natural Natural)
   -&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx))
(Natural -&gt; Const Natural Natural)
-&gt; SelectionParams ctx -&gt; Const Natural (SelectionParams ctx)
</span><a href="#local-6989586621682435947"><span class="hs-var">#certificateDepositsTaken</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionConstraints ctx
 -&gt; Const Coin (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;certificateDepositAmount&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionConstraints ctx
   -&gt; Const Coin (SelectionConstraints ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionConstraints ctx
-&gt; Const Coin (SelectionConstraints ctx)
</span><a href="#local-6989586621682435946"><span class="hs-var">#certificateDepositAmount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435992"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:outputsToCover:SelectionParams :: [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AoutputsToCover%3ASelectionParams"><span class="hs-identifier hs-var">outputsToCover</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-493"></span><span>            </span><span class="annot"><span class="annottext">(([(Address ctx, TokenBundle)]
  -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
 -&gt; SelectionParams ctx
 -&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; [(Address ctx, TokenBundle)]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputsToCover&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; SelectionParams ctx
   -&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; SelectionParams ctx
-&gt; Const [(Address ctx, TokenBundle)] (SelectionParams ctx)
</span><a href="#local-6989586621682435944"><span class="hs-var">#outputsToCover</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:utxoAvailable:SelectionParams :: UTxOSelection (UTxO ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AutxoAvailable%3ASelectionParams"><span class="hs-identifier hs-var">utxoAvailable</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-495"></span><span>            </span><span class="annot"><span class="annottext">((UTxOSelection (UTxO ctx)
  -&gt; Const (UTxOSelection (UTxO ctx)) (UTxOSelection (UTxO ctx)))
 -&gt; SelectionParams ctx
 -&gt; Const (UTxOSelection (UTxO ctx)) (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; UTxOSelection (UTxO ctx)
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoAvailableForInputs&quot;
  ((UTxOSelection (UTxO ctx)
    -&gt; Const (UTxOSelection (UTxO ctx)) (UTxOSelection (UTxO ctx)))
   -&gt; SelectionParams ctx
   -&gt; Const (UTxOSelection (UTxO ctx)) (SelectionParams ctx))
(UTxOSelection (UTxO ctx)
 -&gt; Const (UTxOSelection (UTxO ctx)) (UTxOSelection (UTxO ctx)))
-&gt; SelectionParams ctx
-&gt; Const (UTxOSelection (UTxO ctx)) (SelectionParams ctx)
</span><a href="#local-6989586621682435942"><span class="hs-var">#utxoAvailableForInputs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:selectionStrategy:SelectionParams :: SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AselectionStrategy%3ASelectionParams"><span class="hs-identifier hs-var">selectionStrategy</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-497"></span><span>            </span><span class="annot"><span class="annottext">((SelectionStrategy -&gt; Const SelectionStrategy SelectionStrategy)
 -&gt; SelectionParams ctx
 -&gt; Const SelectionStrategy (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; SelectionStrategy
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;selectionStrategy&quot;
  ((SelectionStrategy -&gt; Const SelectionStrategy SelectionStrategy)
   -&gt; SelectionParams ctx
   -&gt; Const SelectionStrategy (SelectionParams ctx))
(SelectionStrategy -&gt; Const SelectionStrategy SelectionStrategy)
-&gt; SelectionParams ctx
-&gt; Const SelectionStrategy (SelectionParams ctx)
</span><a href="#local-6989586621682435940"><span class="hs-var">#selectionStrategy</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435991"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-498"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- | Creates constraints and parameters for 'Collateral.performSelection'.</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span id="local-6989586621682436486"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#toCollateralConstraintsParams"><span class="hs-identifier hs-type">toCollateralConstraintsParams</span></a></span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436486"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436486"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-505"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436486"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-506"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionConstraints"><span class="hs-identifier hs-type">Collateral.SelectionConstraints</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionParams"><span class="hs-identifier hs-type">Collateral.SelectionParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436486"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-special">)</span></span><span>
</span><span id="line-510"></span><span id="toCollateralConstraintsParams"><span class="annot"><span class="annottext">toCollateralConstraintsParams :: SelectionResult ctx
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toCollateralConstraintsParams"><span class="hs-identifier hs-var hs-var">toCollateralConstraintsParams</span></a></span></span><span> </span><span id="local-6989586621682435939"><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435939"><span class="hs-identifier hs-var">balanceResult</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435938"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435938"><span class="hs-identifier hs-var">constraints</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435937"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435937"><span class="hs-identifier hs-var">params</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints
</span><a href="#local-6989586621682435936"><span class="hs-identifier hs-var">collateralConstraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams (UTxO ctx)
</span><a href="#local-6989586621682435935"><span class="hs-identifier hs-var">collateralParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-513"></span><span>    </span><span id="local-6989586621682435936"><span class="annot"><span class="annottext">collateralConstraints :: SelectionConstraints
</span><a href="#local-6989586621682435936"><span class="hs-identifier hs-var hs-var">collateralConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints :: Int -&gt; SearchSpaceLimit -&gt; SelectionConstraints
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionConstraints"><span class="hs-identifier hs-type">Collateral.SelectionConstraints</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:maximumSelectionSize:SelectionConstraints :: Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#%24sel%3AmaximumSelectionSize%3ASelectionConstraints"><span class="hs-identifier hs-var">maximumSelectionSize</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>            </span><span class="annot"><span class="annottext">((Int -&gt; Const Int Int)
 -&gt; SelectionConstraints ctx
 -&gt; Const Int (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Int
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumCollateralInputCount&quot;
  ((Int -&gt; Const Int Int)
   -&gt; SelectionConstraints ctx
   -&gt; Const Int (SelectionConstraints ctx))
(Int -&gt; Const Int Int)
-&gt; SelectionConstraints ctx -&gt; Const Int (SelectionConstraints ctx)
</span><a href="#local-6989586621682435932"><span class="hs-var">#maximumCollateralInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435938"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:searchSpaceLimit:SelectionConstraints :: SearchSpaceLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#%24sel%3AsearchSpaceLimit%3ASelectionConstraints"><span class="hs-identifier hs-var">searchSpaceLimit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>            </span><span class="hs-comment">-- We use the default search space limit here, as this value is</span><span>
</span><span id="line-518"></span><span>            </span><span class="hs-comment">-- used in the test suite for 'Collateral.performSelection'. We</span><span>
</span><span id="line-519"></span><span>            </span><span class="hs-comment">-- can therefore be reasonably confident that the process of</span><span>
</span><span id="line-520"></span><span>            </span><span class="hs-comment">-- selecting collateral will not use inordinate amounts of time</span><span>
</span><span id="line-521"></span><span>            </span><span class="hs-comment">-- and space:</span><span>
</span><span id="line-522"></span><span>            </span><span class="annot"><span class="annottext">SearchSpaceLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#searchSpaceLimitDefault"><span class="hs-identifier hs-var">Collateral.searchSpaceLimitDefault</span></a></span><span>
</span><span id="line-523"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-524"></span><span>    </span><span id="local-6989586621682435935"><span class="annot"><span class="annottext">collateralParams :: SelectionParams (UTxO ctx)
</span><a href="#local-6989586621682435935"><span class="hs-identifier hs-var hs-var">collateralParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionParams :: forall u. Map u Coin -&gt; Coin -&gt; SelectionParams u
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionParams"><span class="hs-identifier hs-type">Collateral.SelectionParams</span></a></span><span>
</span><span id="line-525"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:coinsAvailable:SelectionParams :: Map (UTxO ctx) Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#%24sel%3AcoinsAvailable%3ASelectionParams"><span class="hs-identifier hs-var">coinsAvailable</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>            </span><span class="annot"><span class="annottext">((Map (UTxO ctx) Coin
  -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
 -&gt; SelectionParams ctx
 -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Map (UTxO ctx) Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoAvailableForCollateral&quot;
  ((Map (UTxO ctx) Coin
    -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
   -&gt; SelectionParams ctx
   -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
(Map (UTxO ctx) Coin
 -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
-&gt; SelectionParams ctx
-&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx)
</span><a href="#local-6989586621682435927"><span class="hs-var">#utxoAvailableForCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435937"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-527"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:minimumSelectionAmount:SelectionParams :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#%24sel%3AminimumSelectionAmount%3ASelectionParams"><span class="hs-identifier hs-var">minimumSelectionAmount</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>            </span><span class="annot"><span class="annottext">ComputeMinimumCollateralParams -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#computeMinimumCollateral"><span class="hs-identifier hs-var">computeMinimumCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">ComputeMinimumCollateralParams :: Natural -&gt; Coin -&gt; ComputeMinimumCollateralParams
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#ComputeMinimumCollateralParams"><span class="hs-identifier hs-type">ComputeMinimumCollateralParams</span></a></span><span>
</span><span id="line-529"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:minimumCollateralPercentage:ComputeMinimumCollateralParams :: Natural
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumCollateralPercentage%3AComputeMinimumCollateralParams"><span class="hs-identifier hs-var">minimumCollateralPercentage</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>                    </span><span class="annot"><span class="annottext">((Natural -&gt; Const Natural Natural)
 -&gt; SelectionConstraints ctx
 -&gt; Const Natural (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx -&gt; Natural
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;minimumCollateralPercentage&quot;
  ((Natural -&gt; Const Natural Natural)
   -&gt; SelectionConstraints ctx
   -&gt; Const Natural (SelectionConstraints ctx))
(Natural -&gt; Const Natural Natural)
-&gt; SelectionConstraints ctx
-&gt; Const Natural (SelectionConstraints ctx)
</span><a href="#local-6989586621682435923"><span class="hs-var">#minimumCollateralPercentage</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435938"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-531"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:transactionFee:ComputeMinimumCollateralParams :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AtransactionFee%3AComputeMinimumCollateralParams"><span class="hs-identifier hs-var">transactionFee</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-532"></span><span>                    </span><span class="annot"><span class="annottext">SelectionResult ctx -&gt; Coin
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionResultOf f ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionSurplusCoin"><span class="hs-identifier hs-var">Balance.selectionSurplusCoin</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435939"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-533"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-534"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | Creates a 'Selection' from selections of inputs and collateral.</span><span>
</span><span id="line-537"></span><span class="hs-comment">--</span><span>
</span><span id="line-538"></span><span id="local-6989586621682436527"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#mkSelection"><span class="hs-identifier hs-type">mkSelection</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436527"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436527"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Collateral.html#SelectionResult"><span class="hs-identifier hs-type">Collateral.SelectionResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436527"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436527"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-543"></span><span id="mkSelection"><span class="annot"><span class="annottext">mkSelection :: SelectionParams ctx
-&gt; SelectionResult ctx
-&gt; SelectionResult (UTxO ctx)
-&gt; Selection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#mkSelection"><span class="hs-identifier hs-var hs-var">mkSelection</span></a></span></span><span> </span><span id="local-6989586621682435920"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435920"><span class="hs-identifier hs-var">_params</span></a></span></span><span> </span><span id="local-6989586621682435919"><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span></span><span> </span><span id="local-6989586621682435918"><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
</span><a href="#local-6989586621682435918"><span class="hs-identifier hs-var">collateralResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Selection :: forall ctx.
NonEmpty (UTxO ctx, TokenBundle)
-&gt; [(UTxO ctx, Coin)]
-&gt; [(Address ctx, TokenBundle)]
-&gt; [TokenBundle]
-&gt; TokenMap
-&gt; TokenMap
-&gt; Coin
-&gt; Coin
-&gt; Selection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:inputs:Selection :: NonEmpty (UTxO ctx, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Ainputs%3ASelection"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NonEmpty (UTxO ctx, TokenBundle)
  -&gt; Const
       (NonEmpty (UTxO ctx, TokenBundle))
       (NonEmpty (UTxO ctx, TokenBundle)))
 -&gt; SelectionResult ctx
 -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; NonEmpty (UTxO ctx, TokenBundle)
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;inputsSelected&quot;
  ((NonEmpty (UTxO ctx, TokenBundle)
    -&gt; Const
         (NonEmpty (UTxO ctx, TokenBundle))
         (NonEmpty (UTxO ctx, TokenBundle)))
   -&gt; SelectionResult ctx
   -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (SelectionResult ctx))
(NonEmpty (UTxO ctx, TokenBundle)
 -&gt; Const
      (NonEmpty (UTxO ctx, TokenBundle))
      (NonEmpty (UTxO ctx, TokenBundle)))
-&gt; SelectionResult ctx
-&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (SelectionResult ctx)
</span><a href="#local-6989586621682435917"><span class="hs-var">#inputsSelected</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:collateral:Selection :: [(UTxO ctx, Coin)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Acollateral%3ASelection"><span class="hs-identifier hs-var">collateral</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; [(UTxO ctx, Coin)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (UTxO ctx) Coin -&gt; [(UTxO ctx, Coin)])
-&gt; Map (UTxO ctx) Coin -&gt; [(UTxO ctx, Coin)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((Map (UTxO ctx) Coin
  -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
 -&gt; SelectionResult (UTxO ctx)
 -&gt; Const (Map (UTxO ctx) Coin) (SelectionResult (UTxO ctx)))
-&gt; SelectionResult (UTxO ctx) -&gt; Map (UTxO ctx) Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;coinsSelected&quot;
  ((Map (UTxO ctx) Coin
    -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
   -&gt; SelectionResult (UTxO ctx)
   -&gt; Const (Map (UTxO ctx) Coin) (SelectionResult (UTxO ctx)))
(Map (UTxO ctx) Coin
 -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
-&gt; SelectionResult (UTxO ctx)
-&gt; Const (Map (UTxO ctx) Coin) (SelectionResult (UTxO ctx))
</span><a href="#local-6989586621682435915"><span class="hs-var">#coinsSelected</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult (UTxO ctx)
</span><a href="#local-6989586621682435918"><span class="hs-identifier hs-var">collateralResult</span></a></span><span>
</span><span id="line-546"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:outputs:Selection :: [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aoutputs%3ASelection"><span class="hs-identifier hs-var">outputs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([(Address ctx, TokenBundle)]
  -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
 -&gt; SelectionResult ctx
 -&gt; Const [(Address ctx, TokenBundle)] (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; [(Address ctx, TokenBundle)]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputsCovered&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; SelectionResult ctx
   -&gt; Const [(Address ctx, TokenBundle)] (SelectionResult ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; SelectionResult ctx
-&gt; Const [(Address ctx, TokenBundle)] (SelectionResult ctx)
</span><a href="#local-6989586621682435914"><span class="hs-var">#outputsCovered</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-547"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:change:Selection :: [TokenBundle]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Achange%3ASelection"><span class="hs-identifier hs-var">change</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
 -&gt; SelectionResult ctx
 -&gt; Const [TokenBundle] (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; [TokenBundle]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;changeGenerated&quot;
  (([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
   -&gt; SelectionResult ctx
   -&gt; Const [TokenBundle] (SelectionResult ctx))
([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
-&gt; SelectionResult ctx -&gt; Const [TokenBundle] (SelectionResult ctx)
</span><a href="#local-6989586621682435913"><span class="hs-var">#changeGenerated</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToMint:Selection :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToMint%3ASelection"><span class="hs-identifier hs-var">assetsToMint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToMint&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx)
</span><a href="#local-6989586621682435912"><span class="hs-var">#assetsToMint</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToBurn:Selection :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AassetsToBurn%3ASelection"><span class="hs-identifier hs-var">assetsToBurn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToBurn&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; SelectionResult ctx -&gt; Const TokenMap (SelectionResult ctx)
</span><a href="#local-6989586621682435911"><span class="hs-var">#assetsToBurn</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSource:Selection :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinSource%3ASelection"><span class="hs-identifier hs-var">extraCoinSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinSource&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx)
</span><a href="#local-6989586621682435910"><span class="hs-var">#extraCoinSource</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSink:Selection :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AextraCoinSink%3ASelection"><span class="hs-identifier hs-var">extraCoinSink</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx))
-&gt; SelectionResult ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinSink&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionResult ctx -&gt; Const Coin (SelectionResult ctx)
</span><a href="#local-6989586621682435909"><span class="hs-var">#extraCoinSink</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionResult ctx
</span><a href="#local-6989586621682435919"><span class="hs-identifier hs-var">balanceResult</span></a></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-comment">-- | Converts a 'Selection' to a balance result.</span><span>
</span><span id="line-555"></span><span class="hs-comment">--</span><span>
</span><span id="line-556"></span><span id="local-6989586621682436238"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-type">toBalanceResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436238"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436238"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-557"></span><span id="toBalanceResult"><span class="annot"><span class="annottext">toBalanceResult :: Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var hs-var">toBalanceResult</span></a></span></span><span> </span><span id="local-6989586621682435907"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionResult :: forall (f :: * -&gt; *) ctx.
NonEmpty (UTxO ctx, TokenBundle)
-&gt; Coin
-&gt; Coin
-&gt; f (Address ctx, TokenBundle)
-&gt; [TokenBundle]
-&gt; TokenMap
-&gt; TokenMap
-&gt; SelectionResultOf f ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionResult"><span class="hs-identifier hs-type">Balance.SelectionResult</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:inputsSelected:SelectionResult :: NonEmpty (UTxO ctx, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AinputsSelected%3ASelectionResult"><span class="hs-identifier hs-var">inputsSelected</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((NonEmpty (UTxO ctx, TokenBundle)
  -&gt; Const
       (NonEmpty (UTxO ctx, TokenBundle))
       (NonEmpty (UTxO ctx, TokenBundle)))
 -&gt; Selection ctx
 -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx))
-&gt; Selection ctx -&gt; NonEmpty (UTxO ctx, TokenBundle)
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;inputs&quot;
  ((NonEmpty (UTxO ctx, TokenBundle)
    -&gt; Const
         (NonEmpty (UTxO ctx, TokenBundle))
         (NonEmpty (UTxO ctx, TokenBundle)))
   -&gt; Selection ctx
   -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx))
(NonEmpty (UTxO ctx, TokenBundle)
 -&gt; Const
      (NonEmpty (UTxO ctx, TokenBundle))
      (NonEmpty (UTxO ctx, TokenBundle)))
-&gt; Selection ctx
-&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx)
</span><a href="#local-6989586621682435904"><span class="hs-var">#inputs</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:outputsCovered:SelectionResult :: [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AoutputsCovered%3ASelectionResult"><span class="hs-identifier hs-var">outputsCovered</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([(Address ctx, TokenBundle)]
  -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
 -&gt; Selection ctx
 -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputs&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; Selection ctx
   -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; Selection ctx
-&gt; Const [(Address ctx, TokenBundle)] (Selection ctx)
</span><a href="#local-6989586621682435902"><span class="hs-var">#outputs</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:changeGenerated:SelectionResult :: [TokenBundle]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AchangeGenerated%3ASelectionResult"><span class="hs-identifier hs-var">changeGenerated</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
 -&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx))
-&gt; Selection ctx -&gt; [TokenBundle]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;change&quot;
  (([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
   -&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx))
([TokenBundle] -&gt; Const [TokenBundle] [TokenBundle])
-&gt; Selection ctx -&gt; Const [TokenBundle] (Selection ctx)
</span><a href="#local-6989586621682435900"><span class="hs-var">#change</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-561"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToMint:SelectionResult :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AassetsToMint%3ASelectionResult"><span class="hs-identifier hs-var">assetsToMint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; Selection ctx -&gt; Const TokenMap (Selection ctx))
-&gt; Selection ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToMint&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; Selection ctx -&gt; Const TokenMap (Selection ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; Selection ctx -&gt; Const TokenMap (Selection ctx)
</span><a href="#local-6989586621682435898"><span class="hs-var">#assetsToMint</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:assetsToBurn:SelectionResult :: TokenMap
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AassetsToBurn%3ASelectionResult"><span class="hs-identifier hs-var">assetsToBurn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; Selection ctx -&gt; Const TokenMap (Selection ctx))
-&gt; Selection ctx -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assetsToBurn&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; Selection ctx -&gt; Const TokenMap (Selection ctx))
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; Selection ctx -&gt; Const TokenMap (Selection ctx)
</span><a href="#local-6989586621682435896"><span class="hs-var">#assetsToBurn</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSource:SelectionResult :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AextraCoinSource%3ASelectionResult"><span class="hs-identifier hs-var">extraCoinSource</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; Selection ctx -&gt; Const Coin (Selection ctx))
-&gt; Selection ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinSource&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; Selection ctx -&gt; Const Coin (Selection ctx))
(Coin -&gt; Const Coin Coin)
-&gt; Selection ctx -&gt; Const Coin (Selection ctx)
</span><a href="#local-6989586621682435894"><span class="hs-var">#extraCoinSource</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:extraCoinSink:SelectionResult :: Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#%24sel%3AextraCoinSink%3ASelectionResult"><span class="hs-identifier hs-var">extraCoinSink</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; Selection ctx -&gt; Const Coin (Selection ctx))
-&gt; Selection ctx -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;extraCoinSink&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; Selection ctx -&gt; Const Coin (Selection ctx))
(Coin -&gt; Const Coin Coin)
-&gt; Selection ctx -&gt; Const Coin (Selection ctx)
</span><a href="#local-6989586621682435892"><span class="hs-var">#extraCoinSink</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435907"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- Verification of post conditions</span><span>
</span><span id="line-569"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="hs-comment">-- | The result of verifying a post condition.</span><span>
</span><span id="line-572"></span><span class="hs-comment">--</span><span>
</span><span id="line-573"></span><span class="hs-keyword">data</span><span> </span><span id="VerificationResult"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-var">VerificationResult</span></a></span></span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="VerificationSuccess"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span></span><span>
</span><span id="line-575"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="VerificationFailure"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailure"><span class="hs-identifier hs-var">VerificationFailure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-type">VerificationFailureReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621682435884"><span id="local-6989586621682435886"><span id="local-6989586621682435888"><span class="annot"><span class="annottext">Int -&gt; VerificationResult -&gt; ShowS
[VerificationResult] -&gt; ShowS
VerificationResult -&gt; String
(Int -&gt; VerificationResult -&gt; ShowS)
-&gt; (VerificationResult -&gt; String)
-&gt; ([VerificationResult] -&gt; ShowS)
-&gt; Show VerificationResult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [VerificationResult] -&gt; ShowS
$cshowList :: [VerificationResult] -&gt; ShowS
show :: VerificationResult -&gt; String
$cshow :: VerificationResult -&gt; String
showsPrec :: Int -&gt; VerificationResult -&gt; ShowS
$cshowsPrec :: Int -&gt; VerificationResult -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="hs-comment">-- | Represents a reason for verification failure.</span><span>
</span><span id="line-579"></span><span class="hs-comment">--</span><span>
</span><span id="line-580"></span><span class="hs-keyword">data</span><span> </span><span id="VerificationFailureReason"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-var">VerificationFailureReason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436429"><span class="annot"><a href="#local-6989586621682436429"><span class="hs-identifier hs-type">failureReason</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436429"><span class="hs-identifier hs-type">failureReason</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-582"></span><span>    </span><span id="VerificationFailureReason"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-var">VerificationFailureReason</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682436429"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-583"></span><span id="local-6989586621682435877"><span id="local-6989586621682435879"><span id="local-6989586621682435881"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-type">VerificationFailureReason</span></a></span></span></span></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682435874"><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621682435873"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435873"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621682435872"><span class="annot"><span class="annottext">== :: VerificationResult -&gt; VerificationResult -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621682435871"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435871"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerificationResult -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435873"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435871"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682435864"><span id="local-6989586621682435866"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621682435862"><span class="annot"><span class="annottext">mempty :: VerificationResult
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span>
</span><span id="line-590"></span><span>
</span><span id="line-591"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682435857"><span id="local-6989586621682435859"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-592"></span><span>    </span><span id="local-6989586621682435855"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435855"><span class="hs-identifier hs-var">r1</span></a></span></span><span> </span><span id="local-6989586621682435854"><span class="annot"><span class="annottext">&lt;&gt; :: VerificationResult -&gt; VerificationResult -&gt; VerificationResult
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span id="local-6989586621682435853"><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435853"><span class="hs-identifier hs-var">r2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VerificationFailureReason] -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultFromFailureReasons"><span class="hs-identifier hs-var">verificationResultFromFailureReasons</span></a></span><span> </span><span class="annot"><span class="annottext">([VerificationFailureReason] -&gt; VerificationResult)
-&gt; [VerificationFailureReason] -&gt; VerificationResult
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[VerificationFailureReason]
-&gt; [VerificationFailureReason] -&gt; [VerificationFailureReason]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span>
</span><span id="line-593"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerificationResult -&gt; [VerificationFailureReason]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultToFailureReasons"><span class="hs-identifier hs-var">verificationResultToFailureReasons</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435855"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerificationResult -&gt; [VerificationFailureReason]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultToFailureReasons"><span class="hs-identifier hs-var">verificationResultToFailureReasons</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="#local-6989586621682435853"><span class="hs-identifier hs-var">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="hs-comment">-- | Constructs a singleton verification failure.</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationFailure"><span class="hs-identifier hs-type">verificationFailure</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436421"><span class="annot"><a href="#local-6989586621682436421"><span class="hs-identifier hs-type">failureReason</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436421"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436421"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-602"></span><span id="verificationFailure"><span class="annot"><span class="annottext">verificationFailure :: failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationFailure"><span class="hs-identifier hs-var hs-var">verificationFailure</span></a></span></span><span> </span><span id="local-6989586621682435849"><span class="annot"><span class="annottext">failureReason
</span><a href="#local-6989586621682435849"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty VerificationFailureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailure"><span class="hs-identifier hs-var">VerificationFailure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">failureReason -&gt; VerificationFailureReason
forall failureReason.
Show failureReason =&gt;
failureReason -&gt; VerificationFailureReason
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-var">VerificationFailureReason</span></a></span><span> </span><span class="annot"><span class="annottext">failureReason
</span><a href="#local-6989586621682435849"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationFailureReason
-&gt; [VerificationFailureReason]
-&gt; NonEmpty VerificationFailureReason
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">:|</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>
</span><span id="line-604"></span><span class="hs-comment">-- | Constructs a 'VerificationResult' from a list of failure reasons.</span><span>
</span><span id="line-605"></span><span class="hs-comment">--</span><span>
</span><span id="line-606"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultFromFailureReasons"><span class="hs-identifier hs-type">verificationResultFromFailureReasons</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-type">VerificationFailureReason</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-608"></span><span id="verificationResultFromFailureReasons"><span class="annot"><span class="annottext">verificationResultFromFailureReasons :: [VerificationFailureReason] -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultFromFailureReasons"><span class="hs-identifier hs-var hs-var">verificationResultFromFailureReasons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult
-&gt; (NonEmpty VerificationFailureReason -&gt; VerificationResult)
-&gt; Maybe (NonEmpty VerificationFailureReason)
-&gt; VerificationResult
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty VerificationFailureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailure"><span class="hs-identifier hs-var">VerificationFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (NonEmpty VerificationFailureReason) -&gt; VerificationResult)
-&gt; ([VerificationFailureReason]
    -&gt; Maybe (NonEmpty VerificationFailureReason))
-&gt; [VerificationFailureReason]
-&gt; VerificationResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[VerificationFailureReason]
-&gt; Maybe (NonEmpty VerificationFailureReason)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- | Deconstructs a 'VerificationResult' into a list of failure reasons.</span><span>
</span><span id="line-612"></span><span class="hs-comment">--</span><span>
</span><span id="line-613"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultToFailureReasons"><span class="hs-identifier hs-type">verificationResultToFailureReasons</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailureReason"><span class="hs-identifier hs-type">VerificationFailureReason</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-615"></span><span id="verificationResultToFailureReasons"><span class="annot"><span class="annottext">verificationResultToFailureReasons :: VerificationResult -&gt; [VerificationFailureReason]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationResultToFailureReasons"><span class="hs-identifier hs-var hs-var">verificationResultToFailureReasons</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationFailure"><span class="hs-identifier hs-type">VerificationFailure</span></a></span><span> </span><span id="local-6989586621682435845"><span class="annot"><span class="annottext">NonEmpty VerificationFailureReason
</span><a href="#local-6989586621682435845"><span class="hs-identifier hs-var">reasons</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty VerificationFailureReason -&gt; [VerificationFailureReason]
forall a. NonEmpty a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.toList</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty VerificationFailureReason
</span><a href="#local-6989586621682435845"><span class="hs-identifier hs-var">reasons</span></a></span><span>
</span><span id="line-618"></span><span>
</span><span id="line-619"></span><span class="hs-comment">-- | Verifies the given condition.</span><span>
</span><span id="line-620"></span><span class="hs-comment">--</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- If the given condition is 'True', returns 'VerificationSuccess'.</span><span>
</span><span id="line-622"></span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- Otherwise, returns 'VerificationFailure' with the given reason.</span><span>
</span><span id="line-624"></span><span class="hs-comment">--</span><span>
</span><span id="line-625"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436418"><span class="annot"><a href="#local-6989586621682436418"><span class="hs-identifier hs-type">failureReason</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436418"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436418"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-630"></span><span id="verify"><span class="annot"><span class="annottext">verify :: Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span id="local-6989586621682435842"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435842"><span class="hs-identifier hs-var">condition</span></a></span></span><span> </span><span id="local-6989586621682435841"><span class="annot"><span class="annottext">failureReason
</span><a href="#local-6989586621682435841"><span class="hs-identifier hs-var">failureReason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-631"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435842"><span class="hs-identifier hs-var">condition</span></a></span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">failureReason -&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationFailure"><span class="hs-identifier hs-var">verificationFailure</span></a></span><span> </span><span class="annot"><span class="annottext">failureReason
</span><a href="#local-6989586621682435841"><span class="hs-identifier hs-var">failureReason</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- | Verifies all of the given conditions.</span><span>
</span><span id="line-636"></span><span class="hs-comment">--</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- If the given conditions are all 'True', returns 'VerificationSuccess'.</span><span>
</span><span id="line-638"></span><span class="hs-comment">--</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- Otherwise, returns 'VerificationFailure' with the given reason.</span><span>
</span><span id="line-640"></span><span class="hs-comment">--</span><span>
</span><span id="line-641"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyAll"><span class="hs-identifier hs-type">verifyAll</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436324"><span class="annot"><a href="#local-6989586621682436324"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621682436323"><span class="annot"><a href="#local-6989586621682436323"><span class="hs-identifier hs-type">failureReason</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436324"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436323"><span class="hs-identifier hs-type">failureReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436324"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-644"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436323"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-646"></span><span id="verifyAll"><span class="annot"><span class="annottext">verifyAll :: f Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyAll"><span class="hs-identifier hs-var hs-var">verifyAll</span></a></span></span><span> </span><span id="local-6989586621682435839"><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621682435839"><span class="hs-identifier hs-var">conditions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; failureReason -&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">All -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">getAll</span></a></span><span> </span><span class="annot"><span class="annottext">(All -&gt; Bool) -&gt; All -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; f Bool -&gt; All
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">f Bool
</span><a href="#local-6989586621682435839"><span class="hs-identifier hs-var">conditions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span class="hs-comment">-- | Verifies that the given list is empty.</span><span>
</span><span id="line-649"></span><span class="hs-comment">--</span><span>
</span><span id="line-650"></span><span class="hs-comment">-- If the given list is empty, returns 'VerificationSuccess'.</span><span>
</span><span id="line-651"></span><span class="hs-comment">--</span><span>
</span><span id="line-652"></span><span class="hs-comment">-- Otherwise, returns 'VerificationFailure', with given reason constructor</span><span>
</span><span id="line-653"></span><span class="hs-comment">-- applied to the non-empty list.</span><span>
</span><span id="line-654"></span><span class="hs-comment">--</span><span>
</span><span id="line-655"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmpty"><span class="hs-identifier hs-type">verifyEmpty</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436367"><span class="annot"><a href="#local-6989586621682436367"><span class="hs-identifier hs-type">failureReason</span></a></span></span><span> </span><span id="local-6989586621682436366"><span class="annot"><a href="#local-6989586621682436366"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436367"><span class="hs-identifier hs-type">failureReason</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621682436366"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436366"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436367"><span class="hs-identifier hs-type">failureReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-660"></span><span id="verifyEmpty"><span class="annot"><span class="annottext">verifyEmpty :: [a] -&gt; (NonEmpty a -&gt; failureReason) -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmpty"><span class="hs-identifier hs-var hs-var">verifyEmpty</span></a></span></span><span> </span><span id="local-6989586621682435834"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682435834"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621682435833"><span class="annot"><span class="annottext">NonEmpty a -&gt; failureReason
</span><a href="#local-6989586621682435833"><span class="hs-identifier hs-var">failureReason</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-661"></span><span>    </span><span class="annot"><span class="annottext">VerificationResult
-&gt; (NonEmpty a -&gt; VerificationResult)
-&gt; Maybe (NonEmpty a)
-&gt; VerificationResult
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-662"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">failureReason -&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationFailure"><span class="hs-identifier hs-var">verificationFailure</span></a></span><span> </span><span class="annot"><span class="annottext">(failureReason -&gt; VerificationResult)
-&gt; (NonEmpty a -&gt; failureReason)
-&gt; NonEmpty a
-&gt; VerificationResult
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty a -&gt; failureReason
</span><a href="#local-6989586621682435833"><span class="hs-identifier hs-var">failureReason</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-664"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Maybe (NonEmpty a)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.nonEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621682435834"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- Selection verification</span><span>
</span><span id="line-668"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-669"></span><span>
</span><span id="line-670"></span><span class="hs-comment">-- | The type of all 'Selection' verification functions.</span><span>
</span><span id="line-671"></span><span class="hs-comment">--</span><span>
</span><span id="line-672"></span><span class="hs-keyword">type</span><span> </span><span id="VerifySelection"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-var">VerifySelection</span></a></span></span><span> </span><span id="local-6989586621682435832"><span class="annot"><a href="#local-6989586621682435832"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435832"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435832"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435832"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-677"></span><span>
</span><span id="line-678"></span><span class="hs-comment">-- | Verifies a 'Selection' for correctness.</span><span>
</span><span id="line-679"></span><span class="hs-comment">--</span><span>
</span><span id="line-680"></span><span class="hs-comment">-- This function is provided primarily as a convenience for testing. As such,</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- it's not usually necessary to call this function from ordinary application</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- code, unless you suspect that a 'Selection' is incorrect in some way.</span><span>
</span><span id="line-683"></span><span class="hs-comment">--</span><span>
</span><span id="line-684"></span><span id="local-6989586621682435831"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelection"><span class="hs-identifier hs-type">verifySelection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435831"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435831"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-685"></span><span id="verifySelection"><span class="annot"><span class="annottext">verifySelection :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelection"><span class="hs-identifier hs-var hs-var">verifySelection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[VerifySelection ctx] -&gt; VerifySelection ctx
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSufficient"><span class="hs-identifier hs-var">verifySelectionCollateralSufficient</span></a></span><span>
</span><span id="line-687"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. SelectionContext ctx =&gt; VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSuitable"><span class="hs-identifier hs-var">verifySelectionCollateralSuitable</span></a></span><span>
</span><span id="line-688"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionDeltaValid"><span class="hs-identifier hs-var">verifySelectionDeltaValid</span></a></span><span>
</span><span id="line-689"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var">verifySelectionInputCountWithinLimit</span></a></span><span>
</span><span id="line-690"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. SelectionContext ctx =&gt; VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-var">verifySelectionOutputCoinsSufficient</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. SelectionContext ctx =&gt; VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-var">verifySelectionOutputSizesWithinLimit</span></a></span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">VerifySelection ctx
forall ctx. SelectionContext ctx =&gt; VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-var">verifySelectionOutputTokenQuantitiesWithinLimit</span></a></span><span>
</span><span id="line-693"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-696"></span><span class="hs-comment">-- Selection verification: collateral sufficiency</span><span>
</span><span id="line-697"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionCollateralSufficient"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSufficient"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralSufficient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-700"></span><span>    </span><span id="FailureToVerifySelectionCollateralSufficient"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSufficient"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralSufficient</span></a></span></span><span>
</span><span id="line-701"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AcollateralSelected%3AFailureToVerifySelectionCollateralSufficient"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSufficient -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralSelected%3AFailureToVerifySelectionCollateralSufficient"><span class="hs-identifier hs-var hs-var">collateralSelected</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcollateralRequired%3AFailureToVerifySelectionCollateralSufficient"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSufficient -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralRequired%3AFailureToVerifySelectionCollateralSufficient"><span class="hs-identifier hs-var hs-var">collateralRequired</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-703"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-704"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435817"><span id="local-6989586621682435819"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSufficient
-&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool
(FailureToVerifySelectionCollateralSufficient
 -&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool)
-&gt; (FailureToVerifySelectionCollateralSufficient
    -&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool)
-&gt; Eq FailureToVerifySelectionCollateralSufficient
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionCollateralSufficient
-&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool
$c/= :: FailureToVerifySelectionCollateralSufficient
-&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool
== :: FailureToVerifySelectionCollateralSufficient
-&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool
$c== :: FailureToVerifySelectionCollateralSufficient
-&gt; FailureToVerifySelectionCollateralSufficient -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435811"><span id="local-6989586621682435813"><span id="local-6989586621682435815"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionCollateralSufficient -&gt; ShowS
[FailureToVerifySelectionCollateralSufficient] -&gt; ShowS
FailureToVerifySelectionCollateralSufficient -&gt; String
(Int -&gt; FailureToVerifySelectionCollateralSufficient -&gt; ShowS)
-&gt; (FailureToVerifySelectionCollateralSufficient -&gt; String)
-&gt; ([FailureToVerifySelectionCollateralSufficient] -&gt; ShowS)
-&gt; Show FailureToVerifySelectionCollateralSufficient
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionCollateralSufficient] -&gt; ShowS
$cshowList :: [FailureToVerifySelectionCollateralSufficient] -&gt; ShowS
show :: FailureToVerifySelectionCollateralSufficient -&gt; String
$cshow :: FailureToVerifySelectionCollateralSufficient -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionCollateralSufficient -&gt; ShowS
$cshowsPrec :: Int -&gt; FailureToVerifySelectionCollateralSufficient -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span id="local-6989586621682436409"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSufficient"><span class="hs-identifier hs-type">verifySelectionCollateralSufficient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436409"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-707"></span><span id="verifySelectionCollateralSufficient"><span class="annot"><span class="annottext">verifySelectionCollateralSufficient :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSufficient"><span class="hs-identifier hs-var hs-var">verifySelectionCollateralSufficient</span></a></span></span><span> </span><span id="local-6989586621682435810"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435810"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435809"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435809"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435808"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435808"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionCollateralSufficient
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-709"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435807"><span class="hs-identifier hs-var">collateralSelected</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435806"><span class="hs-identifier hs-var">collateralRequired</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSufficient :: Coin -&gt; Coin -&gt; FailureToVerifySelectionCollateralSufficient
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSufficient"><span class="hs-identifier hs-type">FailureToVerifySelectionCollateralSufficient</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Coin
collateralRequired :: Coin
collateralSelected :: Coin
$sel:collateralRequired:FailureToVerifySelectionCollateralSufficient :: Coin
$sel:collateralSelected:FailureToVerifySelectionCollateralSufficient :: Coin
</span><a href="#local-6989586621682435806"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-712"></span><span>    </span><span id="local-6989586621682435807"><span class="annot"><span class="annottext">collateralSelected :: Coin
</span><a href="#local-6989586621682435807"><span class="hs-identifier hs-var hs-var">collateralSelected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; Coin
forall ctx. Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateral"><span class="hs-identifier hs-var">selectionCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435808"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-713"></span><span>    </span><span id="local-6989586621682435806"><span class="annot"><span class="annottext">collateralRequired :: Coin
</span><a href="#local-6989586621682435806"><span class="hs-identifier hs-var hs-var">collateralRequired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
forall ctx.
SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCollateral"><span class="hs-identifier hs-var">selectionMinimumCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435810"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435809"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435808"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-714"></span><span>
</span><span id="line-715"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- Selection verification: collateral suitability</span><span>
</span><span id="line-717"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionCollateralSuitable"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSuitable"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralSuitable</span></a></span></span><span> </span><span id="local-6989586621682436395"><span class="annot"><a href="#local-6989586621682436395"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-720"></span><span>    </span><span id="FailureToVerifySelectionCollateralSuitable"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSuitable"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralSuitable</span></a></span></span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AcollateralSelected%3AFailureToVerifySelectionCollateralSuitable"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSuitable u -&gt; [(u, Coin)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralSelected%3AFailureToVerifySelectionCollateralSuitable"><span class="hs-identifier hs-var hs-var">collateralSelected</span></a></span></span><span>
</span><span id="line-722"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436395"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-723"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AcollateralSelectedButUnsuitable%3AFailureToVerifySelectionCollateralSuitable"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSuitable u -&gt; [(u, Coin)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralSelectedButUnsuitable%3AFailureToVerifySelectionCollateralSuitable"><span class="hs-identifier hs-var hs-var">collateralSelectedButUnsuitable</span></a></span></span><span>
</span><span id="line-724"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436395"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-725"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-726"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435799"><span id="local-6989586621682435801"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
(FailureToVerifySelectionCollateralSuitable u
 -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool)
-&gt; (FailureToVerifySelectionCollateralSuitable u
    -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionCollateralSuitable u)
forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
$c/= :: forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
== :: FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
$c== :: forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralSuitable u
-&gt; FailureToVerifySelectionCollateralSuitable u -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435793"><span id="local-6989586621682435795"><span id="local-6989586621682435797"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; ShowS
[FailureToVerifySelectionCollateralSuitable u] -&gt; ShowS
FailureToVerifySelectionCollateralSuitable u -&gt; String
(Int -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; ShowS)
-&gt; (FailureToVerifySelectionCollateralSuitable u -&gt; String)
-&gt; ([FailureToVerifySelectionCollateralSuitable u] -&gt; ShowS)
-&gt; Show (FailureToVerifySelectionCollateralSuitable u)
forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; ShowS
forall u.
Show u =&gt;
[FailureToVerifySelectionCollateralSuitable u] -&gt; ShowS
forall u.
Show u =&gt;
FailureToVerifySelectionCollateralSuitable u -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionCollateralSuitable u] -&gt; ShowS
$cshowList :: forall u.
Show u =&gt;
[FailureToVerifySelectionCollateralSuitable u] -&gt; ShowS
show :: FailureToVerifySelectionCollateralSuitable u -&gt; String
$cshow :: forall u.
Show u =&gt;
FailureToVerifySelectionCollateralSuitable u -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; ShowS
$cshowsPrec :: forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionCollateralSuitable u -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSuitable"><span class="hs-identifier hs-type">verifySelectionCollateralSuitable</span></a></span><span>
</span><span id="line-729"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436408"><span class="annot"><a href="#local-6989586621682436408"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436408"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436408"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-730"></span><span id="verifySelectionCollateralSuitable"><span class="annot"><span class="annottext">verifySelectionCollateralSuitable :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralSuitable"><span class="hs-identifier hs-var hs-var">verifySelectionCollateralSuitable</span></a></span></span><span> </span><span id="local-6989586621682435792"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435792"><span class="hs-identifier hs-var">_cs</span></a></span></span><span> </span><span id="local-6989586621682435791"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435791"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435790"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435790"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-731"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionCollateralSuitable (UTxO ctx)
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-732"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(UTxO ctx, Coin)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">[(UTxO ctx, Coin)]
</span><a href="#local-6989586621682435788"><span class="hs-identifier hs-var">collateralSelectedButUnsuitable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralSuitable :: forall u.
[(u, Coin)]
-&gt; [(u, Coin)] -&gt; FailureToVerifySelectionCollateralSuitable u
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralSuitable"><span class="hs-identifier hs-type">FailureToVerifySelectionCollateralSuitable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">[(UTxO ctx, Coin)]
collateralSelected :: [(UTxO ctx, Coin)]
collateralSelectedButUnsuitable :: [(UTxO ctx, Coin)]
$sel:collateralSelectedButUnsuitable:FailureToVerifySelectionCollateralSuitable :: [(UTxO ctx, Coin)]
$sel:collateralSelected:FailureToVerifySelectionCollateralSuitable :: [(UTxO ctx, Coin)]
</span><a href="#local-6989586621682435787"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-735"></span><span>    </span><span id="local-6989586621682435787"><span class="annot"><span class="annottext">collateralSelected :: [(UTxO ctx, Coin)]
</span><a href="#local-6989586621682435787"><span class="hs-identifier hs-var hs-var">collateralSelected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-736"></span><span>        </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435790"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; (([(UTxO ctx, Coin)]
     -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
    -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
-&gt; [(UTxO ctx, Coin)]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;collateral&quot;
  (([(UTxO ctx, Coin)]
    -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
   -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
([(UTxO ctx, Coin)] -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
-&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx)
</span><a href="#local-6989586621682435786"><span class="hs-var">#collateral</span></a></span><span>
</span><span id="line-737"></span><span>    </span><span id="local-6989586621682435788"><span class="annot"><span class="annottext">collateralSelectedButUnsuitable :: [(UTxO ctx, Coin)]
</span><a href="#local-6989586621682435788"><span class="hs-identifier hs-var hs-var">collateralSelectedButUnsuitable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-738"></span><span>        </span><span class="annot"><span class="annottext">((UTxO ctx, Coin) -&gt; Bool)
-&gt; [(UTxO ctx, Coin)] -&gt; [(UTxO ctx, Coin)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((UTxO ctx, Coin) -&gt; Bool) -&gt; (UTxO ctx, Coin) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxO ctx, Coin) -&gt; Bool
</span><a href="#local-6989586621682435784"><span class="hs-identifier hs-var">utxoSuitableForCollateral</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(UTxO ctx, Coin)]
</span><a href="#local-6989586621682435787"><span class="hs-identifier hs-var">collateralSelected</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span>    </span><span class="hs-comment">-- Since the caller of 'performSelection' is responsible for verifying that</span><span>
</span><span id="line-741"></span><span>    </span><span class="hs-comment">-- all entries within 'utxoAvailableForCollateral' are suitable for use as</span><span>
</span><span id="line-742"></span><span>    </span><span class="hs-comment">-- collateral, here we merely verify that the selected entry is indeed a</span><span>
</span><span id="line-743"></span><span>    </span><span class="hs-comment">-- member of this set.</span><span>
</span><span id="line-744"></span><span>    </span><span class="annot"><a href="#local-6989586621682435784"><span class="hs-identifier hs-type">utxoSuitableForCollateral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436408"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-745"></span><span>    </span><span id="local-6989586621682435784"><span class="annot"><span class="annottext">utxoSuitableForCollateral :: (UTxO ctx, Coin) -&gt; Bool
</span><a href="#local-6989586621682435784"><span class="hs-identifier hs-var hs-var">utxoSuitableForCollateral</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435783"><span class="annot"><span class="annottext">UTxO ctx
</span><a href="#local-6989586621682435783"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435782"><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435782"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><span class="annottext">UTxO ctx -&gt; Coin -&gt; Map (UTxO ctx) Coin
forall k a. k -&gt; a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO ctx
</span><a href="#local-6989586621682435783"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435782"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-747"></span><span>        </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Map (UTxO ctx) Coin -&gt; Bool
forall k a. (Ord k, Eq a) =&gt; Map k a -&gt; Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-operator hs-var">`Map.isSubmapOf`</span></a></span><span>
</span><span id="line-748"></span><span>        </span><span class="annot"><span class="annottext">((Map (UTxO ctx) Coin
  -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
 -&gt; SelectionParams ctx
 -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; Map (UTxO ctx) Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoAvailableForCollateral&quot;
  ((Map (UTxO ctx) Coin
    -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
   -&gt; SelectionParams ctx
   -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
(Map (UTxO ctx) Coin
 -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
-&gt; SelectionParams ctx
-&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx)
</span><a href="#local-6989586621682435779"><span class="hs-var">#utxoAvailableForCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435791"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- Selection verification: delta validity</span><span>
</span><span id="line-752"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-753"></span><span>
</span><span id="line-754"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionDeltaValid"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-var">FailureToVerifySelectionDeltaValid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailureToVerifySelectionDeltaValid"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-var">FailureToVerifySelectionDeltaValid</span></a></span></span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Adelta%3AFailureToVerifySelectionDeltaValid"><span class="annot"><span class="annottext">FailureToVerifySelectionDeltaValid -&gt; SelectionDelta TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Adelta%3AFailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span>
</span><span id="line-756"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionDelta"><span class="hs-identifier hs-type">SelectionDelta</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span>
</span><span id="line-757"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AminimumCost%3AFailureToVerifySelectionDeltaValid"><span class="annot"><span class="annottext">FailureToVerifySelectionDeltaValid -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumCost%3AFailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-var hs-var">minimumCost</span></a></span></span><span>
</span><span id="line-758"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-759"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumCost%3AFailureToVerifySelectionDeltaValid"><span class="annot"><span class="annottext">FailureToVerifySelectionDeltaValid -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumCost%3AFailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-var hs-var">maximumCost</span></a></span></span><span>
</span><span id="line-760"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-761"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-762"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435771"><span id="local-6989586621682435773"><span class="annot"><span class="annottext">FailureToVerifySelectionDeltaValid
-&gt; FailureToVerifySelectionDeltaValid -&gt; Bool
(FailureToVerifySelectionDeltaValid
 -&gt; FailureToVerifySelectionDeltaValid -&gt; Bool)
-&gt; (FailureToVerifySelectionDeltaValid
    -&gt; FailureToVerifySelectionDeltaValid -&gt; Bool)
-&gt; Eq FailureToVerifySelectionDeltaValid
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionDeltaValid
-&gt; FailureToVerifySelectionDeltaValid -&gt; Bool
$c/= :: FailureToVerifySelectionDeltaValid
-&gt; FailureToVerifySelectionDeltaValid -&gt; Bool
== :: FailureToVerifySelectionDeltaValid
-&gt; FailureToVerifySelectionDeltaValid -&gt; Bool
$c== :: FailureToVerifySelectionDeltaValid
-&gt; FailureToVerifySelectionDeltaValid -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435765"><span id="local-6989586621682435767"><span id="local-6989586621682435769"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionDeltaValid -&gt; ShowS
[FailureToVerifySelectionDeltaValid] -&gt; ShowS
FailureToVerifySelectionDeltaValid -&gt; String
(Int -&gt; FailureToVerifySelectionDeltaValid -&gt; ShowS)
-&gt; (FailureToVerifySelectionDeltaValid -&gt; String)
-&gt; ([FailureToVerifySelectionDeltaValid] -&gt; ShowS)
-&gt; Show FailureToVerifySelectionDeltaValid
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionDeltaValid] -&gt; ShowS
$cshowList :: [FailureToVerifySelectionDeltaValid] -&gt; ShowS
show :: FailureToVerifySelectionDeltaValid -&gt; String
$cshow :: FailureToVerifySelectionDeltaValid -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionDeltaValid -&gt; ShowS
$cshowsPrec :: Int -&gt; FailureToVerifySelectionDeltaValid -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span id="local-6989586621682435764"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionDeltaValid"><span class="hs-identifier hs-type">verifySelectionDeltaValid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435764"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-765"></span><span id="verifySelectionDeltaValid"><span class="annot"><span class="annottext">verifySelectionDeltaValid :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionDeltaValid"><span class="hs-identifier hs-var hs-var">verifySelectionDeltaValid</span></a></span></span><span> </span><span id="local-6989586621682435763"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435763"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435762"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435762"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435761"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435761"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-766"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; FailureToVerifySelectionDeltaValid -&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-767"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Bool
forall ctx.
SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasValidSurplus"><span class="hs-identifier hs-var">selectionHasValidSurplus</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435763"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435762"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435761"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionDeltaValid :: SelectionDelta TokenBundle
-&gt; Coin -&gt; Coin -&gt; FailureToVerifySelectionDeltaValid
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionDeltaValid"><span class="hs-identifier hs-type">FailureToVerifySelectionDeltaValid</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Coin
SelectionDelta TokenBundle
maximumCost :: Coin
minimumCost :: Coin
delta :: SelectionDelta TokenBundle
$sel:maximumCost:FailureToVerifySelectionDeltaValid :: Coin
$sel:minimumCost:FailureToVerifySelectionDeltaValid :: Coin
$sel:delta:FailureToVerifySelectionDeltaValid :: SelectionDelta TokenBundle
</span><a href="#local-6989586621682435758"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-770"></span><span>    </span><span id="local-6989586621682435760"><span class="annot"><span class="annottext">delta :: SelectionDelta TokenBundle
</span><a href="#local-6989586621682435760"><span class="hs-identifier hs-var hs-var">delta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionDelta TokenBundle
forall ctx. Selection ctx -&gt; SelectionDelta TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaAllAssets"><span class="hs-identifier hs-var">selectionDeltaAllAssets</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435761"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-771"></span><span>    </span><span id="local-6989586621682435759"><span class="annot"><span class="annottext">minimumCost :: Coin
</span><a href="#local-6989586621682435759"><span class="hs-identifier hs-var hs-var">minimumCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
forall ctx.
SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCost"><span class="hs-identifier hs-var">selectionMinimumCost</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435763"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435762"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435761"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-772"></span><span>    </span><span id="local-6989586621682435758"><span class="annot"><span class="annottext">maximumCost :: Coin
</span><a href="#local-6989586621682435758"><span class="hs-identifier hs-var hs-var">maximumCost</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
forall ctx.
SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMaximumCost"><span class="hs-identifier hs-var">selectionMaximumCost</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435763"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435762"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435761"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- Selection verification: selection limit</span><span>
</span><span id="line-776"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-777"></span><span>
</span><span id="line-778"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionInputCountWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionInputCountWithinLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-779"></span><span>    </span><span id="FailureToVerifySelectionInputCountWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionInputCountWithinLimit</span></a></span></span><span>
</span><span id="line-780"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AcollateralInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcollateralInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var hs-var">collateralInputCount</span></a></span></span><span>
</span><span id="line-781"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AordinaryInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AordinaryInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var hs-var">ordinaryInputCount</span></a></span></span><span>
</span><span id="line-783"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtotalInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AtotalInputCount%3AFailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var hs-var">totalInputCount</span></a></span></span><span>
</span><span id="line-785"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-786"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AselectionLimit%3AFailureToVerifySelectionInputCountWithinLimit"><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectionLimit%3AFailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var hs-var">selectionLimit</span></a></span></span><span>
</span><span id="line-787"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-788"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-789"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435748"><span id="local-6989586621682435750"><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool
(FailureToVerifySelectionInputCountWithinLimit
 -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool)
-&gt; (FailureToVerifySelectionInputCountWithinLimit
    -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool)
-&gt; Eq FailureToVerifySelectionInputCountWithinLimit
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionInputCountWithinLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool
$c/= :: FailureToVerifySelectionInputCountWithinLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool
== :: FailureToVerifySelectionInputCountWithinLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool
$c== :: FailureToVerifySelectionInputCountWithinLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435742"><span id="local-6989586621682435744"><span id="local-6989586621682435746"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; ShowS
[FailureToVerifySelectionInputCountWithinLimit] -&gt; ShowS
FailureToVerifySelectionInputCountWithinLimit -&gt; String
(Int -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; ShowS)
-&gt; (FailureToVerifySelectionInputCountWithinLimit -&gt; String)
-&gt; ([FailureToVerifySelectionInputCountWithinLimit] -&gt; ShowS)
-&gt; Show FailureToVerifySelectionInputCountWithinLimit
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionInputCountWithinLimit] -&gt; ShowS
$cshowList :: [FailureToVerifySelectionInputCountWithinLimit] -&gt; ShowS
show :: FailureToVerifySelectionInputCountWithinLimit -&gt; String
$cshow :: FailureToVerifySelectionInputCountWithinLimit -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; ShowS
$cshowsPrec :: Int -&gt; FailureToVerifySelectionInputCountWithinLimit -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span id="local-6989586621682435741"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionInputCountWithinLimit"><span class="hs-identifier hs-type">verifySelectionInputCountWithinLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435741"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-792"></span><span id="verifySelectionInputCountWithinLimit"><span class="annot"><span class="annottext">verifySelectionInputCountWithinLimit :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionInputCountWithinLimit"><span class="hs-identifier hs-var hs-var">verifySelectionInputCountWithinLimit</span></a></span></span><span> </span><span id="local-6989586621682435740"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435740"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435739"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435739"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435738"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435738"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-793"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionInputCountWithinLimit
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-794"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SelectionLimit
forall a. a -&gt; SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#MaximumInputLimit"><span class="hs-identifier hs-var">Balance.MaximumInputLimit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435736"><span class="hs-identifier hs-var">totalInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; SelectionLimit -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit
</span><a href="#local-6989586621682435734"><span class="hs-identifier hs-var">selectionLimit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-795"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionInputCountWithinLimit :: Int
-&gt; Int
-&gt; Int
-&gt; SelectionLimit
-&gt; FailureToVerifySelectionInputCountWithinLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionInputCountWithinLimit"><span class="hs-identifier hs-type">FailureToVerifySelectionInputCountWithinLimit</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
SelectionLimit
ordinaryInputCount :: Int
collateralInputCount :: Int
selectionLimit :: SelectionLimit
totalInputCount :: Int
$sel:selectionLimit:FailureToVerifySelectionInputCountWithinLimit :: SelectionLimit
$sel:totalInputCount:FailureToVerifySelectionInputCountWithinLimit :: Int
$sel:ordinaryInputCount:FailureToVerifySelectionInputCountWithinLimit :: Int
$sel:collateralInputCount:FailureToVerifySelectionInputCountWithinLimit :: Int
</span><a href="#local-6989586621682435732"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-797"></span><span>    </span><span id="local-6989586621682435733"><span class="annot"><span class="annottext">collateralInputCount :: Int
</span><a href="#local-6989586621682435733"><span class="hs-identifier hs-var hs-var">collateralInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(UTxO ctx, Coin)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435738"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; (([(UTxO ctx, Coin)]
     -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
    -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
-&gt; [(UTxO ctx, Coin)]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;collateral&quot;
  (([(UTxO ctx, Coin)]
    -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
   -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
([(UTxO ctx, Coin)] -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
-&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx)
</span><a href="#local-6989586621682435730"><span class="hs-var">#collateral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-798"></span><span>    </span><span id="local-6989586621682435732"><span class="annot"><span class="annottext">ordinaryInputCount :: Int
</span><a href="#local-6989586621682435732"><span class="hs-identifier hs-var hs-var">ordinaryInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (UTxO ctx, TokenBundle) -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435738"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; ((NonEmpty (UTxO ctx, TokenBundle)
     -&gt; Const
          (NonEmpty (UTxO ctx, TokenBundle))
          (NonEmpty (UTxO ctx, TokenBundle)))
    -&gt; Selection ctx
    -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx))
-&gt; NonEmpty (UTxO ctx, TokenBundle)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;inputs&quot;
  ((NonEmpty (UTxO ctx, TokenBundle)
    -&gt; Const
         (NonEmpty (UTxO ctx, TokenBundle))
         (NonEmpty (UTxO ctx, TokenBundle)))
   -&gt; Selection ctx
   -&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx))
(NonEmpty (UTxO ctx, TokenBundle)
 -&gt; Const
      (NonEmpty (UTxO ctx, TokenBundle))
      (NonEmpty (UTxO ctx, TokenBundle)))
-&gt; Selection ctx
-&gt; Const (NonEmpty (UTxO ctx, TokenBundle)) (Selection ctx)
</span><a href="#local-6989586621682435729"><span class="hs-var">#inputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>    </span><span id="local-6989586621682435736"><span class="annot"><span class="annottext">totalInputCount :: Int
</span><a href="#local-6989586621682435736"><span class="hs-identifier hs-var hs-var">totalInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435733"><span class="hs-identifier hs-var">collateralInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435732"><span class="hs-identifier hs-var">ordinaryInputCount</span></a></span><span>
</span><span id="line-800"></span><span>    </span><span id="local-6989586621682435734"><span class="annot"><span class="annottext">selectionLimit :: SelectionLimit
</span><a href="#local-6989586621682435734"><span class="hs-identifier hs-var hs-var">selectionLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435740"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; ((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
     -&gt; Const
          ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
          ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
         (SelectionConstraints ctx))
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeSelectionLimit&quot;
  ((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; Const
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
        (SelectionConstraints ctx))
(([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
-&gt; SelectionConstraints ctx
-&gt; Const
     ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435728"><span class="hs-var">#computeSelectionLimit</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435738"><span class="hs-identifier hs-var">selection</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
-&gt; (([(Address ctx, TokenBundle)]
     -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
    -&gt; Selection ctx
    -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
-&gt; [(Address ctx, TokenBundle)]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputs&quot;
  (([(Address ctx, TokenBundle)]
    -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
   -&gt; Selection ctx
   -&gt; Const [(Address ctx, TokenBundle)] (Selection ctx))
([(Address ctx, TokenBundle)]
 -&gt; Const [(Address ctx, TokenBundle)] [(Address ctx, TokenBundle)])
-&gt; Selection ctx
-&gt; Const [(Address ctx, TokenBundle)] (Selection ctx)
</span><a href="#local-6989586621682435727"><span class="hs-var">#outputs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>
</span><span id="line-802"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- Selection verification: minimum ada quantities</span><span>
</span><span id="line-804"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-805"></span><span>
</span><span id="line-806"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifySelectionOutputCoinsSufficient"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputCoinsSufficient</span></a></span></span><span> </span><span id="local-6989586621682436365"><span class="annot"><a href="#local-6989586621682436365"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-807"></span><span>    </span><span id="FailureToVerifySelectionOutputCoinsSufficient"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputCoinsSufficient</span></a></span></span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436365"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435722"><span id="local-6989586621682435724"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
(FailureToVerifySelectionOutputCoinsSufficient ctx
 -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputCoinsSufficient ctx
    -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionOutputCoinsSufficient ctx)
forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
$c/= :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
== :: FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
$c== :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputCoinsSufficient ctx
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435716"><span id="local-6989586621682435718"><span id="local-6989586621682435720"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; ShowS
[FailureToVerifySelectionOutputCoinsSufficient ctx] -&gt; ShowS
FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; String
(Int -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; String)
-&gt; ([FailureToVerifySelectionOutputCoinsSufficient ctx] -&gt; ShowS)
-&gt; Show (FailureToVerifySelectionOutputCoinsSufficient ctx)
forall ctx.
SelectionContext ctx =&gt;
Int -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; ShowS
forall ctx.
SelectionContext ctx =&gt;
[FailureToVerifySelectionOutputCoinsSufficient ctx] -&gt; ShowS
forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputCoinsSufficient ctx] -&gt; ShowS
$cshowList :: forall ctx.
SelectionContext ctx =&gt;
[FailureToVerifySelectionOutputCoinsSufficient ctx] -&gt; ShowS
show :: FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; String
$cshow :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; ShowS
$cshowsPrec :: forall ctx.
SelectionContext ctx =&gt;
Int -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-810"></span><span>
</span><span id="line-811"></span><span id="local-6989586621682435714"><span id="local-6989586621682435715"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionOutputCoinInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var">SelectionOutputCoinInsufficientError</span></a></span></span><span> </span><span id="local-6989586621682436359"><span class="annot"><a href="#local-6989586621682436359"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-812"></span><span>    </span><span id="SelectionOutputCoinInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var">SelectionOutputCoinInsufficientError</span></a></span></span><span>
</span><span id="line-813"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AminimumExpectedCoin%3ASelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumExpectedCoin%3ASelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">minimumExpectedCoin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-814"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aoutput%3ASelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; (Address ctx, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aoutput%3ASelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436359"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-816"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionOutputCoinInsufficientError ctx
 -&gt; Rep (SelectionOutputCoinInsufficientError ctx) x)
-&gt; (forall x.
    Rep (SelectionOutputCoinInsufficientError ctx) x
    -&gt; SelectionOutputCoinInsufficientError ctx)
-&gt; Generic (SelectionOutputCoinInsufficientError ctx)
forall x.
Rep (SelectionOutputCoinInsufficientError ctx) x
-&gt; SelectionOutputCoinInsufficientError ctx
forall x.
SelectionOutputCoinInsufficientError ctx
-&gt; Rep (SelectionOutputCoinInsufficientError ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionOutputCoinInsufficientError ctx) x
-&gt; SelectionOutputCoinInsufficientError ctx
forall ctx x.
SelectionOutputCoinInsufficientError ctx
-&gt; Rep (SelectionOutputCoinInsufficientError ctx) x
$cto :: forall ctx x.
Rep (SelectionOutputCoinInsufficientError ctx) x
-&gt; SelectionOutputCoinInsufficientError ctx
$cfrom :: forall ctx x.
SelectionOutputCoinInsufficientError ctx
-&gt; Rep (SelectionOutputCoinInsufficientError ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-817"></span><span>
</span><span id="line-818"></span><span id="local-6989586621682435704"><span id="local-6989586621682435706"><span id="local-6989586621682435708"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435708"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-819"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435708"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-820"></span><span id="local-6989586621682435697"><span id="local-6989586621682435699"><span id="local-6989586621682435701"><span id="local-6989586621682435703"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435703"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435703"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-822"></span><span>
</span><span id="line-823"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-type">verifySelectionOutputCoinsSufficient</span></a></span><span>
</span><span id="line-824"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682435696"><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-825"></span><span id="verifySelectionOutputCoinsSufficient"><span class="annot"><span class="annottext">verifySelectionOutputCoinsSufficient :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-var hs-var">verifySelectionOutputCoinsSufficient</span></a></span></span><span> </span><span id="local-6989586621682435695"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435695"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435694"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435694"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435693"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435693"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-826"></span><span>    </span><span class="annot"><span class="annottext">[SelectionOutputCoinInsufficientError ctx]
-&gt; (NonEmpty (SelectionOutputCoinInsufficientError ctx)
    -&gt; FailureToVerifySelectionOutputCoinsSufficient ctx)
-&gt; VerificationResult
forall failureReason a.
Show failureReason =&gt;
[a] -&gt; (NonEmpty a -&gt; failureReason) -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmpty"><span class="hs-identifier hs-var">verifyEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputCoinInsufficientError ctx]
</span><a href="#local-6989586621682435692"><span class="hs-identifier hs-var">errors</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (SelectionOutputCoinInsufficientError ctx)
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx
forall ctx.
NonEmpty (SelectionOutputCoinInsufficientError ctx)
-&gt; FailureToVerifySelectionOutputCoinsSufficient ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinsSufficient"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputCoinsSufficient</span></a></span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-828"></span><span>    </span><span class="annot"><a href="#local-6989586621682435692"><span class="hs-identifier hs-type">errors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-829"></span><span>    </span><span id="local-6989586621682435692"><span class="annot"><span class="annottext">errors :: [SelectionOutputCoinInsufficientError ctx]
</span><a href="#local-6989586621682435692"><span class="hs-identifier hs-var hs-var">errors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; Maybe (SelectionOutputCoinInsufficientError ctx))
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputCoinInsufficientError ctx]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
</span><a href="#local-6989586621682435691"><span class="hs-identifier hs-var">maybeError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
forall ctx.
SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionAllOutputs"><span class="hs-identifier hs-var">selectionAllOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435695"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435693"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span>    </span><span class="annot"><a href="#local-6989586621682435691"><span class="hs-identifier hs-type">maybeError</span></a></span><span>
</span><span id="line-832"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-833"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435696"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>    </span><span id="local-6989586621682435691"><span class="annot"><span class="annottext">maybeError :: (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
</span><a href="#local-6989586621682435691"><span class="hs-identifier hs-var hs-var">maybeError</span></a></span></span><span> </span><span id="local-6989586621682435690"><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435690"><span class="hs-identifier hs-var">output</span></a></span></span><span>
</span><span id="line-835"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435690"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; TokenBundle -&gt; Const Coin TokenBundle)
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;coin&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; TokenBundle -&gt; Const Coin TokenBundle)
(Coin -&gt; Const Coin Coin) -&gt; TokenBundle -&gt; Const Coin TokenBundle
</span><a href="#local-6989586621682435689"><span class="hs-var">#coin</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435687"><span class="hs-identifier hs-var">minimumExpectedCoin</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-836"></span><span>            </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError :: forall ctx.
Coin
-&gt; (Address ctx, TokenBundle)
-&gt; SelectionOutputCoinInsufficientError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span>
</span><span id="line-837"></span><span>                </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Coin
minimumExpectedCoin :: Coin
$sel:minimumExpectedCoin:SelectionOutputCoinInsufficientError :: Coin
</span><a href="#local-6989586621682435687"><span class="hs-identifier hs-var hs-var">minimumExpectedCoin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
output :: (Address ctx, TokenBundle)
$sel:output:SelectionOutputCoinInsufficientError :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435690"><span class="hs-identifier hs-var hs-var">output</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-838"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-839"></span><span>            </span><span class="annot"><span class="annottext">Maybe (SelectionOutputCoinInsufficientError ctx)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-840"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-841"></span><span>        </span><span class="annot"><a href="#local-6989586621682435687"><span class="hs-identifier hs-type">minimumExpectedCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-842"></span><span>        </span><span id="local-6989586621682435687"><span class="annot"><span class="annottext">minimumExpectedCoin :: Coin
</span><a href="#local-6989586621682435687"><span class="hs-identifier hs-var hs-var">minimumExpectedCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-843"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435695"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((Address ctx -&gt; TokenMap -&gt; Coin)
     -&gt; Const
          (Address ctx -&gt; TokenMap -&gt; Coin)
          (Address ctx -&gt; TokenMap -&gt; Coin))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
-&gt; Address ctx
-&gt; TokenMap
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenMap -&gt; Coin)
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin)
         (Address ctx -&gt; TokenMap -&gt; Coin))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
((Address ctx -&gt; TokenMap -&gt; Coin)
 -&gt; Const
      (Address ctx -&gt; TokenMap -&gt; Coin)
      (Address ctx -&gt; TokenMap -&gt; Coin))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435686"><span class="hs-var">#computeMinimumAdaQuantity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; Address ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435690"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-845"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435690"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((TokenMap -&gt; Const TokenMap TokenMap)
    -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
-&gt; TokenMap
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;tokens&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; TokenBundle -&gt; Const TokenMap TokenBundle
</span><a href="#local-6989586621682435685"><span class="hs-var">#tokens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- Selection verification: output sizes</span><span>
</span><span id="line-849"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-850"></span><span>
</span><span id="line-851"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifySelectionOutputSizesWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputSizesWithinLimit</span></a></span></span><span> </span><span id="local-6989586621682436351"><span class="annot"><a href="#local-6989586621682436351"><span class="hs-identifier hs-type">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-852"></span><span>    </span><span id="FailureToVerifySelectionOutputSizesWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputSizesWithinLimit</span></a></span></span><span>
</span><span id="line-853"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436351"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435680"><span id="local-6989586621682435682"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
(FailureToVerifySelectionOutputSizesWithinLimit address
 -&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputSizesWithinLimit address
    -&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionOutputSizesWithinLimit address)
forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
$c/= :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
== :: FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
$c== :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputSizesWithinLimit address
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435674"><span id="local-6989586621682435676"><span id="local-6989586621682435678"><span class="annot"><span class="annottext">Int
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; ShowS
[FailureToVerifySelectionOutputSizesWithinLimit address] -&gt; ShowS
FailureToVerifySelectionOutputSizesWithinLimit address -&gt; String
(Int
 -&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputSizesWithinLimit address
    -&gt; String)
-&gt; ([FailureToVerifySelectionOutputSizesWithinLimit address]
    -&gt; ShowS)
-&gt; Show (FailureToVerifySelectionOutputSizesWithinLimit address)
forall address.
SelectionContext address =&gt;
Int
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; ShowS
forall address.
SelectionContext address =&gt;
[FailureToVerifySelectionOutputSizesWithinLimit address] -&gt; ShowS
forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputSizesWithinLimit address -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputSizesWithinLimit address] -&gt; ShowS
$cshowList :: forall address.
SelectionContext address =&gt;
[FailureToVerifySelectionOutputSizesWithinLimit address] -&gt; ShowS
show :: FailureToVerifySelectionOutputSizesWithinLimit address -&gt; String
$cshow :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputSizesWithinLimit address -&gt; String
showsPrec :: Int
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; ShowS
$cshowsPrec :: forall address.
SelectionContext address =&gt;
Int
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-855"></span><span>
</span><span id="line-856"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-type">verifySelectionOutputSizesWithinLimit</span></a></span><span>
</span><span id="line-857"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682435673"><span class="annot"><a href="#local-6989586621682435673"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435673"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435673"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-858"></span><span id="verifySelectionOutputSizesWithinLimit"><span class="annot"><span class="annottext">verifySelectionOutputSizesWithinLimit :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-var hs-var">verifySelectionOutputSizesWithinLimit</span></a></span></span><span> </span><span id="local-6989586621682435672"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435672"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435671"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435671"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435670"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435670"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><span class="annottext">[SelectionOutputSizeExceedsLimitError ctx]
-&gt; (NonEmpty (SelectionOutputSizeExceedsLimitError ctx)
    -&gt; FailureToVerifySelectionOutputSizesWithinLimit ctx)
-&gt; VerificationResult
forall failureReason a.
Show failureReason =&gt;
[a] -&gt; (NonEmpty a -&gt; failureReason) -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmpty"><span class="hs-identifier hs-var">verifyEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputSizeExceedsLimitError ctx]
</span><a href="#local-6989586621682435669"><span class="hs-identifier hs-var">errors</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (SelectionOutputSizeExceedsLimitError ctx)
-&gt; FailureToVerifySelectionOutputSizesWithinLimit ctx
forall address.
NonEmpty (SelectionOutputSizeExceedsLimitError address)
-&gt; FailureToVerifySelectionOutputSizesWithinLimit address
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputSizesWithinLimit</span></a></span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-861"></span><span>    </span><span class="annot"><a href="#local-6989586621682435669"><span class="hs-identifier hs-type">errors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435673"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-862"></span><span>    </span><span id="local-6989586621682435669"><span class="annot"><span class="annottext">errors :: [SelectionOutputSizeExceedsLimitError ctx]
</span><a href="#local-6989586621682435669"><span class="hs-identifier hs-var hs-var">errors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx))
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputSizeExceedsLimitError ctx]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
forall ctx.
SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputSize"><span class="hs-identifier hs-var">verifyOutputSize</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435672"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
forall ctx.
SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionAllOutputs"><span class="hs-identifier hs-var">selectionAllOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435672"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435670"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>
</span><span id="line-864"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-865"></span><span class="hs-comment">-- Selection verification: output token quantities</span><span>
</span><span id="line-866"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-867"></span><span>
</span><span id="line-868"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifySelectionOutputTokenQuantitiesWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantitiesWithinLimit</span></a></span></span><span> </span><span id="local-6989586621682436344"><span class="annot"><a href="#local-6989586621682436344"><span class="hs-identifier hs-type">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-869"></span><span>    </span><span id="FailureToVerifySelectionOutputTokenQuantitiesWithinLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantitiesWithinLimit</span></a></span></span><span>
</span><span id="line-870"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436344"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435663"><span id="local-6989586621682435665"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
(FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
 -&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
 -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputTokenQuantitiesWithinLimit
      address
    -&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
    -&gt; Bool)
-&gt; Eq
     (FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address)
forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
$c/= :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
== :: FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
$c== :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435657"><span id="local-6989586621682435659"><span id="local-6989586621682435661"><span class="annot"><span class="annottext">Int
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; ShowS
[FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address]
-&gt; ShowS
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; String
(Int
 -&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
 -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputTokenQuantitiesWithinLimit
      address
    -&gt; String)
-&gt; ([FailureToVerifySelectionOutputTokenQuantitiesWithinLimit
       address]
    -&gt; ShowS)
-&gt; Show
     (FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address)
forall address.
SelectionContext address =&gt;
Int
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; ShowS
forall address.
SelectionContext address =&gt;
[FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address]
-&gt; ShowS
forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address]
-&gt; ShowS
$cshowList :: forall address.
SelectionContext address =&gt;
[FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address]
-&gt; ShowS
show :: FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; String
$cshow :: forall address.
SelectionContext address =&gt;
FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; String
showsPrec :: Int
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; ShowS
$cshowsPrec :: forall address.
SelectionContext address =&gt;
Int
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
-&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-type">verifySelectionOutputTokenQuantitiesWithinLimit</span></a></span><span>
</span><span id="line-874"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682435656"><span class="annot"><a href="#local-6989586621682435656"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435656"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelection"><span class="hs-identifier hs-type">VerifySelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435656"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-875"></span><span id="verifySelectionOutputTokenQuantitiesWithinLimit"><span class="annot"><span class="annottext">verifySelectionOutputTokenQuantitiesWithinLimit :: VerifySelection ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-var hs-var">verifySelectionOutputTokenQuantitiesWithinLimit</span></a></span></span><span> </span><span id="local-6989586621682435655"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435655"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435654"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435654"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435653"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435653"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-876"></span><span>    </span><span class="annot"><span class="annottext">[SelectionOutputTokenQuantityExceedsLimitError ctx]
-&gt; (NonEmpty (SelectionOutputTokenQuantityExceedsLimitError ctx)
    -&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit ctx)
-&gt; VerificationResult
forall failureReason a.
Show failureReason =&gt;
[a] -&gt; (NonEmpty a -&gt; failureReason) -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmpty"><span class="hs-identifier hs-var">verifyEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="#local-6989586621682435652"><span class="hs-identifier hs-var">errors</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (SelectionOutputTokenQuantityExceedsLimitError ctx)
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit ctx
forall address.
NonEmpty (SelectionOutputTokenQuantityExceedsLimitError address)
-&gt; FailureToVerifySelectionOutputTokenQuantitiesWithinLimit address
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantitiesWithinLimit"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantitiesWithinLimit</span></a></span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><a href="#local-6989586621682435652"><span class="hs-identifier hs-type">errors</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435656"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-879"></span><span>    </span><span id="local-6989586621682435652"><span class="annot"><span class="annottext">errors :: [SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="#local-6989586621682435652"><span class="hs-identifier hs-var hs-var">errors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
forall ctx.
(Address ctx, TokenBundle)
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputTokenQuantities"><span class="hs-identifier hs-var">verifyOutputTokenQuantities</span></a></span><span> </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx])
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
forall ctx.
SelectionConstraints ctx
-&gt; Selection ctx -&gt; [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionAllOutputs"><span class="hs-identifier hs-var">selectionAllOutputs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435655"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435653"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- Selection error verification</span><span>
</span><span id="line-883"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="hs-comment">-- | The type of all 'SelectionError' verification functions.</span><span>
</span><span id="line-886"></span><span class="hs-comment">--</span><span>
</span><span id="line-887"></span><span class="hs-keyword">type</span><span> </span><span id="VerifySelectionError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-var">VerifySelectionError</span></a></span></span><span> </span><span id="local-6989586621682435649"><span class="annot"><a href="#local-6989586621682435649"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span id="local-6989586621682435648"><span class="annot"><a href="#local-6989586621682435648"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-888"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435648"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435648"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682435649"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationResult"><span class="hs-identifier hs-type">VerificationResult</span></a></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="hs-comment">-- | Verifies a 'SelectionError' for correctness.</span><span>
</span><span id="line-891"></span><span class="hs-comment">--</span><span>
</span><span id="line-892"></span><span class="hs-comment">-- This function is provided primarily as a convenience for testing. As such,</span><span>
</span><span id="line-893"></span><span class="hs-comment">-- it's not usually necessary to call this function from ordinary application</span><span>
</span><span id="line-894"></span><span class="hs-comment">-- code, unless you suspect that a 'SelectionError' is incorrect in some way.</span><span>
</span><span id="line-895"></span><span class="hs-comment">--</span><span>
</span><span id="line-896"></span><span id="local-6989586621682435647"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionError"><span class="hs-identifier hs-type">verifySelectionError</span></a></span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435647"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435647"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682435647"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-898"></span><span id="verifySelectionError"><span class="annot"><span class="annottext">verifySelectionError :: VerifySelectionError (SelectionError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionError"><span class="hs-identifier hs-var hs-var">verifySelectionError</span></a></span></span><span> </span><span id="local-6989586621682435646"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435646"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435645"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435645"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-899"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionBalanceErrorOf"><span class="hs-identifier hs-type">SelectionBalanceErrorOf</span></a></span><span> </span><span id="local-6989586621682435644"><span class="annot"><span class="annottext">SelectionBalanceError ctx
</span><a href="#local-6989586621682435644"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-900"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionBalanceError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionBalanceError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionBalanceError"><span class="hs-identifier hs-var">verifySelectionBalanceError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435646"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435645"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionBalanceError ctx
</span><a href="#local-6989586621682435644"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-901"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralErrorOf"><span class="hs-identifier hs-type">SelectionCollateralErrorOf</span></a></span><span> </span><span id="local-6989586621682435642"><span class="annot"><span class="annottext">SelectionCollateralError ctx
</span><a href="#local-6989586621682435642"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-902"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionCollateralError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionCollateralError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralError"><span class="hs-identifier hs-var">verifySelectionCollateralError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435646"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435645"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError ctx
</span><a href="#local-6989586621682435642"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-903"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputErrorOf"><span class="hs-identifier hs-type">SelectionOutputErrorOf</span></a></span><span> </span><span id="local-6989586621682435640"><span class="annot"><span class="annottext">SelectionOutputError ctx
</span><a href="#local-6989586621682435640"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-904"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionOutputError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionOutputError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputError"><span class="hs-identifier hs-var">verifySelectionOutputError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435646"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435645"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputError ctx
</span><a href="#local-6989586621682435640"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- Selection error verification: balance errors</span><span>
</span><span id="line-908"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-909"></span><span>
</span><span id="line-910"></span><span id="local-6989586621682436337"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionBalanceError"><span class="hs-identifier hs-type">verifySelectionBalanceError</span></a></span><span>
</span><span id="line-911"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436337"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-912"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionBalanceError"><span class="hs-identifier hs-type">SelectionBalanceError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436337"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436337"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-913"></span><span id="verifySelectionBalanceError"><span class="annot"><span class="annottext">verifySelectionBalanceError :: VerifySelectionError (SelectionBalanceError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionBalanceError"><span class="hs-identifier hs-var hs-var">verifySelectionBalanceError</span></a></span></span><span> </span><span id="local-6989586621682435638"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435638"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435637"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435637"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-914"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#BalanceInsufficient"><span class="hs-identifier hs-type">Balance.BalanceInsufficient</span></a></span><span> </span><span id="local-6989586621682435635"><span class="annot"><span class="annottext">BalanceInsufficientError
</span><a href="#local-6989586621682435635"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-915"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError BalanceInsufficientError ctx
forall ctx. VerifySelectionError BalanceInsufficientError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyBalanceInsufficientError"><span class="hs-identifier hs-var">verifyBalanceInsufficientError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435638"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435637"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">BalanceInsufficientError
</span><a href="#local-6989586621682435635"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-916"></span><span>    </span><span class="annot"><span class="annottext">SelectionBalanceError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#EmptyUTxO"><span class="hs-identifier hs-var">Balance.EmptyUTxO</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-917"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError () ctx
forall ctx. SelectionContext ctx =&gt; VerifySelectionError () ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmptyUTxOError"><span class="hs-identifier hs-var">verifyEmptyUTxOError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435638"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435637"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-918"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#UnableToConstructChange"><span class="hs-identifier hs-type">Balance.UnableToConstructChange</span></a></span><span> </span><span id="local-6989586621682435630"><span class="annot"><span class="annottext">UnableToConstructChangeError
</span><a href="#local-6989586621682435630"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError UnableToConstructChangeError ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError UnableToConstructChangeError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyUnableToConstructChangeError"><span class="hs-identifier hs-var">verifyUnableToConstructChangeError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435638"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435637"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">UnableToConstructChangeError
</span><a href="#local-6989586621682435630"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-920"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimitReached"><span class="hs-identifier hs-type">Balance.SelectionLimitReached</span></a></span><span> </span><span id="local-6989586621682435627"><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435627"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-921"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionLimitReachedError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionLimitReachedError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionLimitReachedError"><span class="hs-identifier hs-var">verifySelectionLimitReachedError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435638"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435637"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435627"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-922"></span><span>
</span><span id="line-923"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-924"></span><span class="hs-comment">-- Selection error verification: balance insufficient errors</span><span>
</span><span id="line-925"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifyBalanceInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyBalanceInsufficientError"><span class="hs-identifier hs-var">FailureToVerifyBalanceInsufficientError</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-928"></span><span>    </span><span id="FailureToVerifyBalanceInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyBalanceInsufficientError"><span class="hs-identifier hs-var">FailureToVerifyBalanceInsufficientError</span></a></span></span><span>
</span><span id="line-929"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AutxoBalanceAvailable%3AFailureToVerifyBalanceInsufficientError"><span class="annot"><span class="annottext">FailureToVerifyBalanceInsufficientError -&gt; TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AutxoBalanceAvailable%3AFailureToVerifyBalanceInsufficientError"><span class="hs-identifier hs-var hs-var">utxoBalanceAvailable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span>
</span><span id="line-930"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AutxoBalanceRequired%3AFailureToVerifyBalanceInsufficientError"><span class="annot"><span class="annottext">FailureToVerifyBalanceInsufficientError -&gt; TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AutxoBalanceRequired%3AFailureToVerifyBalanceInsufficientError"><span class="hs-identifier hs-var hs-var">utxoBalanceRequired</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span>
</span><span id="line-931"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-932"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435619"><span id="local-6989586621682435621"><span class="annot"><span class="annottext">FailureToVerifyBalanceInsufficientError
-&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool
(FailureToVerifyBalanceInsufficientError
 -&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool)
-&gt; (FailureToVerifyBalanceInsufficientError
    -&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool)
-&gt; Eq FailureToVerifyBalanceInsufficientError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifyBalanceInsufficientError
-&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool
$c/= :: FailureToVerifyBalanceInsufficientError
-&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool
== :: FailureToVerifyBalanceInsufficientError
-&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool
$c== :: FailureToVerifyBalanceInsufficientError
-&gt; FailureToVerifyBalanceInsufficientError -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435613"><span id="local-6989586621682435615"><span id="local-6989586621682435617"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifyBalanceInsufficientError -&gt; ShowS
[FailureToVerifyBalanceInsufficientError] -&gt; ShowS
FailureToVerifyBalanceInsufficientError -&gt; String
(Int -&gt; FailureToVerifyBalanceInsufficientError -&gt; ShowS)
-&gt; (FailureToVerifyBalanceInsufficientError -&gt; String)
-&gt; ([FailureToVerifyBalanceInsufficientError] -&gt; ShowS)
-&gt; Show FailureToVerifyBalanceInsufficientError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifyBalanceInsufficientError] -&gt; ShowS
$cshowList :: [FailureToVerifyBalanceInsufficientError] -&gt; ShowS
show :: FailureToVerifyBalanceInsufficientError -&gt; String
$cshow :: FailureToVerifyBalanceInsufficientError -&gt; String
showsPrec :: Int -&gt; FailureToVerifyBalanceInsufficientError -&gt; ShowS
$cshowsPrec :: Int -&gt; FailureToVerifyBalanceInsufficientError -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-933"></span><span>
</span><span id="line-934"></span><span id="local-6989586621682436332"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyBalanceInsufficientError"><span class="hs-identifier hs-type">verifyBalanceInsufficientError</span></a></span><span>
</span><span id="line-935"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#BalanceInsufficientError"><span class="hs-identifier hs-type">Balance.BalanceInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436332"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-936"></span><span id="verifyBalanceInsufficientError"><span class="annot"><span class="annottext">verifyBalanceInsufficientError :: VerifySelectionError BalanceInsufficientError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyBalanceInsufficientError"><span class="hs-identifier hs-var hs-var">verifyBalanceInsufficientError</span></a></span></span><span> </span><span id="local-6989586621682435612"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435612"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435611"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435611"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435610"><span class="annot"><span class="annottext">BalanceInsufficientError
</span><a href="#local-6989586621682435610"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-937"></span><span>    </span><span class="annot"><span class="annottext">[Bool]
-&gt; FailureToVerifyBalanceInsufficientError -&gt; VerificationResult
forall (f :: * -&gt; *) failureReason.
(Foldable f, Show failureReason) =&gt;
f Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyAll"><span class="hs-identifier hs-var">verifyAll</span></a></span><span>
</span><span id="line-938"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435609"><span class="hs-identifier hs-var">utxoBalanceRequired</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; TokenBundle -&gt; Bool
forall a. PartialOrd a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../lattices/html/src"><span class="hs-operator hs-var">`leq`</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435607"><span class="hs-identifier hs-var">utxoBalanceAvailable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-939"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionParamsOf [] ctx -&gt; Bool
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionParamsOf f ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#isUTxOBalanceSufficient"><span class="hs-identifier hs-var">Balance.isUTxOBalanceSufficient</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParamsOf [] ctx
</span><a href="#local-6989586621682435605"><span class="hs-identifier hs-var">balanceParams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-940"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>        </span><span class="annot"><span class="annottext">FailureToVerifyBalanceInsufficientError :: TokenBundle
-&gt; TokenBundle -&gt; FailureToVerifyBalanceInsufficientError
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyBalanceInsufficientError"><span class="hs-identifier hs-type">FailureToVerifyBalanceInsufficientError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">TokenBundle
utxoBalanceAvailable :: TokenBundle
utxoBalanceRequired :: TokenBundle
$sel:utxoBalanceRequired:FailureToVerifyBalanceInsufficientError :: TokenBundle
$sel:utxoBalanceAvailable:FailureToVerifyBalanceInsufficientError :: TokenBundle
</span><a href="#local-6989586621682435607"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-942"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-943"></span><span>    </span><span id="local-6989586621682435605"><span class="annot"><span class="annottext">balanceParams :: SelectionParamsOf [] ctx
</span><a href="#local-6989586621682435605"><span class="hs-identifier hs-var hs-var">balanceParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParamsOf [] ctx)
-&gt; SelectionParamsOf [] ctx
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints ctx, SelectionParamsOf [] ctx)
 -&gt; SelectionParamsOf [] ctx)
-&gt; (SelectionConstraints ctx, SelectionParamsOf [] ctx)
-&gt; SelectionParamsOf [] ctx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParamsOf [] ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435612"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435611"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>    </span><span id="local-6989586621682435607"><span class="annot"><span class="annottext">utxoBalanceAvailable :: TokenBundle
</span><a href="#local-6989586621682435607"><span class="hs-identifier hs-var hs-var">utxoBalanceAvailable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalanceInsufficientError
</span><a href="#local-6989586621682435610"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">BalanceInsufficientError
-&gt; ((TokenBundle -&gt; Const TokenBundle TokenBundle)
    -&gt; BalanceInsufficientError
    -&gt; Const TokenBundle BalanceInsufficientError)
-&gt; TokenBundle
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoBalanceAvailable&quot;
  ((TokenBundle -&gt; Const TokenBundle TokenBundle)
   -&gt; BalanceInsufficientError
   -&gt; Const TokenBundle BalanceInsufficientError)
(TokenBundle -&gt; Const TokenBundle TokenBundle)
-&gt; BalanceInsufficientError
-&gt; Const TokenBundle BalanceInsufficientError
</span><a href="#local-6989586621682435604"><span class="hs-var">#utxoBalanceAvailable</span></a></span><span>
</span><span id="line-945"></span><span>    </span><span id="local-6989586621682435609"><span class="annot"><span class="annottext">utxoBalanceRequired :: TokenBundle
</span><a href="#local-6989586621682435609"><span class="hs-identifier hs-var hs-var">utxoBalanceRequired</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalanceInsufficientError
</span><a href="#local-6989586621682435610"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">BalanceInsufficientError
-&gt; ((TokenBundle -&gt; Const TokenBundle TokenBundle)
    -&gt; BalanceInsufficientError
    -&gt; Const TokenBundle BalanceInsufficientError)
-&gt; TokenBundle
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoBalanceRequired&quot;
  ((TokenBundle -&gt; Const TokenBundle TokenBundle)
   -&gt; BalanceInsufficientError
   -&gt; Const TokenBundle BalanceInsufficientError)
(TokenBundle -&gt; Const TokenBundle TokenBundle)
-&gt; BalanceInsufficientError
-&gt; Const TokenBundle BalanceInsufficientError
</span><a href="#local-6989586621682435603"><span class="hs-var">#utxoBalanceRequired</span></a></span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-948"></span><span class="hs-comment">-- Selection error verification: empty UTxO errors</span><span>
</span><span id="line-949"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifyEmptyUTxOError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyEmptyUTxOError"><span class="hs-identifier hs-var">FailureToVerifyEmptyUTxOError</span></a></span></span><span> </span><span id="local-6989586621682436311"><span class="annot"><a href="#local-6989586621682436311"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailureToVerifyEmptyUTxOError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyEmptyUTxOError"><span class="hs-identifier hs-var">FailureToVerifyEmptyUTxOError</span></a></span></span><span>
</span><span id="line-952"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AutxoAvailableForInputs%3AFailureToVerifyEmptyUTxOError"><span class="annot"><span class="annottext">FailureToVerifyEmptyUTxOError u -&gt; UTxOSelection u
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AutxoAvailableForInputs%3AFailureToVerifyEmptyUTxOError"><span class="hs-identifier hs-var hs-var">utxoAvailableForInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html#UTxOSelection"><span class="hs-identifier hs-type">UTxOSelection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436311"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-953"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435597"><span id="local-6989586621682435599"><span class="annot"><span class="annottext">FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
(FailureToVerifyEmptyUTxOError u
 -&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool)
-&gt; (FailureToVerifyEmptyUTxOError u
    -&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool)
-&gt; Eq (FailureToVerifyEmptyUTxOError u)
forall u.
Eq u =&gt;
FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
$c/= :: forall u.
Eq u =&gt;
FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
== :: FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
$c== :: forall u.
Eq u =&gt;
FailureToVerifyEmptyUTxOError u
-&gt; FailureToVerifyEmptyUTxOError u -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435591"><span id="local-6989586621682435593"><span id="local-6989586621682435595"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifyEmptyUTxOError u -&gt; ShowS
[FailureToVerifyEmptyUTxOError u] -&gt; ShowS
FailureToVerifyEmptyUTxOError u -&gt; String
(Int -&gt; FailureToVerifyEmptyUTxOError u -&gt; ShowS)
-&gt; (FailureToVerifyEmptyUTxOError u -&gt; String)
-&gt; ([FailureToVerifyEmptyUTxOError u] -&gt; ShowS)
-&gt; Show (FailureToVerifyEmptyUTxOError u)
forall u. Show u =&gt; Int -&gt; FailureToVerifyEmptyUTxOError u -&gt; ShowS
forall u. Show u =&gt; [FailureToVerifyEmptyUTxOError u] -&gt; ShowS
forall u. Show u =&gt; FailureToVerifyEmptyUTxOError u -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifyEmptyUTxOError u] -&gt; ShowS
$cshowList :: forall u. Show u =&gt; [FailureToVerifyEmptyUTxOError u] -&gt; ShowS
show :: FailureToVerifyEmptyUTxOError u -&gt; String
$cshow :: forall u. Show u =&gt; FailureToVerifyEmptyUTxOError u -&gt; String
showsPrec :: Int -&gt; FailureToVerifyEmptyUTxOError u -&gt; ShowS
$cshowsPrec :: forall u. Show u =&gt; Int -&gt; FailureToVerifyEmptyUTxOError u -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-954"></span><span>
</span><span id="line-955"></span><span id="local-6989586621682436331"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmptyUTxOError"><span class="hs-identifier hs-type">verifyEmptyUTxOError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436331"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436331"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-956"></span><span id="verifyEmptyUTxOError"><span class="annot"><span class="annottext">verifyEmptyUTxOError :: VerifySelectionError () ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyEmptyUTxOError"><span class="hs-identifier hs-var hs-var">verifyEmptyUTxOError</span></a></span></span><span> </span><span id="local-6989586621682435590"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435590"><span class="hs-identifier hs-var">_cs</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621682435589"><span class="annot"><span class="annottext">UTxOSelection (UTxO ctx)
utxoAvailableForInputs :: UTxOSelection (UTxO ctx)
$sel:utxoAvailableForInputs:SelectionParams :: forall ctx. SelectionParams ctx -&gt; UTxOSelection (UTxO ctx)
</span><a href="#local-6989586621682435589"><span class="hs-identifier hs-var hs-var">utxoAvailableForInputs</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621682435588"><span class="annot"><span class="annottext">()
</span><a href="#local-6989586621682435588"><span class="hs-identifier hs-var">_e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-957"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifyEmptyUTxOError (UTxO ctx) -&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-958"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxOSelection (UTxO ctx)
</span><a href="#local-6989586621682435589"><span class="hs-identifier hs-var">utxoAvailableForInputs</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOSelection (UTxO ctx) -&gt; UTxOSelection (UTxO ctx) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOSelection (UTxO ctx)
forall u. UTxOSelection u
</span><a href="Cardano.Wallet.Primitive.Types.UTxOSelection.html#empty"><span class="hs-identifier hs-var">UTxOSelection.empty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifyEmptyUTxOError :: forall u. UTxOSelection u -&gt; FailureToVerifyEmptyUTxOError u
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyEmptyUTxOError"><span class="hs-identifier hs-type">FailureToVerifyEmptyUTxOError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">UTxOSelection (UTxO ctx)
utxoAvailableForInputs :: UTxOSelection (UTxO ctx)
$sel:utxoAvailableForInputs:FailureToVerifyEmptyUTxOError :: UTxOSelection (UTxO ctx)
</span><a href="#local-6989586621682435589"><span class="hs-identifier hs-var hs-var">utxoAvailableForInputs</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-960"></span><span>
</span><span id="line-961"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- Selection error verification: insufficient minimum ada quantity errors</span><span>
</span><span id="line-963"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionOutputCoinInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputCoinInsufficientError</span></a></span></span><span> </span><span id="local-6989586621682436303"><span class="annot"><a href="#local-6989586621682436303"><span class="hs-identifier hs-type">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-966"></span><span>    </span><span id="FailureToVerifySelectionOutputCoinInsufficientError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputCoinInsufficientError</span></a></span></span><span>
</span><span id="line-967"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AreportedOutput%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; (address, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AreportedOutput%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">reportedOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436303"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AreportedMinCoinValue%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinInsufficientError address -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AreportedMinCoinValue%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">reportedMinCoinValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-969"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AverifiedMinCoinValue%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinInsufficientError address -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AverifiedMinCoinValue%3AFailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">verifiedMinCoinValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-970"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-971"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435579"><span id="local-6989586621682435581"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
(FailureToVerifySelectionOutputCoinInsufficientError address
 -&gt; FailureToVerifySelectionOutputCoinInsufficientError address
 -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputCoinInsufficientError address
    -&gt; FailureToVerifySelectionOutputCoinInsufficientError address
    -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionOutputCoinInsufficientError address)
forall address.
Eq address =&gt;
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
$c/= :: forall address.
Eq address =&gt;
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
== :: FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
$c== :: forall address.
Eq address =&gt;
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435573"><span id="local-6989586621682435575"><span id="local-6989586621682435577"><span class="annot"><span class="annottext">Int
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; ShowS
[FailureToVerifySelectionOutputCoinInsufficientError address]
-&gt; ShowS
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; String
(Int
 -&gt; FailureToVerifySelectionOutputCoinInsufficientError address
 -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputCoinInsufficientError address
    -&gt; String)
-&gt; ([FailureToVerifySelectionOutputCoinInsufficientError address]
    -&gt; ShowS)
-&gt; Show
     (FailureToVerifySelectionOutputCoinInsufficientError address)
forall address.
Show address =&gt;
Int
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; ShowS
forall address.
Show address =&gt;
[FailureToVerifySelectionOutputCoinInsufficientError address]
-&gt; ShowS
forall address.
Show address =&gt;
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputCoinInsufficientError address]
-&gt; ShowS
$cshowList :: forall address.
Show address =&gt;
[FailureToVerifySelectionOutputCoinInsufficientError address]
-&gt; ShowS
show :: FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; String
$cshow :: forall address.
Show address =&gt;
FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; String
showsPrec :: Int
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; ShowS
$cshowsPrec :: forall address.
Show address =&gt;
Int
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
-&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>
</span><span id="line-973"></span><span id="local-6989586621682436256"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">verifySelectionOutputCoinInsufficientError</span></a></span><span>
</span><span id="line-974"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436256"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-975"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436256"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436256"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-976"></span><span id="verifySelectionOutputCoinInsufficientError"><span class="annot"><span class="annottext">verifySelectionOutputCoinInsufficientError :: VerifySelectionError (SelectionOutputCoinInsufficientError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var hs-var">verifySelectionOutputCoinInsufficientError</span></a></span></span><span> </span><span id="local-6989586621682435571"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435571"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435570"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435570"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435569"><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435569"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-977"></span><span>    </span><span class="annot"><span class="annottext">[Bool]
-&gt; FailureToVerifySelectionOutputCoinInsufficientError
     (Address ctx)
-&gt; VerificationResult
forall (f :: * -&gt; *) failureReason.
(Foldable f, Show failureReason) =&gt;
f Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyAll"><span class="hs-identifier hs-var">verifyAll</span></a></span><span>
</span><span id="line-978"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435568"><span class="hs-identifier hs-var">isBelowMinimum</span></a></span><span>
</span><span id="line-979"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435567"><span class="hs-identifier hs-var">reportedMinCoinValue</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435566"><span class="hs-identifier hs-var">verifiedMinCoinValue</span></a></span><span>
</span><span id="line-980"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435567"><span class="hs-identifier hs-var">reportedMinCoinValue</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-identifier hs-var">reportedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; TokenBundle -&gt; Const Coin TokenBundle)
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;coin&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; TokenBundle -&gt; Const Coin TokenBundle)
(Coin -&gt; Const Coin Coin) -&gt; TokenBundle -&gt; Const Coin TokenBundle
</span><a href="#local-6989586621682435563"><span class="hs-var">#coin</span></a></span><span>
</span><span id="line-981"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-982"></span><span>        </span><span class="annot"><span class="annottext">FailureToVerifySelectionOutputCoinInsufficientError :: forall address.
(address, TokenBundle)
-&gt; Coin
-&gt; Coin
-&gt; FailureToVerifySelectionOutputCoinInsufficientError address
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">FailureToVerifySelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
Coin
reportedOutput :: (Address ctx, TokenBundle)
verifiedMinCoinValue :: Coin
reportedMinCoinValue :: Coin
$sel:verifiedMinCoinValue:FailureToVerifySelectionOutputCoinInsufficientError :: Coin
$sel:reportedMinCoinValue:FailureToVerifySelectionOutputCoinInsufficientError :: Coin
$sel:reportedOutput:FailureToVerifySelectionOutputCoinInsufficientError :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-984"></span><span>    </span><span class="annot"><a href="#local-6989586621682435568"><span class="hs-identifier hs-type">isBelowMinimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-985"></span><span>    </span><span id="local-6989586621682435568"><span class="annot"><span class="annottext">isBelowMinimum :: Bool
</span><a href="#local-6989586621682435568"><span class="hs-identifier hs-var hs-var">isBelowMinimum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx -&gt; TokenBundle -&gt; Bool)
-&gt; (Address ctx, TokenBundle) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435571"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((Address ctx -&gt; TokenBundle -&gt; Bool)
     -&gt; Const
          (Address ctx -&gt; TokenBundle -&gt; Bool)
          (Address ctx -&gt; TokenBundle -&gt; Bool))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx))
-&gt; Address ctx
-&gt; TokenBundle
-&gt; Bool
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;isBelowMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenBundle -&gt; Bool)
    -&gt; Const
         (Address ctx -&gt; TokenBundle -&gt; Bool)
         (Address ctx -&gt; TokenBundle -&gt; Bool))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx))
((Address ctx -&gt; TokenBundle -&gt; Bool)
 -&gt; Const
      (Address ctx -&gt; TokenBundle -&gt; Bool)
      (Address ctx -&gt; TokenBundle -&gt; Bool))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435562"><span class="hs-var">#isBelowMinimumAdaQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-identifier hs-var">reportedOutput</span></a></span><span>
</span><span id="line-986"></span><span>
</span><span id="line-987"></span><span>    </span><span id="local-6989586621682435564"><span class="annot"><span class="annottext">reportedOutput :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-identifier hs-var hs-var">reportedOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435569"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; (((Address ctx, TokenBundle)
     -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
    -&gt; SelectionOutputCoinInsufficientError ctx
    -&gt; Const
         (Address ctx, TokenBundle)
         (SelectionOutputCoinInsufficientError ctx))
-&gt; (Address ctx, TokenBundle)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;output&quot;
  (((Address ctx, TokenBundle)
    -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
   -&gt; SelectionOutputCoinInsufficientError ctx
   -&gt; Const
        (Address ctx, TokenBundle)
        (SelectionOutputCoinInsufficientError ctx))
((Address ctx, TokenBundle)
 -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
-&gt; SelectionOutputCoinInsufficientError ctx
-&gt; Const
     (Address ctx, TokenBundle)
     (SelectionOutputCoinInsufficientError ctx)
</span><a href="#local-6989586621682435561"><span class="hs-var">#output</span></a></span><span>
</span><span id="line-988"></span><span>    </span><span id="local-6989586621682435567"><span class="annot"><span class="annottext">reportedMinCoinValue :: Coin
</span><a href="#local-6989586621682435567"><span class="hs-identifier hs-var hs-var">reportedMinCoinValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435569"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; SelectionOutputCoinInsufficientError ctx
    -&gt; Const Coin (SelectionOutputCoinInsufficientError ctx))
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;minimumExpectedCoin&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionOutputCoinInsufficientError ctx
   -&gt; Const Coin (SelectionOutputCoinInsufficientError ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionOutputCoinInsufficientError ctx
-&gt; Const Coin (SelectionOutputCoinInsufficientError ctx)
</span><a href="#local-6989586621682435560"><span class="hs-var">#minimumExpectedCoin</span></a></span><span>
</span><span id="line-989"></span><span>    </span><span id="local-6989586621682435566"><span class="annot"><span class="annottext">verifiedMinCoinValue :: Coin
</span><a href="#local-6989586621682435566"><span class="hs-identifier hs-var hs-var">verifiedMinCoinValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-990"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435571"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((Address ctx -&gt; TokenMap -&gt; Coin)
     -&gt; Const
          (Address ctx -&gt; TokenMap -&gt; Coin)
          (Address ctx -&gt; TokenMap -&gt; Coin))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
-&gt; Address ctx
-&gt; TokenMap
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenMap -&gt; Coin)
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin)
         (Address ctx -&gt; TokenMap -&gt; Coin))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
((Address ctx -&gt; TokenMap -&gt; Coin)
 -&gt; Const
      (Address ctx -&gt; TokenMap -&gt; Coin)
      (Address ctx -&gt; TokenMap -&gt; Coin))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435559"><span class="hs-var">#computeMinimumAdaQuantity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-991"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; Address ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-identifier hs-var">reportedOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-992"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435564"><span class="hs-identifier hs-var">reportedOutput</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((TokenMap -&gt; Const TokenMap TokenMap)
    -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
-&gt; TokenMap
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;tokens&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; TokenBundle -&gt; Const TokenMap TokenBundle
</span><a href="#local-6989586621682435558"><span class="hs-var">#tokens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-993"></span><span>
</span><span id="line-994"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-995"></span><span class="hs-comment">-- Selection error verification: selection limit errors</span><span>
</span><span id="line-996"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionLimitReachedError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var">FailureToVerifySelectionLimitReachedError</span></a></span></span><span> </span><span id="local-6989586621682436294"><span class="annot"><a href="#local-6989586621682436294"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-999"></span><span>    </span><span id="FailureToVerifySelectionLimitReachedError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var">FailureToVerifySelectionLimitReachedError</span></a></span></span><span>
</span><span id="line-1000"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AselectedInputs%3AFailureToVerifySelectionLimitReachedError"><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError u -&gt; [(u, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectedInputs%3AFailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var hs-var">selectedInputs</span></a></span></span><span>
</span><span id="line-1001"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436294"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1002"></span><span>            </span><span class="hs-comment">-- ^ The inputs that were actually selected.</span><span>
</span><span id="line-1003"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AselectedInputCount%3AFailureToVerifySelectionLimitReachedError"><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError u -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectedInputCount%3AFailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var hs-var">selectedInputCount</span></a></span></span><span>
</span><span id="line-1004"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1005"></span><span>            </span><span class="hs-comment">-- ^ The number of inputs that were actually selected.</span><span>
</span><span id="line-1006"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AselectionLimitOriginal%3AFailureToVerifySelectionLimitReachedError"><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError u -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectionLimitOriginal%3AFailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var hs-var">selectionLimitOriginal</span></a></span></span><span>
</span><span id="line-1007"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-1008"></span><span>            </span><span class="hs-comment">-- ^ The selection limit before accounting for collateral inputs.</span><span>
</span><span id="line-1009"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AselectionLimitAdjusted%3AFailureToVerifySelectionLimitReachedError"><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError u -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AselectionLimitAdjusted%3AFailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-var hs-var">selectionLimitAdjusted</span></a></span></span><span>
</span><span id="line-1010"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-1011"></span><span>            </span><span class="hs-comment">-- ^ The selection limit after accounting for collateral inputs.</span><span>
</span><span id="line-1012"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1013"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435549"><span id="local-6989586621682435551"><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
(FailureToVerifySelectionLimitReachedError u
 -&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool)
-&gt; (FailureToVerifySelectionLimitReachedError u
    -&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionLimitReachedError u)
forall u.
Eq u =&gt;
FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
$c/= :: forall u.
Eq u =&gt;
FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
== :: FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
$c== :: forall u.
Eq u =&gt;
FailureToVerifySelectionLimitReachedError u
-&gt; FailureToVerifySelectionLimitReachedError u -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435543"><span id="local-6989586621682435545"><span id="local-6989586621682435547"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionLimitReachedError u -&gt; ShowS
[FailureToVerifySelectionLimitReachedError u] -&gt; ShowS
FailureToVerifySelectionLimitReachedError u -&gt; String
(Int -&gt; FailureToVerifySelectionLimitReachedError u -&gt; ShowS)
-&gt; (FailureToVerifySelectionLimitReachedError u -&gt; String)
-&gt; ([FailureToVerifySelectionLimitReachedError u] -&gt; ShowS)
-&gt; Show (FailureToVerifySelectionLimitReachedError u)
forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionLimitReachedError u -&gt; ShowS
forall u.
Show u =&gt;
[FailureToVerifySelectionLimitReachedError u] -&gt; ShowS
forall u.
Show u =&gt;
FailureToVerifySelectionLimitReachedError u -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionLimitReachedError u] -&gt; ShowS
$cshowList :: forall u.
Show u =&gt;
[FailureToVerifySelectionLimitReachedError u] -&gt; ShowS
show :: FailureToVerifySelectionLimitReachedError u -&gt; String
$cshow :: forall u.
Show u =&gt;
FailureToVerifySelectionLimitReachedError u -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionLimitReachedError u -&gt; ShowS
$cshowsPrec :: forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionLimitReachedError u -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1014"></span><span>
</span><span id="line-1015"></span><span class="hs-comment">-- | Verifies a 'Balance.SelectionLimitReachedError'.</span><span>
</span><span id="line-1016"></span><span class="hs-comment">--</span><span>
</span><span id="line-1017"></span><span class="hs-comment">-- This function verifies that the number of the selected inputs is correct</span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- given the amount of space we expect to be reserved for collateral inputs.</span><span>
</span><span id="line-1019"></span><span class="hs-comment">--</span><span>
</span><span id="line-1020"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionLimitReachedError"><span class="hs-identifier hs-type">verifySelectionLimitReachedError</span></a></span><span>
</span><span id="line-1021"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436327"><span class="annot"><a href="#local-6989586621682436327"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436327"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1022"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimitReachedError"><span class="hs-identifier hs-type">Balance.SelectionLimitReachedError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436327"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436327"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1023"></span><span id="verifySelectionLimitReachedError"><span class="annot"><span class="annottext">verifySelectionLimitReachedError :: VerifySelectionError (SelectionLimitReachedError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionLimitReachedError"><span class="hs-identifier hs-var hs-var">verifySelectionLimitReachedError</span></a></span></span><span> </span><span id="local-6989586621682435542"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435542"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435541"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435541"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435540"><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435540"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1024"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionLimitReachedError (UTxO ctx)
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-1025"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; SelectionLimit
forall a. a -&gt; SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#MaximumInputLimit"><span class="hs-identifier hs-var">Balance.MaximumInputLimit</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435539"><span class="hs-identifier hs-var">selectedInputCount</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; SelectionLimit -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit
</span><a href="#local-6989586621682435538"><span class="hs-identifier hs-var">selectionLimitAdjusted</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1026"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionLimitReachedError :: forall u.
[(u, TokenBundle)]
-&gt; Int
-&gt; SelectionLimit
-&gt; SelectionLimit
-&gt; FailureToVerifySelectionLimitReachedError u
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionLimitReachedError"><span class="hs-identifier hs-type">FailureToVerifySelectionLimitReachedError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
[(UTxO ctx, TokenBundle)]
SelectionLimit
selectionLimitOriginal :: SelectionLimit
selectedInputs :: [(UTxO ctx, TokenBundle)]
selectionLimitAdjusted :: SelectionLimit
selectedInputCount :: Int
$sel:selectionLimitAdjusted:FailureToVerifySelectionLimitReachedError :: SelectionLimit
$sel:selectionLimitOriginal:FailureToVerifySelectionLimitReachedError :: SelectionLimit
$sel:selectedInputCount:FailureToVerifySelectionLimitReachedError :: Int
$sel:selectedInputs:FailureToVerifySelectionLimitReachedError :: [(UTxO ctx, TokenBundle)]
</span><a href="#local-6989586621682435536"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1028"></span><span>    </span><span class="annot"><a href="#local-6989586621682435537"><span class="hs-identifier hs-type">selectedInputs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436327"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1029"></span><span>    </span><span id="local-6989586621682435537"><span class="annot"><span class="annottext">selectedInputs :: [(UTxO ctx, TokenBundle)]
</span><a href="#local-6989586621682435537"><span class="hs-identifier hs-var hs-var">selectedInputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435540"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
-&gt; (([(UTxO ctx, TokenBundle)]
     -&gt; Const [(UTxO ctx, TokenBundle)] [(UTxO ctx, TokenBundle)])
    -&gt; SelectionLimitReachedError ctx
    -&gt; Const
         [(UTxO ctx, TokenBundle)] (SelectionLimitReachedError ctx))
-&gt; [(UTxO ctx, TokenBundle)]
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;inputsSelected&quot;
  (([(UTxO ctx, TokenBundle)]
    -&gt; Const [(UTxO ctx, TokenBundle)] [(UTxO ctx, TokenBundle)])
   -&gt; SelectionLimitReachedError ctx
   -&gt; Const
        [(UTxO ctx, TokenBundle)] (SelectionLimitReachedError ctx))
([(UTxO ctx, TokenBundle)]
 -&gt; Const [(UTxO ctx, TokenBundle)] [(UTxO ctx, TokenBundle)])
-&gt; SelectionLimitReachedError ctx
-&gt; Const [(UTxO ctx, TokenBundle)] (SelectionLimitReachedError ctx)
</span><a href="#local-6989586621682435535"><span class="hs-var">#inputsSelected</span></a></span><span>
</span><span id="line-1030"></span><span>
</span><span id="line-1031"></span><span>    </span><span class="annot"><a href="#local-6989586621682435539"><span class="hs-identifier hs-type">selectedInputCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1032"></span><span>    </span><span id="local-6989586621682435539"><span class="annot"><span class="annottext">selectedInputCount :: Int
</span><a href="#local-6989586621682435539"><span class="hs-identifier hs-var hs-var">selectedInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(UTxO ctx, TokenBundle)] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.length</span></a></span><span> </span><span class="annot"><span class="annottext">[(UTxO ctx, TokenBundle)]
</span><a href="#local-6989586621682435537"><span class="hs-identifier hs-var">selectedInputs</span></a></span><span>
</span><span id="line-1033"></span><span>
</span><span id="line-1034"></span><span>    </span><span class="annot"><a href="#local-6989586621682435538"><span class="hs-identifier hs-type">selectionLimitAdjusted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-1035"></span><span>    </span><span id="local-6989586621682435538"><span class="annot"><span class="annottext">selectionLimitAdjusted :: SelectionLimit
</span><a href="#local-6989586621682435538"><span class="hs-identifier hs-var hs-var">selectionLimitAdjusted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435542"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435541"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>        </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; ((SelectionConstraints ctx, SelectionParams ctx)
    -&gt; SelectionConstraints ctx)
-&gt; SelectionConstraints ctx
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-1037"></span><span>        </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (SelectionConstraints ctx
    -&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
  -&gt; Const
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeSelectionLimit&quot;
  ((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; Const
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
        (SelectionConstraints ctx))
(([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
-&gt; SelectionConstraints ctx
-&gt; Const
     ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435534"><span class="hs-var">#computeSelectionLimit</span></a></span><span>
</span><span id="line-1038"></span><span>        </span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; (([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; SelectionLimit)
-&gt; SelectionLimit
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Address ctx, TokenBundle)
 -&gt; [(Address ctx, TokenBundle)])
-&gt; NonEmpty (Address ctx, TokenBundle)
-&gt; [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435540"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
-&gt; ((NonEmpty (Address ctx, TokenBundle)
     -&gt; Const
          (NonEmpty (Address ctx, TokenBundle))
          (NonEmpty (Address ctx, TokenBundle)))
    -&gt; SelectionLimitReachedError ctx
    -&gt; Const
         (NonEmpty (Address ctx, TokenBundle))
         (SelectionLimitReachedError ctx))
-&gt; NonEmpty (Address ctx, TokenBundle)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputsToCover&quot;
  ((NonEmpty (Address ctx, TokenBundle)
    -&gt; Const
         (NonEmpty (Address ctx, TokenBundle))
         (NonEmpty (Address ctx, TokenBundle)))
   -&gt; SelectionLimitReachedError ctx
   -&gt; Const
        (NonEmpty (Address ctx, TokenBundle))
        (SelectionLimitReachedError ctx))
(NonEmpty (Address ctx, TokenBundle)
 -&gt; Const
      (NonEmpty (Address ctx, TokenBundle))
      (NonEmpty (Address ctx, TokenBundle)))
-&gt; SelectionLimitReachedError ctx
-&gt; Const
     (NonEmpty (Address ctx, TokenBundle))
     (SelectionLimitReachedError ctx)
</span><a href="#local-6989586621682435532"><span class="hs-var">#outputsToCover</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span>    </span><span class="annot"><a href="#local-6989586621682435536"><span class="hs-identifier hs-type">selectionLimitOriginal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-1041"></span><span>    </span><span id="local-6989586621682435536"><span class="annot"><span class="annottext">selectionLimitOriginal :: SelectionLimit
</span><a href="#local-6989586621682435536"><span class="hs-identifier hs-var hs-var">selectionLimitOriginal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435542"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1042"></span><span>        </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (SelectionConstraints ctx
    -&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
  -&gt; Const
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
       ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
 -&gt; SelectionConstraints ctx
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      (SelectionConstraints ctx))
-&gt; SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; SelectionLimit
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeSelectionLimit&quot;
  ((([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; Const
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
         ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
        (SelectionConstraints ctx))
(([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
 -&gt; Const
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
      ([(Address ctx, TokenBundle)] -&gt; SelectionLimit))
-&gt; SelectionConstraints ctx
-&gt; Const
     ([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435531"><span class="hs-var">#computeSelectionLimit</span></a></span><span>
</span><span id="line-1043"></span><span>        </span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; (([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
    -&gt; SelectionLimit)
-&gt; SelectionLimit
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; SelectionLimit)
-&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Address ctx, TokenBundle)
 -&gt; [(Address ctx, TokenBundle)])
-&gt; NonEmpty (Address ctx, TokenBundle)
-&gt; [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
</span><a href="#local-6989586621682435540"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimitReachedError ctx
-&gt; ((NonEmpty (Address ctx, TokenBundle)
     -&gt; Const
          (NonEmpty (Address ctx, TokenBundle))
          (NonEmpty (Address ctx, TokenBundle)))
    -&gt; SelectionLimitReachedError ctx
    -&gt; Const
         (NonEmpty (Address ctx, TokenBundle))
         (SelectionLimitReachedError ctx))
-&gt; NonEmpty (Address ctx, TokenBundle)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputsToCover&quot;
  ((NonEmpty (Address ctx, TokenBundle)
    -&gt; Const
         (NonEmpty (Address ctx, TokenBundle))
         (NonEmpty (Address ctx, TokenBundle)))
   -&gt; SelectionLimitReachedError ctx
   -&gt; Const
        (NonEmpty (Address ctx, TokenBundle))
        (SelectionLimitReachedError ctx))
(NonEmpty (Address ctx, TokenBundle)
 -&gt; Const
      (NonEmpty (Address ctx, TokenBundle))
      (NonEmpty (Address ctx, TokenBundle)))
-&gt; SelectionLimitReachedError ctx
-&gt; Const
     (NonEmpty (Address ctx, TokenBundle))
     (SelectionLimitReachedError ctx)
</span><a href="#local-6989586621682435530"><span class="hs-var">#outputsToCover</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1044"></span><span>
</span><span id="line-1045"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1046"></span><span class="hs-comment">-- Selection error verification: change construction errors</span><span>
</span><span id="line-1047"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifyUnableToConstructChangeError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-var">FailureToVerifyUnableToConstructChangeError</span></a></span></span><span> </span><span id="local-6989586621682436286"><span class="annot"><a href="#local-6989586621682436286"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1050"></span><span>    </span><span id="FailureToVerifyUnableToConstructChangeError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-var">FailureToVerifyUnableToConstructChangeError</span></a></span></span><span>
</span><span id="line-1051"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AerrorOriginal%3AFailureToVerifyUnableToConstructChangeError"><span class="annot"><span class="annottext">FailureToVerifyUnableToConstructChangeError ctx
-&gt; UnableToConstructChangeError
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AerrorOriginal%3AFailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-var hs-var">errorOriginal</span></a></span></span><span>
</span><span id="line-1052"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#UnableToConstructChangeError"><span class="hs-identifier hs-type">Balance.UnableToConstructChangeError</span></a></span><span>
</span><span id="line-1053"></span><span>            </span><span class="hs-comment">-- ^ The original error.</span><span>
</span><span id="line-1054"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AerrorWithMinimalConstraints%3AFailureToVerifyUnableToConstructChangeError"><span class="annot"><span class="annottext">FailureToVerifyUnableToConstructChangeError ctx
-&gt; SelectionError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AerrorWithMinimalConstraints%3AFailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-var hs-var">errorWithMinimalConstraints</span></a></span></span><span>
</span><span id="line-1055"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436286"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1056"></span><span>            </span><span class="hs-comment">-- ^ An error encountered when attempting to re-run the selection</span><span>
</span><span id="line-1057"></span><span>            </span><span class="hs-comment">-- process with minimal constraints.</span><span>
</span><span id="line-1058"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span id="local-6989586621682435522"><span id="local-6989586621682435524"><span id="local-6989586621682435526"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435526"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1061"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-type">FailureToVerifyUnableToConstructChangeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435526"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1062"></span><span id="local-6989586621682435515"><span id="local-6989586621682435517"><span id="local-6989586621682435519"><span id="local-6989586621682435521"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435521"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1063"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-type">FailureToVerifyUnableToConstructChangeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435521"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- | Verifies a 'Balance.UnableToConstructChangeError'.</span><span>
</span><span id="line-1066"></span><span class="hs-comment">--</span><span>
</span><span id="line-1067"></span><span class="hs-comment">-- This function verifies that it's possible to successfully re-run the</span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- selection process with exactly the same parameters /if/ we modify the</span><span>
</span><span id="line-1069"></span><span class="hs-comment">-- constraints to be minimal, where we have:</span><span>
</span><span id="line-1070"></span><span class="hs-comment">--</span><span>
</span><span id="line-1071"></span><span class="hs-comment">--   - a minimum cost function that always returns zero.</span><span>
</span><span id="line-1072"></span><span class="hs-comment">--   - a minimum ada quantity function that always returns zero.</span><span>
</span><span id="line-1073"></span><span class="hs-comment">--</span><span>
</span><span id="line-1074"></span><span class="hs-comment">-- Such an attempt should always succeed, since 'UnableToConstructChangeError'</span><span>
</span><span id="line-1075"></span><span class="hs-comment">-- should be returned if (and only if) the available UTxO balance:</span><span>
</span><span id="line-1076"></span><span class="hs-comment">--</span><span>
</span><span id="line-1077"></span><span class="hs-comment">--  - is sufficient to cover the desired total output balance; but</span><span>
</span><span id="line-1078"></span><span class="hs-comment">--</span><span>
</span><span id="line-1079"></span><span class="hs-comment">--  - is NOT sufficient to cover:</span><span>
</span><span id="line-1080"></span><span class="hs-comment">--</span><span>
</span><span id="line-1081"></span><span class="hs-comment">--      a. the minimum cost of the transaction;</span><span>
</span><span id="line-1082"></span><span class="hs-comment">--      b. the minimum ada quantities of generated change outputs.</span><span>
</span><span id="line-1083"></span><span class="hs-comment">--</span><span>
</span><span id="line-1084"></span><span class="hs-comment">-- If the available UTxO balance is not sufficient to cover the desired total</span><span>
</span><span id="line-1085"></span><span class="hs-comment">-- output balance, then 'performSelection' should explicitly indicate that the</span><span>
</span><span id="line-1086"></span><span class="hs-comment">-- balance is insufficient by returning a 'BalanceInsufficientError' instead.</span><span>
</span><span id="line-1087"></span><span class="hs-comment">--</span><span>
</span><span id="line-1088"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyUnableToConstructChangeError"><span class="hs-identifier hs-type">verifyUnableToConstructChangeError</span></a></span><span>
</span><span id="line-1089"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436329"><span class="annot"><a href="#local-6989586621682436329"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436329"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1090"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#UnableToConstructChangeError"><span class="hs-identifier hs-type">Balance.UnableToConstructChangeError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436329"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1091"></span><span id="verifyUnableToConstructChangeError"><span class="annot"><span class="annottext">verifyUnableToConstructChangeError :: VerifySelectionError UnableToConstructChangeError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyUnableToConstructChangeError"><span class="hs-identifier hs-var hs-var">verifyUnableToConstructChangeError</span></a></span></span><span> </span><span id="local-6989586621682435514"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435514"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435513"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435513"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435512"><span class="annot"><span class="annottext">UnableToConstructChangeError
</span><a href="#local-6989586621682435512"><span class="hs-identifier hs-var">errorOriginal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1092"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (SelectionError ctx) (Selection ctx)
</span><a href="#local-6989586621682435511"><span class="hs-identifier hs-var">resultWithMinimalConstraints</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1093"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682435510"><span class="annot"><span class="annottext">SelectionError ctx
</span><a href="#local-6989586621682435510"><span class="hs-identifier hs-var">errorWithMinimalConstraints</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1094"></span><span>            </span><span class="annot"><span class="annottext">FailureToVerifyUnableToConstructChangeError ctx
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verificationFailure"><span class="hs-identifier hs-var">verificationFailure</span></a></span><span>
</span><span id="line-1095"></span><span>            </span><span class="annot"><span class="annottext">FailureToVerifyUnableToConstructChangeError :: forall ctx.
UnableToConstructChangeError
-&gt; SelectionError ctx
-&gt; FailureToVerifyUnableToConstructChangeError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifyUnableToConstructChangeError"><span class="hs-identifier hs-type">FailureToVerifyUnableToConstructChangeError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">UnableToConstructChangeError
SelectionError ctx
errorWithMinimalConstraints :: SelectionError ctx
errorOriginal :: UnableToConstructChangeError
$sel:errorWithMinimalConstraints:FailureToVerifyUnableToConstructChangeError :: SelectionError ctx
$sel:errorOriginal:FailureToVerifyUnableToConstructChangeError :: UnableToConstructChangeError
</span><a href="#local-6989586621682435510"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1096"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1097"></span><span>            </span><span class="annot"><span class="annottext">VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#VerificationSuccess"><span class="hs-identifier hs-var">VerificationSuccess</span></a></span><span>
</span><span id="line-1098"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1099"></span><span>    </span><span class="hs-comment">-- The result of attempting to re-run the selection process with minimal</span><span>
</span><span id="line-1100"></span><span>    </span><span class="hs-comment">-- constraints, where we have:</span><span>
</span><span id="line-1101"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1102"></span><span>    </span><span class="hs-comment">--   - a minimum cost function that always returns zero.</span><span>
</span><span id="line-1103"></span><span>    </span><span class="hs-comment">--   - a minimum ada quantity function that always returns zero.</span><span>
</span><span id="line-1104"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-1105"></span><span>    </span><span class="annot"><a href="#local-6989586621682435511"><span class="hs-identifier hs-type">resultWithMinimalConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionError"><span class="hs-identifier hs-type">SelectionError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436329"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436329"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>    </span><span id="local-6989586621682435511"><span class="annot"><span class="annottext">resultWithMinimalConstraints :: Either (SelectionError ctx) (Selection ctx)
</span><a href="#local-6989586621682435511"><span class="hs-identifier hs-var hs-var">resultWithMinimalConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-comment">-- The 'performSelection' function requires a 'MonadRandom' context so</span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-comment">-- that it can select entries at random from the available UTxO set.</span><span>
</span><span id="line-1109"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1110"></span><span>        </span><span class="hs-comment">-- However, for this verification step, we don't actually require UTxO</span><span>
</span><span id="line-1111"></span><span>        </span><span class="hs-comment">-- selection to be random. We only require that the 'performSelection'</span><span>
</span><span id="line-1112"></span><span>        </span><span class="hs-comment">-- function is able to select some sequence of UTxOs that collectively</span><span>
</span><span id="line-1113"></span><span>        </span><span class="hs-comment">-- covers the desired output amount.</span><span>
</span><span id="line-1114"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1115"></span><span>        </span><span class="hs-comment">-- To satisfy the requirement to provide a 'MonadRandom' context, we use</span><span>
</span><span id="line-1116"></span><span>        </span><span class="hs-comment">-- the 'NonRandom' type, for which a 'MonadRandom' instance is provided.</span><span>
</span><span id="line-1117"></span><span>        </span><span class="hs-comment">-- This instance, when asked to provide a random value from within a</span><span>
</span><span id="line-1118"></span><span>        </span><span class="hs-comment">-- range of values, will always provide the same value.</span><span>
</span><span id="line-1119"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1120"></span><span>        </span><span class="hs-comment">-- This means that each internal step of 'performSelection' will select</span><span>
</span><span id="line-1121"></span><span>        </span><span class="hs-comment">-- a value from the same relative position of the leftover available</span><span>
</span><span id="line-1122"></span><span>        </span><span class="hs-comment">-- UTxO set. However, since selecting a UTxO entry removes it from the</span><span>
</span><span id="line-1123"></span><span>        </span><span class="hs-comment">-- leftover set, every subsequent step will select a different entry,</span><span>
</span><span id="line-1124"></span><span>        </span><span class="hs-comment">-- and thus the selection algorithm will always be able to make forward</span><span>
</span><span id="line-1125"></span><span>        </span><span class="hs-comment">-- progress.</span><span>
</span><span id="line-1126"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-1127"></span><span>        </span><span class="annot"><span class="annottext">NonRandom (Either (SelectionError ctx) (Selection ctx))
-&gt; Either (SelectionError ctx) (Selection ctx)
forall a. NonRandom a -&gt; a
</span><a href="Control.Monad.Random.Extra.html#runNonRandom"><span class="hs-identifier hs-var hs-var">runNonRandom</span></a></span><span> </span><span class="annot"><span class="annottext">(NonRandom (Either (SelectionError ctx) (Selection ctx))
 -&gt; Either (SelectionError ctx) (Selection ctx))
-&gt; NonRandom (Either (SelectionError ctx) (Selection ctx))
-&gt; Either (SelectionError ctx) (Selection ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT (SelectionError ctx) NonRandom (Selection ctx)
-&gt; NonRandom (Either (SelectionError ctx) (Selection ctx))
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT (SelectionError ctx) NonRandom (Selection ctx)
 -&gt; NonRandom (Either (SelectionError ctx) (Selection ctx)))
-&gt; ExceptT (SelectionError ctx) NonRandom (Selection ctx)
-&gt; NonRandom (Either (SelectionError ctx) (Selection ctx))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PerformSelection NonRandom ctx (Selection ctx)
forall (m :: * -&gt; *) ctx.
(HasCallStack, MonadRandom m, SelectionContext ctx) =&gt;
PerformSelection m ctx (Selection ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#performSelection"><span class="hs-identifier hs-var">performSelection</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435508"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435513"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-1128"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1129"></span><span>        </span><span class="hs-comment">-- A modified set of constraints that should always allow the</span><span>
</span><span id="line-1130"></span><span>        </span><span class="hs-comment">-- successful creation of a selection:</span><span>
</span><span id="line-1131"></span><span>        </span><span id="local-6989586621682435508"><span class="annot"><span class="annottext">cs' :: SelectionConstraints ctx
</span><a href="#local-6989586621682435508"><span class="hs-identifier hs-var hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435514"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1132"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:computeMinimumAdaQuantity:SelectionConstraints :: Address ctx -&gt; TokenMap -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeMinimumAdaQuantity%3ASelectionConstraints"><span class="hs-identifier hs-var">computeMinimumAdaQuantity</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TokenMap -&gt; Coin) -&gt; Address ctx -&gt; TokenMap -&gt; Coin
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">((TokenMap -&gt; Coin) -&gt; Address ctx -&gt; TokenMap -&gt; Coin)
-&gt; (TokenMap -&gt; Coin) -&gt; Address ctx -&gt; TokenMap -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; TokenMap -&gt; Coin
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; TokenMap -&gt; Coin) -&gt; Coin -&gt; TokenMap -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1133"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:computeMinimumCost:SelectionConstraints :: SelectionSkeleton ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeMinimumCost%3ASelectionConstraints"><span class="hs-identifier hs-var">computeMinimumCost</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Coin -&gt; SelectionSkeleton ctx -&gt; Coin
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; SelectionSkeleton ctx -&gt; Coin)
-&gt; Coin -&gt; SelectionSkeleton ctx -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1134"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:computeSelectionLimit:SelectionConstraints :: [(Address ctx, TokenBundle)] -&gt; SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AcomputeSelectionLimit%3ASelectionConstraints"><span class="hs-identifier hs-var">computeSelectionLimit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; [(Address ctx, TokenBundle)] -&gt; SelectionLimit
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit
forall a. SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#NoLimit"><span class="hs-identifier hs-var">Balance.NoLimit</span></a></span><span>
</span><span id="line-1135"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-1136"></span><span>
</span><span id="line-1137"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1138"></span><span class="hs-comment">-- Selection error verification: collateral errors</span><span>
</span><span id="line-1139"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1140"></span><span>
</span><span id="line-1141"></span><span class="hs-keyword">data</span><span> </span><span id="FailureToVerifySelectionCollateralError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralError</span></a></span></span><span> </span><span id="local-6989586621682436266"><span class="annot"><a href="#local-6989586621682436266"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1142"></span><span>    </span><span id="FailureToVerifySelectionCollateralError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var">FailureToVerifySelectionCollateralError</span></a></span></span><span>
</span><span id="line-1143"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AlargestCombination%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Map u Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AlargestCombination%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">largestCombination</span></a></span></span><span>
</span><span id="line-1144"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436266"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1145"></span><span>            </span><span class="hs-comment">-- ^ The largest available UTxO combination reported.</span><span>
</span><span id="line-1146"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AlargestCombinationValue%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AlargestCombinationValue%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">largestCombinationValue</span></a></span></span><span>
</span><span id="line-1147"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1148"></span><span>            </span><span class="hs-comment">-- ^ The total balance of the largest available UTxO combination.</span><span>
</span><span id="line-1149"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AlargestCombinationSize%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AlargestCombinationSize%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">largestCombinationSize</span></a></span></span><span>
</span><span id="line-1150"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1151"></span><span>            </span><span class="hs-comment">-- ^ The size of the largest available UTxO combination.</span><span>
</span><span id="line-1152"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AlargestCombinationUnsuitableSubset%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Map u Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AlargestCombinationUnsuitableSubset%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">largestCombinationUnsuitableSubset</span></a></span></span><span>
</span><span id="line-1153"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436266"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1154"></span><span>            </span><span class="hs-comment">-- ^ The subset of UTxOs in the largest available combination that</span><span>
</span><span id="line-1155"></span><span>            </span><span class="hs-comment">-- are not suitable for use as collateral.</span><span>
</span><span id="line-1156"></span><span>            </span><span class="hs-comment">--</span><span>
</span><span id="line-1157"></span><span>            </span><span class="hs-comment">-- UTxOs that are not suitable for collateral should never be made</span><span>
</span><span id="line-1158"></span><span>            </span><span class="hs-comment">-- available to the collateral selection algorithm, and should</span><span>
</span><span id="line-1159"></span><span>            </span><span class="hs-comment">-- therefore never be included in any error reported by the</span><span>
</span><span id="line-1160"></span><span>            </span><span class="hs-comment">-- collateral selection algorithm.</span><span>
</span><span id="line-1161"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AmaximumSelectionSize%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Int
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AmaximumSelectionSize%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">maximumSelectionSize</span></a></span></span><span>
</span><span id="line-1162"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1163"></span><span>            </span><span class="hs-comment">-- ^ The maximum number of entries permitted in the largest</span><span>
</span><span id="line-1164"></span><span>            </span><span class="hs-comment">-- combination, determined by the maximum allowable number of</span><span>
</span><span id="line-1165"></span><span>            </span><span class="hs-comment">-- collateral inputs.</span><span>
</span><span id="line-1166"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AminimumSelectionAmount%3AFailureToVerifySelectionCollateralError"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumSelectionAmount%3AFailureToVerifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">minimumSelectionAmount</span></a></span></span><span>
</span><span id="line-1167"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1168"></span><span>            </span><span class="hs-comment">-- ^ The reported minimum selection amount.</span><span>
</span><span id="line-1169"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1170"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435494"><span id="local-6989586621682435496"><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
(FailureToVerifySelectionCollateralError u
 -&gt; FailureToVerifySelectionCollateralError u -&gt; Bool)
-&gt; (FailureToVerifySelectionCollateralError u
    -&gt; FailureToVerifySelectionCollateralError u -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionCollateralError u)
forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
$c/= :: forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
== :: FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
$c== :: forall u.
Eq u =&gt;
FailureToVerifySelectionCollateralError u
-&gt; FailureToVerifySelectionCollateralError u -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435488"><span id="local-6989586621682435490"><span id="local-6989586621682435492"><span class="annot"><span class="annottext">Int -&gt; FailureToVerifySelectionCollateralError u -&gt; ShowS
[FailureToVerifySelectionCollateralError u] -&gt; ShowS
FailureToVerifySelectionCollateralError u -&gt; String
(Int -&gt; FailureToVerifySelectionCollateralError u -&gt; ShowS)
-&gt; (FailureToVerifySelectionCollateralError u -&gt; String)
-&gt; ([FailureToVerifySelectionCollateralError u] -&gt; ShowS)
-&gt; Show (FailureToVerifySelectionCollateralError u)
forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionCollateralError u -&gt; ShowS
forall u.
Show u =&gt;
[FailureToVerifySelectionCollateralError u] -&gt; ShowS
forall u.
Show u =&gt;
FailureToVerifySelectionCollateralError u -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionCollateralError u] -&gt; ShowS
$cshowList :: forall u.
Show u =&gt;
[FailureToVerifySelectionCollateralError u] -&gt; ShowS
show :: FailureToVerifySelectionCollateralError u -&gt; String
$cshow :: forall u.
Show u =&gt;
FailureToVerifySelectionCollateralError u -&gt; String
showsPrec :: Int -&gt; FailureToVerifySelectionCollateralError u -&gt; ShowS
$cshowsPrec :: forall u.
Show u =&gt;
Int -&gt; FailureToVerifySelectionCollateralError u -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1171"></span><span>
</span><span id="line-1172"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralError"><span class="hs-identifier hs-type">verifySelectionCollateralError</span></a></span><span>
</span><span id="line-1173"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436336"><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1174"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralError"><span class="hs-identifier hs-type">SelectionCollateralError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1175"></span><span id="verifySelectionCollateralError"><span class="annot"><span class="annottext">verifySelectionCollateralError :: VerifySelectionError (SelectionCollateralError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionCollateralError"><span class="hs-identifier hs-var hs-var">verifySelectionCollateralError</span></a></span></span><span> </span><span id="local-6989586621682435487"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435487"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435486"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435486"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621682435485"><span class="annot"><span class="annottext">SelectionCollateralError ctx
</span><a href="#local-6989586621682435485"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1176"></span><span>    </span><span class="annot"><span class="annottext">[Bool]
-&gt; FailureToVerifySelectionCollateralError (UTxO ctx)
-&gt; VerificationResult
forall (f :: * -&gt; *) failureReason.
(Foldable f, Show failureReason) =&gt;
f Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyAll"><span class="hs-identifier hs-var">verifyAll</span></a></span><span>
</span><span id="line-1177"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Bool
forall k a. Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.null</span></a></span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435483"><span class="hs-identifier hs-var">largestCombinationUnsuitableSubset</span></a></span><span>
</span><span id="line-1178"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435482"><span class="hs-identifier hs-var">largestCombinationSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435481"><span class="hs-identifier hs-var">maximumSelectionSize</span></a></span><span>
</span><span id="line-1179"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435480"><span class="hs-identifier hs-var">largestCombinationValue</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435479"><span class="hs-identifier hs-var">minimumSelectionAmount</span></a></span><span>
</span><span id="line-1180"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1181"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionCollateralError :: forall u.
Map u Coin
-&gt; Coin
-&gt; Int
-&gt; Map u Coin
-&gt; Int
-&gt; Coin
-&gt; FailureToVerifySelectionCollateralError u
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionCollateralError"><span class="hs-identifier hs-type">FailureToVerifySelectionCollateralError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Int
Map (UTxO ctx) Coin
Coin
largestCombination :: Map (UTxO ctx) Coin
minimumSelectionAmount :: Coin
largestCombinationValue :: Coin
maximumSelectionSize :: Int
largestCombinationSize :: Int
largestCombinationUnsuitableSubset :: Map (UTxO ctx) Coin
$sel:minimumSelectionAmount:FailureToVerifySelectionCollateralError :: Coin
$sel:maximumSelectionSize:FailureToVerifySelectionCollateralError :: Int
$sel:largestCombinationUnsuitableSubset:FailureToVerifySelectionCollateralError :: Map (UTxO ctx) Coin
$sel:largestCombinationSize:FailureToVerifySelectionCollateralError :: Int
$sel:largestCombinationValue:FailureToVerifySelectionCollateralError :: Coin
$sel:largestCombination:FailureToVerifySelectionCollateralError :: Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435478"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1182"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1183"></span><span>    </span><span class="annot"><a href="#local-6989586621682435478"><span class="hs-identifier hs-type">largestCombination</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1184"></span><span>    </span><span id="local-6989586621682435478"><span class="annot"><span class="annottext">largestCombination :: Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435478"><span class="hs-identifier hs-var hs-var">largestCombination</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError ctx
</span><a href="#local-6989586621682435485"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError ctx
-&gt; ((Map (UTxO ctx) Coin
     -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
    -&gt; SelectionCollateralError ctx
    -&gt; Const (Map (UTxO ctx) Coin) (SelectionCollateralError ctx))
-&gt; Map (UTxO ctx) Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;largestCombinationAvailable&quot;
  ((Map (UTxO ctx) Coin
    -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
   -&gt; SelectionCollateralError ctx
   -&gt; Const (Map (UTxO ctx) Coin) (SelectionCollateralError ctx))
(Map (UTxO ctx) Coin
 -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
-&gt; SelectionCollateralError ctx
-&gt; Const (Map (UTxO ctx) Coin) (SelectionCollateralError ctx)
</span><a href="#local-6989586621682435477"><span class="hs-var">#largestCombinationAvailable</span></a></span><span>
</span><span id="line-1185"></span><span>    </span><span class="annot"><a href="#local-6989586621682435482"><span class="hs-identifier hs-type">largestCombinationSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1186"></span><span>    </span><span id="local-6989586621682435482"><span class="annot"><span class="annottext">largestCombinationSize :: Int
</span><a href="#local-6989586621682435482"><span class="hs-identifier hs-var hs-var">largestCombinationSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Int
forall k a. Map k a -&gt; Int
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.size</span></a></span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435478"><span class="hs-identifier hs-var">largestCombination</span></a></span><span>
</span><span id="line-1187"></span><span>    </span><span class="annot"><a href="#local-6989586621682435480"><span class="hs-identifier hs-type">largestCombinationValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1188"></span><span>    </span><span id="local-6989586621682435480"><span class="annot"><span class="annottext">largestCombinationValue :: Coin
</span><a href="#local-6989586621682435480"><span class="hs-identifier hs-var hs-var">largestCombinationValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Coin
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.fold</span></a></span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435478"><span class="hs-identifier hs-var">largestCombination</span></a></span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span>    </span><span class="annot"><a href="#local-6989586621682435483"><span class="hs-identifier hs-type">largestCombinationUnsuitableSubset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#UTxO"><span class="hs-identifier hs-type">UTxO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436336"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1191"></span><span>    </span><span id="local-6989586621682435483"><span class="annot"><span class="annottext">largestCombinationUnsuitableSubset :: Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435483"><span class="hs-identifier hs-var hs-var">largestCombinationUnsuitableSubset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Set (UTxO ctx) -&gt; Map (UTxO ctx) Coin
forall k a. Ord k =&gt; Map k a -&gt; Set k -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.withoutKeys</span></a></span><span>
</span><span id="line-1192"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin
</span><a href="#local-6989586621682435478"><span class="hs-identifier hs-var">largestCombination</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (UTxO ctx) Coin -&gt; Set (UTxO ctx)
forall k a. Map k a -&gt; Set k
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.keysSet</span></a></span><span> </span><span class="annot"><span class="annottext">(Map (UTxO ctx) Coin -&gt; Set (UTxO ctx))
-&gt; Map (UTxO ctx) Coin -&gt; Set (UTxO ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435486"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
-&gt; ((Map (UTxO ctx) Coin
     -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
    -&gt; SelectionParams ctx
    -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
-&gt; Map (UTxO ctx) Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;utxoAvailableForCollateral&quot;
  ((Map (UTxO ctx) Coin
    -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
   -&gt; SelectionParams ctx
   -&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx))
(Map (UTxO ctx) Coin
 -&gt; Const (Map (UTxO ctx) Coin) (Map (UTxO ctx) Coin))
-&gt; SelectionParams ctx
-&gt; Const (Map (UTxO ctx) Coin) (SelectionParams ctx)
</span><a href="#local-6989586621682435472"><span class="hs-var">#utxoAvailableForCollateral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1194"></span><span>
</span><span id="line-1195"></span><span>    </span><span class="annot"><a href="#local-6989586621682435481"><span class="hs-identifier hs-type">maximumSelectionSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-1196"></span><span>    </span><span id="local-6989586621682435481"><span class="annot"><span class="annottext">maximumSelectionSize :: Int
</span><a href="#local-6989586621682435481"><span class="hs-identifier hs-var hs-var">maximumSelectionSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435487"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; ((Int -&gt; Const Int Int)
    -&gt; SelectionConstraints ctx
    -&gt; Const Int (SelectionConstraints ctx))
-&gt; Int
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;maximumCollateralInputCount&quot;
  ((Int -&gt; Const Int Int)
   -&gt; SelectionConstraints ctx
   -&gt; Const Int (SelectionConstraints ctx))
(Int -&gt; Const Int Int)
-&gt; SelectionConstraints ctx -&gt; Const Int (SelectionConstraints ctx)
</span><a href="#local-6989586621682435471"><span class="hs-var">#maximumCollateralInputCount</span></a></span><span>
</span><span id="line-1197"></span><span>    </span><span class="annot"><a href="#local-6989586621682435479"><span class="hs-identifier hs-type">minimumSelectionAmount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1198"></span><span>    </span><span id="local-6989586621682435479"><span class="annot"><span class="annottext">minimumSelectionAmount :: Coin
</span><a href="#local-6989586621682435479"><span class="hs-identifier hs-var hs-var">minimumSelectionAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError ctx
</span><a href="#local-6989586621682435485"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionCollateralError ctx
-&gt; ((Coin -&gt; Const Coin Coin)
    -&gt; SelectionCollateralError ctx
    -&gt; Const Coin (SelectionCollateralError ctx))
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;minimumSelectionAmount&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionCollateralError ctx
   -&gt; Const Coin (SelectionCollateralError ctx))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionCollateralError ctx
-&gt; Const Coin (SelectionCollateralError ctx)
</span><a href="#local-6989586621682435470"><span class="hs-var">#minimumSelectionAmount</span></a></span><span>
</span><span id="line-1199"></span><span>
</span><span id="line-1200"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1201"></span><span class="hs-comment">-- Selection error verification: output errors</span><span>
</span><span id="line-1202"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1203"></span><span>
</span><span id="line-1204"></span><span id="local-6989586621682436335"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputError"><span class="hs-identifier hs-type">verifySelectionOutputError</span></a></span><span>
</span><span id="line-1205"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436335"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1206"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-type">SelectionOutputError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436335"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436335"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-1207"></span><span id="verifySelectionOutputError"><span class="annot"><span class="annottext">verifySelectionOutputError :: VerifySelectionError (SelectionOutputError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputError"><span class="hs-identifier hs-var hs-var">verifySelectionOutputError</span></a></span></span><span> </span><span id="local-6989586621682435469"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435469"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435468"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435468"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1208"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficient"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficient</span></a></span><span> </span><span id="local-6989586621682435466"><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435466"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1209"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionOutputCoinInsufficientError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionOutputCoinInsufficientError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputCoinInsufficientError"><span class="hs-identifier hs-var">verifySelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435469"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435468"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435466"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1210"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimit"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimit</span></a></span><span> </span><span id="local-6989586621682435464"><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435464"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1211"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError (SelectionOutputSizeExceedsLimitError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError (SelectionOutputSizeExceedsLimitError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">verifySelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435469"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435468"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435464"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1212"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimit"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimit</span></a></span><span> </span><span id="local-6989586621682435461"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435461"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1213"></span><span>        </span><span class="annot"><span class="annottext">VerifySelectionError
  (SelectionOutputTokenQuantityExceedsLimitError ctx) ctx
forall ctx.
SelectionContext ctx =&gt;
VerifySelectionError
  (SelectionOutputTokenQuantityExceedsLimitError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">verifySelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435469"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435468"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435461"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1214"></span><span>
</span><span id="line-1215"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1216"></span><span class="hs-comment">-- Selection error verification: output size errors</span><span>
</span><span id="line-1217"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1218"></span><span>
</span><span id="line-1219"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifySelectionOutputSizeExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputSizeExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682436248"><span class="annot"><a href="#local-6989586621682436248"><span class="hs-identifier hs-type">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1220"></span><span>    </span><span id="FailureToVerifySelectionOutputSizeExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputSizeExceedsLimitError</span></a></span></span><span>
</span><span id="line-1221"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AoutputReportedAsExceedingLimit%3AFailureToVerifySelectionOutputSizeExceedsLimitError"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; (address, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AoutputReportedAsExceedingLimit%3AFailureToVerifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var hs-var">outputReportedAsExceedingLimit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436248"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1222"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435454"><span id="local-6989586621682435456"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
(FailureToVerifySelectionOutputSizeExceedsLimitError address
 -&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
 -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputSizeExceedsLimitError address
    -&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
    -&gt; Bool)
-&gt; Eq (FailureToVerifySelectionOutputSizeExceedsLimitError address)
forall address.
Eq address =&gt;
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
$c/= :: forall address.
Eq address =&gt;
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
== :: FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
$c== :: forall address.
Eq address =&gt;
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435448"><span id="local-6989586621682435450"><span id="local-6989586621682435452"><span class="annot"><span class="annottext">Int
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; ShowS
[FailureToVerifySelectionOutputSizeExceedsLimitError address]
-&gt; ShowS
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; String
(Int
 -&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
 -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputSizeExceedsLimitError address
    -&gt; String)
-&gt; ([FailureToVerifySelectionOutputSizeExceedsLimitError address]
    -&gt; ShowS)
-&gt; Show
     (FailureToVerifySelectionOutputSizeExceedsLimitError address)
forall address.
Show address =&gt;
Int
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; ShowS
forall address.
Show address =&gt;
[FailureToVerifySelectionOutputSizeExceedsLimitError address]
-&gt; ShowS
forall address.
Show address =&gt;
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputSizeExceedsLimitError address]
-&gt; ShowS
$cshowList :: forall address.
Show address =&gt;
[FailureToVerifySelectionOutputSizeExceedsLimitError address]
-&gt; ShowS
show :: FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; String
$cshow :: forall address.
Show address =&gt;
FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; String
showsPrec :: Int
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; ShowS
$cshowsPrec :: forall address.
Show address =&gt;
Int
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
-&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1223"></span><span>
</span><span id="line-1224"></span><span id="local-6989586621682436255"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">verifySelectionOutputSizeExceedsLimitError</span></a></span><span>
</span><span id="line-1225"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436255"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1226"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436255"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436255"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-1227"></span><span id="verifySelectionOutputSizeExceedsLimitError"><span class="annot"><span class="annottext">verifySelectionOutputSizeExceedsLimitError :: VerifySelectionError (SelectionOutputSizeExceedsLimitError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var hs-var">verifySelectionOutputSizeExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682435447"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435447"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435446"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435446"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435445"><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435445"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1228"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError
     (Address ctx)
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-1229"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435444"><span class="hs-identifier hs-var">isWithinLimit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1230"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FailureToVerifySelectionOutputSizeExceedsLimitError :: forall address.
(address, TokenBundle)
-&gt; FailureToVerifySelectionOutputSizeExceedsLimitError address
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">FailureToVerifySelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
outputReportedAsExceedingLimit :: (Address ctx, TokenBundle)
$sel:outputReportedAsExceedingLimit:FailureToVerifySelectionOutputSizeExceedsLimitError :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435443"><span class="hs-glyph hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1231"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1232"></span><span>    </span><span id="local-6989586621682435444"><span class="annot"><span class="annottext">isWithinLimit :: Bool
</span><a href="#local-6989586621682435444"><span class="hs-identifier hs-var hs-var">isWithinLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435447"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((TokenBundle -&gt; TokenBundleSizeAssessment)
     -&gt; Const
          (TokenBundle -&gt; TokenBundleSizeAssessment)
          (TokenBundle -&gt; TokenBundleSizeAssessment))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (TokenBundle -&gt; TokenBundleSizeAssessment)
         (SelectionConstraints ctx))
-&gt; TokenBundle
-&gt; TokenBundleSizeAssessment
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assessTokenBundleSize&quot;
  (((TokenBundle -&gt; TokenBundleSizeAssessment)
    -&gt; Const
         (TokenBundle -&gt; TokenBundleSizeAssessment)
         (TokenBundle -&gt; TokenBundleSizeAssessment))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (TokenBundle -&gt; TokenBundleSizeAssessment)
        (SelectionConstraints ctx))
((TokenBundle -&gt; TokenBundleSizeAssessment)
 -&gt; Const
      (TokenBundle -&gt; TokenBundleSizeAssessment)
      (TokenBundle -&gt; TokenBundleSizeAssessment))
-&gt; SelectionConstraints ctx
-&gt; Const
     (TokenBundle -&gt; TokenBundleSizeAssessment)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435442"><span class="hs-var">#assessTokenBundleSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435441"><span class="hs-identifier hs-var">bundle</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1233"></span><span>        </span><span class="annot"><span class="annottext">TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeWithinLimit"><span class="hs-identifier hs-var">TokenBundleSizeWithinLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1234"></span><span>        </span><span class="annot"><span class="annottext">TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeExceedsLimit"><span class="hs-identifier hs-var">TokenBundleSizeExceedsLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1235"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-1236"></span><span>        </span><span id="local-6989586621682435441"><span class="annot"><span class="annottext">bundle :: TokenBundle
</span><a href="#local-6989586621682435441"><span class="hs-identifier hs-var hs-var">bundle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435443"><span class="hs-identifier hs-var">outputReportedAsExceedingLimit</span></a></span><span>
</span><span id="line-1237"></span><span>
</span><span id="line-1238"></span><span>    </span><span id="local-6989586621682435443"><span class="annot"><span class="annottext">outputReportedAsExceedingLimit :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435443"><span class="hs-identifier hs-var hs-var">outputReportedAsExceedingLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435445"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
-&gt; (((Address ctx, TokenBundle)
     -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
    -&gt; SelectionOutputSizeExceedsLimitError ctx
    -&gt; Const
         (Address ctx, TokenBundle)
         (SelectionOutputSizeExceedsLimitError ctx))
-&gt; (Address ctx, TokenBundle)
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;outputThatExceedsLimit&quot;
  (((Address ctx, TokenBundle)
    -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
   -&gt; SelectionOutputSizeExceedsLimitError ctx
   -&gt; Const
        (Address ctx, TokenBundle)
        (SelectionOutputSizeExceedsLimitError ctx))
((Address ctx, TokenBundle)
 -&gt; Const (Address ctx, TokenBundle) (Address ctx, TokenBundle))
-&gt; SelectionOutputSizeExceedsLimitError ctx
-&gt; Const
     (Address ctx, TokenBundle)
     (SelectionOutputSizeExceedsLimitError ctx)
</span><a href="#local-6989586621682435438"><span class="hs-var">#outputThatExceedsLimit</span></a></span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1241"></span><span class="hs-comment">-- Selection error verification: output token quantity errors</span><span>
</span><span id="line-1242"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantityExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682436242"><span class="annot"><a href="#local-6989586621682436242"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1245"></span><span>    </span><span id="FailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantityExceedsLimitError</span></a></span></span><span>
</span><span id="line-1246"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AreportedError%3AFailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AreportedError%3AFailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">reportedError</span></a></span></span><span>
</span><span id="line-1247"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436242"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1248"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-1249"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435432"><span id="local-6989586621682435434"><span class="annot"><span class="annottext">FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
(FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
 -&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
 -&gt; Bool)
-&gt; (FailureToVerifySelectionOutputTokenQuantityExceedsLimitError
      ctx
    -&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
    -&gt; Bool)
-&gt; Eq
     (FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx)
forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
$c/= :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
== :: FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
$c== :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435426"><span id="local-6989586621682435428"><span id="local-6989586621682435430"><span class="annot"><span class="annottext">Int
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ShowS
[FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx]
-&gt; ShowS
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; String
(Int
 -&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
 -&gt; ShowS)
-&gt; (FailureToVerifySelectionOutputTokenQuantityExceedsLimitError
      ctx
    -&gt; String)
-&gt; ([FailureToVerifySelectionOutputTokenQuantityExceedsLimitError
       ctx]
    -&gt; ShowS)
-&gt; Show
     (FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx)
forall ctx.
SelectionContext ctx =&gt;
Int
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ShowS
forall ctx.
SelectionContext ctx =&gt;
[FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx]
-&gt; ShowS
forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx]
-&gt; ShowS
$cshowList :: forall ctx.
SelectionContext ctx =&gt;
[FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx]
-&gt; ShowS
show :: FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; String
$cshow :: forall ctx.
SelectionContext ctx =&gt;
FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; String
showsPrec :: Int
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ShowS
$cshowsPrec :: forall ctx.
SelectionContext ctx =&gt;
Int
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1250"></span><span>
</span><span id="line-1251"></span><span id="local-6989586621682436254"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">verifySelectionOutputTokenQuantityExceedsLimitError</span></a></span><span>
</span><span id="line-1252"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436254"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1253"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#VerifySelectionError"><span class="hs-identifier hs-type">VerifySelectionError</span></a></span><span>
</span><span id="line-1254"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436254"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621682436254"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-1255"></span><span id="verifySelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">verifySelectionOutputTokenQuantityExceedsLimitError :: VerifySelectionError
  (SelectionOutputTokenQuantityExceedsLimitError ctx) ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">verifySelectionOutputTokenQuantityExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682435425"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435425"><span class="hs-identifier hs-var">_cs</span></a></span></span><span> </span><span id="local-6989586621682435424"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435424"><span class="hs-identifier hs-var">_ps</span></a></span></span><span> </span><span id="local-6989586621682435423"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435423"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1256"></span><span>    </span><span class="annot"><span class="annottext">Bool
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; VerificationResult
forall failureReason.
Show failureReason =&gt;
Bool -&gt; failureReason -&gt; VerificationResult
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verify"><span class="hs-identifier hs-var">verify</span></a></span><span>
</span><span id="line-1257"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435423"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
    -&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
    -&gt; Const
         TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx))
-&gt; TokenQuantity
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;quantity&quot;
  ((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
   -&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
   -&gt; Const
        TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx))
(TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Const
     TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx)
</span><a href="#local-6989586621682435422"><span class="hs-var">#quantity</span></a></span><span> </span><span class="annot"><span class="annottext">TokenQuantity -&gt; TokenQuantity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435423"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; ((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
    -&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
    -&gt; Const
         TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx))
-&gt; TokenQuantity
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;quantityMaxBound&quot;
  ((TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
   -&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
   -&gt; Const
        TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx))
(TokenQuantity -&gt; Const TokenQuantity TokenQuantity)
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Const
     TokenQuantity (SelectionOutputTokenQuantityExceedsLimitError ctx)
</span><a href="#local-6989586621682435421"><span class="hs-var">#quantityMaxBound</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1258"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
forall ctx.
SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; FailureToVerifySelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#FailureToVerifySelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">FailureToVerifySelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435423"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>
</span><span id="line-1260"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1261"></span><span class="hs-comment">-- Selection deltas</span><span>
</span><span id="line-1262"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1263"></span><span>
</span><span id="line-1264"></span><span class="hs-comment">-- | Calculates the selection delta for all assets.</span><span>
</span><span id="line-1265"></span><span class="hs-comment">--</span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- See 'SelectionDelta'.</span><span>
</span><span id="line-1267"></span><span class="hs-comment">--</span><span>
</span><span id="line-1268"></span><span id="local-6989586621682436385"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaAllAssets"><span class="hs-identifier hs-type">selectionDeltaAllAssets</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436385"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionDelta"><span class="hs-identifier hs-type">SelectionDelta</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span></span><span>
</span><span id="line-1269"></span><span id="selectionDeltaAllAssets"><span class="annot"><span class="annottext">selectionDeltaAllAssets :: Selection ctx -&gt; SelectionDelta TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaAllAssets"><span class="hs-identifier hs-var hs-var">selectionDeltaAllAssets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionResultOf [] ctx -&gt; SelectionDelta TokenBundle
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionResultOf f ctx -&gt; SelectionDelta TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionDeltaAllAssets"><span class="hs-identifier hs-var">Balance.selectionDeltaAllAssets</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionResultOf [] ctx -&gt; SelectionDelta TokenBundle)
-&gt; (Selection ctx -&gt; SelectionResultOf [] ctx)
-&gt; Selection ctx
-&gt; SelectionDelta TokenBundle
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResultOf [] ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- | Calculates the ada selection delta.</span><span>
</span><span id="line-1272"></span><span class="hs-comment">--</span><span>
</span><span id="line-1273"></span><span class="hs-comment">-- See 'SelectionDelta'.</span><span>
</span><span id="line-1274"></span><span class="hs-comment">--</span><span>
</span><span id="line-1275"></span><span id="local-6989586621682435419"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaCoin"><span class="hs-identifier hs-type">selectionDeltaCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435419"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionDelta"><span class="hs-identifier hs-type">SelectionDelta</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1276"></span><span id="selectionDeltaCoin"><span class="annot"><span class="annottext">selectionDeltaCoin :: Selection ctx -&gt; SelectionDelta Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaCoin"><span class="hs-identifier hs-var hs-var">selectionDeltaCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TokenBundle -&gt; Coin)
-&gt; SelectionDelta TokenBundle -&gt; SelectionDelta Coin
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#getCoin"><span class="hs-identifier hs-var">TokenBundle.getCoin</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionDelta TokenBundle -&gt; SelectionDelta Coin)
-&gt; (Selection ctx -&gt; SelectionDelta TokenBundle)
-&gt; Selection ctx
-&gt; SelectionDelta Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionDelta TokenBundle
forall ctx. Selection ctx -&gt; SelectionDelta TokenBundle
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionDeltaAllAssets"><span class="hs-identifier hs-var">selectionDeltaAllAssets</span></a></span><span>
</span><span id="line-1277"></span><span>
</span><span id="line-1278"></span><span class="hs-comment">-- | Indicates whether or not a selection has a valid surplus.</span><span>
</span><span id="line-1279"></span><span class="hs-comment">--</span><span>
</span><span id="line-1280"></span><span class="hs-comment">-- This function returns 'True' if and only if the selection has a delta that</span><span>
</span><span id="line-1281"></span><span class="hs-comment">-- is a *surplus*, and that surplus is greater than or equal to the result of</span><span>
</span><span id="line-1282"></span><span class="hs-comment">-- 'selectionMinimumCost'.</span><span>
</span><span id="line-1283"></span><span class="hs-comment">--</span><span>
</span><span id="line-1284"></span><span class="hs-comment">-- See 'SelectionDelta'.</span><span>
</span><span id="line-1285"></span><span class="hs-comment">--</span><span>
</span><span id="line-1286"></span><span id="local-6989586621682436386"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasValidSurplus"><span class="hs-identifier hs-type">selectionHasValidSurplus</span></a></span><span>
</span><span id="line-1287"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436386"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436386"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436386"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-1288"></span><span id="selectionHasValidSurplus"><span class="annot"><span class="annottext">selectionHasValidSurplus :: SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasValidSurplus"><span class="hs-identifier hs-var hs-var">selectionHasValidSurplus</span></a></span></span><span> </span><span id="local-6989586621682435417"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435417"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435416"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435416"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435415"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435415"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1289"></span><span>    </span><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; SelectionResultOf [] ctx -&gt; Bool
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionConstraints ctx -&gt; SelectionResultOf f ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionHasValidSurplus"><span class="hs-identifier hs-var">Balance.selectionHasValidSurplus</span></a></span><span>
</span><span id="line-1290"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints ctx, SelectionParams ctx)
 -&gt; SelectionConstraints ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435417"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435416"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1291"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResultOf [] ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435415"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1292"></span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- | Computes the minimum required cost of a selection.</span><span>
</span><span id="line-1294"></span><span class="hs-comment">--</span><span>
</span><span id="line-1295"></span><span id="local-6989586621682435413"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCost"><span class="hs-identifier hs-type">selectionMinimumCost</span></a></span><span>
</span><span id="line-1296"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435413"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435413"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435413"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1297"></span><span id="selectionMinimumCost"><span class="annot"><span class="annottext">selectionMinimumCost :: SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCost"><span class="hs-identifier hs-var hs-var">selectionMinimumCost</span></a></span></span><span> </span><span id="local-6989586621682435412"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435412"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435411"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435411"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435410"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435410"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1298"></span><span>    </span><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; SelectionResultOf [] ctx -&gt; Coin
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionConstraints ctx -&gt; SelectionResultOf f ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionMinimumCost"><span class="hs-identifier hs-var">Balance.selectionMinimumCost</span></a></span><span>
</span><span id="line-1299"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints ctx, SelectionParams ctx)
 -&gt; SelectionConstraints ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435412"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435411"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1300"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResultOf [] ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435410"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span>
</span><span id="line-1302"></span><span class="hs-comment">-- | Computes the maximum acceptable cost of a selection.</span><span>
</span><span id="line-1303"></span><span class="hs-comment">--</span><span>
</span><span id="line-1304"></span><span id="local-6989586621682435408"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMaximumCost"><span class="hs-identifier hs-type">selectionMaximumCost</span></a></span><span>
</span><span id="line-1305"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435408"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435408"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435408"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1306"></span><span id="selectionMaximumCost"><span class="annot"><span class="annottext">selectionMaximumCost :: SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMaximumCost"><span class="hs-identifier hs-var hs-var">selectionMaximumCost</span></a></span></span><span> </span><span id="local-6989586621682435407"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435407"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435406"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435406"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435405"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435405"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1307"></span><span>    </span><span class="annot"><span class="annottext">SelectionConstraints ctx -&gt; SelectionResultOf [] ctx -&gt; Coin
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionConstraints ctx -&gt; SelectionResultOf f ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionMaximumCost"><span class="hs-identifier hs-var">Balance.selectionMaximumCost</span></a></span><span>
</span><span id="line-1308"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints ctx, SelectionParams ctx)
 -&gt; SelectionConstraints ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; SelectionConstraints ctx
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
forall ctx.
(SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceConstraintsParams"><span class="hs-identifier hs-var">toBalanceConstraintsParams</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435407"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435406"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1309"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResultOf [] ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435405"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1310"></span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- | Calculates the ada selection surplus, assuming there is a surplus.</span><span>
</span><span id="line-1312"></span><span class="hs-comment">--</span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- If there is a surplus, then this function returns that surplus.</span><span>
</span><span id="line-1314"></span><span class="hs-comment">-- If there is a deficit, then this function returns zero.</span><span>
</span><span id="line-1315"></span><span class="hs-comment">--</span><span>
</span><span id="line-1316"></span><span class="hs-comment">-- Use 'selectionDeltaCoin' if you wish to handle the case where there is</span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- a deficit.</span><span>
</span><span id="line-1318"></span><span class="hs-comment">--</span><span>
</span><span id="line-1319"></span><span id="local-6989586621682435403"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionSurplusCoin"><span class="hs-identifier hs-type">selectionSurplusCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435403"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1320"></span><span id="selectionSurplusCoin"><span class="annot"><span class="annottext">selectionSurplusCoin :: Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionSurplusCoin"><span class="hs-identifier hs-var hs-var">selectionSurplusCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionResultOf [] ctx -&gt; Coin
forall (f :: * -&gt; *) ctx.
Foldable f =&gt;
SelectionResultOf f ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#selectionSurplusCoin"><span class="hs-identifier hs-var">Balance.selectionSurplusCoin</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionResultOf [] ctx -&gt; Coin)
-&gt; (Selection ctx -&gt; SelectionResultOf [] ctx)
-&gt; Selection ctx
-&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResultOf [] ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span>
</span><span id="line-1321"></span><span>
</span><span id="line-1322"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- Selection collateral</span><span>
</span><span id="line-1324"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1325"></span><span>
</span><span id="line-1326"></span><span class="hs-comment">-- | Indicates the collateral requirement for a selection.</span><span>
</span><span id="line-1327"></span><span class="hs-comment">--</span><span>
</span><span id="line-1328"></span><span id="local-6989586621682435401"><span id="local-6989586621682435402"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionCollateralRequirement"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralRequirement"><span class="hs-identifier hs-var">SelectionCollateralRequirement</span></a></span></span><span>
</span><span id="line-1329"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SelectionCollateralRequired"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralRequired"><span class="hs-identifier hs-var">SelectionCollateralRequired</span></a></span></span><span>
</span><span id="line-1330"></span><span>    </span><span class="hs-comment">-- ^ Indicates that collateral is required.</span><span>
</span><span id="line-1331"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SelectionCollateralNotRequired"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralNotRequired"><span class="hs-identifier hs-var">SelectionCollateralNotRequired</span></a></span></span><span>
</span><span id="line-1332"></span><span>    </span><span class="hs-comment">-- ^ Indicates that collateral is not required.</span><span>
</span><span id="line-1333"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435395"><span id="local-6989586621682435397"><span class="annot"><span class="annottext">SelectionCollateralRequirement
SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; Bounded SelectionCollateralRequirement
forall a. a -&gt; a -&gt; Bounded a
maxBound :: SelectionCollateralRequirement
$cmaxBound :: SelectionCollateralRequirement
minBound :: SelectionCollateralRequirement
$cminBound :: SelectionCollateralRequirement
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435378"><span id="local-6989586621682435380"><span id="local-6989586621682435382"><span id="local-6989586621682435384"><span id="local-6989586621682435386"><span id="local-6989586621682435388"><span id="local-6989586621682435390"><span id="local-6989586621682435392"><span class="annot"><span class="annottext">Int -&gt; SelectionCollateralRequirement
SelectionCollateralRequirement -&gt; Int
SelectionCollateralRequirement -&gt; [SelectionCollateralRequirement]
SelectionCollateralRequirement -&gt; SelectionCollateralRequirement
SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
(SelectionCollateralRequirement -&gt; SelectionCollateralRequirement)
-&gt; (SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement)
-&gt; (Int -&gt; SelectionCollateralRequirement)
-&gt; (SelectionCollateralRequirement -&gt; Int)
-&gt; (SelectionCollateralRequirement
    -&gt; [SelectionCollateralRequirement])
-&gt; (SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement
    -&gt; [SelectionCollateralRequirement])
-&gt; (SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement
    -&gt; [SelectionCollateralRequirement])
-&gt; (SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement
    -&gt; [SelectionCollateralRequirement])
-&gt; Enum SelectionCollateralRequirement
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
$cenumFromThenTo :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
enumFromTo :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
$cenumFromTo :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
enumFromThen :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
$cenumFromThen :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement
-&gt; [SelectionCollateralRequirement]
enumFrom :: SelectionCollateralRequirement -&gt; [SelectionCollateralRequirement]
$cenumFrom :: SelectionCollateralRequirement -&gt; [SelectionCollateralRequirement]
fromEnum :: SelectionCollateralRequirement -&gt; Int
$cfromEnum :: SelectionCollateralRequirement -&gt; Int
toEnum :: Int -&gt; SelectionCollateralRequirement
$ctoEnum :: Int -&gt; SelectionCollateralRequirement
pred :: SelectionCollateralRequirement -&gt; SelectionCollateralRequirement
$cpred :: SelectionCollateralRequirement -&gt; SelectionCollateralRequirement
succ :: SelectionCollateralRequirement -&gt; SelectionCollateralRequirement
$csucc :: SelectionCollateralRequirement -&gt; SelectionCollateralRequirement
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435373"><span id="local-6989586621682435375"><span class="annot"><span class="annottext">SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement -&gt; Bool
(SelectionCollateralRequirement
 -&gt; SelectionCollateralRequirement -&gt; Bool)
-&gt; (SelectionCollateralRequirement
    -&gt; SelectionCollateralRequirement -&gt; Bool)
-&gt; Eq SelectionCollateralRequirement
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement -&gt; Bool
$c/= :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement -&gt; Bool
== :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement -&gt; Bool
$c== :: SelectionCollateralRequirement
-&gt; SelectionCollateralRequirement -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionCollateralRequirement
 -&gt; Rep SelectionCollateralRequirement x)
-&gt; (forall x.
    Rep SelectionCollateralRequirement x
    -&gt; SelectionCollateralRequirement)
-&gt; Generic SelectionCollateralRequirement
forall x.
Rep SelectionCollateralRequirement x
-&gt; SelectionCollateralRequirement
forall x.
SelectionCollateralRequirement
-&gt; Rep SelectionCollateralRequirement x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x.
Rep SelectionCollateralRequirement x
-&gt; SelectionCollateralRequirement
$cfrom :: forall x.
SelectionCollateralRequirement
-&gt; Rep SelectionCollateralRequirement x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435365"><span id="local-6989586621682435367"><span id="local-6989586621682435369"><span class="annot"><span class="annottext">Int -&gt; SelectionCollateralRequirement -&gt; ShowS
[SelectionCollateralRequirement] -&gt; ShowS
SelectionCollateralRequirement -&gt; String
(Int -&gt; SelectionCollateralRequirement -&gt; ShowS)
-&gt; (SelectionCollateralRequirement -&gt; String)
-&gt; ([SelectionCollateralRequirement] -&gt; ShowS)
-&gt; Show SelectionCollateralRequirement
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SelectionCollateralRequirement] -&gt; ShowS
$cshowList :: [SelectionCollateralRequirement] -&gt; ShowS
show :: SelectionCollateralRequirement -&gt; String
$cshow :: SelectionCollateralRequirement -&gt; String
showsPrec :: Int -&gt; SelectionCollateralRequirement -&gt; ShowS
$cshowsPrec :: Int -&gt; SelectionCollateralRequirement -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1334"></span><span>
</span><span id="line-1335"></span><span class="hs-comment">-- | Indicates 'True' if and only if collateral is required.</span><span>
</span><span id="line-1336"></span><span class="hs-comment">--</span><span>
</span><span id="line-1337"></span><span id="local-6989586621682436493"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier hs-type">selectionCollateralRequired</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436493"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-1338"></span><span id="selectionCollateralRequired"><span class="annot"><span class="annottext">selectionCollateralRequired :: SelectionParams ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier hs-var hs-var">selectionCollateralRequired</span></a></span></span><span> </span><span id="local-6989586621682435364"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435364"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">((SelectionCollateralRequirement
  -&gt; Const
       SelectionCollateralRequirement SelectionCollateralRequirement)
 -&gt; SelectionParams ctx
 -&gt; Const SelectionCollateralRequirement (SelectionParams ctx))
-&gt; SelectionParams ctx -&gt; SelectionCollateralRequirement
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;collateralRequirement&quot;
  ((SelectionCollateralRequirement
    -&gt; Const
         SelectionCollateralRequirement SelectionCollateralRequirement)
   -&gt; SelectionParams ctx
   -&gt; Const SelectionCollateralRequirement (SelectionParams ctx))
(SelectionCollateralRequirement
 -&gt; Const
      SelectionCollateralRequirement SelectionCollateralRequirement)
-&gt; SelectionParams ctx
-&gt; Const SelectionCollateralRequirement (SelectionParams ctx)
</span><a href="#local-6989586621682435363"><span class="hs-var">#collateralRequirement</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435364"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1339"></span><span>    </span><span class="annot"><span class="annottext">SelectionCollateralRequirement
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralRequired"><span class="hs-identifier hs-var">SelectionCollateralRequired</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1340"></span><span>    </span><span class="annot"><span class="annottext">SelectionCollateralRequirement
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionCollateralNotRequired"><span class="hs-identifier hs-var">SelectionCollateralNotRequired</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1341"></span><span>
</span><span id="line-1342"></span><span class="hs-comment">-- | Applies the given transformation function only when collateral is required.</span><span>
</span><span id="line-1343"></span><span class="hs-comment">--</span><span>
</span><span id="line-1344"></span><span id="local-6989586621682436469"><span id="local-6989586621682436470"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#whenCollateralRequired"><span class="hs-identifier hs-type">whenCollateralRequired</span></a></span><span>
</span><span id="line-1345"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436470"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1346"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436469"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1347"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436469"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-1348"></span><span id="whenCollateralRequired"><span class="annot"><span class="annottext">whenCollateralRequired :: SelectionParams ctx -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#whenCollateralRequired"><span class="hs-identifier hs-var hs-var">whenCollateralRequired</span></a></span></span><span> </span><span id="local-6989586621682435362"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435362"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435361"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621682435361"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-1349"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Bool
forall ctx. SelectionParams ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier hs-var">selectionCollateralRequired</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435362"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621682435361"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-1350"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-1351"></span><span>
</span><span id="line-1352"></span><span class="hs-comment">-- | Computes the total amount of collateral within a selection.</span><span>
</span><span id="line-1353"></span><span class="hs-comment">--</span><span>
</span><span id="line-1354"></span><span id="local-6989586621682436404"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateral"><span class="hs-identifier hs-type">selectionCollateral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436404"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1355"></span><span id="selectionCollateral"><span class="annot"><span class="annottext">selectionCollateral :: Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateral"><span class="hs-identifier hs-var hs-var">selectionCollateral</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((UTxO ctx, Coin) -&gt; Coin) -&gt; [(UTxO ctx, Coin)] -&gt; Coin
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">F.foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">(UTxO ctx, Coin) -&gt; Coin
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">([(UTxO ctx, Coin)] -&gt; Coin)
-&gt; (Selection ctx -&gt; [(UTxO ctx, Coin)]) -&gt; Selection ctx -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(([(UTxO ctx, Coin)]
  -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
 -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
-&gt; Selection ctx -&gt; [(UTxO ctx, Coin)]
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;collateral&quot;
  (([(UTxO ctx, Coin)]
    -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
   -&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx))
([(UTxO ctx, Coin)] -&gt; Const [(UTxO ctx, Coin)] [(UTxO ctx, Coin)])
-&gt; Selection ctx -&gt; Const [(UTxO ctx, Coin)] (Selection ctx)
</span><a href="#local-6989586621682435359"><span class="hs-var">#collateral</span></a></span><span>
</span><span id="line-1356"></span><span>
</span><span id="line-1357"></span><span class="hs-comment">-- | Indicates whether or not a selection has sufficient collateral.</span><span>
</span><span id="line-1358"></span><span class="hs-comment">--</span><span>
</span><span id="line-1359"></span><span id="local-6989586621682435358"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasSufficientCollateral"><span class="hs-identifier hs-type">selectionHasSufficientCollateral</span></a></span><span>
</span><span id="line-1360"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435358"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435358"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435358"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-1361"></span><span id="selectionHasSufficientCollateral"><span class="annot"><span class="annottext">selectionHasSufficientCollateral :: SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionHasSufficientCollateral"><span class="hs-identifier hs-var hs-var">selectionHasSufficientCollateral</span></a></span></span><span> </span><span id="local-6989586621682435357"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435357"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435356"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435356"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435355"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435355"><span class="hs-identifier hs-var">selection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1362"></span><span>    </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435354"><span class="hs-identifier hs-var">actual</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Coin
</span><a href="#local-6989586621682435353"><span class="hs-identifier hs-var">required</span></a></span><span>
</span><span id="line-1363"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1364"></span><span>    </span><span id="local-6989586621682435354"><span class="annot"><span class="annottext">actual :: Coin
</span><a href="#local-6989586621682435354"><span class="hs-identifier hs-var hs-var">actual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Selection ctx -&gt; Coin
forall ctx. Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateral"><span class="hs-identifier hs-var">selectionCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435355"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-1365"></span><span>    </span><span id="local-6989586621682435353"><span class="annot"><span class="annottext">required :: Coin
</span><a href="#local-6989586621682435353"><span class="hs-identifier hs-var hs-var">required</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
forall ctx.
SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCollateral"><span class="hs-identifier hs-var">selectionMinimumCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435357"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435356"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435355"><span class="hs-identifier hs-var">selection</span></a></span><span>
</span><span id="line-1366"></span><span>
</span><span id="line-1367"></span><span class="hs-comment">-- | Computes the minimum required amount of collateral for a selection.</span><span>
</span><span id="line-1368"></span><span class="hs-comment">--</span><span>
</span><span id="line-1369"></span><span id="local-6989586621682436403"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCollateral"><span class="hs-identifier hs-type">selectionMinimumCollateral</span></a></span><span>
</span><span id="line-1370"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436403"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionParams"><span class="hs-identifier hs-type">SelectionParams</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436403"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#Selection"><span class="hs-identifier hs-type">Selection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436403"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span></span><span>
</span><span id="line-1371"></span><span id="selectionMinimumCollateral"><span class="annot"><span class="annottext">selectionMinimumCollateral :: SelectionConstraints ctx
-&gt; SelectionParams ctx -&gt; Selection ctx -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionMinimumCollateral"><span class="hs-identifier hs-var hs-var">selectionMinimumCollateral</span></a></span></span><span> </span><span id="local-6989586621682435352"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435352"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435351"><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435351"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682435350"><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435350"><span class="hs-identifier hs-var">selection</span></a></span></span><span>
</span><span id="line-1372"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx -&gt; Bool
forall ctx. SelectionParams ctx -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#selectionCollateralRequired"><span class="hs-identifier hs-var">selectionCollateralRequired</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435351"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1373"></span><span>        </span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; SelectionParams (UTxO ctx)
 -&gt; Const Coin (SelectionParams (UTxO ctx)))
-&gt; SelectionParams (UTxO ctx) -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;minimumSelectionAmount&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; SelectionParams (UTxO ctx)
   -&gt; Const Coin (SelectionParams (UTxO ctx)))
(Coin -&gt; Const Coin Coin)
-&gt; SelectionParams (UTxO ctx)
-&gt; Const Coin (SelectionParams (UTxO ctx))
</span><a href="#local-6989586621682435349"><span class="hs-var">#minimumSelectionAmount</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionParams (UTxO ctx) -&gt; Coin)
-&gt; SelectionParams (UTxO ctx) -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionConstraints, SelectionParams (UTxO ctx))
-&gt; SelectionParams (UTxO ctx)
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((SelectionConstraints, SelectionParams (UTxO ctx))
 -&gt; SelectionParams (UTxO ctx))
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
-&gt; SelectionParams (UTxO ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1374"></span><span>        </span><span class="annot"><span class="annottext">SelectionResult ctx
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
forall ctx.
SelectionResult ctx
-&gt; (SelectionConstraints ctx, SelectionParams ctx)
-&gt; (SelectionConstraints, SelectionParams (UTxO ctx))
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toCollateralConstraintsParams"><span class="hs-identifier hs-var">toCollateralConstraintsParams</span></a></span><span>
</span><span id="line-1375"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Selection ctx -&gt; SelectionResult ctx
forall ctx. Selection ctx -&gt; SelectionResult ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#toBalanceResult"><span class="hs-identifier hs-var">toBalanceResult</span></a></span><span> </span><span class="annot"><span class="annottext">Selection ctx
</span><a href="#local-6989586621682435350"><span class="hs-identifier hs-var">selection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1376"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435352"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionParams ctx
</span><a href="#local-6989586621682435351"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1377"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1378"></span><span>
</span><span id="line-1379"></span><span class="hs-comment">-- | Parameters for 'computeMinimumCollateral'.</span><span>
</span><span id="line-1380"></span><span>
</span><span id="line-1381"></span><span id="local-6989586621682435347"><span id="local-6989586621682435348"></span></span><span class="hs-keyword">data</span><span> </span><span id="ComputeMinimumCollateralParams"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#ComputeMinimumCollateralParams"><span class="hs-identifier hs-var">ComputeMinimumCollateralParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ComputeMinimumCollateralParams"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#ComputeMinimumCollateralParams"><span class="hs-identifier hs-var">ComputeMinimumCollateralParams</span></a></span></span><span>
</span><span id="line-1382"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AminimumCollateralPercentage%3AComputeMinimumCollateralParams"><span class="annot"><span class="annottext">ComputeMinimumCollateralParams -&gt; Natural
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AminimumCollateralPercentage%3AComputeMinimumCollateralParams"><span class="hs-identifier hs-var hs-var">minimumCollateralPercentage</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Natural</span></a></span><span>
</span><span id="line-1383"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AtransactionFee%3AComputeMinimumCollateralParams"><span class="annot"><span class="annottext">ComputeMinimumCollateralParams -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AtransactionFee%3AComputeMinimumCollateralParams"><span class="hs-identifier hs-var hs-var">transactionFee</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1384"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1385"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435343"><span id="local-6989586621682435345"><span class="annot"><span class="annottext">ComputeMinimumCollateralParams
-&gt; ComputeMinimumCollateralParams -&gt; Bool
(ComputeMinimumCollateralParams
 -&gt; ComputeMinimumCollateralParams -&gt; Bool)
-&gt; (ComputeMinimumCollateralParams
    -&gt; ComputeMinimumCollateralParams -&gt; Bool)
-&gt; Eq ComputeMinimumCollateralParams
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ComputeMinimumCollateralParams
-&gt; ComputeMinimumCollateralParams -&gt; Bool
$c/= :: ComputeMinimumCollateralParams
-&gt; ComputeMinimumCollateralParams -&gt; Bool
== :: ComputeMinimumCollateralParams
-&gt; ComputeMinimumCollateralParams -&gt; Bool
$c== :: ComputeMinimumCollateralParams
-&gt; ComputeMinimumCollateralParams -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x.
 ComputeMinimumCollateralParams
 -&gt; Rep ComputeMinimumCollateralParams x)
-&gt; (forall x.
    Rep ComputeMinimumCollateralParams x
    -&gt; ComputeMinimumCollateralParams)
-&gt; Generic ComputeMinimumCollateralParams
forall x.
Rep ComputeMinimumCollateralParams x
-&gt; ComputeMinimumCollateralParams
forall x.
ComputeMinimumCollateralParams
-&gt; Rep ComputeMinimumCollateralParams x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x.
Rep ComputeMinimumCollateralParams x
-&gt; ComputeMinimumCollateralParams
$cfrom :: forall x.
ComputeMinimumCollateralParams
-&gt; Rep ComputeMinimumCollateralParams x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435335"><span id="local-6989586621682435337"><span id="local-6989586621682435339"><span class="annot"><span class="annottext">Int -&gt; ComputeMinimumCollateralParams -&gt; ShowS
[ComputeMinimumCollateralParams] -&gt; ShowS
ComputeMinimumCollateralParams -&gt; String
(Int -&gt; ComputeMinimumCollateralParams -&gt; ShowS)
-&gt; (ComputeMinimumCollateralParams -&gt; String)
-&gt; ([ComputeMinimumCollateralParams] -&gt; ShowS)
-&gt; Show ComputeMinimumCollateralParams
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ComputeMinimumCollateralParams] -&gt; ShowS
$cshowList :: [ComputeMinimumCollateralParams] -&gt; ShowS
show :: ComputeMinimumCollateralParams -&gt; String
$cshow :: ComputeMinimumCollateralParams -&gt; String
showsPrec :: Int -&gt; ComputeMinimumCollateralParams -&gt; ShowS
$cshowsPrec :: Int -&gt; ComputeMinimumCollateralParams -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1386"></span><span>
</span><span id="line-1387"></span><span class="hs-comment">-- | Computes the minimum required amount of collateral given a fee and a</span><span>
</span><span id="line-1388"></span><span class="hs-comment">--   minimum collateral percentage.</span><span>
</span><span id="line-1389"></span><span class="hs-comment">--</span><span>
</span><span id="line-1390"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#computeMinimumCollateral"><span class="hs-identifier hs-type">computeMinimumCollateral</span></a></span><span>
</span><span id="line-1391"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#ComputeMinimumCollateralParams"><span class="hs-identifier hs-type">ComputeMinimumCollateralParams</span></a></span><span>
</span><span id="line-1392"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1393"></span><span id="computeMinimumCollateral"><span class="annot"><span class="annottext">computeMinimumCollateral :: ComputeMinimumCollateralParams -&gt; Coin
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#computeMinimumCollateral"><span class="hs-identifier hs-var hs-var">computeMinimumCollateral</span></a></span></span><span> </span><span id="local-6989586621682435334"><span class="annot"><span class="annottext">ComputeMinimumCollateralParams
</span><a href="#local-6989586621682435334"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1394"></span><span>    </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Coin) -&gt; (Coin -&gt; Natural) -&gt; Coin -&gt; Coin
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Natural -&gt; Natural
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">ceiling</span></a></span><span> </span><span class="annot"><span class="annottext">(Ratio Natural -&gt; Natural)
-&gt; (Coin -&gt; Ratio Natural) -&gt; Coin -&gt; Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; Natural -&gt; Ratio Natural
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Natural -&gt; Ratio Natural)
-&gt; (Coin -&gt; Natural) -&gt; Coin -&gt; Ratio Natural
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Natural
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#unCoin"><span class="hs-identifier hs-var hs-var">unCoin</span></a></span><span> </span><span class="annot"><span class="annottext">(Coin -&gt; Coin) -&gt; Coin -&gt; Coin
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1395"></span><span>    </span><span class="annot"><span class="annottext">Natural -&gt; Coin -&gt; Coin
forall b a. (Integral b, Monoid a) =&gt; b -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mtimesDefault</span></a></span><span>
</span><span id="line-1396"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Natural -&gt; Const Natural Natural)
 -&gt; ComputeMinimumCollateralParams
 -&gt; Const Natural ComputeMinimumCollateralParams)
-&gt; ComputeMinimumCollateralParams -&gt; Natural
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;minimumCollateralPercentage&quot;
  ((Natural -&gt; Const Natural Natural)
   -&gt; ComputeMinimumCollateralParams
   -&gt; Const Natural ComputeMinimumCollateralParams)
(Natural -&gt; Const Natural Natural)
-&gt; ComputeMinimumCollateralParams
-&gt; Const Natural ComputeMinimumCollateralParams
</span><a href="#local-6989586621682435331"><span class="hs-var">#minimumCollateralPercentage</span></a></span><span> </span><span class="annot"><span class="annottext">ComputeMinimumCollateralParams
</span><a href="#local-6989586621682435334"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1397"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Coin -&gt; Const Coin Coin)
 -&gt; ComputeMinimumCollateralParams
 -&gt; Const Coin ComputeMinimumCollateralParams)
-&gt; ComputeMinimumCollateralParams -&gt; Coin
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;transactionFee&quot;
  ((Coin -&gt; Const Coin Coin)
   -&gt; ComputeMinimumCollateralParams
   -&gt; Const Coin ComputeMinimumCollateralParams)
(Coin -&gt; Const Coin Coin)
-&gt; ComputeMinimumCollateralParams
-&gt; Const Coin ComputeMinimumCollateralParams
</span><a href="#local-6989586621682435330"><span class="hs-var">#transactionFee</span></a></span><span> </span><span class="annot"><span class="annottext">ComputeMinimumCollateralParams
</span><a href="#local-6989586621682435334"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1398"></span><span>
</span><span id="line-1399"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1400"></span><span class="hs-comment">-- Preparing outputs</span><span>
</span><span id="line-1401"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-1402"></span><span>
</span><span id="line-1403"></span><span class="hs-comment">-- | Prepares the given user-specified outputs, ensuring that they are valid.</span><span>
</span><span id="line-1404"></span><span class="hs-comment">--</span><span>
</span><span id="line-1405"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsInternal"><span class="hs-identifier hs-type">prepareOutputsInternal</span></a></span><span>
</span><span id="line-1406"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436515"><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1407"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1408"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-type">SelectionOutputError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-1409"></span><span id="prepareOutputsInternal"><span class="annot"><span class="annottext">prepareOutputsInternal :: SelectionConstraints ctx
-&gt; [(Address ctx, TokenBundle)]
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsInternal"><span class="hs-identifier hs-var hs-var">prepareOutputsInternal</span></a></span></span><span> </span><span id="local-6989586621682435329"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435329"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435328"><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435328"><span class="hs-identifier hs-var">outputsUnprepared</span></a></span></span><span>
</span><span id="line-1410"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682435327"><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435327"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputSizeExceedsLimitError ctx]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SelectionOutputSizeExceedsLimitError ctx]
</span><a href="#local-6989586621682435326"><span class="hs-identifier hs-var">excessivelyLargeBundles</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1411"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionOutputError ctx
 -&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)])
-&gt; SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1412"></span><span>        </span><span class="hs-comment">-- We encountered one or more excessively large token bundles.</span><span>
</span><span id="line-1413"></span><span>        </span><span class="hs-comment">-- Just report the first such bundle:</span><span>
</span><span id="line-1414"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
-&gt; SelectionOutputError ctx
forall ctx.
SelectionOutputSizeExceedsLimitError ctx
-&gt; SelectionOutputError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimit"><span class="hs-identifier hs-var">SelectionOutputSizeExceedsLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
</span><a href="#local-6989586621682435327"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1415"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682435325"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435325"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="#local-6989586621682435324"><span class="hs-identifier hs-var">excessiveTokenQuantities</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1416"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionOutputError ctx
 -&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)])
-&gt; SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1417"></span><span>        </span><span class="hs-comment">-- We encountered one or more excessive token quantities.</span><span>
</span><span id="line-1418"></span><span>        </span><span class="hs-comment">-- Just report the first such quantity:</span><span>
</span><span id="line-1419"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; SelectionOutputError ctx
forall ctx.
SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; SelectionOutputError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimit"><span class="hs-identifier hs-var">SelectionOutputTokenQuantityExceedsLimit</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="#local-6989586621682435325"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1420"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621682435323"><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435323"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span class="annot"><span class="annottext">[SelectionOutputCoinInsufficientError ctx]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[SelectionOutputCoinInsufficientError ctx]
</span><a href="#local-6989586621682435322"><span class="hs-identifier hs-var">insufficientCoins</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1421"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionOutputError ctx
 -&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)])
-&gt; SelectionOutputError ctx
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1422"></span><span>        </span><span class="hs-comment">-- We encountered one or more outputs with an ada quantity that is</span><span>
</span><span id="line-1423"></span><span>        </span><span class="hs-comment">-- below the minimum required quantity.</span><span>
</span><span id="line-1424"></span><span>        </span><span class="hs-comment">-- Just report the first such output:</span><span>
</span><span id="line-1425"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; SelectionOutputError ctx
forall ctx.
SelectionOutputCoinInsufficientError ctx
-&gt; SelectionOutputError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficient"><span class="hs-identifier hs-var">SelectionOutputCoinInsufficient</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
</span><a href="#local-6989586621682435323"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-1426"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1427"></span><span>        </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
-&gt; Either (SelectionOutputError ctx) [(Address ctx, TokenBundle)]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435321"><span class="hs-identifier hs-var">outputsToCover</span></a></span><span>
</span><span id="line-1428"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1429"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span>
</span><span id="line-1430"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="local-6989586621682435320"><span class="annot"><span class="annottext">Address ctx -&gt; TokenMap -&gt; Coin
computeMinimumAdaQuantity :: Address ctx -&gt; TokenMap -&gt; Coin
$sel:computeMinimumAdaQuantity:SelectionConstraints :: forall ctx.
SelectionConstraints ctx -&gt; Address ctx -&gt; TokenMap -&gt; Coin
</span><a href="#local-6989586621682435320"><span class="hs-identifier hs-var hs-var">computeMinimumAdaQuantity</span></a></span></span><span>
</span><span id="line-1431"></span><span>        </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435329"><span class="hs-identifier hs-var">constraints</span></a></span><span>
</span><span id="line-1432"></span><span>
</span><span id="line-1433"></span><span>    </span><span class="hs-comment">-- The complete list of token bundles whose serialized lengths are greater</span><span>
</span><span id="line-1434"></span><span>    </span><span class="hs-comment">-- than the limit of what is allowed in a transaction output:</span><span>
</span><span id="line-1435"></span><span>    </span><span class="annot"><a href="#local-6989586621682435326"><span class="hs-identifier hs-type">excessivelyLargeBundles</span></a></span><span>
</span><span id="line-1436"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1437"></span><span>    </span><span id="local-6989586621682435326"><span class="annot"><span class="annottext">excessivelyLargeBundles :: [SelectionOutputSizeExceedsLimitError ctx]
</span><a href="#local-6989586621682435326"><span class="hs-identifier hs-var hs-var">excessivelyLargeBundles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1438"></span><span>        </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx))
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputSizeExceedsLimitError ctx]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
forall ctx.
SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputSize"><span class="hs-identifier hs-var">verifyOutputSize</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435329"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435321"><span class="hs-identifier hs-var">outputsToCover</span></a></span><span>
</span><span id="line-1439"></span><span>
</span><span id="line-1440"></span><span>    </span><span class="hs-comment">-- The complete list of token quantities that exceed the maximum quantity</span><span>
</span><span id="line-1441"></span><span>    </span><span class="hs-comment">-- allowed in a transaction output:</span><span>
</span><span id="line-1442"></span><span>    </span><span class="annot"><a href="#local-6989586621682435324"><span class="hs-identifier hs-type">excessiveTokenQuantities</span></a></span><span>
</span><span id="line-1443"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1444"></span><span>    </span><span id="local-6989586621682435324"><span class="annot"><span class="annottext">excessiveTokenQuantities :: [SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="#local-6989586621682435324"><span class="hs-identifier hs-var hs-var">excessiveTokenQuantities</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
forall ctx.
(Address ctx, TokenBundle)
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputTokenQuantities"><span class="hs-identifier hs-var">verifyOutputTokenQuantities</span></a></span><span> </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx])
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435321"><span class="hs-identifier hs-var">outputsToCover</span></a></span><span>
</span><span id="line-1445"></span><span>
</span><span id="line-1446"></span><span>    </span><span class="hs-comment">-- The complete list of outputs whose ada quantities are below the minimum</span><span>
</span><span id="line-1447"></span><span>    </span><span class="hs-comment">-- required:</span><span>
</span><span id="line-1448"></span><span>    </span><span class="annot"><a href="#local-6989586621682435322"><span class="hs-identifier hs-type">insufficientCoins</span></a></span><span>
</span><span id="line-1449"></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436515"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1450"></span><span>    </span><span id="local-6989586621682435322"><span class="annot"><span class="annottext">insufficientCoins :: [SelectionOutputCoinInsufficientError ctx]
</span><a href="#local-6989586621682435322"><span class="hs-identifier hs-var hs-var">insufficientCoins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1451"></span><span>        </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle)
 -&gt; Maybe (SelectionOutputCoinInsufficientError ctx))
-&gt; [(Address ctx, TokenBundle)]
-&gt; [SelectionOutputCoinInsufficientError ctx]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
forall ctx.
SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputCoinSufficient"><span class="hs-identifier hs-var">verifyOutputCoinSufficient</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435329"><span class="hs-identifier hs-var">constraints</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435321"><span class="hs-identifier hs-var">outputsToCover</span></a></span><span>
</span><span id="line-1452"></span><span>
</span><span id="line-1453"></span><span>    </span><span id="local-6989586621682435321"><span class="annot"><span class="annottext">outputsToCover :: [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435321"><span class="hs-identifier hs-var hs-var">outputsToCover</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1454"></span><span>        </span><span class="annot"><span class="annottext">(Address ctx -&gt; TokenMap -&gt; Coin)
-&gt; [(Address ctx, TokenBundle)] -&gt; [(Address ctx, TokenBundle)]
forall (f :: * -&gt; *) address.
Functor f =&gt;
(address -&gt; TokenMap -&gt; Coin)
-&gt; f (address, TokenBundle) -&gt; f (address, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsWith"><span class="hs-identifier hs-var">prepareOutputsWith</span></a></span><span> </span><span class="annot"><span class="annottext">Address ctx -&gt; TokenMap -&gt; Coin
</span><a href="#local-6989586621682435320"><span class="hs-identifier hs-var">computeMinimumAdaQuantity</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435328"><span class="hs-identifier hs-var">outputsUnprepared</span></a></span><span>
</span><span id="line-1455"></span><span>
</span><span id="line-1456"></span><span class="hs-comment">-- | Assigns minimal ada quantities to outputs without ada quantities.</span><span>
</span><span id="line-1457"></span><span class="hs-comment">--</span><span>
</span><span id="line-1458"></span><span class="hs-comment">-- This function only modifies outputs that have an ada quantity of zero.</span><span>
</span><span id="line-1459"></span><span class="hs-comment">-- Outputs that have non-zero ada quantities will not be modified.</span><span>
</span><span id="line-1460"></span><span class="hs-comment">--</span><span>
</span><span id="line-1461"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsWith"><span class="hs-identifier hs-type">prepareOutputsWith</span></a></span><span>
</span><span id="line-1462"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682436209"><span class="annot"><a href="#local-6989586621682436209"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621682436208"><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436209"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-1463"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#TokenMap"><span class="hs-identifier hs-type">TokenMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1464"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436209"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1465"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682436209"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1466"></span><span id="prepareOutputsWith"><span class="annot"><span class="annottext">prepareOutputsWith :: (address -&gt; TokenMap -&gt; Coin)
-&gt; f (address, TokenBundle) -&gt; f (address, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#prepareOutputsWith"><span class="hs-identifier hs-var hs-var">prepareOutputsWith</span></a></span></span><span> </span><span id="local-6989586621682435318"><span class="annot"><span class="annottext">address -&gt; TokenMap -&gt; Coin
</span><a href="#local-6989586621682435318"><span class="hs-identifier hs-var">minCoinValueFor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1467"></span><span>    </span><span class="annot"><span class="annottext">((address, TokenBundle) -&gt; (address, TokenBundle))
-&gt; f (address, TokenBundle) -&gt; f (address, TokenBundle)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">(address, TokenBundle) -&gt; (address, TokenBundle)
</span><a href="#local-6989586621682435317"><span class="hs-identifier hs-var">augmentBundle</span></a></span><span>
</span><span id="line-1468"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1469"></span><span>    </span><span class="annot"><a href="#local-6989586621682435317"><span class="hs-identifier hs-type">augmentBundle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682436208"><span class="hs-identifier hs-type">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1470"></span><span>    </span><span id="local-6989586621682435317"><span class="annot"><span class="annottext">augmentBundle :: (address, TokenBundle) -&gt; (address, TokenBundle)
</span><a href="#local-6989586621682435317"><span class="hs-identifier hs-var hs-var">augmentBundle</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435316"><span class="annot"><span class="annottext">address
</span><a href="#local-6989586621682435316"><span class="hs-identifier hs-var">addr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435315"><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435315"><span class="hs-identifier hs-var">bundle</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">address
</span><a href="#local-6989586621682435316"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TokenBundle -&gt; (address, TokenBundle))
-&gt; TokenBundle -&gt; (address, TokenBundle)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-1471"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#getCoin"><span class="hs-identifier hs-var">TokenBundle.getCoin</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435315"><span class="hs-identifier hs-var">bundle</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1472"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435315"><span class="hs-identifier hs-var">bundle</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; (TokenBundle -&gt; TokenBundle) -&gt; TokenBundle
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Lens TokenBundle TokenBundle Coin Coin
-&gt; Coin -&gt; TokenBundle -&gt; TokenBundle
forall s t a b. Lens s t a b -&gt; b -&gt; s -&gt; t
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">set</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel &quot;coin&quot; ((Coin -&gt; f Coin) -&gt; TokenBundle -&gt; f TokenBundle)
Lens TokenBundle TokenBundle Coin Coin
</span><a href="#local-6989586621682435314"><span class="hs-var">#coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">address -&gt; TokenMap -&gt; Coin
</span><a href="#local-6989586621682435318"><span class="hs-identifier hs-var">minCoinValueFor</span></a></span><span> </span><span class="annot"><span class="annottext">address
</span><a href="#local-6989586621682435316"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((TokenMap -&gt; Const TokenMap TokenMap)
 -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
-&gt; TokenBundle -&gt; TokenMap
forall a s. ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; s -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-identifier hs-var">view</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;tokens&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; TokenBundle -&gt; Const TokenMap TokenBundle
</span><a href="#local-6989586621682435313"><span class="hs-var">#tokens</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435315"><span class="hs-identifier hs-var">bundle</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1473"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435315"><span class="hs-identifier hs-var">bundle</span></a></span><span>
</span><span id="line-1474"></span><span>
</span><span id="line-1475"></span><span class="hs-comment">-- | Indicates a problem when preparing outputs for a coin selection.</span><span>
</span><span id="line-1476"></span><span class="hs-comment">--</span><span>
</span><span id="line-1477"></span><span id="local-6989586621682435311"><span id="local-6989586621682435312"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionOutputError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-var">SelectionOutputError</span></a></span></span><span> </span><span id="local-6989586621682436211"><span class="annot"><a href="#local-6989586621682436211"><span class="hs-identifier hs-type">ctx</span></a></span></span><span>
</span><span id="line-1478"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="SelectionOutputCoinInsufficient"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficient"><span class="hs-identifier hs-var">SelectionOutputCoinInsufficient</span></a></span></span><span>
</span><span id="line-1479"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436211"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1480"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SelectionOutputSizeExceedsLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimit"><span class="hs-identifier hs-var">SelectionOutputSizeExceedsLimit</span></a></span></span><span>
</span><span id="line-1481"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436211"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1482"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SelectionOutputTokenQuantityExceedsLimit"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimit"><span class="hs-identifier hs-var">SelectionOutputTokenQuantityExceedsLimit</span></a></span></span><span>
</span><span id="line-1483"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436211"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1484"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionOutputError ctx -&gt; Rep (SelectionOutputError ctx) x)
-&gt; (forall x.
    Rep (SelectionOutputError ctx) x -&gt; SelectionOutputError ctx)
-&gt; Generic (SelectionOutputError ctx)
forall x.
Rep (SelectionOutputError ctx) x -&gt; SelectionOutputError ctx
forall x.
SelectionOutputError ctx -&gt; Rep (SelectionOutputError ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionOutputError ctx) x -&gt; SelectionOutputError ctx
forall ctx x.
SelectionOutputError ctx -&gt; Rep (SelectionOutputError ctx) x
$cto :: forall ctx x.
Rep (SelectionOutputError ctx) x -&gt; SelectionOutputError ctx
$cfrom :: forall ctx x.
SelectionOutputError ctx -&gt; Rep (SelectionOutputError ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-1485"></span><span>
</span><span id="line-1486"></span><span id="local-6989586621682435304"><span id="local-6989586621682435306"><span id="local-6989586621682435308"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435308"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-type">SelectionOutputError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435308"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1487"></span><span id="local-6989586621682435297"><span id="local-6989586621682435299"><span id="local-6989586621682435301"><span id="local-6989586621682435303"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435303"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputError"><span class="hs-identifier hs-type">SelectionOutputError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435303"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1488"></span><span>
</span><span id="line-1489"></span><span id="local-6989586621682435295"><span id="local-6989586621682435296"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="SelectionOutputSizeExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">SelectionOutputSizeExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682436187"><span class="annot"><a href="#local-6989586621682436187"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1490"></span><span>    </span><span id="SelectionOutputSizeExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">SelectionOutputSizeExceedsLimitError</span></a></span></span><span>
</span><span id="line-1491"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AoutputThatExceedsLimit%3ASelectionOutputSizeExceedsLimitError"><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
-&gt; (Address ctx, TokenBundle)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AoutputThatExceedsLimit%3ASelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var hs-var">outputThatExceedsLimit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436187"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1492"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1493"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionOutputSizeExceedsLimitError ctx
 -&gt; Rep (SelectionOutputSizeExceedsLimitError ctx) x)
-&gt; (forall x.
    Rep (SelectionOutputSizeExceedsLimitError ctx) x
    -&gt; SelectionOutputSizeExceedsLimitError ctx)
-&gt; Generic (SelectionOutputSizeExceedsLimitError ctx)
forall x.
Rep (SelectionOutputSizeExceedsLimitError ctx) x
-&gt; SelectionOutputSizeExceedsLimitError ctx
forall x.
SelectionOutputSizeExceedsLimitError ctx
-&gt; Rep (SelectionOutputSizeExceedsLimitError ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionOutputSizeExceedsLimitError ctx) x
-&gt; SelectionOutputSizeExceedsLimitError ctx
forall ctx x.
SelectionOutputSizeExceedsLimitError ctx
-&gt; Rep (SelectionOutputSizeExceedsLimitError ctx) x
$cto :: forall ctx x.
Rep (SelectionOutputSizeExceedsLimitError ctx) x
-&gt; SelectionOutputSizeExceedsLimitError ctx
$cfrom :: forall ctx x.
SelectionOutputSizeExceedsLimitError ctx
-&gt; Rep (SelectionOutputSizeExceedsLimitError ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-1494"></span><span>
</span><span id="line-1495"></span><span id="local-6989586621682435286"><span id="local-6989586621682435288"><span id="local-6989586621682435290"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435290"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1496"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435290"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1497"></span><span id="local-6989586621682435279"><span id="local-6989586621682435281"><span id="local-6989586621682435283"><span id="local-6989586621682435285"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435285"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1498"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435285"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1499"></span><span>
</span><span id="line-1500"></span><span class="hs-comment">-- | Verifies the size of an output.</span><span>
</span><span id="line-1501"></span><span class="hs-comment">--</span><span>
</span><span id="line-1502"></span><span class="hs-comment">-- Returns 'SelectionOutputSizeExceedsLimitError' if and only if the size</span><span>
</span><span id="line-1503"></span><span class="hs-comment">-- exceeds the limit defined by the protocol.</span><span>
</span><span id="line-1504"></span><span class="hs-comment">--</span><span>
</span><span id="line-1505"></span><span id="local-6989586621682436350"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputSize"><span class="hs-identifier hs-type">verifyOutputSize</span></a></span><span>
</span><span id="line-1506"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436350"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1507"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436350"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1508"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436350"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1509"></span><span id="verifyOutputSize"><span class="annot"><span class="annottext">verifyOutputSize :: SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputSize"><span class="hs-identifier hs-var hs-var">verifyOutputSize</span></a></span></span><span> </span><span id="local-6989586621682435278"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435278"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621682435277"><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435277"><span class="hs-identifier hs-var">out</span></a></span></span><span>
</span><span id="line-1510"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435276"><span class="hs-identifier hs-var">withinLimit</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1511"></span><span>        </span><span class="annot"><span class="annottext">Maybe (SelectionOutputSizeExceedsLimitError ctx)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1512"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1513"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputSizeExceedsLimitError ctx
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(SelectionOutputSizeExceedsLimitError ctx
 -&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx))
-&gt; SelectionOutputSizeExceedsLimitError ctx
-&gt; Maybe (SelectionOutputSizeExceedsLimitError ctx)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
-&gt; SelectionOutputSizeExceedsLimitError ctx
forall ctx.
(Address ctx, TokenBundle)
-&gt; SelectionOutputSizeExceedsLimitError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputSizeExceedsLimitError"><span class="hs-identifier hs-var">SelectionOutputSizeExceedsLimitError</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435277"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-1514"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1515"></span><span>    </span><span class="annot"><a href="#local-6989586621682435276"><span class="hs-identifier hs-type">withinLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1516"></span><span>    </span><span id="local-6989586621682435276"><span class="annot"><span class="annottext">withinLimit :: Bool
</span><a href="#local-6989586621682435276"><span class="hs-identifier hs-var hs-var">withinLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1517"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435278"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((TokenBundle -&gt; TokenBundleSizeAssessment)
     -&gt; Const
          (TokenBundle -&gt; TokenBundleSizeAssessment)
          (TokenBundle -&gt; TokenBundleSizeAssessment))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (TokenBundle -&gt; TokenBundleSizeAssessment)
         (SelectionConstraints ctx))
-&gt; TokenBundle
-&gt; TokenBundleSizeAssessment
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;assessTokenBundleSize&quot;
  (((TokenBundle -&gt; TokenBundleSizeAssessment)
    -&gt; Const
         (TokenBundle -&gt; TokenBundleSizeAssessment)
         (TokenBundle -&gt; TokenBundleSizeAssessment))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (TokenBundle -&gt; TokenBundleSizeAssessment)
        (SelectionConstraints ctx))
((TokenBundle -&gt; TokenBundleSizeAssessment)
 -&gt; Const
      (TokenBundle -&gt; TokenBundleSizeAssessment)
      (TokenBundle -&gt; TokenBundleSizeAssessment))
-&gt; SelectionConstraints ctx
-&gt; Const
     (TokenBundle -&gt; TokenBundleSizeAssessment)
     (SelectionConstraints ctx)
</span><a href="#local-6989586621682435275"><span class="hs-var">#assessTokenBundleSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435277"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1518"></span><span>            </span><span class="annot"><span class="annottext">TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeWithinLimit"><span class="hs-identifier hs-var">TokenBundleSizeWithinLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-1519"></span><span>            </span><span class="annot"><span class="annottext">TokenBundleSizeAssessment
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#TokenBundleSizeExceedsLimit"><span class="hs-identifier hs-var">TokenBundleSizeExceedsLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-1520"></span><span>
</span><span id="line-1521"></span><span class="hs-comment">-- | Indicates that a token quantity exceeds the maximum quantity that can</span><span>
</span><span id="line-1522"></span><span class="hs-comment">--   appear in a transaction output's token bundle.</span><span>
</span><span id="line-1523"></span><span class="hs-comment">--</span><span>
</span><span id="line-1524"></span><span id="local-6989586621682435273"><span id="local-6989586621682435274"></span></span><span class="hs-keyword">data</span><span> </span><span id="SelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">SelectionOutputTokenQuantityExceedsLimitError</span></a></span></span><span> </span><span id="local-6989586621682436175"><span class="annot"><a href="#local-6989586621682436175"><span class="hs-identifier hs-type">ctx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1525"></span><span>    </span><span id="SelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">SelectionOutputTokenQuantityExceedsLimitError</span></a></span></span><span>
</span><span id="line-1526"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aaddress%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx -&gt; Address ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aaddress%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436175"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1527"></span><span>      </span><span class="hs-comment">-- ^ The address to which this token quantity was to be sent.</span><span>
</span><span id="line-1528"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aasset%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx -&gt; AssetId
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aasset%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">asset</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span>
</span><span id="line-1529"></span><span>      </span><span class="hs-comment">-- ^ The asset identifier to which this token quantity corresponds.</span><span>
</span><span id="line-1530"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aquantity%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx -&gt; TokenQuantity
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3Aquantity%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">quantity</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenQuantity.html#TokenQuantity"><span class="hs-identifier hs-type">TokenQuantity</span></a></span><span>
</span><span id="line-1531"></span><span>      </span><span class="hs-comment">-- ^ The token quantity that exceeded the bound.</span><span>
</span><span id="line-1532"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AquantityMaxBound%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError ctx -&gt; TokenQuantity
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AquantityMaxBound%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var hs-var">quantityMaxBound</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenQuantity.html#TokenQuantity"><span class="hs-identifier hs-type">TokenQuantity</span></a></span><span>
</span><span id="line-1533"></span><span>      </span><span class="hs-comment">-- ^ The maximum allowable token quantity.</span><span>
</span><span id="line-1534"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1535"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="annottext">(forall x.
 SelectionOutputTokenQuantityExceedsLimitError ctx
 -&gt; Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x)
-&gt; (forall x.
    Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
    -&gt; SelectionOutputTokenQuantityExceedsLimitError ctx)
-&gt; Generic (SelectionOutputTokenQuantityExceedsLimitError ctx)
forall x.
Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
forall x.
SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall ctx x.
Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
forall ctx x.
SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
$cto :: forall ctx x.
Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
$cfrom :: forall ctx x.
SelectionOutputTokenQuantityExceedsLimitError ctx
-&gt; Rep (SelectionOutputTokenQuantityExceedsLimitError ctx) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span>
</span><span id="line-1536"></span><span>
</span><span id="line-1537"></span><span id="local-6989586621682435261"><span id="local-6989586621682435263"><span id="local-6989586621682435265"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435265"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1538"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435265"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1539"></span><span id="local-6989586621682435254"><span id="local-6989586621682435256"><span id="local-6989586621682435258"><span id="local-6989586621682435260"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier hs-type">SelectionContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435260"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1540"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435260"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-1541"></span><span>
</span><span id="line-1542"></span><span class="hs-comment">-- | Verifies the token quantities of an output.</span><span>
</span><span id="line-1543"></span><span class="hs-comment">--</span><span>
</span><span id="line-1544"></span><span class="hs-comment">-- Returns a list of token quantities that exceed the limit defined by the</span><span>
</span><span id="line-1545"></span><span class="hs-comment">-- protocol.</span><span>
</span><span id="line-1546"></span><span class="hs-comment">--</span><span>
</span><span id="line-1547"></span><span id="local-6989586621682436343"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputTokenQuantities"><span class="hs-identifier hs-type">verifyOutputTokenQuantities</span></a></span><span>
</span><span id="line-1548"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436343"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436343"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1550"></span><span id="verifyOutputTokenQuantities"><span class="annot"><span class="annottext">verifyOutputTokenQuantities :: (Address ctx, TokenBundle)
-&gt; [SelectionOutputTokenQuantityExceedsLimitError ctx]
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputTokenQuantities"><span class="hs-identifier hs-var hs-var">verifyOutputTokenQuantities</span></a></span></span><span> </span><span id="local-6989586621682435253"><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435253"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1551"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">SelectionOutputTokenQuantityExceedsLimitError :: forall ctx.
Address ctx
-&gt; AssetId
-&gt; TokenQuantity
-&gt; TokenQuantity
-&gt; SelectionOutputTokenQuantityExceedsLimitError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-type">SelectionOutputTokenQuantityExceedsLimitError</span></a></span><span>
</span><span id="line-1552"></span><span>        </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Address ctx
address :: Address ctx
$sel:address:SelectionOutputTokenQuantityExceedsLimitError :: Address ctx
</span><a href="#local-6989586621682435252"><span class="hs-identifier hs-var hs-var">address</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AssetId
asset :: AssetId
$sel:asset:SelectionOutputTokenQuantityExceedsLimitError :: AssetId
</span><a href="#local-6989586621682435251"><span class="hs-identifier hs-var hs-var">asset</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenQuantity
quantity :: TokenQuantity
$sel:quantity:SelectionOutputTokenQuantityExceedsLimitError :: TokenQuantity
</span><a href="#local-6989586621682435250"><span class="hs-identifier hs-var hs-var">quantity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:quantityMaxBound:SelectionOutputTokenQuantityExceedsLimitError :: TokenQuantity
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#%24sel%3AquantityMaxBound%3ASelectionOutputTokenQuantityExceedsLimitError"><span class="hs-identifier hs-var">quantityMaxBound</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TokenQuantity
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#txOutMaxTokenQuantity"><span class="hs-identifier hs-var">txOutMaxTokenQuantity</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1553"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682435252"><span class="annot"><span class="annottext">address :: Address ctx
</span><a href="#local-6989586621682435252"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; Address ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435253"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-1554"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682435251"><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621682435251"><span class="hs-identifier hs-var">asset</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682435250"><span class="annot"><span class="annottext">TokenQuantity
</span><a href="#local-6989586621682435250"><span class="hs-identifier hs-var">quantity</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TokenMap -&gt; [(AssetId, TokenQuantity)]
</span><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#toFlatList"><span class="hs-identifier hs-var">TokenMap.toFlatList</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenMap -&gt; [(AssetId, TokenQuantity)])
-&gt; TokenMap -&gt; [(AssetId, TokenQuantity)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435253"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((TokenMap -&gt; Const TokenMap TokenMap)
    -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
-&gt; TokenMap
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;tokens&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; TokenBundle -&gt; Const TokenMap TokenBundle
</span><a href="#local-6989586621682435248"><span class="hs-var">#tokens</span></a></span><span>
</span><span id="line-1555"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenQuantity
</span><a href="#local-6989586621682435250"><span class="hs-identifier hs-var">quantity</span></a></span><span> </span><span class="annot"><span class="annottext">TokenQuantity -&gt; TokenQuantity -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TokenQuantity
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#txOutMaxTokenQuantity"><span class="hs-identifier hs-var">txOutMaxTokenQuantity</span></a></span><span>
</span><span id="line-1556"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-1557"></span><span>
</span><span id="line-1558"></span><span class="hs-comment">-- | Verifies that an output's ada quantity is sufficient.</span><span>
</span><span id="line-1559"></span><span class="hs-comment">--</span><span>
</span><span id="line-1560"></span><span class="hs-comment">-- An output's ada quantity must be greater than or equal to the minimum</span><span>
</span><span id="line-1561"></span><span class="hs-comment">-- required quantity for that output.</span><span>
</span><span id="line-1562"></span><span class="hs-comment">--</span><span>
</span><span id="line-1563"></span><span id="local-6989586621682436210"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputCoinSufficient"><span class="hs-identifier hs-type">verifyOutputCoinSufficient</span></a></span><span>
</span><span id="line-1564"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionConstraints"><span class="hs-identifier hs-type">SelectionConstraints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436210"><span class="hs-identifier hs-type">ctx</span></a></span><span>
</span><span id="line-1565"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436210"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1566"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682436210"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-1567"></span><span id="verifyOutputCoinSufficient"><span class="annot"><span class="annottext">verifyOutputCoinSufficient :: SelectionConstraints ctx
-&gt; (Address ctx, TokenBundle)
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#verifyOutputCoinSufficient"><span class="hs-identifier hs-var hs-var">verifyOutputCoinSufficient</span></a></span></span><span> </span><span id="local-6989586621682435247"><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435247"><span class="hs-identifier hs-var">constraints</span></a></span></span><span> </span><span id="local-6989586621682435246"><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435246"><span class="hs-identifier hs-var">output</span></a></span></span><span>
</span><span id="line-1568"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621682435245"><span class="hs-identifier hs-var">isBelowMinimum</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1569"></span><span>        </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError ctx
-&gt; Maybe (SelectionOutputCoinInsufficientError ctx)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionOutputCoinInsufficientError :: forall ctx.
Coin
-&gt; (Address ctx, TokenBundle)
-&gt; SelectionOutputCoinInsufficientError ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.html#SelectionOutputCoinInsufficientError"><span class="hs-identifier hs-type">SelectionOutputCoinInsufficientError</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Coin
minimumExpectedCoin :: Coin
$sel:minimumExpectedCoin:SelectionOutputCoinInsufficientError :: Coin
</span><a href="#local-6989586621682435244"><span class="hs-identifier hs-var hs-var">minimumExpectedCoin</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
output :: (Address ctx, TokenBundle)
$sel:output:SelectionOutputCoinInsufficientError :: (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435246"><span class="hs-identifier hs-var hs-var">output</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1570"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1571"></span><span>        </span><span class="annot"><span class="annottext">Maybe (SelectionOutputCoinInsufficientError ctx)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-1572"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1573"></span><span>    </span><span class="annot"><a href="#local-6989586621682435245"><span class="hs-identifier hs-type">isBelowMinimum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-1574"></span><span>    </span><span id="local-6989586621682435245"><span class="annot"><span class="annottext">isBelowMinimum :: Bool
</span><a href="#local-6989586621682435245"><span class="hs-identifier hs-var hs-var">isBelowMinimum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Address ctx -&gt; TokenBundle -&gt; Bool)
-&gt; (Address ctx, TokenBundle) -&gt; Bool
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435247"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((Address ctx -&gt; TokenBundle -&gt; Bool)
     -&gt; Const
          (Address ctx -&gt; TokenBundle -&gt; Bool)
          (Address ctx -&gt; TokenBundle -&gt; Bool))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx))
-&gt; Address ctx
-&gt; TokenBundle
-&gt; Bool
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;isBelowMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenBundle -&gt; Bool)
    -&gt; Const
         (Address ctx -&gt; TokenBundle -&gt; Bool)
         (Address ctx -&gt; TokenBundle -&gt; Bool))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx))
((Address ctx -&gt; TokenBundle -&gt; Bool)
 -&gt; Const
      (Address ctx -&gt; TokenBundle -&gt; Bool)
      (Address ctx -&gt; TokenBundle -&gt; Bool))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenBundle -&gt; Bool) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435243"><span class="hs-var">#isBelowMinimumAdaQuantity</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435246"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-1575"></span><span>
</span><span id="line-1576"></span><span>    </span><span class="annot"><a href="#local-6989586621682435244"><span class="hs-identifier hs-type">minimumExpectedCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-1577"></span><span>    </span><span id="local-6989586621682435244"><span class="annot"><span class="annottext">minimumExpectedCoin :: Coin
</span><a href="#local-6989586621682435244"><span class="hs-identifier hs-var hs-var">minimumExpectedCoin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1578"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SelectionConstraints ctx
</span><a href="#local-6989586621682435247"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionConstraints ctx
-&gt; (((Address ctx -&gt; TokenMap -&gt; Coin)
     -&gt; Const
          (Address ctx -&gt; TokenMap -&gt; Coin)
          (Address ctx -&gt; TokenMap -&gt; Coin))
    -&gt; SelectionConstraints ctx
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
-&gt; Address ctx
-&gt; TokenMap
-&gt; Coin
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;computeMinimumAdaQuantity&quot;
  (((Address ctx -&gt; TokenMap -&gt; Coin)
    -&gt; Const
         (Address ctx -&gt; TokenMap -&gt; Coin)
         (Address ctx -&gt; TokenMap -&gt; Coin))
   -&gt; SelectionConstraints ctx
   -&gt; Const
        (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx))
((Address ctx -&gt; TokenMap -&gt; Coin)
 -&gt; Const
      (Address ctx -&gt; TokenMap -&gt; Coin)
      (Address ctx -&gt; TokenMap -&gt; Coin))
-&gt; SelectionConstraints ctx
-&gt; Const
     (Address ctx -&gt; TokenMap -&gt; Coin) (SelectionConstraints ctx)
</span><a href="#local-6989586621682435242"><span class="hs-var">#computeMinimumAdaQuantity</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1579"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; Address ctx
forall a b. (a, b) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435246"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1580"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; TokenBundle
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle)
</span><a href="#local-6989586621682435246"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
-&gt; ((TokenMap -&gt; Const TokenMap TokenMap)
    -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
-&gt; TokenMap
forall s a. s -&gt; ((a -&gt; Const a a) -&gt; s -&gt; Const a s) -&gt; a
</span><a href="../../../../generic-lens/html/src"><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">IsLabel
  &quot;tokens&quot;
  ((TokenMap -&gt; Const TokenMap TokenMap)
   -&gt; TokenBundle -&gt; Const TokenMap TokenBundle)
(TokenMap -&gt; Const TokenMap TokenMap)
-&gt; TokenBundle -&gt; Const TokenMap TokenBundle
</span><a href="#local-6989586621682435241"><span class="hs-var">#tokens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1581"></span></pre></body></html>