<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RoleAnnotations #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Copyright: &#169; 2018-2020 IOHK</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License: Apache-2.0</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Implementation of address derivation for 'Shelley' Keys.</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation.Shelley</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier">ShelleyKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Constants</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#minSeedLengthBytes"><span class="hs-identifier">minSeedLengthBytes</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generation and derivation</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#generateKeyFromSeed"><span class="hs-identifier">generateKeyFromSeed</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeed"><span class="hs-identifier">unsafeGenerateKeyFromSeed</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeedShelley"><span class="hs-identifier">unsafeGenerateKeyFromSeedShelley</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAccountPrivateKeyShelley"><span class="hs-identifier">deriveAccountPrivateKeyShelley</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPrivateKeyShelley"><span class="hs-identifier">deriveAddressPrivateKeyShelley</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPublicKeyShelley"><span class="hs-identifier">deriveAddressPublicKeyShelley</span></a></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reward Account</span></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#toRewardAccountRaw"><span class="hs-identifier">toRewardAccountRaw</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">Cardano.Crypto.Wallet</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">DerivationScheme</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">XPrv</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">XPub</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">deriveXPrv</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">deriveXPub</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">generateNew</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">toXPub</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">unXPrv</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">unXPub</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">xprv</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier">xpub</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Mnemonic</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">SomeMnemonic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">entropyToBytes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">mnemonicToEntropy</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#BoundedAddressLength"><span class="hs-identifier">BoundedAddressLength</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DelegationAddress"><span class="hs-identifier">DelegationAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Depth"><span class="hs-identifier">Depth</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier">DerivationIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationType"><span class="hs-identifier">DerivationType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#HardDerivation"><span class="hs-identifier">HardDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier">KeyFingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#MkKeyFingerprint"><span class="hs-identifier">MkKeyFingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#NetworkDiscriminant"><span class="hs-identifier">NetworkDiscriminant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PaymentAddress"><span class="hs-identifier">PaymentAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PersistPrivateKey"><span class="hs-identifier">PersistPrivateKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PersistPublicKey"><span class="hs-identifier">PersistPublicKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.RewardAccount.html#RewardAccount"><span class="hs-identifier">RewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Role"><span class="hs-identifier">Role</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#SoftDerivation"><span class="hs-identifier">SoftDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#ToRewardAccount"><span class="hs-identifier">ToRewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#WalletKey"><span class="hs-identifier">WalletKey</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#fromHex"><span class="hs-identifier">fromHex</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#hex"><span class="hs-identifier">hex</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#mutableAccount"><span class="hs-identifier">mutableAccount</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDiscovery</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#DiscoverTxs"><span class="hs-identifier">DiscoverTxs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#GetPurpose"><span class="hs-identifier">GetPurpose</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#IsOurs"><span class="hs-identifier">IsOurs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#MaybeLight"><span class="hs-identifier">MaybeLight</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDiscovery.Sequential</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationPrefix"><span class="hs-identifier">DerivationPrefix</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#SeqState"><span class="hs-identifier">SeqState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#coinTypeAda"><span class="hs-identifier">coinTypeAda</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#discoverSeqWithRewards"><span class="hs-identifier">discoverSeqWithRewards</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#purposeBIP44"><span class="hs-identifier">purposeBIP44</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#purposeCIP1852"><span class="hs-identifier">purposeCIP1852</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#rewardAccountKey"><span class="hs-identifier">rewardAccountKey</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Passphrase</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier">Passphrase</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#PassphraseHash"><span class="hs-identifier">PassphraseHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.html#changePassphraseXPrv"><span class="hs-identifier">changePassphraseXPrv</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Address</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier">Address</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Util.html"><span class="hs-identifier">Cardano.Wallet.Util</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Util.html#invariant"><span class="hs-identifier">invariant</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;=&lt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Hash</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">hash</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Hash.Algorithms</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Blake2b_224</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Hash.IO</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">HashAlgorithm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">hashDigestSize</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Crypto.Hash.Utils.html"><span class="hs-identifier">Crypto.Hash.Utils</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier">blake2b224</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">Data.Binary.Put</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">putByteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">putWord8</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">runPut</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BA</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-123"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List.NonEmpty</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                            Sequential Derivation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | A cryptographic key for Shelley address derivation, with phantom-types to</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- disambiguate derivation paths</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- let rootPrivateKey = ShelleyKey 'RootK XPrv</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- let accountPubKey = ShelleyKey 'AccountK XPub</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- let addressPubKey = ShelleyKey 'AddressK XPub</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-137"></span><span id="local-6989586621682446302"><span id="local-6989586621682446303"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="ShelleyKey"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682446528"><span class="annot"><a href="#local-6989586621682446528"><span class="hs-identifier hs-type">depth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446529"><span class="annot"><a href="#local-6989586621682446529"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>    </span><span id="ShelleyKey"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getKey"><span class="annot"><span class="annottext">ShelleyKey depth key -&gt; key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682446529"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. ShelleyKey depth key -&gt; Rep (ShelleyKey depth key) x)
-&gt; (forall x. Rep (ShelleyKey depth key) x -&gt; ShelleyKey depth key)
-&gt; Generic (ShelleyKey depth key)
forall x. Rep (ShelleyKey depth key) x -&gt; ShelleyKey depth key
forall x. ShelleyKey depth key -&gt; Rep (ShelleyKey depth key) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (depth :: Depth) key x.
Rep (ShelleyKey depth key) x -&gt; ShelleyKey depth key
forall (depth :: Depth) key x.
ShelleyKey depth key -&gt; Rep (ShelleyKey depth key) x
$cto :: forall (depth :: Depth) key x.
Rep (ShelleyKey depth key) x -&gt; ShelleyKey depth key
$cfrom :: forall (depth :: Depth) key x.
ShelleyKey depth key -&gt; Rep (ShelleyKey depth key) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446291"><span id="local-6989586621682446293"><span id="local-6989586621682446295"><span class="annot"><span class="annottext">Int -&gt; ShelleyKey depth key -&gt; ShowS
[ShelleyKey depth key] -&gt; ShowS
ShelleyKey depth key -&gt; String
(Int -&gt; ShelleyKey depth key -&gt; ShowS)
-&gt; (ShelleyKey depth key -&gt; String)
-&gt; ([ShelleyKey depth key] -&gt; ShowS)
-&gt; Show (ShelleyKey depth key)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (depth :: Depth) key.
Show key =&gt;
Int -&gt; ShelleyKey depth key -&gt; ShowS
forall (depth :: Depth) key.
Show key =&gt;
[ShelleyKey depth key] -&gt; ShowS
forall (depth :: Depth) key.
Show key =&gt;
ShelleyKey depth key -&gt; String
showList :: [ShelleyKey depth key] -&gt; ShowS
$cshowList :: forall (depth :: Depth) key.
Show key =&gt;
[ShelleyKey depth key] -&gt; ShowS
show :: ShelleyKey depth key -&gt; String
$cshow :: forall (depth :: Depth) key.
Show key =&gt;
ShelleyKey depth key -&gt; String
showsPrec :: Int -&gt; ShelleyKey depth key -&gt; ShowS
$cshowsPrec :: forall (depth :: Depth) key.
Show key =&gt;
Int -&gt; ShelleyKey depth key -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446286"><span id="local-6989586621682446288"><span class="annot"><span class="annottext">ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
(ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool)
-&gt; (ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool)
-&gt; Eq (ShelleyKey depth key)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (depth :: Depth) key.
Eq key =&gt;
ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
/= :: ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
$c/= :: forall (depth :: Depth) key.
Eq key =&gt;
ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
== :: ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
$c== :: forall (depth :: Depth) key.
Eq key =&gt;
ShelleyKey depth key -&gt; ShelleyKey depth key -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621682446283"><span id="local-6989586621682446284"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682446281"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446284"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446283"><span class="hs-identifier hs-type">depth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446284"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | The minimum seed length for 'generateKeyFromSeed' and</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- 'unsafeGenerateKeyFromSeed'.</span><span>
</span><span id="line-145"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#minSeedLengthBytes"><span class="hs-identifier hs-type">minSeedLengthBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-146"></span><span id="minSeedLengthBytes"><span class="annot"><span class="annottext">minSeedLengthBytes :: Int
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#minSeedLengthBytes"><span class="hs-identifier hs-var hs-var">minSeedLengthBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Generate a root key from a corresponding seed.</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- The seed should be at least 16 bytes.</span><span>
</span><span id="line-150"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#generateKeyFromSeed"><span class="hs-identifier hs-type">generateKeyFromSeed</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>       </span><span class="hs-comment">-- ^ The actual seed and its recovery / generation passphrase</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;encryption&quot;</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#RootK"><span class="hs-identifier hs-type">RootK</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-155"></span><span id="generateKeyFromSeed"><span class="annot"><span class="annottext">generateKeyFromSeed :: (SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; ShelleyKey 'RootK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#generateKeyFromSeed"><span class="hs-identifier hs-var hs-var">generateKeyFromSeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; ShelleyKey 'RootK XPrv
forall (depth :: Depth).
(SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; ShelleyKey depth XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeed"><span class="hs-identifier hs-var">unsafeGenerateKeyFromSeed</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Generate a new key from seed. Note that the @depth@ is left open so that</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- the caller gets to decide what type of key this is. This is mostly for</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- testing, in practice, seeds are used to represent root keys, and one should</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- use 'generateKeyFromSeed'.</span><span>
</span><span id="line-161"></span><span id="local-6989586621682446531"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeed"><span class="hs-identifier hs-type">unsafeGenerateKeyFromSeed</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-comment">-- ^ The actual seed and its recovery / generation passphrase</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;encryption&quot;</span></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446531"><span class="hs-identifier hs-type">depth</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span></span><span>
</span><span id="line-166"></span><span id="unsafeGenerateKeyFromSeed"><span class="annot"><span class="annottext">unsafeGenerateKeyFromSeed :: (SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; ShelleyKey depth XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeed"><span class="hs-identifier hs-var hs-var">unsafeGenerateKeyFromSeed</span></a></span></span><span> </span><span id="local-6989586621682446279"><span class="annot"><span class="annottext">(SomeMnemonic, Maybe SomeMnemonic)
</span><a href="#local-6989586621682446279"><span class="hs-identifier hs-var">mnemonics</span></a></span></span><span> </span><span id="local-6989586621682446278"><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446278"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">XPrv -&gt; ShelleyKey depth XPrv
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ShelleyKey depth XPrv) -&gt; XPrv -&gt; ShelleyKey depth XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeedShelley"><span class="hs-identifier hs-var">unsafeGenerateKeyFromSeedShelley</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeMnemonic, Maybe SomeMnemonic)
</span><a href="#local-6989586621682446279"><span class="hs-identifier hs-var">mnemonics</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446278"><span class="hs-identifier hs-var">pwd</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeedShelley"><span class="hs-identifier hs-type">unsafeGenerateKeyFromSeedShelley</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-comment">-- ^ The actual seed and its recovery / generation passphrase</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;encryption&quot;</span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-174"></span><span id="unsafeGenerateKeyFromSeedShelley"><span class="annot"><span class="annottext">unsafeGenerateKeyFromSeedShelley :: (SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#unsafeGenerateKeyFromSeedShelley"><span class="hs-identifier hs-var hs-var">unsafeGenerateKeyFromSeedShelley</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682446277"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682446277"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446276"><span class="annot"><span class="annottext">Maybe SomeMnemonic
</span><a href="#local-6989586621682446276"><span class="hs-identifier hs-var">m2nd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446275"><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446275"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; ScrubbedBytes -&gt; ScrubbedBytes -&gt; XPrv
forall keyPassPhrase generationPassPhrase seed.
(ByteArrayAccess keyPassPhrase,
 ByteArrayAccess generationPassPhrase, ByteArrayAccess seed) =&gt;
seed -&gt; generationPassPhrase -&gt; keyPassPhrase -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">generateNew</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446274"><span class="hs-identifier hs-var">seed'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScrubbedBytes
-&gt; (SomeMnemonic -&gt; ScrubbedBytes)
-&gt; Maybe SomeMnemonic
-&gt; ScrubbedBytes
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic -&gt; ScrubbedBytes
</span><a href="#local-6989586621682446272"><span class="hs-identifier hs-var">mnemonicToBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SomeMnemonic
</span><a href="#local-6989586621682446276"><span class="hs-identifier hs-var">m2nd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot; -&gt; ScrubbedBytes
forall (purpose :: Symbol). Passphrase purpose -&gt; ScrubbedBytes
</span><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#unPassphrase"><span class="hs-identifier hs-var hs-var">unPassphrase</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446275"><span class="hs-identifier hs-var">pwd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>    </span><span id="local-6989586621682446272"><span class="annot"><span class="annottext">mnemonicToBytes :: SomeMnemonic -&gt; ScrubbedBytes
</span><a href="#local-6989586621682446272"><span class="hs-identifier hs-var hs-var">mnemonicToBytes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">SomeMnemonic</span></a></span><span> </span><span id="local-6989586621682446269"><span class="annot"><span class="annottext">Mnemonic mw
</span><a href="#local-6989586621682446269"><span class="hs-identifier hs-var">mw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Entropy (EntropySize mw) -&gt; ScrubbedBytes
forall (n :: Nat). Entropy n -&gt; ScrubbedBytes
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">entropyToBytes</span></a></span><span> </span><span class="annot"><span class="annottext">(Entropy (EntropySize mw) -&gt; ScrubbedBytes)
-&gt; Entropy (EntropySize mw) -&gt; ScrubbedBytes
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Mnemonic mw -&gt; Entropy (EntropySize mw)
forall (mw :: Nat). Mnemonic mw -&gt; Entropy (EntropySize mw)
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">mnemonicToEntropy</span></a></span><span> </span><span class="annot"><span class="annottext">Mnemonic mw
</span><a href="#local-6989586621682446269"><span class="hs-identifier hs-var">mw</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621682446268"><span class="annot"><span class="annottext">seed :: ScrubbedBytes
</span><a href="#local-6989586621682446268"><span class="hs-identifier hs-var hs-var">seed</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SomeMnemonic -&gt; ScrubbedBytes
</span><a href="#local-6989586621682446272"><span class="hs-identifier hs-var">mnemonicToBytes</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682446277"><span class="hs-identifier hs-var">root</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621682446274"><span class="annot"><span class="annottext">seed' :: ScrubbedBytes
</span><a href="#local-6989586621682446274"><span class="hs-identifier hs-var hs-var">seed'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ScrubbedBytes -&gt; (ScrubbedBytes -&gt; Bool) -&gt; ScrubbedBytes
forall a. HasCallStack =&gt; String -&gt; a -&gt; (a -&gt; Bool) -&gt; a
</span><a href="Cardano.Wallet.Util.html#invariant"><span class="hs-identifier hs-var">invariant</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;seed length : &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.length</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446268"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; in (Passphrase \&quot;seed\&quot;) is not valid&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446268"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682446265"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446265"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.length</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446265"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#minSeedLengthBytes"><span class="hs-identifier hs-var">minSeedLengthBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; Int
forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">BA.length</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446265"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">255</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAccountPrivateKeyShelley"><span class="hs-identifier hs-type">deriveAccountPrivateKeyShelley</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PurposeK"><span class="hs-identifier hs-type">PurposeK</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;encryption&quot;</span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#AccountK"><span class="hs-identifier hs-type">AccountK</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-190"></span><span id="deriveAccountPrivateKeyShelley"><span class="annot"><span class="annottext">deriveAccountPrivateKeyShelley :: Index 'Hardened 'PurposeK
-&gt; Passphrase &quot;encryption&quot;
-&gt; XPrv
-&gt; Index 'Hardened 'AccountK
-&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAccountPrivateKeyShelley"><span class="hs-identifier hs-var hs-var">deriveAccountPrivateKeyShelley</span></a></span></span><span> </span><span id="local-6989586621682446262"><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="#local-6989586621682446262"><span class="hs-identifier hs-var">purpose</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span id="local-6989586621682446260"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446260"><span class="hs-identifier hs-var">pwd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446259"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446259"><span class="hs-identifier hs-var">rootXPrv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span id="local-6989586621682446257"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446257"><span class="hs-identifier hs-var">accIx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-192"></span><span>        </span><span id="local-6989586621682446256"><span class="annot"><span class="annottext">purposeXPrv :: XPrv
</span><a href="#local-6989586621682446256"><span class="hs-identifier hs-var hs-var">purposeXPrv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- lvl1 derivation; hardened derivation of purpose'</span><span>
</span><span id="line-193"></span><span>            </span><span class="annot"><span class="annottext">DerivationScheme -&gt; ScrubbedBytes -&gt; XPrv -&gt; Word32 -&gt; XPrv
forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446260"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446259"><span class="hs-identifier hs-var">rootXPrv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="#local-6989586621682446262"><span class="hs-identifier hs-var">purpose</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621682446253"><span class="annot"><span class="annottext">coinTypeXPrv :: XPrv
</span><a href="#local-6989586621682446253"><span class="hs-identifier hs-var hs-var">coinTypeXPrv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- lvl2 derivation; hardened derivation of coin_type'</span><span>
</span><span id="line-195"></span><span>            </span><span class="annot"><span class="annottext">DerivationScheme -&gt; ScrubbedBytes -&gt; XPrv -&gt; Word32 -&gt; XPrv
forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446260"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446256"><span class="hs-identifier hs-var">purposeXPrv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#coinTypeAda"><span class="hs-identifier hs-var">coinTypeAda</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>     </span><span class="hs-comment">-- lvl3 derivation; hardened derivation of account' index</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">DerivationScheme -&gt; ScrubbedBytes -&gt; XPrv -&gt; Word32 -&gt; XPrv
forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446260"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446253"><span class="hs-identifier hs-var">coinTypeXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446257"><span class="hs-identifier hs-var">accIx</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span id="local-6989586621682446472"><span id="local-6989586621682446473"><span id="local-6989586621682446474"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPrivateKeyShelley"><span class="hs-identifier hs-type">deriveAddressPrivateKeyShelley</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446474"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;encryption&quot;</span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682446474"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446473"><span class="hs-identifier hs-type">derivationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446472"><span class="hs-identifier hs-type">level</span></a></span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span></span><span>
</span><span id="line-206"></span><span id="deriveAddressPrivateKeyShelley"><span class="annot"><span class="annottext">deriveAddressPrivateKeyShelley :: Passphrase &quot;encryption&quot;
-&gt; XPrv -&gt; a -&gt; Index derivationType level -&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPrivateKeyShelley"><span class="hs-identifier hs-var hs-var">deriveAddressPrivateKeyShelley</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#Passphrase"><span class="hs-identifier hs-type">Passphrase</span></a></span><span> </span><span id="local-6989586621682446252"><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446252"><span class="hs-identifier hs-var">pwd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446251"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446251"><span class="hs-identifier hs-var">accXPrv</span></a></span></span><span> </span><span id="local-6989586621682446250"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682446250"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span id="local-6989586621682446249"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446249"><span class="hs-identifier hs-var">addrIx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-208"></span><span>        </span><span id="local-6989586621682446248"><span class="annot"><span class="annottext">changeCode :: Word32
</span><a href="#local-6989586621682446248"><span class="hs-identifier hs-var hs-var">changeCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>            </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682446250"><span class="hs-keyword hs-var">role</span></a></span><span>
</span><span id="line-210"></span><span>        </span><span id="local-6989586621682446246"><span class="annot"><span class="annottext">changeXPrv :: XPrv
</span><a href="#local-6989586621682446246"><span class="hs-identifier hs-var hs-var">changeXPrv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- lvl4 derivation; soft derivation of change chain</span><span>
</span><span id="line-211"></span><span>            </span><span class="annot"><span class="annottext">DerivationScheme -&gt; ScrubbedBytes -&gt; XPrv -&gt; Word32 -&gt; XPrv
forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446252"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446251"><span class="hs-identifier hs-var">accXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446248"><span class="hs-identifier hs-var">changeCode</span></a></span><span>
</span><span id="line-212"></span><span>       </span><span class="hs-comment">-- lvl5 derivation; soft derivation of address index</span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">DerivationScheme -&gt; ScrubbedBytes -&gt; XPrv -&gt; Word32 -&gt; XPrv
forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes
</span><a href="#local-6989586621682446252"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446246"><span class="hs-identifier hs-var">changeXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446249"><span class="hs-identifier hs-var">addrIx</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span id="local-6989586621682446467"><span id="local-6989586621682446468"><span id="local-6989586621682446469"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPublicKeyShelley"><span class="hs-identifier hs-type">deriveAddressPublicKeyShelley</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446469"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682446469"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446468"><span class="hs-identifier hs-type">derivationType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446467"><span class="hs-identifier hs-type">level</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPub</span></a></span></span></span></span><span>
</span><span id="line-221"></span><span id="deriveAddressPublicKeyShelley"><span class="annot"><span class="annottext">deriveAddressPublicKeyShelley :: XPub -&gt; a -&gt; Index derivationType level -&gt; XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPublicKeyShelley"><span class="hs-identifier hs-var hs-var">deriveAddressPublicKeyShelley</span></a></span></span><span> </span><span id="local-6989586621682446245"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446245"><span class="hs-identifier hs-var">accXPub</span></a></span></span><span> </span><span id="local-6989586621682446244"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682446244"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span id="local-6989586621682446243"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446243"><span class="hs-identifier hs-var">addrIx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">XPub -&gt; Maybe XPub -&gt; XPub
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446242"><span class="hs-identifier hs-var">errWrongIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe XPub -&gt; XPub) -&gt; Maybe XPub -&gt; XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682446241"><span class="annot"><span class="annottext">changeCode :: Word32
</span><a href="#local-6989586621682446241"><span class="hs-identifier hs-var hs-var">changeCode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32) -&gt; Int -&gt; Word32
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682446244"><span class="hs-keyword hs-var">role</span></a></span><span>
</span><span id="line-224"></span><span>        </span><span id="local-6989586621682446240"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446240"><span class="hs-identifier hs-var">changeXPub</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-comment">-- lvl4 derivation in bip44 is derivation of change chain</span><span>
</span><span id="line-225"></span><span>            </span><span class="annot"><span class="annottext">DerivationScheme -&gt; XPub -&gt; Word32 -&gt; Maybe XPub
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPub</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446245"><span class="hs-identifier hs-var">accXPub</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446241"><span class="hs-identifier hs-var">changeCode</span></a></span><span>
</span><span id="line-226"></span><span>        </span><span class="hs-comment">-- lvl5 derivation in bip44 is derivation of address chain</span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">DerivationScheme -&gt; XPub -&gt; Word32 -&gt; Maybe XPub
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">deriveXPub</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">DerivationScheme2</span></a></span><span> </span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446240"><span class="hs-identifier hs-var">changeXPub</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446243"><span class="hs-identifier hs-var">addrIx</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-229"></span><span>      </span><span id="local-6989586621682446242"><span class="annot"><span class="annottext">errWrongIndex :: XPub
</span><a href="#local-6989586621682446242"><span class="hs-identifier hs-var hs-var">errWrongIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPub
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; XPub) -&gt; String -&gt; XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;deriveAddressPublicKey failed: was given an hardened (or too big) \
          \index for soft path derivation ( &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621682446243"><span class="hs-identifier hs-var">addrIx</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;). This is \
          \either a programmer error, or, we may have reached the maximum \
          \number of addresses for a given wallet.&quot;</span></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#HardDerivation"><span class="hs-identifier hs-type">HardDerivation</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="AddressIndexDerivationType"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#AddressIndexDerivationType"><span class="hs-identifier hs-var">AddressIndexDerivationType</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621682446235"><span class="annot"><span class="annottext">deriveAccountPrivateKey :: Passphrase &quot;encryption&quot;
-&gt; ShelleyKey 'RootK XPrv
-&gt; Index 'Hardened 'AccountK
-&gt; ShelleyKey 'AccountK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#deriveAccountPrivateKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">deriveAccountPrivateKey</span></a></span></span><span> </span><span id="local-6989586621682446233"><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446233"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446232"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446232"><span class="hs-identifier hs-var">rootXPrv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446231"><span class="annot"><span class="annottext">Index 'Hardened 'AccountK
</span><a href="#local-6989586621682446231"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="annottext">XPrv -&gt; ShelleyKey 'AccountK XPrv
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ShelleyKey 'AccountK XPrv)
-&gt; XPrv -&gt; ShelleyKey 'AccountK XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
-&gt; Passphrase &quot;encryption&quot;
-&gt; XPrv
-&gt; Index 'Hardened 'AccountK
-&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAccountPrivateKeyShelley"><span class="hs-identifier hs-var">deriveAccountPrivateKeyShelley</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#purposeCIP1852"><span class="hs-identifier hs-var">purposeCIP1852</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446233"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446232"><span class="hs-identifier hs-var">rootXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'AccountK
</span><a href="#local-6989586621682446231"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621682446230"><span class="annot"><span class="annottext">deriveAddressPrivateKey :: Passphrase &quot;encryption&quot;
-&gt; ShelleyKey 'AccountK XPrv
-&gt; Role
-&gt; Index (AddressIndexDerivationType ShelleyKey) 'AddressK
-&gt; ShelleyKey 'AddressK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#deriveAddressPrivateKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">deriveAddressPrivateKey</span></a></span></span><span> </span><span id="local-6989586621682446228"><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446228"><span class="hs-identifier hs-var">pwd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446227"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446227"><span class="hs-identifier hs-var">accXPrv</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446226"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682446226"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621682446225"><span class="annot"><span class="annottext">Index (AddressIndexDerivationType ShelleyKey) 'AddressK
</span><a href="#local-6989586621682446225"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">XPrv -&gt; ShelleyKey 'AddressK XPrv
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ShelleyKey 'AddressK XPrv)
-&gt; XPrv -&gt; ShelleyKey 'AddressK XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
-&gt; XPrv -&gt; Role -&gt; Index 'Soft 'AddressK -&gt; XPrv
forall a (derivationType :: DerivationType) (level :: Depth).
Enum a =&gt;
Passphrase &quot;encryption&quot;
-&gt; XPrv -&gt; a -&gt; Index derivationType level -&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPrivateKeyShelley"><span class="hs-identifier hs-var">deriveAddressPrivateKeyShelley</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
</span><a href="#local-6989586621682446228"><span class="hs-identifier hs-var">pwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446227"><span class="hs-identifier hs-var">accXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682446226"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">Index (AddressIndexDerivationType ShelleyKey) 'AddressK
Index 'Soft 'AddressK
</span><a href="#local-6989586621682446225"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#SoftDerivation"><span class="hs-identifier hs-type">SoftDerivation</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621682446221"><span class="annot"><span class="annottext">deriveAddressPublicKey :: ShelleyKey 'AccountK XPub
-&gt; Role -&gt; Index 'Soft 'AddressK -&gt; ShelleyKey 'AddressK XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#deriveAddressPublicKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">deriveAddressPublicKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446219"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446219"><span class="hs-identifier hs-var">accXPub</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446218"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682446218"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621682446217"><span class="annot"><span class="annottext">Index 'Soft 'AddressK
</span><a href="#local-6989586621682446217"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>        </span><span class="annot"><span class="annottext">XPub -&gt; ShelleyKey 'AddressK XPub
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ShelleyKey 'AddressK XPub)
-&gt; XPub -&gt; ShelleyKey 'AddressK XPub
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; Role -&gt; Index 'Soft 'AddressK -&gt; XPub
forall a (derivationType :: DerivationType) (level :: Depth).
Enum a =&gt;
XPub -&gt; a -&gt; Index derivationType level -&gt; XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#deriveAddressPublicKeyShelley"><span class="hs-identifier hs-var">deriveAddressPublicKeyShelley</span></a></span><span> </span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446219"><span class="hs-identifier hs-var">accXPub</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682446218"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'AddressK
</span><a href="#local-6989586621682446217"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                            WalletKey implementation
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#WalletKey"><span class="hs-identifier hs-type">WalletKey</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621682446209"><span class="annot"><span class="annottext">changePassphrase :: (PassphraseScheme, Passphrase &quot;user&quot;)
-&gt; (PassphraseScheme, Passphrase &quot;user&quot;)
-&gt; ShelleyKey depth XPrv
-&gt; ShelleyKey depth XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#changePassphrase"><span class="hs-identifier hs-var hs-var hs-var hs-var">changePassphrase</span></a></span></span><span> </span><span id="local-6989586621682446207"><span class="annot"><span class="annottext">(PassphraseScheme, Passphrase &quot;user&quot;)
</span><a href="#local-6989586621682446207"><span class="hs-identifier hs-var">oldPwd</span></a></span></span><span> </span><span id="local-6989586621682446206"><span class="annot"><span class="annottext">(PassphraseScheme, Passphrase &quot;user&quot;)
</span><a href="#local-6989586621682446206"><span class="hs-identifier hs-var">newPwd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446205"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446205"><span class="hs-identifier hs-var">prv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-254"></span><span>        </span><span class="annot"><span class="annottext">XPrv -&gt; ShelleyKey depth XPrv
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ShelleyKey depth XPrv) -&gt; XPrv -&gt; ShelleyKey depth XPrv
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(PassphraseScheme, Passphrase &quot;user&quot;)
-&gt; (PassphraseScheme, Passphrase &quot;user&quot;) -&gt; XPrv -&gt; XPrv
</span><a href="Cardano.Wallet.Primitive.Passphrase.html#changePassphraseXPrv"><span class="hs-identifier hs-var">changePassphraseXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">(PassphraseScheme, Passphrase &quot;user&quot;)
</span><a href="#local-6989586621682446207"><span class="hs-identifier hs-var">oldPwd</span></a></span><span> </span><span class="annot"><span class="annottext">(PassphraseScheme, Passphrase &quot;user&quot;)
</span><a href="#local-6989586621682446206"><span class="hs-identifier hs-var">newPwd</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446205"><span class="hs-identifier hs-var">prv</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621682446204"><span class="annot"><span class="annottext">publicKey :: ShelleyKey depth XPrv -&gt; ShelleyKey depth XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#publicKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">publicKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446202"><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446202"><span class="hs-identifier hs-var">prv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="annottext">XPub -&gt; ShelleyKey depth XPub
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; XPrv -&gt; XPub
XPrv -&gt; XPub
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">toXPub</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv
</span><a href="#local-6989586621682446202"><span class="hs-identifier hs-var">prv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621682446201"><span class="annot"><span class="annottext">digest :: ShelleyKey depth XPub -&gt; Digest a
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#digest"><span class="hs-identifier hs-var hs-var hs-var hs-var">digest</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span id="local-6989586621682446199"><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446199"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Digest a
forall ba a.
(ByteArrayAccess ba, HashAlgorithm a) =&gt;
ba -&gt; Digest a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">hash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">unXPub</span></a></span><span> </span><span class="annot"><span class="annottext">XPub
</span><a href="#local-6989586621682446199"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621682446198"><span class="annot"><span class="annottext">getRawKey :: ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getRawKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">getRawKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><span class="annottext">ShelleyKey depth raw -&gt; raw
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621682446196"><span class="annot"><span class="annottext">liftRawKey :: raw -&gt; ShelleyKey depth raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#liftRawKey"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftRawKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">raw -&gt; ShelleyKey depth raw
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621682446194"><span class="annot"><span class="annottext">keyTypeDescriptor :: Proxy ShelleyKey -&gt; String
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#keyTypeDescriptor"><span class="hs-identifier hs-var hs-var hs-var hs-var">keyTypeDescriptor</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy ShelleyKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-269"></span><span>        </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;she&quot;</span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                         Relationship Key / Address
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#GetPurpose"><span class="hs-identifier hs-type">GetPurpose</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>    </span><span id="local-6989586621682446190"><span class="annot"><span class="annottext">getPurpose :: Index 'Hardened 'PurposeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#getPurpose"><span class="hs-identifier hs-var hs-var hs-var hs-var">getPurpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#purposeCIP1852"><span class="hs-identifier hs-var">purposeCIP1852</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PaymentAddress"><span class="hs-identifier hs-type">PaymentAddress</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Mainnet"><span class="hs-identifier hs-type">Mainnet</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-279"></span><span>    </span><span id="local-6989586621682446184"><span class="annot"><span class="annottext">paymentAddress :: ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#paymentAddress"><span class="hs-identifier hs-var hs-var hs-var hs-var">paymentAddress</span></a></span></span><span> </span><span id="local-6989586621682446182"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446182"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446179"><span class="hs-identifier hs-var">enterprise</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446177"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446182"><span class="hs-identifier hs-var">paymentK</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621682446179"><span class="annot"><span class="annottext">enterprise :: Word8
</span><a href="#local-6989586621682446179"><span class="hs-identifier hs-var hs-var">enterprise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">96</span></span><span>
</span><span id="line-285"></span><span>        </span><span id="local-6989586621682446177"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446177"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621682446174"><span class="annot"><span class="annottext">liftPaymentAddress :: KeyFingerprint &quot;payment&quot; ShelleyKey -&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#liftPaymentAddress"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftPaymentAddress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-type">KeyFingerprint</span></a></span><span> </span><span id="local-6989586621682446171"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446171"><span class="hs-identifier hs-var">fingerprint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446170"><span class="hs-identifier hs-var">enterprise</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446169"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446171"><span class="hs-identifier hs-var">fingerprint</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>        </span><span id="local-6989586621682446170"><span class="annot"><span class="annottext">enterprise :: Word8
</span><a href="#local-6989586621682446170"><span class="hs-identifier hs-var hs-var">enterprise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">96</span></span><span>
</span><span id="line-293"></span><span>        </span><span id="local-6989586621682446169"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446169"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621682446168"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PaymentAddress"><span class="hs-identifier hs-type">PaymentAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Testnet"><span class="hs-identifier hs-type">Testnet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446168"><span class="hs-identifier hs-type">pm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>    </span><span id="local-6989586621682446164"><span class="annot"><span class="annottext">paymentAddress :: ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="#local-6989586621682446164"><span class="hs-identifier hs-var hs-var hs-var hs-var">paymentAddress</span></a></span></span><span> </span><span id="local-6989586621682446163"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446163"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446162"><span class="hs-identifier hs-var">enterprise</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446161"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446163"><span class="hs-identifier hs-var">paymentK</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-301"></span><span>        </span><span id="local-6989586621682446162"><span class="annot"><span class="annottext">enterprise :: Word8
</span><a href="#local-6989586621682446162"><span class="hs-identifier hs-var hs-var">enterprise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">96</span></span><span>
</span><span id="line-302"></span><span>        </span><span id="local-6989586621682446161"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446161"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>    </span><span id="local-6989586621682446160"><span class="annot"><span class="annottext">liftPaymentAddress :: KeyFingerprint &quot;payment&quot; ShelleyKey -&gt; Address
</span><a href="#local-6989586621682446160"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftPaymentAddress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-type">KeyFingerprint</span></a></span><span> </span><span id="local-6989586621682446159"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446159"><span class="hs-identifier hs-var">fingerprint</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446158"><span class="hs-identifier hs-var">enterprise</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446157"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446159"><span class="hs-identifier hs-var">fingerprint</span></a></span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>        </span><span id="local-6989586621682446158"><span class="annot"><span class="annottext">enterprise :: Word8
</span><a href="#local-6989586621682446158"><span class="hs-identifier hs-var hs-var">enterprise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">96</span></span><span>
</span><span id="line-310"></span><span>        </span><span id="local-6989586621682446157"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446157"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DelegationAddress"><span class="hs-identifier hs-type">DelegationAddress</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Mainnet"><span class="hs-identifier hs-type">Mainnet</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span id="local-6989586621682446152"><span class="annot"><span class="annottext">delegationAddress :: ShelleyKey 'AddressK XPub -&gt; ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#delegationAddress"><span class="hs-identifier hs-var hs-var hs-var hs-var">delegationAddress</span></a></span></span><span> </span><span id="local-6989586621682446150"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446150"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span> </span><span id="local-6989586621682446149"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446149"><span class="hs-identifier hs-var">stakingK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446148"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446147"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446150"><span class="hs-identifier hs-var">paymentK</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446149"><span class="hs-identifier hs-var">stakingK</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621682446148"><span class="annot"><span class="annottext">base :: Word8
</span><a href="#local-6989586621682446148"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621682446147"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446147"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621682446146"><span class="annot"><span class="annottext">liftDelegationAddress :: KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#liftDelegationAddress"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftDelegationAddress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-type">KeyFingerprint</span></a></span><span> </span><span id="local-6989586621682446144"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446144"><span class="hs-identifier hs-var">fingerprint</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446143"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446143"><span class="hs-identifier hs-var">stakingK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446142"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446141"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446144"><span class="hs-identifier hs-var">fingerprint</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446143"><span class="hs-identifier hs-var">stakingK</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-328"></span><span>        </span><span id="local-6989586621682446142"><span class="annot"><span class="annottext">base :: Word8
</span><a href="#local-6989586621682446142"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621682446141"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446141"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">1</span></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span id="local-6989586621682446140"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DelegationAddress"><span class="hs-identifier hs-type">DelegationAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Testnet"><span class="hs-identifier hs-type">Testnet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446140"><span class="hs-identifier hs-type">pm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621682446136"><span class="annot"><span class="annottext">delegationAddress :: ShelleyKey 'AddressK XPub -&gt; ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="#local-6989586621682446136"><span class="hs-identifier hs-var hs-var hs-var hs-var">delegationAddress</span></a></span></span><span> </span><span id="local-6989586621682446135"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446135"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span> </span><span id="local-6989586621682446134"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446134"><span class="hs-identifier hs-var">stakingK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446133"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446132"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446135"><span class="hs-identifier hs-var">paymentK</span></a></span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446134"><span class="hs-identifier hs-var">stakingK</span></a></span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>        </span><span id="local-6989586621682446133"><span class="annot"><span class="annottext">base :: Word8
</span><a href="#local-6989586621682446133"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-339"></span><span>        </span><span id="local-6989586621682446132"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446132"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621682446131"><span class="annot"><span class="annottext">liftDelegationAddress :: KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; ShelleyKey 'AddressK XPub -&gt; Address
</span><a href="#local-6989586621682446131"><span class="hs-identifier hs-var hs-var hs-var hs-var">liftDelegationAddress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-type">KeyFingerprint</span></a></span><span> </span><span id="local-6989586621682446130"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446130"><span class="hs-identifier hs-var">fingerprint</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682446129"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446129"><span class="hs-identifier hs-var">stakingK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Put -&gt; ByteString
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">runPut</span></a></span><span> </span><span class="annot"><span class="annottext">(Put -&gt; ByteString) -&gt; Put -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putWord8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446128"><span class="hs-identifier hs-var">base</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Word8 -&gt; Word8
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682446127"><span class="hs-identifier hs-var">networkId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446130"><span class="hs-identifier hs-var">fingerprint</span></a></span><span>
</span><span id="line-345"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">putByteString</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Put)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; Put
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; ByteString)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; Put)
-&gt; ShelleyKey 'AddressK XPub -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446129"><span class="hs-identifier hs-var">stakingK</span></a></span><span>
</span><span id="line-346"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621682446128"><span class="annot"><span class="annottext">base :: Word8
</span><a href="#local-6989586621682446128"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-348"></span><span>        </span><span id="local-6989586621682446127"><span class="annot"><span class="annottext">networkId :: Word8
</span><a href="#local-6989586621682446127"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#MkKeyFingerprint"><span class="hs-identifier hs-type">MkKeyFingerprint</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621682446123"><span class="annot"><span class="annottext">paymentKeyFingerprint :: Address
-&gt; Either
     (ErrMkKeyFingerprint ShelleyKey Address)
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#paymentKeyFingerprint"><span class="hs-identifier hs-var hs-var hs-var hs-var">paymentKeyFingerprint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621682446121"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446121"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><span class="annottext">KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; Either
     (ErrMkKeyFingerprint ShelleyKey Address)
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyFingerprint &quot;payment&quot; ShelleyKey
 -&gt; Either
      (ErrMkKeyFingerprint ShelleyKey Address)
      (KeyFingerprint &quot;payment&quot; ShelleyKey))
-&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; Either
     (ErrMkKeyFingerprint ShelleyKey Address)
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
forall k (s :: Symbol) (key :: k).
ByteString -&gt; KeyFingerprint s key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-var">KeyFingerprint</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey)
-&gt; ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BS.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#hashSize"><span class="hs-identifier hs-var">hashSize</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BS.drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446121"><span class="hs-identifier hs-var">bytes</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span id="local-6989586621682446117"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#MkKeyFingerprint"><span class="hs-identifier hs-type">MkKeyFingerprint</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682446117"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#NetworkDiscriminant"><span class="hs-identifier hs-type">NetworkDiscriminant</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#AddressK"><span class="hs-identifier hs-type">AddressK</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPub</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621682446114"><span class="annot"><span class="annottext">paymentKeyFingerprint :: (Proxy n, ShelleyKey 'AddressK XPub)
-&gt; Either
     (ErrMkKeyFingerprint
        ShelleyKey (Proxy n, ShelleyKey 'AddressK XPub))
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
</span><a href="#local-6989586621682446114"><span class="hs-identifier hs-var hs-var hs-var hs-var">paymentKeyFingerprint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446113"><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446113"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; Either
     (ErrMkKeyFingerprint
        ShelleyKey (Proxy n, ShelleyKey 'AddressK XPub))
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyFingerprint &quot;payment&quot; ShelleyKey
 -&gt; Either
      (ErrMkKeyFingerprint
         ShelleyKey (Proxy n, ShelleyKey 'AddressK XPub))
      (KeyFingerprint &quot;payment&quot; ShelleyKey))
-&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
-&gt; Either
     (ErrMkKeyFingerprint
        ShelleyKey (Proxy n, ShelleyKey 'AddressK XPub))
     (KeyFingerprint &quot;payment&quot; ShelleyKey)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
forall k (s :: Symbol) (key :: k).
ByteString -&gt; KeyFingerprint s key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#KeyFingerprint"><span class="hs-identifier hs-var">KeyFingerprint</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey)
-&gt; ByteString -&gt; KeyFingerprint &quot;payment&quot; ShelleyKey
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString) -&gt; XPub -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub
</span><a href="#local-6989586621682446113"><span class="hs-identifier hs-var">paymentK</span></a></span></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#BoundedAddressLength"><span class="hs-identifier hs-type">BoundedAddressLength</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>    </span><span id="local-6989586621682446110"><span class="annot"><span class="annottext">maxLengthAddressFor :: Proxy ShelleyKey -&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#maxLengthAddressFor"><span class="hs-identifier hs-var hs-var hs-var hs-var">maxLengthAddressFor</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy ShelleyKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word8 -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BS.replicate</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">57</span></span><span> </span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                          Dealing with Rewards
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span id="local-6989586621682446107"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#IsOurs"><span class="hs-identifier hs-type">IsOurs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#SeqState"><span class="hs-identifier hs-type">SeqState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446107"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.RewardAccount.html#RewardAccount"><span class="hs-identifier hs-type">RewardAccount</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621682446104"><span class="annot"><span class="annottext">isOurs :: RewardAccount
-&gt; SeqState n ShelleyKey
-&gt; (Maybe (NonEmpty DerivationIndex), SeqState n ShelleyKey)
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#isOurs"><span class="hs-identifier hs-var hs-var hs-var hs-var">isOurs</span></a></span></span><span> </span><span id="local-6989586621682446102"><span class="annot"><span class="annottext">RewardAccount
</span><a href="#local-6989586621682446102"><span class="hs-identifier hs-var">account</span></a></span></span><span> </span><span id="local-6989586621682446101"><span class="annot"><span class="annottext">state :: SeqState n ShelleyKey
</span><a href="#local-6989586621682446101"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#SeqState"><span class="hs-identifier hs-type">SeqState</span></a></span><span class="hs-special">{</span><span id="local-6989586621682446099"><span class="annot"><span class="annottext">DerivationPrefix
derivationPrefix :: forall (n :: NetworkDiscriminant) (k :: Depth -&gt; * -&gt; *).
SeqState n k -&gt; DerivationPrefix
derivationPrefix :: DerivationPrefix
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#derivationPrefix"><span class="hs-identifier hs-var hs-var">derivationPrefix</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-369"></span><span>            </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationPrefix"><span class="hs-identifier hs-type">DerivationPrefix</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682446096"><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="#local-6989586621682446096"><span class="hs-identifier hs-var">purpose</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446095"><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK
</span><a href="#local-6989586621682446095"><span class="hs-identifier hs-var">coinType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446094"><span class="annot"><span class="annottext">Index 'Hardened 'AccountK
</span><a href="#local-6989586621682446094"><span class="hs-identifier hs-var">accountIx</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DerivationPrefix
</span><a href="#local-6989586621682446099"><span class="hs-identifier hs-var">derivationPrefix</span></a></span><span>
</span><span id="line-370"></span><span>            </span><span id="local-6989586621682446093"><span class="annot"><span class="annottext">path :: NonEmpty DerivationIndex
</span><a href="#local-6989586621682446093"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DerivationIndex] -&gt; NonEmpty DerivationIndex
forall a. [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.fromList</span></a></span><span>
</span><span id="line-371"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="#local-6989586621682446096"><span class="hs-identifier hs-var">purpose</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK
</span><a href="#local-6989586621682446095"><span class="hs-identifier hs-var">coinType</span></a></span><span>
</span><span id="line-373"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'AccountK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'AccountK
</span><a href="#local-6989586621682446094"><span class="hs-identifier hs-var">accountIx</span></a></span><span>
</span><span id="line-374"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'RoleK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'RoleK
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#mutableAccount"><span class="hs-identifier hs-var">mutableAccount</span></a></span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft Any -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft Any
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RewardAccount
</span><a href="#local-6989586621682446102"><span class="hs-identifier hs-var">account</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccount -&gt; RewardAccount -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">RewardAccount
</span><a href="#local-6989586621682446089"><span class="hs-identifier hs-var">ourAccount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ()
-&gt; Maybe (NonEmpty DerivationIndex)
-&gt; Maybe (NonEmpty DerivationIndex)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DerivationIndex -&gt; Maybe (NonEmpty DerivationIndex)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty DerivationIndex
</span><a href="#local-6989586621682446093"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SeqState n ShelleyKey
</span><a href="#local-6989586621682446101"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-380"></span><span>        </span><span id="local-6989586621682446089"><span class="annot"><span class="annottext">ourAccount :: RewardAccount
</span><a href="#local-6989586621682446089"><span class="hs-identifier hs-var hs-var">ourAccount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; RewardAccount
forall (k :: Depth -&gt; * -&gt; *).
ToRewardAccount k =&gt;
k 'AddressK XPub -&gt; RewardAccount
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#toRewardAccount"><span class="hs-identifier hs-var">toRewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'AddressK XPub -&gt; RewardAccount)
-&gt; ShelleyKey 'AddressK XPub -&gt; RewardAccount
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SeqState n ShelleyKey -&gt; ShelleyKey 'AddressK XPub
forall (n :: NetworkDiscriminant) (k :: Depth -&gt; * -&gt; *).
SeqState n k -&gt; k 'AddressK XPub
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#rewardAccountKey"><span class="hs-identifier hs-var hs-var">rewardAccountKey</span></a></span><span> </span><span class="annot"><span class="annottext">SeqState n ShelleyKey
</span><a href="#local-6989586621682446101"><span class="hs-identifier hs-var">state</span></a></span></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#ToRewardAccount"><span class="hs-identifier hs-type">ToRewardAccount</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-383"></span><span>    </span><span id="local-6989586621682446084"><span class="annot"><span class="annottext">toRewardAccount :: ShelleyKey 'AddressK XPub -&gt; RewardAccount
</span><a href="#local-6989586621682446084"><span class="hs-identifier hs-var hs-var hs-var hs-var">toRewardAccount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPub -&gt; RewardAccount
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#toRewardAccountRaw"><span class="hs-identifier hs-var">toRewardAccountRaw</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; RewardAccount)
-&gt; (ShelleyKey 'AddressK XPub -&gt; XPub)
-&gt; ShelleyKey 'AddressK XPub
-&gt; RewardAccount
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span id="local-6989586621682446083"><span class="annot"><span class="annottext">someRewardAccount :: SomeMnemonic -&gt; (XPrv, RewardAccount, NonEmpty DerivationIndex)
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#someRewardAccount"><span class="hs-identifier hs-var hs-var hs-var hs-var">someRewardAccount</span></a></span></span><span> </span><span id="local-6989586621682446081"><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682446081"><span class="hs-identifier hs-var">mw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-comment">-- NOTE: Accounts from mnemonics are considered to be ITN wallet-like,</span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-comment">-- therefore bound to purpose=44', 0th account.</span><span>
</span><span id="line-388"></span><span>            </span><span id="local-6989586621682446080"><span class="annot"><span class="annottext">path :: NonEmpty DerivationIndex
</span><a href="#local-6989586621682446080"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[DerivationIndex] -&gt; NonEmpty DerivationIndex
forall a. [a] -&gt; NonEmpty a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NE.fromList</span></a></span><span>
</span><span id="line-389"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'PurposeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#purposeBIP44"><span class="hs-identifier hs-var">purposeBIP44</span></a></span><span>
</span><span id="line-390"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'CoinTypeK
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#coinTypeAda"><span class="hs-identifier hs-var">coinTypeAda</span></a></span><span>
</span><span id="line-391"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened Any -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened Any
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-392"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'RoleK -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'RoleK
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#mutableAccount"><span class="hs-identifier hs-var">mutableAccount</span></a></span><span>
</span><span id="line-393"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; DerivationIndex
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationIndex"><span class="hs-identifier hs-var">DerivationIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; DerivationIndex) -&gt; Word32 -&gt; DerivationIndex
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft Any -&gt; Word32
forall (derivationType :: DerivationType) (level :: Depth).
Index derivationType level -&gt; Word32
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getIndex"><span class="hs-identifier hs-var hs-var">getIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft Any
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-394"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-395"></span><span>        </span><span class="hs-keyword">in</span><span>
</span><span id="line-396"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPrv -&gt; XPrv
forall (key :: Depth -&gt; * -&gt; *) (depth :: Depth) raw.
WalletKey key =&gt;
key depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#getRawKey"><span class="hs-identifier hs-var">getRawKey</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPrv
</span><a href="#local-6989586621682446079"><span class="hs-identifier hs-var">stakK</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPub -&gt; RewardAccount
forall (k :: Depth -&gt; * -&gt; *).
ToRewardAccount k =&gt;
k 'AddressK XPub -&gt; RewardAccount
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#toRewardAccount"><span class="hs-identifier hs-var">toRewardAccount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPrv -&gt; ShelleyKey 'AddressK XPub
forall (key :: Depth -&gt; * -&gt; *) (depth :: Depth).
WalletKey key =&gt;
key depth XPrv -&gt; key depth XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#publicKey"><span class="hs-identifier hs-var">publicKey</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AddressK XPrv
</span><a href="#local-6989586621682446079"><span class="hs-identifier hs-var">stakK</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonEmpty DerivationIndex
</span><a href="#local-6989586621682446080"><span class="hs-identifier hs-var">path</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621682446078"><span class="annot"><span class="annottext">rootK :: ShelleyKey 'RootK XPrv
</span><a href="#local-6989586621682446078"><span class="hs-identifier hs-var hs-var">rootK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SomeMnemonic, Maybe SomeMnemonic)
-&gt; Passphrase &quot;encryption&quot; -&gt; ShelleyKey 'RootK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#generateKeyFromSeed"><span class="hs-identifier hs-var">generateKeyFromSeed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMnemonic
</span><a href="#local-6989586621682446081"><span class="hs-identifier hs-var">mw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe SomeMnemonic
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span id="local-6989586621682446077"><span class="annot"><span class="annottext">acctK :: ShelleyKey 'AccountK XPrv
</span><a href="#local-6989586621682446077"><span class="hs-identifier hs-var hs-var">acctK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
-&gt; ShelleyKey 'RootK XPrv
-&gt; Index 'Hardened 'AccountK
-&gt; ShelleyKey 'AccountK XPrv
forall (key :: Depth -&gt; * -&gt; *).
HardDerivation key =&gt;
Passphrase &quot;encryption&quot;
-&gt; key 'RootK XPrv
-&gt; Index 'Hardened 'AccountK
-&gt; key 'AccountK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#deriveAccountPrivateKey"><span class="hs-identifier hs-var">deriveAccountPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'RootK XPrv
</span><a href="#local-6989586621682446078"><span class="hs-identifier hs-var">rootK</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Hardened 'AccountK
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span id="local-6989586621682446079"><span class="annot"><span class="annottext">stakK :: ShelleyKey 'AddressK XPrv
</span><a href="#local-6989586621682446079"><span class="hs-identifier hs-var hs-var">stakK</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
-&gt; ShelleyKey 'AccountK XPrv
-&gt; Role
-&gt; Index (AddressIndexDerivationType ShelleyKey) 'AddressK
-&gt; ShelleyKey 'AddressK XPrv
forall (key :: Depth -&gt; * -&gt; *).
HardDerivation key =&gt;
Passphrase &quot;encryption&quot;
-&gt; key 'AccountK XPrv
-&gt; Role
-&gt; Index (AddressIndexDerivationType key) 'AddressK
-&gt; key 'AddressK XPrv
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#deriveAddressPrivateKey"><span class="hs-identifier hs-var">deriveAddressPrivateKey</span></a></span><span> </span><span class="annot"><span class="annottext">Passphrase &quot;encryption&quot;
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'AccountK XPrv
</span><a href="#local-6989586621682446077"><span class="hs-identifier hs-var">acctK</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#MutableAccount"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="annot"><span class="annottext">Index (AddressIndexDerivationType ShelleyKey) 'AddressK
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#toRewardAccountRaw"><span class="hs-identifier hs-type">toRewardAccountRaw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.RewardAccount.html#RewardAccount"><span class="hs-identifier hs-type">RewardAccount</span></a></span><span>
</span><span id="line-403"></span><span id="toRewardAccountRaw"><span class="annot"><span class="annottext">toRewardAccountRaw :: XPub -&gt; RewardAccount
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#toRewardAccountRaw"><span class="hs-identifier hs-var hs-var">toRewardAccountRaw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RewardAccount
</span><a href="Cardano.Wallet.Primitive.Types.RewardAccount.html#RewardAccount"><span class="hs-identifier hs-var">RewardAccount</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; RewardAccount)
-&gt; (XPub -&gt; ByteString) -&gt; XPub -&gt; RewardAccount
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Crypto.Hash.Utils.html#blake2b224"><span class="hs-identifier hs-var">blake2b224</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (XPub -&gt; ByteString) -&gt; XPub -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span id="local-6989586621682446074"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DelegationAddress"><span class="hs-identifier hs-type">DelegationAddress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446074"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#MaybeLight"><span class="hs-identifier hs-type">MaybeLight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#SeqState"><span class="hs-identifier hs-type">SeqState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446074"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>    </span><span id="local-6989586621682446071"><span class="annot"><span class="annottext">maybeDiscover :: Maybe (LightDiscoverTxs (SeqState n ShelleyKey))
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#maybeDiscover"><span class="hs-identifier hs-var hs-var hs-var hs-var">maybeDiscover</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LightDiscoverTxs (SeqState n ShelleyKey)
-&gt; Maybe (LightDiscoverTxs (SeqState n ShelleyKey))
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(LightDiscoverTxs (SeqState n ShelleyKey)
 -&gt; Maybe (LightDiscoverTxs (SeqState n ShelleyKey)))
-&gt; LightDiscoverTxs (SeqState n ShelleyKey)
-&gt; Maybe (LightDiscoverTxs (SeqState n ShelleyKey))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (m :: * -&gt; *).
 Monad m =&gt;
 (Either Address RewardAccount -&gt; m ChainEvents)
 -&gt; SeqState n ShelleyKey -&gt; m (ChainEvents, SeqState n ShelleyKey))
-&gt; LightDiscoverTxs (SeqState n ShelleyKey)
forall addr txs s.
(forall (m :: * -&gt; *).
 Monad m =&gt;
 (addr -&gt; m txs) -&gt; s -&gt; m (txs, s))
-&gt; DiscoverTxs addr txs s
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.html#DiscoverTxs"><span class="hs-identifier hs-var">DiscoverTxs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (n :: NetworkDiscriminant) (k :: Depth -&gt; * -&gt; *)
       (m :: * -&gt; *).
(DelegationAddress n k, ToRewardAccount k, Monad m) =&gt;
(Either Address RewardAccount -&gt; m ChainEvents)
-&gt; SeqState n k -&gt; m (ChainEvents, SeqState n k)
forall (m :: * -&gt; *).
Monad m =&gt;
(Either Address RewardAccount -&gt; m ChainEvents)
-&gt; SeqState n ShelleyKey -&gt; m (ChainEvents, SeqState n ShelleyKey)
</span><a href="Cardano.Wallet.Primitive.AddressDiscovery.Sequential.html#discoverSeqWithRewards"><span class="hs-identifier hs-var">discoverSeqWithRewards</span></a></span></span><span>
</span><span id="line-409"></span><span>
</span><span id="line-410"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                          Storing and retrieving keys
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PersistPrivateKey"><span class="hs-identifier hs-type">PersistPrivateKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#RootK"><span class="hs-identifier hs-type">RootK</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-415"></span><span>    </span><span id="local-6989586621682446065"><span class="annot"><span class="annottext">serializeXPrv :: (ShelleyKey 'RootK XPrv, PassphraseHash)
-&gt; (ByteString, ByteString)
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#serializeXPrv"><span class="hs-identifier hs-var hs-var hs-var hs-var">serializeXPrv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682446063"><span class="annot"><span class="annottext">ShelleyKey 'RootK XPrv
</span><a href="#local-6989586621682446063"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446062"><span class="annot"><span class="annottext">PassphraseHash
</span><a href="#local-6989586621682446062"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#hex"><span class="hs-identifier hs-var">hex</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey 'RootK XPrv -&gt; ByteString)
-&gt; ShelleyKey 'RootK XPrv
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">unXPrv</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ByteString)
-&gt; (ShelleyKey 'RootK XPrv -&gt; XPrv)
-&gt; ShelleyKey 'RootK XPrv
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'RootK XPrv -&gt; XPrv
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'RootK XPrv -&gt; ByteString)
-&gt; ShelleyKey 'RootK XPrv -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey 'RootK XPrv
</span><a href="#local-6989586621682446063"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#hex"><span class="hs-identifier hs-var">hex</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; ByteString)
-&gt; (PassphraseHash -&gt; ScrubbedBytes)
-&gt; PassphraseHash
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PassphraseHash -&gt; ScrubbedBytes
</span><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#getPassphraseHash"><span class="hs-identifier hs-var hs-var">getPassphraseHash</span></a></span><span> </span><span class="annot"><span class="annottext">(PassphraseHash -&gt; ByteString) -&gt; PassphraseHash -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">PassphraseHash
</span><a href="#local-6989586621682446062"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621682446060"><span class="annot"><span class="annottext">unsafeDeserializeXPrv :: (ByteString, ByteString)
-&gt; (ShelleyKey 'RootK XPrv, PassphraseHash)
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#unsafeDeserializeXPrv"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeDeserializeXPrv</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682446058"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446058"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682446057"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446057"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
-&gt; ((ShelleyKey 'RootK XPrv, PassphraseHash)
    -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
-&gt; Either String (ShelleyKey 'RootK XPrv, PassphraseHash)
-&gt; (ShelleyKey 'RootK XPrv, PassphraseHash)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash)
forall p a. p -&gt; a
</span><a href="#local-6989586621682446055"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">(ShelleyKey 'RootK XPrv, PassphraseHash)
-&gt; (ShelleyKey 'RootK XPrv, PassphraseHash)
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String (ShelleyKey 'RootK XPrv, PassphraseHash)
 -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
-&gt; Either String (ShelleyKey 'RootK XPrv, PassphraseHash)
-&gt; (ShelleyKey 'RootK XPrv, PassphraseHash)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><span class="annottext">(ShelleyKey 'RootK XPrv
 -&gt; PassphraseHash -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
-&gt; Either String (ShelleyKey 'RootK XPrv)
-&gt; Either
     String (PassphraseHash -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(XPrv -&gt; ShelleyKey 'RootK XPrv)
-&gt; Either String XPrv -&gt; Either String (ShelleyKey 'RootK XPrv)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">XPrv -&gt; ShelleyKey 'RootK XPrv
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either String XPrv
</span><a href="#local-6989586621682446052"><span class="hs-identifier hs-var">xprvFromText</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446058"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><span class="annottext">Either
  String (PassphraseHash -&gt; (ShelleyKey 'RootK XPrv, PassphraseHash))
-&gt; Either String PassphraseHash
-&gt; Either String (ShelleyKey 'RootK XPrv, PassphraseHash)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(ScrubbedBytes -&gt; PassphraseHash)
-&gt; Either String ScrubbedBytes -&gt; Either String PassphraseHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ScrubbedBytes -&gt; PassphraseHash
</span><a href="Cardano.Wallet.Primitive.Passphrase.Types.html#PassphraseHash"><span class="hs-identifier hs-var">PassphraseHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either String ScrubbedBytes
forall bout. ByteArray bout =&gt; ByteString -&gt; Either String bout
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#fromHex"><span class="hs-identifier hs-var">fromHex</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682446057"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621682446052"><span class="annot"><span class="annottext">xprvFromText :: ByteString -&gt; Either String XPrv
</span><a href="#local-6989586621682446052"><span class="hs-identifier hs-var hs-var">xprvFromText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String XPrv
forall bin. ByteArrayAccess bin =&gt; bin -&gt; Either String XPrv
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">xprv</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String XPrv)
-&gt; (ByteString -&gt; Either String ByteString)
-&gt; ByteString
-&gt; Either String XPrv
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray ByteString =&gt; ByteString -&gt; Either String ByteString
forall bout. ByteArray bout =&gt; ByteString -&gt; Either String bout
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#fromHex"><span class="hs-identifier hs-var">fromHex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span id="local-6989586621682446055"><span class="annot"><span class="annottext">err :: p -&gt; a
</span><a href="#local-6989586621682446055"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsafeDeserializeXPrv: unable to deserialize ShelleyKey&quot;</span></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span id="local-6989586621682446050"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PersistPublicKey"><span class="hs-identifier hs-type">PersistPublicKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-type">ShelleyKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682446050"><span class="hs-identifier hs-type">depth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621682446046"><span class="annot"><span class="annottext">serializeXPub :: ShelleyKey depth XPub -&gt; ByteString
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#serializeXPub"><span class="hs-identifier hs-var hs-var hs-var hs-var">serializeXPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
forall a. ByteArrayAccess a =&gt; a -&gt; ByteString
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#hex"><span class="hs-identifier hs-var">hex</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString)
-&gt; (ShelleyKey depth XPub -&gt; ByteString)
-&gt; ShelleyKey depth XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">unXPub</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; ByteString)
-&gt; (ShelleyKey depth XPub -&gt; XPub)
-&gt; ShelleyKey depth XPub
-&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShelleyKey depth XPub -&gt; XPub
forall (depth :: Depth) raw. ShelleyKey depth raw -&gt; raw
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span>    </span><span id="local-6989586621682446044"><span class="annot"><span class="annottext">unsafeDeserializeXPub :: ByteString -&gt; ShelleyKey depth XPub
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#unsafeDeserializeXPub"><span class="hs-identifier hs-var hs-var hs-var hs-var">unsafeDeserializeXPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; ShelleyKey depth XPub)
-&gt; (XPub -&gt; ShelleyKey depth XPub)
-&gt; Either String XPub
-&gt; ShelleyKey depth XPub
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShelleyKey depth XPub
forall p a. p -&gt; a
</span><a href="#local-6989586621682446042"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">XPub -&gt; ShelleyKey depth XPub
forall (depth :: Depth) key. key -&gt; ShelleyKey depth key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#ShelleyKey"><span class="hs-identifier hs-var">ShelleyKey</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String XPub -&gt; ShelleyKey depth XPub)
-&gt; (ByteString -&gt; Either String XPub)
-&gt; ByteString
-&gt; ShelleyKey depth XPub
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either String XPub
</span><a href="../../../../cardano-crypto/html/src"><span class="hs-identifier hs-var">xpub</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String XPub)
-&gt; (ByteString -&gt; Either String ByteString)
-&gt; ByteString
-&gt; Either String XPub
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteArray ByteString =&gt; ByteString -&gt; Either String ByteString
forall bout. ByteArray bout =&gt; ByteString -&gt; Either String bout
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#fromHex"><span class="hs-identifier hs-var">fromHex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-434"></span><span>        </span><span id="local-6989586621682446042"><span class="annot"><span class="annottext">err :: p -&gt; a
</span><a href="#local-6989586621682446042"><span class="hs-identifier hs-var hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;unsafeDeserializeXPub: unable to deserialize ShelleyKey&quot;</span></span></span><span>
</span><span id="line-435"></span><span>
</span><span id="line-436"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                                 Internals
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#hashSize"><span class="hs-identifier hs-type">hashSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-441"></span><span id="hashSize"><span class="annot"><span class="annottext">hashSize :: Int
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.Shelley.html#hashSize"><span class="hs-identifier hs-var hs-var">hashSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-442"></span><span>    </span><span class="annot"><span class="annottext">Blake2b_224 -&gt; Int
forall a. HashAlgorithm a =&gt; a -&gt; Int
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">hashDigestSize</span></a></span><span> </span><span class="annot"><span class="annottext">Blake2b_224
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Blake2b_224</span></a></span><span>
</span><span id="line-443"></span></pre></body></html>