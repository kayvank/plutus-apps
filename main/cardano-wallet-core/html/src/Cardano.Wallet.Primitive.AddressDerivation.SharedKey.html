<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RoleAnnotations #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Copyright: &#169; 2018-2021 IOHK</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- License: Apache-2.0</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Definition of 'Shared' Keys.</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation.SharedKey</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#SharedKey"><span class="hs-identifier">SharedKey</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#purposeCIP1854"><span class="hs-identifier">purposeCIP1854</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#constructAddressFromIx"><span class="hs-identifier">constructAddressFromIx</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#toNetworkTag"><span class="hs-identifier">toNetworkTag</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#replaceCosignersWithVerKeys"><span class="hs-identifier">replaceCosignersWithVerKeys</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Script</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cosigner</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">KeyHash</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Script</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">ScriptTemplate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">toScriptHash</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Style.Shared</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">deriveAddressPublicKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">deriveDelegationPublicKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">hashKey</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">liftXPub</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Style.Shelley</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Credential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">delegationAddress</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">paymentAddress</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html"><span class="hs-identifier">Cardano.Wallet.Primitive.AddressDerivation</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Depth"><span class="hs-identifier">Depth</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#DerivationType"><span class="hs-identifier">DerivationType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier">Index</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#NetworkDiscriminant"><span class="hs-identifier">NetworkDiscriminant</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Role"><span class="hs-identifier">Role</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Address</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier">Address</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Util.html"><span class="hs-identifier">Cardano.Wallet.Util</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Util.html#invariant"><span class="hs-identifier">invariant</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromJust</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">isJust</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Type.Equality</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(:~:)</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">testEquality</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Type.Reflection</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">typeRep</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CA</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Derivation</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CA</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Script</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CA</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier">Cardano.Address.Style.Shelley</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CA</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | Purpose for shared wallets is a constant set to 1854' (or 0x8000073E) following the original</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- CIP-1854 Multi-signature Wallets.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- It indicates that the subtree of this node is used according to this</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- specification.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Hardened derivation is used at this level.</span><span>
</span><span id="line-75"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#purposeCIP1854"><span class="hs-identifier hs-type">purposeCIP1854</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Hardened"><span class="hs-identifier hs-type">Hardened</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#PurposeK"><span class="hs-identifier hs-type">PurposeK</span></a></span><span>
</span><span id="line-76"></span><span id="purposeCIP1854"><span class="annot"><span class="annottext">purposeCIP1854 :: Index 'Hardened 'PurposeK
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#purposeCIP1854"><span class="hs-identifier hs-var hs-var">purposeCIP1854</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Index 'Hardened 'PurposeK
forall a. Enum a =&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x8000073E</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | A cryptographic key for Shared address derivation, with phantom-types to</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- disambiguate derivation paths</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- let rootPrivateKey = SharedKey 'RootK XPrv</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- let accountPubKey = SharedKey 'AccountK XPub</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- let addressPubKey = SharedKey 'AddressK XPub</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-86"></span><span id="local-6989586621682427937"><span id="local-6989586621682427938"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="SharedKey"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#SharedKey"><span class="hs-identifier hs-var">SharedKey</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682427936"><span class="annot"><a href="#local-6989586621682427936"><span class="hs-identifier hs-type">depth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Depth"><span class="hs-identifier hs-type">Depth</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682427935"><span class="annot"><a href="#local-6989586621682427935"><span class="hs-identifier hs-type">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>    </span><span id="SharedKey"><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#SharedKey"><span class="hs-identifier hs-var">SharedKey</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getKey"><span class="annot"><span class="annottext">SharedKey depth key -&gt; key
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#getKey"><span class="hs-identifier hs-var hs-var">getKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621682427935"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. SharedKey depth key -&gt; Rep (SharedKey depth key) x)
-&gt; (forall x. Rep (SharedKey depth key) x -&gt; SharedKey depth key)
-&gt; Generic (SharedKey depth key)
forall x. Rep (SharedKey depth key) x -&gt; SharedKey depth key
forall x. SharedKey depth key -&gt; Rep (SharedKey depth key) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (depth :: Depth) key x.
Rep (SharedKey depth key) x -&gt; SharedKey depth key
forall (depth :: Depth) key x.
SharedKey depth key -&gt; Rep (SharedKey depth key) x
$cto :: forall (depth :: Depth) key x.
Rep (SharedKey depth key) x -&gt; SharedKey depth key
$cfrom :: forall (depth :: Depth) key x.
SharedKey depth key -&gt; Rep (SharedKey depth key) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682427924"><span id="local-6989586621682427926"><span id="local-6989586621682427928"><span class="annot"><span class="annottext">Int -&gt; SharedKey depth key -&gt; ShowS
[SharedKey depth key] -&gt; ShowS
SharedKey depth key -&gt; String
(Int -&gt; SharedKey depth key -&gt; ShowS)
-&gt; (SharedKey depth key -&gt; String)
-&gt; ([SharedKey depth key] -&gt; ShowS)
-&gt; Show (SharedKey depth key)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (depth :: Depth) key.
Show key =&gt;
Int -&gt; SharedKey depth key -&gt; ShowS
forall (depth :: Depth) key.
Show key =&gt;
[SharedKey depth key] -&gt; ShowS
forall (depth :: Depth) key.
Show key =&gt;
SharedKey depth key -&gt; String
showList :: [SharedKey depth key] -&gt; ShowS
$cshowList :: forall (depth :: Depth) key.
Show key =&gt;
[SharedKey depth key] -&gt; ShowS
show :: SharedKey depth key -&gt; String
$cshow :: forall (depth :: Depth) key.
Show key =&gt;
SharedKey depth key -&gt; String
showsPrec :: Int -&gt; SharedKey depth key -&gt; ShowS
$cshowsPrec :: forall (depth :: Depth) key.
Show key =&gt;
Int -&gt; SharedKey depth key -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682427919"><span id="local-6989586621682427921"><span class="annot"><span class="annottext">SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
(SharedKey depth key -&gt; SharedKey depth key -&gt; Bool)
-&gt; (SharedKey depth key -&gt; SharedKey depth key -&gt; Bool)
-&gt; Eq (SharedKey depth key)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (depth :: Depth) key.
Eq key =&gt;
SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
/= :: SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
$c/= :: forall (depth :: Depth) key.
Eq key =&gt;
SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
== :: SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
$c== :: forall (depth :: Depth) key.
Eq key =&gt;
SharedKey depth key -&gt; SharedKey depth key -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621682427916"><span id="local-6989586621682427917"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682427914"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682427917"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#SharedKey"><span class="hs-identifier hs-type">SharedKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682427916"><span class="hs-identifier hs-type">depth</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682427917"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#constructAddressFromIx"><span class="hs-identifier hs-type">constructAddressFromIx</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682427912"><span class="annot"><a href="#local-6989586621682427912"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#NetworkDiscriminant"><span class="hs-identifier hs-type">NetworkDiscriminant</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682427912"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Role"><span class="hs-identifier hs-type">Role</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ScriptTemplate</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ScriptTemplate</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#ScriptK"><span class="hs-identifier hs-type">ScriptK</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span>
</span><span id="line-99"></span><span id="constructAddressFromIx"><span class="annot"><span class="annottext">constructAddressFromIx :: Role
-&gt; ScriptTemplate
-&gt; Maybe ScriptTemplate
-&gt; Index 'Soft 'ScriptK
-&gt; Address
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#constructAddressFromIx"><span class="hs-identifier hs-var hs-var">constructAddressFromIx</span></a></span></span><span> </span><span id="local-6989586621682427911"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427911"><span class="hs-keyword hs-var">role</span></a></span></span><span> </span><span id="local-6989586621682427910"><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427910"><span class="hs-identifier hs-var">pTemplate</span></a></span></span><span> </span><span id="local-6989586621682427909"><span class="annot"><span class="annottext">Maybe ScriptTemplate
</span><a href="#local-6989586621682427909"><span class="hs-identifier hs-var">dTemplate</span></a></span></span><span> </span><span id="local-6989586621682427908"><span class="annot"><span class="annottext">Index 'Soft 'ScriptK
</span><a href="#local-6989586621682427908"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682427907"><span class="annot"><span class="annottext">delegationCredential :: Script KeyHash -&gt; Credential 'DelegationK
</span><a href="#local-6989586621682427907"><span class="hs-identifier hs-var hs-var">delegationCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; Credential 'DelegationK
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">DelegationFromScript</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; Credential 'DelegationK)
-&gt; (Script KeyHash -&gt; ScriptHash)
-&gt; Script KeyHash
-&gt; Credential 'DelegationK
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash -&gt; ScriptHash
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span>
</span><span id="line-101"></span><span>        </span><span id="local-6989586621682427904"><span class="annot"><span class="annottext">paymentCredential :: Script KeyHash -&gt; Credential 'PaymentK
</span><a href="#local-6989586621682427904"><span class="hs-identifier hs-var hs-var">paymentCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; Credential 'PaymentK
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">PaymentFromScript</span></a></span><span> </span><span class="annot"><span class="annottext">(ScriptHash -&gt; Credential 'PaymentK)
-&gt; (Script KeyHash -&gt; ScriptHash)
-&gt; Script KeyHash
-&gt; Credential 'PaymentK
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash -&gt; ScriptHash
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span>
</span><span id="line-102"></span><span>        </span><span id="local-6989586621682427902"><span class="annot"><span class="annottext">tag :: NetworkTag
</span><a href="#local-6989586621682427902"><span class="hs-identifier hs-var hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Typeable n =&gt; NetworkTag
forall (n :: NetworkDiscriminant). Typeable n =&gt; NetworkTag
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#toNetworkTag"><span class="hs-identifier hs-var">toNetworkTag</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682427912"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span id="local-6989586621682427901"><span class="annot"><span class="annottext">createBaseAddress :: Script KeyHash -&gt; Script KeyHash -&gt; ByteString
</span><a href="#local-6989586621682427901"><span class="hs-identifier hs-var hs-var">createBaseAddress</span></a></span></span><span> </span><span id="local-6989586621682427900"><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427900"><span class="hs-identifier hs-var">pScript'</span></a></span></span><span> </span><span id="local-6989586621682427899"><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427899"><span class="hs-identifier hs-var">dScript'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">Address -&gt; ByteString
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">CA.unAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; ByteString) -&gt; Address -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">NetworkDiscriminant Shelley
-&gt; Credential 'PaymentK -&gt; Credential 'DelegationK -&gt; Address
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">delegationAddress</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkDiscriminant Shelley
NetworkTag
</span><a href="#local-6989586621682427902"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script KeyHash -&gt; Credential 'PaymentK
</span><a href="#local-6989586621682427904"><span class="hs-identifier hs-var">paymentCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427900"><span class="hs-identifier hs-var">pScript'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script KeyHash -&gt; Credential 'DelegationK
</span><a href="#local-6989586621682427907"><span class="hs-identifier hs-var">delegationCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427899"><span class="hs-identifier hs-var">dScript'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>        </span><span id="local-6989586621682427897"><span class="annot"><span class="annottext">createEnterpriseAddress :: Script KeyHash -&gt; ByteString
</span><a href="#local-6989586621682427897"><span class="hs-identifier hs-var hs-var">createEnterpriseAddress</span></a></span></span><span> </span><span id="local-6989586621682427896"><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427896"><span class="hs-identifier hs-var">pScript'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>            </span><span class="annot"><span class="annottext">Address -&gt; ByteString
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var hs-var">CA.unAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; ByteString) -&gt; Address -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-109"></span><span>            </span><span class="annot"><span class="annottext">NetworkDiscriminant Shelley -&gt; Credential 'PaymentK -&gt; Address
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">paymentAddress</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkDiscriminant Shelley
NetworkTag
</span><a href="#local-6989586621682427902"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script KeyHash -&gt; Credential 'PaymentK
</span><a href="#local-6989586621682427904"><span class="hs-identifier hs-var">paymentCredential</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427896"><span class="hs-identifier hs-var">pScript'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>        </span><span id="local-6989586621682427895"><span class="annot"><span class="annottext">role' :: Role
</span><a href="#local-6989586621682427895"><span class="hs-identifier hs-var hs-var">role'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427911"><span class="hs-keyword hs-var">role</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>            </span><span class="annot"><span class="annottext">Role
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#UtxoExternal"><span class="hs-identifier hs-var">UtxoExternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOExternal</span></a></span><span>
</span><span id="line-113"></span><span>            </span><span class="annot"><span class="annottext">Role
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#UtxoInternal"><span class="hs-identifier hs-var">UtxoInternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOInternal</span></a></span><span>
</span><span id="line-114"></span><span>            </span><span class="annot"><span class="annottext">Role
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.html#MutableAccount"><span class="hs-identifier hs-var">MutableAccount</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; Role
forall a. HasCallStack =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;role is specified only for payment credential&quot;</span></span><span>
</span><span id="line-116"></span><span>        </span><span id="local-6989586621682427888"><span class="annot"><span class="annottext">pScript :: Script KeyHash
</span><a href="#local-6989586621682427888"><span class="hs-identifier hs-var hs-var">pScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="annottext">Role -&gt; ScriptTemplate -&gt; Index 'Soft 'ScriptK -&gt; Script KeyHash
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#replaceCosignersWithVerKeys"><span class="hs-identifier hs-var">replaceCosignersWithVerKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427895"><span class="hs-identifier hs-var">role'</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427910"><span class="hs-identifier hs-var">pTemplate</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'ScriptK
</span><a href="#local-6989586621682427908"><span class="hs-identifier hs-var">ix</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span id="local-6989586621682427887"><span class="annot"><span class="annottext">dScript :: ScriptTemplate -&gt; Script KeyHash
</span><a href="#local-6989586621682427887"><span class="hs-identifier hs-var hs-var">dScript</span></a></span></span><span> </span><span id="local-6989586621682427886"><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427886"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">Role -&gt; ScriptTemplate -&gt; Index 'Soft 'ScriptK -&gt; Script KeyHash
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#replaceCosignersWithVerKeys"><span class="hs-identifier hs-var">replaceCosignersWithVerKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Stake</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427886"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'ScriptK
forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Address) -&gt; ByteString -&gt; Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
</span><a href="#local-6989586621682427909"><span class="hs-identifier hs-var">dTemplate</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682427882"><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427882"><span class="hs-identifier hs-var">dTemplate'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-122"></span><span>            </span><span class="annot"><span class="annottext">Script KeyHash -&gt; Script KeyHash -&gt; ByteString
</span><a href="#local-6989586621682427901"><span class="hs-identifier hs-var">createBaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427888"><span class="hs-identifier hs-var">pScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScriptTemplate -&gt; Script KeyHash
</span><a href="#local-6989586621682427887"><span class="hs-identifier hs-var">dScript</span></a></span><span> </span><span class="annot"><span class="annottext">ScriptTemplate
</span><a href="#local-6989586621682427882"><span class="hs-identifier hs-var">dTemplate'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>        </span><span class="annot"><span class="annottext">Maybe ScriptTemplate
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">Script KeyHash -&gt; ByteString
</span><a href="#local-6989586621682427897"><span class="hs-identifier hs-var">createEnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Script KeyHash
</span><a href="#local-6989586621682427888"><span class="hs-identifier hs-var">pScript</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#replaceCosignersWithVerKeys"><span class="hs-identifier hs-type">replaceCosignersWithVerKeys</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">CA.Role</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ScriptTemplate</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#ScriptK"><span class="hs-identifier hs-type">ScriptK</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span>
</span><span id="line-131"></span><span id="replaceCosignersWithVerKeys"><span class="annot"><span class="annottext">replaceCosignersWithVerKeys :: Role -&gt; ScriptTemplate -&gt; Index 'Soft 'ScriptK -&gt; Script KeyHash
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#replaceCosignersWithVerKeys"><span class="hs-identifier hs-var hs-var">replaceCosignersWithVerKeys</span></a></span></span><span> </span><span id="local-6989586621682427881"><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427881"><span class="hs-identifier hs-var">role'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ScriptTemplate</span></a></span><span> </span><span id="local-6989586621682427879"><span class="annot"><span class="annottext">Map Cosigner XPub
</span><a href="#local-6989586621682427879"><span class="hs-identifier hs-var">xpubs</span></a></span></span><span> </span><span id="local-6989586621682427878"><span class="annot"><span class="annottext">Script Cosigner
</span><a href="#local-6989586621682427878"><span class="hs-identifier hs-var">scriptTemplate</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682427877"><span class="annot"><span class="annottext">Index 'Soft 'ScriptK
</span><a href="#local-6989586621682427877"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">Script Cosigner -&gt; Script KeyHash
</span><a href="#local-6989586621682427876"><span class="hs-identifier hs-var">replaceCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">Script Cosigner
</span><a href="#local-6989586621682427878"><span class="hs-identifier hs-var">scriptTemplate</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="#local-6989586621682427876"><span class="hs-identifier hs-type">replaceCosigner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">Cosigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">Script</span></a></span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621682427876"><span class="annot"><span class="annottext">replaceCosigner :: Script Cosigner -&gt; Script KeyHash
</span><a href="#local-6989586621682427876"><span class="hs-identifier hs-var hs-var">replaceCosigner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">RequireSignatureOf</span></a></span><span> </span><span id="local-6989586621682427874"><span class="annot"><span class="annottext">Cosigner
</span><a href="#local-6989586621682427874"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyHash -&gt; Script KeyHash
forall elem. elem -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">RequireSignatureOf</span></a></span><span> </span><span class="annot"><span class="annottext">(KeyHash -&gt; Script KeyHash) -&gt; KeyHash -&gt; Script KeyHash
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Cosigner -&gt; KeyHash
</span><a href="#local-6989586621682427873"><span class="hs-identifier hs-var">toKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Cosigner
</span><a href="#local-6989586621682427874"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">RequireAllOf</span></a></span><span> </span><span id="local-6989586621682427871"><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427871"><span class="hs-identifier hs-var">xs</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Script KeyHash] -&gt; Script KeyHash
forall elem. [Script elem] -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">RequireAllOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Script Cosigner -&gt; Script KeyHash)
-&gt; [Script Cosigner] -&gt; [Script KeyHash]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Script Cosigner -&gt; Script KeyHash
</span><a href="#local-6989586621682427876"><span class="hs-identifier hs-var">replaceCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427871"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">RequireAnyOf</span></a></span><span> </span><span id="local-6989586621682427869"><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427869"><span class="hs-identifier hs-var">xs</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Script KeyHash] -&gt; Script KeyHash
forall elem. [Script elem] -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">RequireAnyOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Script Cosigner -&gt; Script KeyHash)
-&gt; [Script Cosigner] -&gt; [Script KeyHash]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Script Cosigner -&gt; Script KeyHash
</span><a href="#local-6989586621682427876"><span class="hs-identifier hs-var">replaceCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427869"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">RequireSomeOf</span></a></span><span> </span><span id="local-6989586621682427867"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682427867"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621682427866"><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427866"><span class="hs-identifier hs-var">xs</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; [Script KeyHash] -&gt; Script KeyHash
forall elem. Word8 -&gt; [Script elem] -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">RequireSomeOf</span></a></span><span> </span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682427867"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Script Cosigner -&gt; Script KeyHash)
-&gt; [Script Cosigner] -&gt; [Script KeyHash]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Script Cosigner -&gt; Script KeyHash
</span><a href="#local-6989586621682427876"><span class="hs-identifier hs-var">replaceCosigner</span></a></span><span> </span><span class="annot"><span class="annottext">[Script Cosigner]
</span><a href="#local-6989586621682427866"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ActiveFromSlot</span></a></span><span> </span><span id="local-6989586621682427864"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682427864"><span class="hs-identifier hs-var">s</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Script KeyHash
forall elem. Natural -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">ActiveFromSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682427864"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">ActiveUntilSlot</span></a></span><span> </span><span id="local-6989586621682427862"><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682427862"><span class="hs-identifier hs-var">s</span></a></span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Script KeyHash
forall elem. Natural -&gt; Script elem
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">ActiveUntilSlot</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><a href="#local-6989586621682427862"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="#local-6989586621682427861"><span class="hs-identifier hs-type">convertIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Index"><span class="hs-identifier hs-type">Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Soft"><span class="hs-identifier hs-type">Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#ScriptK"><span class="hs-identifier hs-type">ScriptK</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">CA.Index</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">CA.Soft</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">CA.PaymentK</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621682427861"><span class="annot"><span class="annottext">convertIndex :: Index 'Soft 'ScriptK -&gt; Index 'Soft 'PaymentK
</span><a href="#local-6989586621682427861"><span class="hs-identifier hs-var hs-var">convertIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Index 'Soft 'PaymentK) -&gt; Index 'Soft 'PaymentK
forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromJust</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Index 'Soft 'PaymentK) -&gt; Index 'Soft 'PaymentK)
-&gt; (Index 'Soft 'ScriptK -&gt; Maybe (Index 'Soft 'PaymentK))
-&gt; Index 'Soft 'ScriptK
-&gt; Index 'Soft 'PaymentK
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; Maybe (Index 'Soft 'PaymentK)
forall ix (derivationType :: DerivationType) (depth :: Depth).
(ix ~ Index derivationType depth, Bounded ix) =&gt;
Word32 -&gt; Maybe ix
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.indexFromWord32</span></a></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; Maybe (Index 'Soft 'PaymentK))
-&gt; (Index 'Soft 'ScriptK -&gt; Word32)
-&gt; Index 'Soft 'ScriptK
-&gt; Maybe (Index 'Soft 'PaymentK)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word32
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word32)
-&gt; (Index 'Soft 'ScriptK -&gt; Int) -&gt; Index 'Soft 'ScriptK -&gt; Word32
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'ScriptK -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromEnum</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="#local-6989586621682427873"><span class="hs-identifier hs-type">toKeyHash</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">Cosigner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">KeyHash</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621682427873"><span class="annot"><span class="annottext">toKeyHash :: Cosigner -&gt; KeyHash
</span><a href="#local-6989586621682427873"><span class="hs-identifier hs-var hs-var">toKeyHash</span></a></span></span><span> </span><span id="local-6989586621682427858"><span class="annot"><span class="annottext">Cosigner
</span><a href="#local-6989586621682427858"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682427857"><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427857"><span class="hs-identifier hs-var">accXPub</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>                </span><span class="annot"><span class="annottext">String
-&gt; Maybe (Shared 'AccountK XPub)
-&gt; (Maybe (Shared 'AccountK XPub) -&gt; Bool)
-&gt; Maybe (Shared 'AccountK XPub)
forall a. HasCallStack =&gt; String -&gt; a -&gt; (a -&gt; Bool) -&gt; a
</span><a href="Cardano.Wallet.Util.html#invariant"><span class="hs-identifier hs-var">invariant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;we should have accXPubs of all cosigners at this point&quot;</span></span><span>
</span><span id="line-148"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPub -&gt; Shared 'AccountK XPub
forall (depth :: Depth). XPub -&gt; Shared depth XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">liftXPub</span></a></span><span> </span><span class="annot"><span class="annottext">(XPub -&gt; Shared 'AccountK XPub)
-&gt; Maybe XPub -&gt; Maybe (Shared 'AccountK XPub)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Cosigner -&gt; Map Cosigner XPub -&gt; Maybe XPub
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Cosigner
</span><a href="#local-6989586621682427858"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Map Cosigner XPub
</span><a href="#local-6989586621682427879"><span class="hs-identifier hs-var">xpubs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Shared 'AccountK XPub) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isJust</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span id="local-6989586621682427854"><span class="annot"><span class="annottext">verKey :: Shared 'ScriptK XPub
</span><a href="#local-6989586621682427854"><span class="hs-identifier hs-var hs-var">verKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
-&gt; Index 'Soft 'PaymentK -&gt; Shared 'ScriptK XPub
</span><a href="#local-6989586621682427853"><span class="hs-identifier hs-var">deriveMultisigPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427857"><span class="hs-identifier hs-var">accXPub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index 'Soft 'ScriptK -&gt; Index 'Soft 'PaymentK
</span><a href="#local-6989586621682427861"><span class="hs-identifier hs-var">convertIndex</span></a></span><span> </span><span class="annot"><span class="annottext">Index 'Soft 'ScriptK
</span><a href="#local-6989586621682427877"><span class="hs-identifier hs-var">ix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">KeyRole -&gt; Shared 'ScriptK XPub -&gt; KeyHash
forall (key :: Depth). KeyRole -&gt; Shared key XPub -&gt; KeyHash
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">hashKey</span></a></span><span> </span><span class="annot"><span class="annottext">KeyRole
</span><a href="#local-6989586621682427852"><span class="hs-identifier hs-var">walletRole</span></a></span><span> </span><span class="annot"><span class="annottext">Shared 'ScriptK XPub
</span><a href="#local-6989586621682427854"><span class="hs-identifier hs-var">verKey</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621682427852"><span class="annot"><span class="annottext">walletRole :: KeyRole
</span><a href="#local-6989586621682427852"><span class="hs-identifier hs-var hs-var">walletRole</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427881"><span class="hs-identifier hs-var">role'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOExternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyRole
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Payment</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOInternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyRole
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Payment</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Stake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KeyRole
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Delegation</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621682427853"><span class="annot"><span class="annottext">deriveMultisigPublicKey :: Shared 'AccountK XPub
-&gt; Index 'Soft 'PaymentK -&gt; Shared 'ScriptK XPub
</span><a href="#local-6989586621682427853"><span class="hs-identifier hs-var hs-var">deriveMultisigPublicKey</span></a></span></span><span> </span><span id="local-6989586621682427849"><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427849"><span class="hs-identifier hs-var">accXPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427881"><span class="hs-identifier hs-var">role'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOExternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
-&gt; Role -&gt; Index 'Soft 'PaymentK -&gt; Shared 'ScriptK XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">deriveAddressPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427849"><span class="hs-identifier hs-var">accXPub</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427881"><span class="hs-identifier hs-var">role'</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.UTxOInternal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
-&gt; Role -&gt; Index 'Soft 'PaymentK -&gt; Shared 'ScriptK XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">deriveAddressPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427849"><span class="hs-identifier hs-var">accXPub</span></a></span><span> </span><span class="annot"><span class="annottext">Role
</span><a href="#local-6989586621682427881"><span class="hs-identifier hs-var">role'</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">Role
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.Stake</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
-&gt; Index 'Soft 'PaymentK -&gt; Shared 'ScriptK XPub
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">deriveDelegationPublicKey</span></a></span><span> </span><span class="annot"><span class="annottext">Shared 'AccountK XPub
</span><a href="#local-6989586621682427849"><span class="hs-identifier hs-var">accXPub</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Convert 'NetworkDiscriminant type parameter to</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- 'Cardano.Address.NetworkTag'.</span><span>
</span><span id="line-163"></span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#toNetworkTag"><span class="hs-identifier hs-type">toNetworkTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682428008"><span class="annot"><a href="#local-6989586621682428008"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#NetworkDiscriminant"><span class="hs-identifier hs-type">NetworkDiscriminant</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682428008"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-type">CA.NetworkTag</span></a></span><span>
</span><span id="line-164"></span><span id="toNetworkTag"><span class="annot"><span class="annottext">toNetworkTag :: NetworkTag
</span><a href="Cardano.Wallet.Primitive.AddressDerivation.SharedKey.html#toNetworkTag"><span class="hs-identifier hs-var hs-var">toNetworkTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeRep n -&gt; TypeRep 'Mainnet -&gt; Maybe (n :~: 'Mainnet)
forall k (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">testEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable n =&gt; TypeRep n
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682428008"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable 'Mainnet =&gt; TypeRep 'Mainnet
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="Cardano.Wallet.Primitive.AddressDerivation.html#Mainnet"><span class="hs-identifier hs-type">Mainnet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">n :~: 'Mainnet
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; NetworkTag
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.NetworkTag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">1</span></span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Maybe (n :~: 'Mainnet)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word32 -&gt; NetworkTag
</span><a href="../../../../cardano-addresses/html/src"><span class="hs-identifier hs-var">CA.NetworkTag</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0</span></span><span> </span><span class="hs-comment">-- fixme: Not all testnets have NetworkTag=0</span><span>
</span><span id="line-167"></span></pre></body></html>