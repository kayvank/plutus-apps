<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE QuasiQuotes #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- Copyright: &#169; 2018-2021 IOHK</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- License: Apache-2.0</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-- A client used to query asset metadata from the Cardano metadata-server.</span><span>
</span><span id="line-30"></span><span class="hs-comment">--</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- The OpenAPI specification is here:</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- &lt;https://github.com/input-output-hk/metadata-server/blob/master/specifications/api/openapi.yaml&gt;</span><span>
</span><span id="line-33"></span><span class="hs-comment">--</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- An important consideration is that cardano-wallet should not trust the</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- metadata-server operator to produce correct, valid, authentic, or even</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- non-malicious data.</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- In future, signatures of property values will be checked to determine</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- authenticity. The exact details are not yet specified.</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- In any case, we should not rely on the validation that the metadata-server</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- may or may not have applied to the user-supplied metadata.</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.TokenMetadata</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Associating metadata with assets</span></span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#fillMetadata"><span class="hs-identifier">fillMetadata</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Token Metadata Client</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier">TokenMetadataClient</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#newMetadataClient"><span class="hs-identifier">newMetadataClient</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#getTokenMetadata"><span class="hs-identifier">getTokenMetadata</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier">TokenMetadataError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Logging</span></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier">TokenMetadataLog</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generic metadata server client</span></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#metadataClient"><span class="hs-identifier">metadataClient</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier">BatchRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier">BatchResponse</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier">SubjectProperties</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier">Property</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier">PropertyName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#propertyName"><span class="hs-identifier">propertyName</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier">PropertyValue</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier">Subject</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier">Signature</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Parsing</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#metadataFromProperties"><span class="hs-identifier">metadataFromProperties</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Severity</span></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Tracer</span></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">HasPrivacyAnnotation</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasSeverityAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html"><span class="hs-identifier">Cardano.Wallet.Logging</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier">BracketLog</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier">LoggedException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer"><span class="hs-identifier">bracketTracer</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#produceTimings"><span class="hs-identifier">produceTimings</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.html#TokenMetadataServer"><span class="hs-identifier">TokenMetadataServer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Hash.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Hash</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Hash.html#Hash"><span class="hs-identifier">Hash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenMap</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier">AssetId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenPolicy</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetDecimals"><span class="hs-identifier">AssetDecimals</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetLogo"><span class="hs-identifier">AssetLogo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier">AssetMetadata</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetURL"><span class="hs-identifier">AssetURL</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#TokenName"><span class="hs-identifier">TokenName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#TokenPolicyId"><span class="hs-identifier">TokenPolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataDecimals"><span class="hs-identifier">validateMetadataDecimals</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataDescription"><span class="hs-identifier">validateMetadataDescription</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataLogo"><span class="hs-identifier">validateMetadataLogo</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataName"><span class="hs-identifier">validateMetadataName</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataTicker"><span class="hs-identifier">validateMetadataTicker</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataURL"><span class="hs-identifier">validateMetadataURL</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">when</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&gt;=&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">Control.Tracer</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">Tracer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">contramap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">traceWith</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Object</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">eitherDecodeStrict'</span></a></span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">encode</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">withObject</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">withText</span></a></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.!=)</span></a></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.:)</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.:?)</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson.Types</span></a></span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Parser</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">fromJSON</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bifunctor</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">first</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray.Encoding</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Base16</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Base64</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">convertFromBase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">convertToBase</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">ByteString</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Foldable</span></a></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">toList</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">($&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Data.Hashable</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Hashable</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">catMaybes</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mapMaybe</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Proxy</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.String</span></a></span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">IsString</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">Data.Text.Class</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">ToText</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">DiffTime</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">KnownSymbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">symbolVal</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">Network.HTTP.Client</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">HttpException</span></a></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">Manager</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">Request</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">RequestBody</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">Response</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">brReadSome</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">requestFromURI</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">setRequestCheckStatus</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier">withResponse</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../http-client-tls/html/src"><span class="hs-identifier">Network.HTTP.Client.TLS</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../http-client-tls/html/src"><span class="hs-identifier">newTlsManager</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">Network.URI</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">URI</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">relativeTo</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">Network.URI.Static</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier">relativeReference</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">UnliftIO.Exception</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">SomeException</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">handle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">handleAny</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson.Types</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-181"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B8</span></span><span>
</span><span id="line-182"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-183"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../unordered-containers/html/src"><span class="hs-identifier">Data.HashMap.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HM</span></span><span>
</span><span id="line-184"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-185"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-186"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-187"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding.Error</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                                 Token Metadata
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Helper for adding metadata to sets of assets.</span><span>
</span><span id="line-194"></span><span id="local-6989586621682440852"><span id="local-6989586621682440853"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#fillMetadata"><span class="hs-identifier hs-type">fillMetadata</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440853"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440853"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-type">TokenMetadataClient</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682440853"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier hs-type">AssetMetadata</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682440852"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682440853"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440852"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-200"></span><span id="fillMetadata"><span class="annot"><span class="annottext">fillMetadata :: TokenMetadataClient IO
-&gt; t AssetId
-&gt; (Either TokenMetadataError (Maybe AssetMetadata)
    -&gt; AssetId -&gt; a)
-&gt; IO (t a)
</span><a href="Cardano.Wallet.TokenMetadata.html#fillMetadata"><span class="hs-identifier hs-var hs-var">fillMetadata</span></a></span></span><span> </span><span id="local-6989586621682440851"><span class="annot"><span class="annottext">TokenMetadataClient IO
</span><a href="#local-6989586621682440851"><span class="hs-identifier hs-var">client</span></a></span></span><span> </span><span id="local-6989586621682440850"><span class="annot"><span class="annottext">t AssetId
</span><a href="#local-6989586621682440850"><span class="hs-identifier hs-var">assets</span></a></span></span><span> </span><span id="local-6989586621682440849"><span class="annot"><span class="annottext">Either TokenMetadataError (Maybe AssetMetadata) -&gt; AssetId -&gt; a
</span><a href="#local-6989586621682440849"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621682440848"><span class="annot"><span class="annottext">Either TokenMetadataError (Map AssetId AssetMetadata)
</span><a href="#local-6989586621682440848"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(AssetId, AssetMetadata)] -&gt; Map AssetId AssetMetadata)
-&gt; Either TokenMetadataError [(AssetId, AssetMetadata)]
-&gt; Either TokenMetadataError (Map AssetId AssetMetadata)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">[(AssetId, AssetMetadata)] -&gt; Map AssetId AssetMetadata
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TokenMetadataError [(AssetId, AssetMetadata)]
 -&gt; Either TokenMetadataError (Map AssetId AssetMetadata))
-&gt; IO (Either TokenMetadataError [(AssetId, AssetMetadata)])
-&gt; IO (Either TokenMetadataError (Map AssetId AssetMetadata))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataClient IO
-&gt; [AssetId]
-&gt; IO (Either TokenMetadataError [(AssetId, AssetMetadata)])
</span><a href="Cardano.Wallet.TokenMetadata.html#getTokenMetadata"><span class="hs-identifier hs-var">getTokenMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataClient IO
</span><a href="#local-6989586621682440851"><span class="hs-identifier hs-var">client</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t AssetId -&gt; [AssetId]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">t AssetId
</span><a href="#local-6989586621682440850"><span class="hs-identifier hs-var">assets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><span class="annottext">t a -&gt; IO (t a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(t a -&gt; IO (t a)) -&gt; t a -&gt; IO (t a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError (Map AssetId AssetMetadata)
-&gt; AssetId -&gt; a
</span><a href="#local-6989586621682440845"><span class="hs-identifier hs-var">findAsset</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError (Map AssetId AssetMetadata)
</span><a href="#local-6989586621682440848"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; a) -&gt; t AssetId -&gt; t a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t AssetId
</span><a href="#local-6989586621682440850"><span class="hs-identifier hs-var">assets</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-204"></span><span>    </span><span id="local-6989586621682440845"><span class="annot"><span class="annottext">findAsset :: Either TokenMetadataError (Map AssetId AssetMetadata)
-&gt; AssetId -&gt; a
</span><a href="#local-6989586621682440845"><span class="hs-identifier hs-var hs-var">findAsset</span></a></span></span><span> </span><span id="local-6989586621682440844"><span class="annot"><span class="annottext">Either TokenMetadataError (Map AssetId AssetMetadata)
</span><a href="#local-6989586621682440844"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682440843"><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621682440843"><span class="hs-identifier hs-var">aid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError (Maybe AssetMetadata) -&gt; AssetId -&gt; a
</span><a href="#local-6989586621682440849"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssetId -&gt; Map AssetId AssetMetadata -&gt; Maybe AssetMetadata
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621682440843"><span class="hs-identifier hs-var">aid</span></a></span><span> </span><span class="annot"><span class="annottext">(Map AssetId AssetMetadata -&gt; Maybe AssetMetadata)
-&gt; Either TokenMetadataError (Map AssetId AssetMetadata)
-&gt; Either TokenMetadataError (Maybe AssetMetadata)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError (Map AssetId AssetMetadata)
</span><a href="#local-6989586621682440844"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621682440843"><span class="hs-identifier hs-var">aid</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                            Cardano Metadata Server
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Models a request to the @POST /metadata/query@ endpoint of the metadata</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- server -- the only one that we need.</span><span>
</span><span id="line-212"></span><span id="local-6989586621682440840"><span id="local-6989586621682440841"></span></span><span class="hs-keyword">data</span><span> </span><span id="BatchRequest"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-var">BatchRequest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BatchRequest"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-var">BatchRequest</span></a></span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Asubjects%3ABatchRequest"><span class="annot"><span class="annottext">BatchRequest -&gt; [Subject]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asubjects%3ABatchRequest"><span class="hs-identifier hs-var hs-var">subjects</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-type">Subject</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aproperties%3ABatchRequest"><span class="annot"><span class="annottext">BatchRequest -&gt; [PropertyName]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Aproperties%3ABatchRequest"><span class="hs-identifier hs-var hs-var">properties</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-type">PropertyName</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BatchRequest -&gt; Rep BatchRequest x)
-&gt; (forall x. Rep BatchRequest x -&gt; BatchRequest)
-&gt; Generic BatchRequest
forall x. Rep BatchRequest x -&gt; BatchRequest
forall x. BatchRequest -&gt; Rep BatchRequest x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BatchRequest x -&gt; BatchRequest
$cfrom :: forall x. BatchRequest -&gt; Rep BatchRequest x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440828"><span id="local-6989586621682440830"><span id="local-6989586621682440832"><span class="annot"><span class="annottext">Int -&gt; BatchRequest -&gt; ShowS
[BatchRequest] -&gt; ShowS
BatchRequest -&gt; String
(Int -&gt; BatchRequest -&gt; ShowS)
-&gt; (BatchRequest -&gt; String)
-&gt; ([BatchRequest] -&gt; ShowS)
-&gt; Show BatchRequest
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BatchRequest] -&gt; ShowS
$cshowList :: [BatchRequest] -&gt; ShowS
show :: BatchRequest -&gt; String
$cshow :: BatchRequest -&gt; String
showsPrec :: Int -&gt; BatchRequest -&gt; ShowS
$cshowsPrec :: Int -&gt; BatchRequest -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440823"><span id="local-6989586621682440825"><span class="annot"><span class="annottext">BatchRequest -&gt; BatchRequest -&gt; Bool
(BatchRequest -&gt; BatchRequest -&gt; Bool)
-&gt; (BatchRequest -&gt; BatchRequest -&gt; Bool) -&gt; Eq BatchRequest
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BatchRequest -&gt; BatchRequest -&gt; Bool
$c/= :: BatchRequest -&gt; BatchRequest -&gt; Bool
== :: BatchRequest -&gt; BatchRequest -&gt; Bool
$c== :: BatchRequest -&gt; BatchRequest -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Models the response from the @POST /metadata/query@ endpoint of the</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- metadata server. This should contain properties each subject in the</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- 'BatchRequest'.</span><span>
</span><span id="line-220"></span><span id="local-6989586621682440820"><span id="local-6989586621682440821"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="BatchResponse"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-var">BatchResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BatchResponse"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-var">BatchResponse</span></a></span></span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AgetBatchResponse%3ABatchResponse"><span class="annot"><span class="annottext">BatchResponse -&gt; [SubjectProperties]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AgetBatchResponse%3ABatchResponse"><span class="hs-identifier hs-var hs-var">getBatchResponse</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-type">SubjectProperties</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BatchResponse -&gt; Rep BatchResponse x)
-&gt; (forall x. Rep BatchResponse x -&gt; BatchResponse)
-&gt; Generic BatchResponse
forall x. Rep BatchResponse x -&gt; BatchResponse
forall x. BatchResponse -&gt; Rep BatchResponse x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep BatchResponse x -&gt; BatchResponse
$cfrom :: forall x. BatchResponse -&gt; Rep BatchResponse x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440810"><span id="local-6989586621682440812"><span id="local-6989586621682440814"><span class="annot"><span class="annottext">Int -&gt; BatchResponse -&gt; ShowS
[BatchResponse] -&gt; ShowS
BatchResponse -&gt; String
(Int -&gt; BatchResponse -&gt; ShowS)
-&gt; (BatchResponse -&gt; String)
-&gt; ([BatchResponse] -&gt; ShowS)
-&gt; Show BatchResponse
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BatchResponse] -&gt; ShowS
$cshowList :: [BatchResponse] -&gt; ShowS
show :: BatchResponse -&gt; String
$cshow :: BatchResponse -&gt; String
showsPrec :: Int -&gt; BatchResponse -&gt; ShowS
$cshowsPrec :: Int -&gt; BatchResponse -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440806"><span id="local-6989586621682440808"><span class="annot"><span class="annottext">BatchResponse -&gt; BatchResponse -&gt; Bool
(BatchResponse -&gt; BatchResponse -&gt; Bool)
-&gt; (BatchResponse -&gt; BatchResponse -&gt; Bool) -&gt; Eq BatchResponse
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BatchResponse -&gt; BatchResponse -&gt; Bool
$c/= :: BatchResponse -&gt; BatchResponse -&gt; Bool
== :: BatchResponse -&gt; BatchResponse -&gt; Bool
$c== :: BatchResponse -&gt; BatchResponse -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Property values and signatures for a given subject.</span><span>
</span><span id="line-225"></span><span id="local-6989586621682440804"><span id="local-6989586621682440805"></span></span><span class="hs-keyword">data</span><span> </span><span id="SubjectProperties"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-var">SubjectProperties</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SubjectProperties"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-var">SubjectProperties</span></a></span></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Asubject%3ASubjectProperties"><span class="annot"><span class="annottext">SubjectProperties -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asubject%3ASubjectProperties"><span class="hs-identifier hs-var hs-var">subject</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-type">Subject</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aowner%3ASubjectProperties"><span class="annot"><span class="annottext">SubjectProperties -&gt; Maybe Signature
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Aowner%3ASubjectProperties"><span class="hs-identifier hs-var hs-var">owner</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- TODO: use Data.SOP.NP and parameterize type by property names</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- Name and description are required, both others may be missing the</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- response.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aproperties%3ASubjectProperties"><span class="annot"><span class="annottext">SubjectProperties
-&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
    Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
    Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Aproperties%3ASubjectProperties"><span class="hs-identifier hs-var hs-var">properties</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;description&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;ticker&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;url&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;logo&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;decimals&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. SubjectProperties -&gt; Rep SubjectProperties x)
-&gt; (forall x. Rep SubjectProperties x -&gt; SubjectProperties)
-&gt; Generic SubjectProperties
forall x. Rep SubjectProperties x -&gt; SubjectProperties
forall x. SubjectProperties -&gt; Rep SubjectProperties x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SubjectProperties x -&gt; SubjectProperties
$cfrom :: forall x. SubjectProperties -&gt; Rep SubjectProperties x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440792"><span id="local-6989586621682440794"><span id="local-6989586621682440796"><span class="annot"><span class="annottext">Int -&gt; SubjectProperties -&gt; ShowS
[SubjectProperties] -&gt; ShowS
SubjectProperties -&gt; String
(Int -&gt; SubjectProperties -&gt; ShowS)
-&gt; (SubjectProperties -&gt; String)
-&gt; ([SubjectProperties] -&gt; ShowS)
-&gt; Show SubjectProperties
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SubjectProperties] -&gt; ShowS
$cshowList :: [SubjectProperties] -&gt; ShowS
show :: SubjectProperties -&gt; String
$cshow :: SubjectProperties -&gt; String
showsPrec :: Int -&gt; SubjectProperties -&gt; ShowS
$cshowsPrec :: Int -&gt; SubjectProperties -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440788"><span id="local-6989586621682440790"><span class="annot"><span class="annottext">SubjectProperties -&gt; SubjectProperties -&gt; Bool
(SubjectProperties -&gt; SubjectProperties -&gt; Bool)
-&gt; (SubjectProperties -&gt; SubjectProperties -&gt; Bool)
-&gt; Eq SubjectProperties
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SubjectProperties -&gt; SubjectProperties -&gt; Bool
$c/= :: SubjectProperties -&gt; SubjectProperties -&gt; Bool
== :: SubjectProperties -&gt; SubjectProperties -&gt; Bool
$c== :: SubjectProperties -&gt; SubjectProperties -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | A property value and its signatures.</span><span>
</span><span id="line-242"></span><span id="local-6989586621682440786"><span id="local-6989586621682440787"></span></span><span class="hs-keyword">data</span><span> </span><span id="Property"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span> </span><span id="local-6989586621682440952"><span class="annot"><a href="#local-6989586621682440952"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Property"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-var">Property</span></a></span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Avalue%3AProperty"><span class="annot"><span class="annottext">Property name -&gt; Either (String, Value) (PropertyValue name)
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Avalue%3AProperty"><span class="hs-identifier hs-var hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440952"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-comment">-- ^ The result of JSON parsing and validating the property value.</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Asignatures%3AProperty"><span class="annot"><span class="annottext">Property name -&gt; [Signature]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asignatures%3AProperty"><span class="hs-identifier hs-var hs-var">signatures</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-246"></span><span>       </span><span class="hs-comment">-- ^ Zero or more signatures of the property value.</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AsequenceNumber%3AProperty"><span class="annot"><span class="annottext">Property name -&gt; Int
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AsequenceNumber%3AProperty"><span class="hs-identifier hs-var hs-var">sequenceNumber</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-248"></span><span>       </span><span class="hs-comment">-- ^ Counter to prevent replaying old signatures.</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Property name -&gt; Rep (Property name) x)
-&gt; (forall x. Rep (Property name) x -&gt; Property name)
-&gt; Generic (Property name)
forall x. Rep (Property name) x -&gt; Property name
forall x. Property name -&gt; Rep (Property name) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (name :: Symbol) x. Rep (Property name) x -&gt; Property name
forall (name :: Symbol) x. Property name -&gt; Rep (Property name) x
$cto :: forall (name :: Symbol) x. Rep (Property name) x -&gt; Property name
$cfrom :: forall (name :: Symbol) x. Property name -&gt; Rep (Property name) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#propertyName"><span class="hs-identifier hs-type">propertyName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682440779"><span class="annot"><a href="#local-6989586621682440779"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440779"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440779"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-type">PropertyName</span></a></span><span>
</span><span id="line-252"></span><span id="propertyName"><span class="annot"><span class="annottext">propertyName :: Property name -&gt; PropertyName
</span><a href="Cardano.Wallet.TokenMetadata.html#propertyName"><span class="hs-identifier hs-var hs-var">propertyName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Property name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; PropertyName
</span><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PropertyName) -&gt; Text -&gt; PropertyName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; String -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">symbolVal</span></a></span><span> </span><span class="annot"><span class="annottext">(Proxy name -&gt; String) -&gt; Proxy name -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682440779"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span id="local-6989586621682440769"><span id="local-6989586621682440771"><span id="local-6989586621682440773"><span id="local-6989586621682440775"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440775"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440775"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-255"></span><span id="local-6989586621682440764"><span id="local-6989586621682440766"><span id="local-6989586621682440768"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440768"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440768"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-comment">-- | A metadata server subject, which can be any string.</span><span>
</span><span id="line-258"></span><span id="local-6989586621682440762"><span id="local-6989586621682440763"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Subject"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-var">Subject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Subject"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-var">Subject</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AunSubject%3ASubject"><span class="annot"><span class="annottext">Subject -&gt; Text
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AunSubject%3ASubject"><span class="hs-identifier hs-var hs-var">unSubject</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Subject -&gt; Rep Subject x)
-&gt; (forall x. Rep Subject x -&gt; Subject) -&gt; Generic Subject
forall x. Rep Subject x -&gt; Subject
forall x. Subject -&gt; Rep Subject x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Subject x -&gt; Subject
$cfrom :: forall x. Subject -&gt; Rep Subject x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440752"><span id="local-6989586621682440754"><span id="local-6989586621682440756"><span class="annot"><span class="annottext">Int -&gt; Subject -&gt; ShowS
[Subject] -&gt; ShowS
Subject -&gt; String
(Int -&gt; Subject -&gt; ShowS)
-&gt; (Subject -&gt; String) -&gt; ([Subject] -&gt; ShowS) -&gt; Show Subject
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Subject] -&gt; ShowS
$cshowList :: [Subject] -&gt; ShowS
show :: Subject -&gt; String
$cshow :: Subject -&gt; String
showsPrec :: Int -&gt; Subject -&gt; ShowS
$cshowsPrec :: Int -&gt; Subject -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440748"><span id="local-6989586621682440750"><span class="annot"><span class="annottext">Subject -&gt; Subject -&gt; Bool
(Subject -&gt; Subject -&gt; Bool)
-&gt; (Subject -&gt; Subject -&gt; Bool) -&gt; Eq Subject
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Subject -&gt; Subject -&gt; Bool
$c/= :: Subject -&gt; Subject -&gt; Bool
== :: Subject -&gt; Subject -&gt; Bool
$c== :: Subject -&gt; Subject -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440733"><span id="local-6989586621682440735"><span id="local-6989586621682440737"><span id="local-6989586621682440739"><span id="local-6989586621682440741"><span id="local-6989586621682440743"><span id="local-6989586621682440745"><span class="annot"><span class="annottext">Eq Subject
Eq Subject
-&gt; (Subject -&gt; Subject -&gt; Ordering)
-&gt; (Subject -&gt; Subject -&gt; Bool)
-&gt; (Subject -&gt; Subject -&gt; Bool)
-&gt; (Subject -&gt; Subject -&gt; Bool)
-&gt; (Subject -&gt; Subject -&gt; Bool)
-&gt; (Subject -&gt; Subject -&gt; Subject)
-&gt; (Subject -&gt; Subject -&gt; Subject)
-&gt; Ord Subject
Subject -&gt; Subject -&gt; Bool
Subject -&gt; Subject -&gt; Ordering
Subject -&gt; Subject -&gt; Subject
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Subject -&gt; Subject -&gt; Subject
$cmin :: Subject -&gt; Subject -&gt; Subject
max :: Subject -&gt; Subject -&gt; Subject
$cmax :: Subject -&gt; Subject -&gt; Subject
&gt;= :: Subject -&gt; Subject -&gt; Bool
$c&gt;= :: Subject -&gt; Subject -&gt; Bool
&gt; :: Subject -&gt; Subject -&gt; Bool
$c&gt; :: Subject -&gt; Subject -&gt; Bool
&lt;= :: Subject -&gt; Subject -&gt; Bool
$c&lt;= :: Subject -&gt; Subject -&gt; Bool
&lt; :: Subject -&gt; Subject -&gt; Bool
$c&lt; :: Subject -&gt; Subject -&gt; Bool
compare :: Subject -&gt; Subject -&gt; Ordering
$ccompare :: Subject -&gt; Subject -&gt; Ordering
$cp1Ord :: Eq Subject
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682440730"><span class="annot"><span class="annottext">String -&gt; Subject
(String -&gt; Subject) -&gt; IsString Subject
forall a. (String -&gt; a) -&gt; IsString a
fromString :: String -&gt; Subject
$cfromString :: String -&gt; Subject
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">IsString</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440725"><span id="local-6989586621682440727"><span class="annot"><span class="annottext">Int -&gt; Subject -&gt; Int
Subject -&gt; Int
(Int -&gt; Subject -&gt; Int) -&gt; (Subject -&gt; Int) -&gt; Hashable Subject
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: Subject -&gt; Int
$chash :: Subject -&gt; Int
hashWithSalt :: Int -&gt; Subject -&gt; Int
$chashWithSalt :: Int -&gt; Subject -&gt; Int
</span><a href="../../../../hashable/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Metadata property identifier.</span><span>
</span><span id="line-263"></span><span id="local-6989586621682440722"><span id="local-6989586621682440723"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="PropertyName"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PropertyName"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AunPropertyName%3APropertyName"><span class="annot"><span class="annottext">PropertyName -&gt; Text
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AunPropertyName%3APropertyName"><span class="hs-identifier hs-var hs-var">unPropertyName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. PropertyName -&gt; Rep PropertyName x)
-&gt; (forall x. Rep PropertyName x -&gt; PropertyName)
-&gt; Generic PropertyName
forall x. Rep PropertyName x -&gt; PropertyName
forall x. PropertyName -&gt; Rep PropertyName x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PropertyName x -&gt; PropertyName
$cfrom :: forall x. PropertyName -&gt; Rep PropertyName x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440713"><span id="local-6989586621682440715"><span id="local-6989586621682440717"><span class="annot"><span class="annottext">Int -&gt; PropertyName -&gt; ShowS
[PropertyName] -&gt; ShowS
PropertyName -&gt; String
(Int -&gt; PropertyName -&gt; ShowS)
-&gt; (PropertyName -&gt; String)
-&gt; ([PropertyName] -&gt; ShowS)
-&gt; Show PropertyName
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PropertyName] -&gt; ShowS
$cshowList :: [PropertyName] -&gt; ShowS
show :: PropertyName -&gt; String
$cshow :: PropertyName -&gt; String
showsPrec :: Int -&gt; PropertyName -&gt; ShowS
$cshowsPrec :: Int -&gt; PropertyName -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440709"><span id="local-6989586621682440711"><span class="annot"><span class="annottext">PropertyName -&gt; PropertyName -&gt; Bool
(PropertyName -&gt; PropertyName -&gt; Bool)
-&gt; (PropertyName -&gt; PropertyName -&gt; Bool) -&gt; Eq PropertyName
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PropertyName -&gt; PropertyName -&gt; Bool
$c/= :: PropertyName -&gt; PropertyName -&gt; Bool
== :: PropertyName -&gt; PropertyName -&gt; Bool
$c== :: PropertyName -&gt; PropertyName -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682440707"><span class="annot"><span class="annottext">String -&gt; PropertyName
(String -&gt; PropertyName) -&gt; IsString PropertyName
forall a. (String -&gt; a) -&gt; IsString a
fromString :: String -&gt; PropertyName
$cfromString :: String -&gt; PropertyName
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">IsString</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440703"><span id="local-6989586621682440705"><span class="annot"><span class="annottext">Int -&gt; PropertyName -&gt; Int
PropertyName -&gt; Int
(Int -&gt; PropertyName -&gt; Int)
-&gt; (PropertyName -&gt; Int) -&gt; Hashable PropertyName
forall a. (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: PropertyName -&gt; Int
$chash :: PropertyName -&gt; Int
hashWithSalt :: Int -&gt; PropertyName -&gt; Int
$chashWithSalt :: Int -&gt; PropertyName -&gt; Int
</span><a href="#local-6989586621682440703"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- | The type of a given property name.</span><span>
</span><span id="line-268"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682440702"><span class="annot"><a href="#local-6989586621682440702"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-269"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-270"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;description&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-271"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;ticker&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-272"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;url&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetURL"><span class="hs-identifier hs-type">AssetURL</span></a></span><span>
</span><span id="line-273"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;logo&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetLogo"><span class="hs-identifier hs-type">AssetLogo</span></a></span><span>
</span><span id="line-274"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="PropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-var">PropertyValue</span></a></span></span><span> </span><span class="annot"><span class="hs-string">&quot;decimals&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetDecimals"><span class="hs-identifier hs-type">AssetDecimals</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-keyword">class</span><span> </span><span id="HasValidator"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-var">HasValidator</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682441089"><span class="annot"><a href="#local-6989586621682441089"><span class="hs-identifier hs-type">name</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- TODO: requires AllowAmbiguousTypes extension</span><span>
</span><span id="line-278"></span><span>    </span><span id="validatePropertyValue"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#validatePropertyValue"><span class="hs-identifier hs-type">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682441089"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682441089"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621682440698"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;name&quot; -&gt; Either String (PropertyValue &quot;name&quot;)
</span><a href="#local-6989586621682440698"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Text
PropertyValue &quot;name&quot; -&gt; Either String (PropertyValue &quot;name&quot;)
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataName"><span class="hs-identifier hs-var">validateMetadataName</span></a></span><span>
</span><span id="line-282"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;description&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621682440696"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;description&quot;
-&gt; Either String (PropertyValue &quot;description&quot;)
</span><a href="#local-6989586621682440696"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Text
PropertyValue &quot;description&quot;
-&gt; Either String (PropertyValue &quot;description&quot;)
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataDescription"><span class="hs-identifier hs-var">validateMetadataDescription</span></a></span><span>
</span><span id="line-284"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;ticker&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621682440694"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;ticker&quot; -&gt; Either String (PropertyValue &quot;ticker&quot;)
</span><a href="#local-6989586621682440694"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String Text
PropertyValue &quot;ticker&quot; -&gt; Either String (PropertyValue &quot;ticker&quot;)
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataTicker"><span class="hs-identifier hs-var">validateMetadataTicker</span></a></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;url&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-comment">-- validation is done before parsing</span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621682440692"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;url&quot; -&gt; Either String (PropertyValue &quot;url&quot;)
</span><a href="#local-6989586621682440692"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PropertyValue &quot;url&quot; -&gt; Either String (PropertyValue &quot;url&quot;)
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span>
</span><span id="line-289"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;logo&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621682440690"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;logo&quot; -&gt; Either String (PropertyValue &quot;logo&quot;)
</span><a href="#local-6989586621682440690"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetLogo -&gt; Either String AssetLogo
PropertyValue &quot;logo&quot; -&gt; Either String (PropertyValue &quot;logo&quot;)
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataLogo"><span class="hs-identifier hs-var">validateMetadataLogo</span></a></span><span>
</span><span id="line-291"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;decimals&quot;</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621682440688"><span class="annot"><span class="annottext">validatePropertyValue :: PropertyValue &quot;decimals&quot;
-&gt; Either String (PropertyValue &quot;decimals&quot;)
</span><a href="#local-6989586621682440688"><span class="hs-identifier hs-var hs-var hs-var hs-var">validatePropertyValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AssetDecimals -&gt; Either String AssetDecimals
PropertyValue &quot;decimals&quot;
-&gt; Either String (PropertyValue &quot;decimals&quot;)
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataDecimals"><span class="hs-identifier hs-var">validateMetadataDecimals</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- | Will be used in future for checking integrity and authenticity of metadata.</span><span>
</span><span id="line-295"></span><span id="local-6989586621682440686"><span id="local-6989586621682440687"></span></span><span class="hs-keyword">data</span><span> </span><span id="Signature"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Signature"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Asignature%3ASignature"><span class="annot"><span class="annottext">Signature -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asignature%3ASignature"><span class="hs-keyword hs-var hs-var">signature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="%24sel%3ApublicKey%3ASignature"><span class="annot"><span class="annottext">Signature -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3ApublicKey%3ASignature"><span class="hs-identifier hs-var hs-var">publicKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Signature -&gt; Rep Signature x)
-&gt; (forall x. Rep Signature x -&gt; Signature) -&gt; Generic Signature
forall x. Rep Signature x -&gt; Signature
forall x. Signature -&gt; Rep Signature x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Signature x -&gt; Signature
$cfrom :: forall x. Signature -&gt; Rep Signature x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440675"><span id="local-6989586621682440677"><span id="local-6989586621682440679"><span class="annot"><span class="annottext">Int -&gt; Signature -&gt; ShowS
[Signature] -&gt; ShowS
Signature -&gt; String
(Int -&gt; Signature -&gt; ShowS)
-&gt; (Signature -&gt; String)
-&gt; ([Signature] -&gt; ShowS)
-&gt; Show Signature
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Signature] -&gt; ShowS
$cshowList :: [Signature] -&gt; ShowS
show :: Signature -&gt; String
$cshow :: Signature -&gt; String
showsPrec :: Int -&gt; Signature -&gt; ShowS
$cshowsPrec :: Int -&gt; Signature -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440671"><span id="local-6989586621682440673"><span class="annot"><span class="annottext">Signature -&gt; Signature -&gt; Bool
(Signature -&gt; Signature -&gt; Bool)
-&gt; (Signature -&gt; Signature -&gt; Bool) -&gt; Eq Signature
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Signature -&gt; Signature -&gt; Bool
$c/= :: Signature -&gt; Signature -&gt; Bool
== :: Signature -&gt; Signature -&gt; Bool
$c== :: Signature -&gt; Signature -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                       Client for Cardano metadata-server
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#metadataClient"><span class="hs-identifier hs-type">metadataClient</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.html#TokenMetadataServer"><span class="hs-identifier hs-type">TokenMetadataServer</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier hs-type">Manager</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span id="metadataClient"><span class="annot"><span class="annottext">metadataClient :: Tracer IO TokenMetadataLog
-&gt; TokenMetadataServer
-&gt; Manager
-&gt; BatchRequest
-&gt; IO (Either TokenMetadataError BatchResponse)
</span><a href="Cardano.Wallet.TokenMetadata.html#metadataClient"><span class="hs-identifier hs-var hs-var">metadataClient</span></a></span></span><span> </span><span id="local-6989586621682440670"><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440670"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.html#TokenMetadataServer"><span class="hs-identifier hs-type">TokenMetadataServer</span></a></span><span> </span><span id="local-6989586621682440668"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440668"><span class="hs-identifier hs-var">baseURI</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682440667"><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621682440667"><span class="hs-identifier hs-var">manager</span></a></span></span><span> </span><span id="local-6989586621682440666"><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440666"><span class="hs-identifier hs-var">batch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621682440665"><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
</span><a href="#local-6989586621682440665"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Either TokenMetadataError BatchResponse)
-&gt; IO (Either TokenMetadataError BatchResponse)
forall b.
IO (Either TokenMetadataError b)
-&gt; IO (Either TokenMetadataError b)
</span><a href="#local-6989586621682440664"><span class="hs-identifier hs-var">handleExc</span></a></span><span> </span><span class="annot"><span class="annottext">(IO (Either TokenMetadataError BatchResponse)
 -&gt; IO (Either TokenMetadataError BatchResponse))
-&gt; IO (Either TokenMetadataError BatchResponse)
-&gt; IO (Either TokenMetadataError BatchResponse)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either TokenMetadataError BatchResponse)
-&gt; IO ByteString -&gt; IO (Either TokenMetadataError BatchResponse)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either TokenMetadataError BatchResponse
forall c. FromJSON c =&gt; ByteString -&gt; Either TokenMetadataError c
</span><a href="#local-6989586621682440663"><span class="hs-identifier hs-var">parseResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO (Either TokenMetadataError BatchResponse))
-&gt; (Request -&gt; IO ByteString)
-&gt; Request
-&gt; IO (Either TokenMetadataError BatchResponse)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; IO ByteString
</span><a href="#local-6989586621682440661"><span class="hs-identifier hs-var">doRequest</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO (Either TokenMetadataError BatchResponse))
-&gt; IO Request -&gt; IO (Either TokenMetadataError BatchResponse)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest -&gt; IO Request
</span><a href="#local-6989586621682440659"><span class="hs-identifier hs-var">makeHttpReq</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440666"><span class="hs-identifier hs-var">batch</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog -&gt; TokenMetadataLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440670"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenMetadataLog -&gt; IO ()) -&gt; TokenMetadataLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
-&gt; Either TokenMetadataError BatchResponse -&gt; TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchResult"><span class="hs-identifier hs-var">MsgFetchResult</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440666"><span class="hs-identifier hs-var">batch</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
</span><a href="#local-6989586621682440665"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
-&gt; IO (Either TokenMetadataError BatchResponse)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
</span><a href="#local-6989586621682440665"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- Construct a Request from the batch.</span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621682440659"><span class="annot"><span class="annottext">makeHttpReq :: BatchRequest -&gt; IO Request
</span><a href="#local-6989586621682440659"><span class="hs-identifier hs-var hs-var">makeHttpReq</span></a></span></span><span> </span><span id="local-6989586621682440657"><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440657"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682440656"><span class="annot"><span class="annottext">json :: ByteString
</span><a href="#local-6989586621682440656"><span class="hs-identifier hs-var hs-var">json</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BatchRequest -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440657"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span id="local-6989586621682440655"><span class="annot"><span class="annottext">uri :: URI
</span><a href="#local-6989586621682440655"><span class="hs-identifier hs-var hs-var">uri</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440654"><span class="hs-identifier hs-var">endpoint</span></a></span><span> </span><span class="annot"><span class="annottext">URI -&gt; URI -&gt; URI
</span><a href="../../../../network-uri/html/src"><span class="hs-operator hs-var">`relativeTo`</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440668"><span class="hs-identifier hs-var">baseURI</span></a></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog -&gt; TokenMetadataLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440670"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenMetadataLog -&gt; IO ()) -&gt; TokenMetadataLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">URI -&gt; ByteString -&gt; TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequestBody"><span class="hs-identifier hs-var">MsgFetchRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440655"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440656"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621682440652"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621682440652"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">URI -&gt; IO Request
forall (m :: * -&gt; *). MonadThrow m =&gt; URI -&gt; m Request
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">requestFromURI</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440655"><span class="hs-identifier hs-var">uri</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">Request -&gt; IO Request
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Request -&gt; IO Request) -&gt; Request -&gt; IO Request
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Request -&gt; Request
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">setRequestCheckStatus</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621682440652"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-322"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">method :: ByteString
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;POST&quot;</span></span><span>
</span><span id="line-323"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">requestBody :: RequestBody
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">requestBody</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; RequestBody
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">RequestBodyLBS</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440656"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-324"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">requestHeaders :: RequestHeaders
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">requestHeaders</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">HeaderName
</span><span class="hs-string">&quot;Content-type&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;application/json&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621682440654"><span class="annot"><span class="annottext">endpoint :: URI
</span><a href="#local-6989586621682440654"><span class="hs-identifier hs-var hs-var">endpoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="">[relativeReference|metadata/query|]</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- Read the request body. Status code has already been checked via</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">-- 'setRequestStatus'.</span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621682440661"><span class="annot"><span class="annottext">doRequest :: Request -&gt; IO ByteString
</span><a href="#local-6989586621682440661"><span class="hs-identifier hs-var hs-var">doRequest</span></a></span></span><span> </span><span id="local-6989586621682440646"><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621682440646"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer IO BracketLog -&gt; IO ByteString -&gt; IO ByteString
forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
Tracer m BracketLog -&gt; m a -&gt; m a
</span><a href="Cardano.Wallet.Logging.html#bracketTracer"><span class="hs-identifier hs-var">bracketTracer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BracketLog -&gt; TokenMetadataLog)
-&gt; Tracer IO TokenMetadataLog -&gt; Tracer IO BracketLog
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BatchRequest -&gt; BracketLog -&gt; TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-var">MsgFetchRequest</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440666"><span class="hs-identifier hs-var">batch</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440670"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO ByteString -&gt; IO ByteString) -&gt; IO ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">Request
-&gt; Manager
-&gt; (Response (IO ByteString) -&gt; IO ByteString)
-&gt; IO ByteString
forall a.
Request -&gt; Manager -&gt; (Response (IO ByteString) -&gt; IO a) -&gt; IO a
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">withResponse</span></a></span><span> </span><span class="annot"><span class="annottext">Request
</span><a href="#local-6989586621682440646"><span class="hs-identifier hs-var">req</span></a></span><span> </span><span class="annot"><span class="annottext">Manager
</span><a href="#local-6989586621682440667"><span class="hs-identifier hs-var">manager</span></a></span><span> </span><span class="annot"><span class="annottext">((Response (IO ByteString) -&gt; IO ByteString) -&gt; IO ByteString)
-&gt; (Response (IO ByteString) -&gt; IO ByteString) -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682440644"><span class="annot"><span class="annottext">Response (IO ByteString)
</span><a href="#local-6989586621682440644"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>            </span><span id="local-6989586621682440643"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440643"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ByteString -&gt; Int -&gt; IO ByteString
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var">brReadSome</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Response (IO ByteString) -&gt; IO ByteString
forall body. Response body -&gt; body
</span><a href="../../../../http-client/html/src"><span class="hs-identifier hs-var hs-var">responseBody</span></a></span><span> </span><span class="annot"><span class="annottext">Response (IO ByteString)
</span><a href="#local-6989586621682440644"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682440641"><span class="hs-identifier hs-var">maxResponseSize</span></a></span><span>
</span><span id="line-333"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int64
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440643"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682440641"><span class="hs-identifier hs-var">maxResponseSize</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-334"></span><span>                </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog -&gt; TokenMetadataLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440670"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataMaxSize"><span class="hs-identifier hs-var">MsgFetchMetadataMaxSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682440641"><span class="hs-identifier hs-var">maxResponseSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><span class="annottext">ByteString -&gt; IO ByteString
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ByteString) -&gt; ByteString -&gt; IO ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440643"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-comment">-- decode and parse json</span><span>
</span><span id="line-338"></span><span>    </span><span id="local-6989586621682440663"><span class="annot"><span class="annottext">parseResponse :: ByteString -&gt; Either TokenMetadataError c
</span><a href="#local-6989586621682440663"><span class="hs-identifier hs-var hs-var">parseResponse</span></a></span></span><span> </span><span id="local-6989586621682440637"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440637"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; TokenMetadataError)
-&gt; Either String c -&gt; Either TokenMetadataError c
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; String -&gt; TokenMetadataError
</span><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataJSONParseError"><span class="hs-identifier hs-var">TokenMetadataJSONParseError</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440637"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Either String c
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">eitherDecodeStrict'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440637"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- Convert http-client exceptions to Left, handle any other synchronous</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">-- exceptions that may occur.</span><span>
</span><span id="line-343"></span><span>    </span><span id="local-6989586621682440664"><span class="annot"><span class="annottext">handleExc :: IO (Either TokenMetadataError b)
-&gt; IO (Either TokenMetadataError b)
</span><a href="#local-6989586621682440664"><span class="hs-identifier hs-var hs-var">handleExc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(HttpException -&gt; IO (Either TokenMetadataError b))
-&gt; IO (Either TokenMetadataError b)
-&gt; IO (Either TokenMetadataError b)
forall (m :: * -&gt; *) e a.
(MonadUnliftIO m, Exception e) =&gt;
(e -&gt; m a) -&gt; m a -&gt; m a
</span><a href="../../../../unliftio/html/src"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LoggedException HttpException -&gt; TokenMetadataError)
-&gt; HttpException -&gt; IO (Either TokenMetadataError b)
forall (f :: * -&gt; *) e a b.
Applicative f =&gt;
(LoggedException e -&gt; a) -&gt; e -&gt; f (Either a b)
</span><a href="#local-6989586621682440635"><span class="hs-identifier hs-var">loggedErr</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException HttpException -&gt; TokenMetadataError
</span><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataFetchError"><span class="hs-identifier hs-var">TokenMetadataFetchError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><span class="annottext">(IO (Either TokenMetadataError b)
 -&gt; IO (Either TokenMetadataError b))
-&gt; (IO (Either TokenMetadataError b)
    -&gt; IO (Either TokenMetadataError b))
-&gt; IO (Either TokenMetadataError b)
-&gt; IO (Either TokenMetadataError b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; IO (Either TokenMetadataError b))
-&gt; IO (Either TokenMetadataError b)
-&gt; IO (Either TokenMetadataError b)
forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
(SomeException -&gt; m a) -&gt; m a -&gt; m a
</span><a href="../../../../unliftio/html/src"><span class="hs-identifier hs-var">handleAny</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LoggedException SomeException -&gt; TokenMetadataError)
-&gt; SomeException -&gt; IO (Either TokenMetadataError b)
forall (f :: * -&gt; *) e a b.
Applicative f =&gt;
(LoggedException e -&gt; a) -&gt; e -&gt; f (Either a b)
</span><a href="#local-6989586621682440635"><span class="hs-identifier hs-var">loggedErr</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; TokenMetadataError
</span><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClientError"><span class="hs-identifier hs-var">TokenMetadataClientError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621682440635"><span class="annot"><span class="annottext">loggedErr :: (LoggedException e -&gt; a) -&gt; e -&gt; f (Either a b)
</span><a href="#local-6989586621682440635"><span class="hs-identifier hs-var hs-var">loggedErr</span></a></span></span><span> </span><span id="local-6989586621682440632"><span class="annot"><span class="annottext">LoggedException e -&gt; a
</span><a href="#local-6989586621682440632"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; f (Either a b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; f (Either a b))
-&gt; (e -&gt; Either a b) -&gt; e -&gt; f (Either a b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Either a b) -&gt; (e -&gt; a) -&gt; e -&gt; Either a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e -&gt; a
</span><a href="#local-6989586621682440632"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(LoggedException e -&gt; a) -&gt; (e -&gt; LoggedException e) -&gt; e -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; LoggedException e
forall e. e -&gt; LoggedException e
</span><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-var">LoggedException</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- Don't let a metadata server consume all our memory - limit to 10MiB</span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621682440641"><span class="annot"><span class="annottext">maxResponseSize :: Int
</span><a href="#local-6989586621682440641"><span class="hs-identifier hs-var hs-var">maxResponseSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- Errors</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- | The possible errors which can occur when fetching metadata.</span><span>
</span><span id="line-354"></span><span id="local-6989586621682440628"><span id="local-6989586621682440629"></span></span><span class="hs-keyword">data</span><span> </span><span id="TokenMetadataError"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-var">TokenMetadataError</span></a></span></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="TokenMetadataClientError"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClientError"><span class="hs-identifier hs-var">TokenMetadataClientError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span class="hs-comment">-- ^ Unhandled exception</span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TokenMetadataFetchError"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataFetchError"><span class="hs-identifier hs-var">TokenMetadataFetchError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="../../../../http-client/html/src"><span class="hs-identifier hs-type">HttpException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>        </span><span class="hs-comment">-- ^ Error with HTTP request</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="TokenMetadataJSONParseError"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataJSONParseError"><span class="hs-identifier hs-var">TokenMetadataJSONParseError</span></a></span></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-comment">-- ^ Error from aeson decoding of JSON</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. TokenMetadataError -&gt; Rep TokenMetadataError x)
-&gt; (forall x. Rep TokenMetadataError x -&gt; TokenMetadataError)
-&gt; Generic TokenMetadataError
forall x. Rep TokenMetadataError x -&gt; TokenMetadataError
forall x. TokenMetadataError -&gt; Rep TokenMetadataError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep TokenMetadataError x -&gt; TokenMetadataError
$cfrom :: forall x. TokenMetadataError -&gt; Rep TokenMetadataError x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440620"><span id="local-6989586621682440622"><span id="local-6989586621682440624"><span class="annot"><span class="annottext">Int -&gt; TokenMetadataError -&gt; ShowS
[TokenMetadataError] -&gt; ShowS
TokenMetadataError -&gt; String
(Int -&gt; TokenMetadataError -&gt; ShowS)
-&gt; (TokenMetadataError -&gt; String)
-&gt; ([TokenMetadataError] -&gt; ShowS)
-&gt; Show TokenMetadataError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TokenMetadataError] -&gt; ShowS
$cshowList :: [TokenMetadataError] -&gt; ShowS
show :: TokenMetadataError -&gt; String
$cshow :: TokenMetadataError -&gt; String
showsPrec :: Int -&gt; TokenMetadataError -&gt; ShowS
$cshowsPrec :: Int -&gt; TokenMetadataError -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440616"><span id="local-6989586621682440618"><span class="annot"><span class="annottext">TokenMetadataError -&gt; TokenMetadataError -&gt; Bool
(TokenMetadataError -&gt; TokenMetadataError -&gt; Bool)
-&gt; (TokenMetadataError -&gt; TokenMetadataError -&gt; Bool)
-&gt; Eq TokenMetadataError
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TokenMetadataError -&gt; TokenMetadataError -&gt; Bool
$c/= :: TokenMetadataError -&gt; TokenMetadataError -&gt; Bool
== :: TokenMetadataError -&gt; TokenMetadataError -&gt; Bool
$c== :: TokenMetadataError -&gt; TokenMetadataError -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-364"></span><span>    </span><span id="local-6989586621682440613"><span class="annot"><span class="annottext">rnf :: TokenMetadataError -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ())
-&gt; (TokenMetadataError -&gt; String) -&gt; TokenMetadataError -&gt; ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataError -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-367"></span><span>    </span><span id="local-6989586621682440608"><span class="annot"><span class="annottext">toText :: TokenMetadataError -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClientError"><span class="hs-identifier hs-type">TokenMetadataClientError</span></a></span><span> </span><span id="local-6989586621682440606"><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682440606"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>             </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Unhandled exception: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682440606"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataFetchError"><span class="hs-identifier hs-type">TokenMetadataFetchError</span></a></span><span> </span><span id="local-6989586621682440605"><span class="annot"><span class="annottext">LoggedException HttpException
</span><a href="#local-6989586621682440605"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>             </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error querying metadata server: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException HttpException -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException HttpException
</span><a href="#local-6989586621682440605"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataJSONParseError"><span class="hs-identifier hs-type">TokenMetadataJSONParseError</span></a></span><span> </span><span id="local-6989586621682440604"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440604"><span class="hs-identifier hs-var">json</span></a></span></span><span> </span><span id="local-6989586621682440603"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682440603"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-373"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Error parsing metadata server response JSON: &quot;</span></span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682440603"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-375"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\nThe first 250 characters of the response are:\n&quot;</span></span><span>
</span><span id="line-376"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.decodeUtf8With</span></a></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.lenientDecode</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B8.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">250</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440604"><span class="hs-identifier hs-var">json</span></a></span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span class="hs-comment">-----------</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- Logging</span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-keyword">data</span><span> </span><span id="TokenMetadataLog"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-var">TokenMetadataLog</span></a></span></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="MsgNotConfigured"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgNotConfigured"><span class="hs-identifier hs-var">MsgNotConfigured</span></a></span></span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgFetchRequest"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-var">MsgFetchRequest</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgFetchRequestBody"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequestBody"><span class="hs-identifier hs-var">MsgFetchRequestBody</span></a></span></span><span> </span><span class="annot"><a href="../../../../network-uri/html/src"><span class="hs-identifier hs-type">URI</span></a></span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">BL.ByteString</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgFetchMetadataMaxSize"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataMaxSize"><span class="hs-identifier hs-var">MsgFetchMetadataMaxSize</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgFetchResult"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchResult"><span class="hs-identifier hs-var">MsgFetchResult</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MsgFetchMetadataTime"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataTime"><span class="hs-identifier hs-var">MsgFetchMetadataTime</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">DiffTime</span></a></span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682440592"><span id="local-6989586621682440594"><span id="local-6989586621682440596"><span class="annot"><span class="annottext">Int -&gt; TokenMetadataLog -&gt; ShowS
[TokenMetadataLog] -&gt; ShowS
TokenMetadataLog -&gt; String
(Int -&gt; TokenMetadataLog -&gt; ShowS)
-&gt; (TokenMetadataLog -&gt; String)
-&gt; ([TokenMetadataLog] -&gt; ShowS)
-&gt; Show TokenMetadataLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TokenMetadataLog] -&gt; ShowS
$cshowList :: [TokenMetadataLog] -&gt; ShowS
show :: TokenMetadataLog -&gt; String
$cshow :: TokenMetadataLog -&gt; String
showsPrec :: Int -&gt; TokenMetadataLog -&gt; ShowS
$cshowsPrec :: Int -&gt; TokenMetadataLog -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440588"><span id="local-6989586621682440590"><span class="annot"><span class="annottext">TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool
(TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool)
-&gt; (TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool)
-&gt; Eq TokenMetadataLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool
$c/= :: TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool
== :: TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool
$c== :: TokenMetadataLog -&gt; TokenMetadataLog -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621682440585"><span class="annot"><span class="annottext">getSeverityAnnotation :: TokenMetadataLog -&gt; Severity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">getSeverityAnnotation</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><span class="annottext">TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgNotConfigured"><span class="hs-identifier hs-var">MsgNotConfigured</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Notice</span></span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-type">MsgFetchRequest</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682440582"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440582"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BracketLog -&gt; Severity
forall a. HasSeverityAnnotation a =&gt; a -&gt; Severity
</span><span class="hs-identifier hs-var">getSeverityAnnotation</span></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440582"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequestBody"><span class="hs-identifier hs-type">MsgFetchRequestBody</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataMaxSize"><span class="hs-identifier hs-type">MsgFetchMetadataMaxSize</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Warning</span></span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchResult"><span class="hs-identifier hs-type">MsgFetchResult</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">BatchResponse
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Info</span></span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchResult"><span class="hs-identifier hs-type">MsgFetchResult</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataError
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataTime"><span class="hs-identifier hs-type">MsgFetchMetadataTime</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-402"></span><span>    </span><span id="local-6989586621682440576"><span class="annot"><span class="annottext">toText :: TokenMetadataLog -&gt; Text
</span><a href="#local-6989586621682440576"><span class="hs-identifier hs-var hs-var hs-var hs-var">toText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><span class="annottext">TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgNotConfigured"><span class="hs-identifier hs-var">MsgNotConfigured</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-404"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;No token metadata server is configured.&quot;</span></span><span>
</span><span id="line-405"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-type">MsgFetchRequest</span></a></span><span> </span><span id="local-6989586621682440575"><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440575"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-407"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Will fetch metadata: &quot;</span></span><span>
</span><span id="line-408"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BatchRequest -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440575"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-type">MsgFetchRequest</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682440573"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440573"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-411"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Metadata fetch: &quot;</span></span><span>
</span><span id="line-412"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BracketLog -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440573"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-413"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequestBody"><span class="hs-identifier hs-type">MsgFetchRequestBody</span></a></span><span> </span><span id="local-6989586621682440572"><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440572"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span id="local-6989586621682440571"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440571"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-415"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;POST &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">URI -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">URI
</span><a href="#local-6989586621682440572"><span class="hs-identifier hs-var">uri</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.decodeUtf8With</span></a></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.lenientDecode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440571"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataMaxSize"><span class="hs-identifier hs-type">MsgFetchMetadataMaxSize</span></a></span><span> </span><span id="local-6989586621682440570"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682440570"><span class="hs-identifier hs-var">maxSize</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-418"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Metadata server returned more data than the permitted maximum of&quot;</span></span><span>
</span><span id="line-419"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682440570"><span class="hs-identifier hs-var">maxSize</span></a></span><span>
</span><span id="line-420"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; bytes.&quot;</span></span><span>
</span><span id="line-421"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchResult"><span class="hs-identifier hs-type">MsgFetchResult</span></a></span><span> </span><span id="local-6989586621682440569"><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440569"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621682440568"><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
</span><a href="#local-6989586621682440568"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
</span><a href="#local-6989586621682440568"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-423"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span><span> </span><span id="local-6989586621682440567"><span class="annot"><span class="annottext">[SubjectProperties]
</span><a href="#local-6989586621682440567"><span class="hs-identifier hs-var">batch</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-424"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Successfully queried metadata-server for &quot;</span></span><span>
</span><span id="line-425"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Subject] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">([Subject] -&gt; Int) -&gt; [Subject] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest -&gt; [Subject]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asubjects%3ABatchRequest"><span class="hs-identifier hs-var hs-var">subjects</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440569"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; assets, and received &quot;</span></span><span>
</span><span id="line-427"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[SubjectProperties] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[SubjectProperties]
</span><a href="#local-6989586621682440567"><span class="hs-identifier hs-var">batch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot; in response.&quot;</span></span><span>
</span><span id="line-429"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-430"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621682440565"><span class="annot"><span class="annottext">TokenMetadataError
</span><a href="#local-6989586621682440565"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-431"></span><span>                </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;An error occurred while fetching metadata: &quot;</span></span><span>
</span><span id="line-432"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenMetadataError -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataError
</span><a href="#local-6989586621682440565"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-433"></span><span>                </span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataTime"><span class="hs-identifier hs-type">MsgFetchMetadataTime</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682440564"><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621682440564"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-435"></span><span>            </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Metadata request took: &quot;</span></span><span>
</span><span id="line-436"></span><span>            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DiffTime -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><a href="#local-6989586621682440564"><span class="hs-identifier hs-var">dt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>            </span><span class="hs-special">]</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440562"><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span></span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#traceRequestTimings"><span class="hs-identifier hs-type">traceRequestTimings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span id="traceRequestTimings"><span class="annot"><span class="annottext">traceRequestTimings :: Tracer IO TokenMetadataLog -&gt; IO (Tracer IO TokenMetadataLog)
</span><a href="Cardano.Wallet.TokenMetadata.html#traceRequestTimings"><span class="hs-identifier hs-var hs-var">traceRequestTimings</span></a></span></span><span> </span><span id="local-6989586621682440559"><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440559"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TokenMetadataLog -&gt; Maybe (BatchRequest, BracketLog))
-&gt; Tracer IO (BatchRequest, DiffTime)
-&gt; IO (Tracer IO TokenMetadataLog)
forall (m :: * -&gt; *) a ctx.
(MonadUnliftIO m, MonadMask m) =&gt;
(a -&gt; Maybe (ctx, BracketLog))
-&gt; Tracer m (ctx, DiffTime) -&gt; m (Tracer m a)
</span><a href="Cardano.Wallet.Logging.html#produceTimings"><span class="hs-identifier hs-var">produceTimings</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataLog -&gt; Maybe (BatchRequest, BracketLog)
</span><a href="#local-6989586621682440558"><span class="hs-identifier hs-var">msgQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO (BatchRequest, DiffTime)
</span><a href="#local-6989586621682440557"><span class="hs-identifier hs-var">trDiffTime</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>    </span><span id="local-6989586621682440557"><span class="annot"><span class="annottext">trDiffTime :: Tracer IO (BatchRequest, DiffTime)
</span><a href="#local-6989586621682440557"><span class="hs-identifier hs-var hs-var">trDiffTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((BatchRequest, DiffTime) -&gt; TokenMetadataLog)
-&gt; Tracer IO TokenMetadataLog -&gt; Tracer IO (BatchRequest, DiffTime)
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(BatchRequest -&gt; DiffTime -&gt; TokenMetadataLog)
-&gt; (BatchRequest, DiffTime) -&gt; TokenMetadataLog
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest -&gt; DiffTime -&gt; TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchMetadataTime"><span class="hs-identifier hs-var">MsgFetchMetadataTime</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440559"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621682440558"><span class="annot"><span class="annottext">msgQuery :: TokenMetadataLog -&gt; Maybe (BatchRequest, BracketLog)
</span><a href="#local-6989586621682440558"><span class="hs-identifier hs-var hs-var">msgQuery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#MsgFetchRequest"><span class="hs-identifier hs-type">MsgFetchRequest</span></a></span><span> </span><span id="local-6989586621682440555"><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440555"><span class="hs-identifier hs-var">req</span></a></span></span><span> </span><span id="local-6989586621682440554"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440554"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(BatchRequest, BracketLog) -&gt; Maybe (BatchRequest, BracketLog)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440555"><span class="hs-identifier hs-var">req</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682440554"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>        </span><span class="annot"><span class="annottext">TokenMetadataLog
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (BatchRequest, BracketLog)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                           Requesting token metadata
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Represents a client for the metadata server.</span><span>
</span><span id="line-454"></span><span class="hs-keyword">newtype</span><span> </span><span id="TokenMetadataClient"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-var">TokenMetadataClient</span></a></span></span><span> </span><span id="local-6989586621682440991"><span class="annot"><a href="#local-6989586621682440991"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TokenMetadataClient"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-var">TokenMetadataClient</span></a></span></span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3A_batchQuery%3ATokenMetadataClient"><span class="annot"><span class="annottext">TokenMetadataClient m
-&gt; BatchRequest -&gt; m (Either TokenMetadataError BatchResponse)
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3A_batchQuery%3ATokenMetadataClient"><span class="hs-identifier hs-var hs-var">_batchQuery</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682440991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Not a client for the metadata server.</span><span>
</span><span id="line-459"></span><span id="local-6989586621682440983"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#nullTokenMetadataClient"><span class="hs-identifier hs-type">nullTokenMetadataClient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440983"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-type">TokenMetadataClient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440983"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-460"></span><span id="nullTokenMetadataClient"><span class="annot"><span class="annottext">nullTokenMetadataClient :: TokenMetadataClient m
</span><a href="Cardano.Wallet.TokenMetadata.html#nullTokenMetadataClient"><span class="hs-identifier hs-var hs-var">nullTokenMetadataClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><span class="annottext">(BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; TokenMetadataClient m
forall (m :: * -&gt; *).
(BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; TokenMetadataClient m
</span><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-var">TokenMetadataClient</span></a></span><span> </span><span class="annot"><span class="annottext">((BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
 -&gt; TokenMetadataClient m)
-&gt; (BatchResponse
    -&gt; BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; BatchResponse
-&gt; TokenMetadataClient m
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">m (Either TokenMetadataError BatchResponse)
-&gt; BatchRequest -&gt; m (Either TokenMetadataError BatchResponse)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either TokenMetadataError BatchResponse)
 -&gt; BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; (BatchResponse -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; BatchResponse
-&gt; BatchRequest
-&gt; m (Either TokenMetadataError BatchResponse)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Either TokenMetadataError BatchResponse
-&gt; m (Either TokenMetadataError BatchResponse)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TokenMetadataError BatchResponse
 -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; (BatchResponse -&gt; Either TokenMetadataError BatchResponse)
-&gt; BatchResponse
-&gt; m (Either TokenMetadataError BatchResponse)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BatchResponse -&gt; Either TokenMetadataError BatchResponse
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">(BatchResponse -&gt; TokenMetadataClient m)
-&gt; BatchResponse -&gt; TokenMetadataClient m
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[SubjectProperties] -&gt; BatchResponse
</span><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-var">BatchResponse</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="hs-comment">-- | Construct a 'TokenMetadataClient' for use with 'getTokenMetadata'.</span><span>
</span><span id="line-464"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#newMetadataClient"><span class="hs-identifier hs-type">newMetadataClient</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataLog"><span class="hs-identifier hs-type">TokenMetadataLog</span></a></span><span> </span><span class="hs-comment">-- ^ Logging</span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.html#TokenMetadataServer"><span class="hs-identifier hs-type">TokenMetadataServer</span></a></span><span> </span><span class="hs-comment">-- ^ URL of metadata server, if enabled.</span><span>
</span><span id="line-467"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-type">TokenMetadataClient</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span id="newMetadataClient"><span class="annot"><span class="annottext">newMetadataClient :: Tracer IO TokenMetadataLog
-&gt; Maybe TokenMetadataServer -&gt; IO (TokenMetadataClient IO)
</span><a href="Cardano.Wallet.TokenMetadata.html#newMetadataClient"><span class="hs-identifier hs-var hs-var">newMetadataClient</span></a></span></span><span> </span><span id="local-6989586621682440549"><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440549"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682440548"><span class="annot"><span class="annottext">TokenMetadataServer
</span><a href="#local-6989586621682440548"><span class="hs-identifier hs-var">uri</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621682440547"><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440547"><span class="hs-identifier hs-var">trTimings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog -&gt; IO (Tracer IO TokenMetadataLog)
</span><a href="Cardano.Wallet.TokenMetadata.html#traceRequestTimings"><span class="hs-identifier hs-var">traceRequestTimings</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440549"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><span class="annottext">(BatchRequest -&gt; IO (Either TokenMetadataError BatchResponse))
-&gt; TokenMetadataClient IO
forall (m :: * -&gt; *).
(BatchRequest -&gt; m (Either TokenMetadataError BatchResponse))
-&gt; TokenMetadataClient m
</span><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-var">TokenMetadataClient</span></a></span><span> </span><span class="annot"><span class="annottext">((BatchRequest -&gt; IO (Either TokenMetadataError BatchResponse))
 -&gt; TokenMetadataClient IO)
-&gt; (Manager
    -&gt; BatchRequest -&gt; IO (Either TokenMetadataError BatchResponse))
-&gt; Manager
-&gt; TokenMetadataClient IO
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
-&gt; TokenMetadataServer
-&gt; Manager
-&gt; BatchRequest
-&gt; IO (Either TokenMetadataError BatchResponse)
</span><a href="Cardano.Wallet.TokenMetadata.html#metadataClient"><span class="hs-identifier hs-var">metadataClient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440549"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
-&gt; Tracer IO TokenMetadataLog -&gt; Tracer IO TokenMetadataLog
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440547"><span class="hs-identifier hs-var">trTimings</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TokenMetadataServer
</span><a href="#local-6989586621682440548"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">(Manager -&gt; TokenMetadataClient IO)
-&gt; IO Manager -&gt; IO (TokenMetadataClient IO)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO Manager
forall (m :: * -&gt; *). MonadIO m =&gt; m Manager
</span><a href="../../../../http-client-tls/html/src"><span class="hs-identifier hs-var">newTlsManager</span></a></span><span>
</span><span id="line-471"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#newMetadataClient"><span class="hs-identifier hs-var">newMetadataClient</span></a></span><span> </span><span id="local-6989586621682440546"><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440546"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe TokenMetadataServer
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog -&gt; TokenMetadataLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO TokenMetadataLog
</span><a href="#local-6989586621682440546"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataLog
</span><a href="Cardano.Wallet.TokenMetadata.html#MsgNotConfigured"><span class="hs-identifier hs-var">MsgNotConfigured</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; TokenMetadataClient IO -&gt; IO (TokenMetadataClient IO)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TokenMetadataClient IO
forall (m :: * -&gt; *). Applicative m =&gt; TokenMetadataClient m
</span><a href="Cardano.Wallet.TokenMetadata.html#nullTokenMetadataClient"><span class="hs-identifier hs-var">nullTokenMetadataClient</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Fetches metadata for a list of assets using the given client.</span><span>
</span><span id="line-475"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#getTokenMetadata"><span class="hs-identifier hs-type">getTokenMetadata</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-type">TokenMetadataClient</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataError"><span class="hs-identifier hs-type">TokenMetadataError</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier hs-type">AssetMetadata</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span id="getTokenMetadata"><span class="annot"><span class="annottext">getTokenMetadata :: TokenMetadataClient IO
-&gt; [AssetId]
-&gt; IO (Either TokenMetadataError [(AssetId, AssetMetadata)])
</span><a href="Cardano.Wallet.TokenMetadata.html#getTokenMetadata"><span class="hs-identifier hs-var hs-var">getTokenMetadata</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#TokenMetadataClient"><span class="hs-identifier hs-type">TokenMetadataClient</span></a></span><span> </span><span id="local-6989586621682440545"><span class="annot"><span class="annottext">BatchRequest -&gt; IO (Either TokenMetadataError BatchResponse)
</span><a href="#local-6989586621682440545"><span class="hs-identifier hs-var">client</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621682440544"><span class="annot"><span class="annottext">[AssetId]
</span><a href="#local-6989586621682440544"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><span class="annottext">(BatchResponse -&gt; [(AssetId, AssetMetadata)])
-&gt; Either TokenMetadataError BatchResponse
-&gt; Either TokenMetadataError [(AssetId, AssetMetadata)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">BatchResponse -&gt; [(AssetId, AssetMetadata)]
</span><a href="#local-6989586621682440543"><span class="hs-identifier hs-var">fromResponse</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TokenMetadataError BatchResponse
 -&gt; Either TokenMetadataError [(AssetId, AssetMetadata)])
-&gt; IO (Either TokenMetadataError BatchResponse)
-&gt; IO (Either TokenMetadataError [(AssetId, AssetMetadata)])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest -&gt; IO (Either TokenMetadataError BatchResponse)
</span><a href="#local-6989586621682440545"><span class="hs-identifier hs-var">client</span></a></span><span> </span><span class="annot"><span class="annottext">BatchRequest
</span><a href="#local-6989586621682440542"><span class="hs-identifier hs-var">req</span></a></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621682440541"><span class="annot"><span class="annottext">subjects :: [Subject]
</span><a href="#local-6989586621682440541"><span class="hs-identifier hs-var hs-var">subjects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(AssetId -&gt; Subject) -&gt; [AssetId] -&gt; [Subject]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#assetIdToSubject"><span class="hs-identifier hs-var">assetIdToSubject</span></a></span><span> </span><span class="annot"><span class="annottext">[AssetId]
</span><a href="#local-6989586621682440544"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621682440542"><span class="annot"><span class="annottext">req :: BatchRequest
</span><a href="#local-6989586621682440542"><span class="hs-identifier hs-var hs-var">req</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BatchRequest :: [Subject] -&gt; [PropertyName] -&gt; BatchRequest
</span><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span><span>
</span><span id="line-484"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">[Subject]
subjects :: [Subject]
$sel:subjects:BatchRequest :: [Subject]
</span><a href="#local-6989586621682440541"><span class="hs-identifier hs-var hs-var">subjects</span></a></span><span>
</span><span id="line-485"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:properties:BatchRequest :: [PropertyName]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Aproperties%3ABatchRequest"><span class="hs-identifier hs-var">properties</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; PropertyName
</span><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; PropertyName) -&gt; [Text] -&gt; [PropertyName]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span>
</span><span id="line-486"></span><span>             </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;description&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ticker&quot;</span></span><span>
</span><span id="line-487"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;url&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;logo&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decimals&quot;</span></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-489"></span><span>    </span><span id="local-6989586621682440539"><span class="annot"><span class="annottext">subjectAsset :: HashMap Subject AssetId
</span><a href="#local-6989586621682440539"><span class="hs-identifier hs-var hs-var">subjectAsset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Subject, AssetId)] -&gt; HashMap Subject AssetId
forall k v. (Eq k, Hashable k) =&gt; [(k, v)] -&gt; HashMap k v
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HM.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Subject, AssetId)] -&gt; HashMap Subject AssetId)
-&gt; [(Subject, AssetId)] -&gt; HashMap Subject AssetId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Subject] -&gt; [AssetId] -&gt; [(Subject, AssetId)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="annot"><span class="annottext">[Subject]
</span><a href="#local-6989586621682440541"><span class="hs-identifier hs-var">subjects</span></a></span><span> </span><span class="annot"><span class="annottext">[AssetId]
</span><a href="#local-6989586621682440544"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="annot"><a href="#local-6989586621682440543"><span class="hs-identifier hs-type">fromResponse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier hs-type">AssetMetadata</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621682440543"><span class="annot"><span class="annottext">fromResponse :: BatchResponse -&gt; [(AssetId, AssetMetadata)]
</span><a href="#local-6989586621682440543"><span class="hs-identifier hs-var hs-var">fromResponse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SubjectProperties -&gt; Maybe (AssetId, AssetMetadata))
-&gt; [SubjectProperties] -&gt; [(AssetId, AssetMetadata)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621682440537"><span class="annot"><span class="annottext">SubjectProperties
</span><a href="#local-6989586621682440537"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>        </span><span class="annot"><span class="annottext">(AssetId -&gt; AssetMetadata -&gt; (AssetId, AssetMetadata))
-&gt; Maybe AssetId
-&gt; Maybe (AssetMetadata -&gt; (AssetId, AssetMetadata))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Subject -&gt; HashMap Subject AssetId -&gt; Maybe AssetId
forall k v. (Eq k, Hashable k) =&gt; k -&gt; HashMap k v -&gt; Maybe v
</span><a href="../../../../unordered-containers/html/src"><span class="hs-identifier hs-var">HM.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SubjectProperties -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Asubject%3ASubjectProperties"><span class="hs-identifier hs-var hs-var">subject</span></a></span><span> </span><span class="annot"><span class="annottext">SubjectProperties
</span><a href="#local-6989586621682440537"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">HashMap Subject AssetId
</span><a href="#local-6989586621682440539"><span class="hs-identifier hs-var">subjectAsset</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="annottext">Maybe (AssetMetadata -&gt; (AssetId, AssetMetadata))
-&gt; Maybe AssetMetadata -&gt; Maybe (AssetId, AssetMetadata)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">SubjectProperties -&gt; Maybe AssetMetadata
</span><a href="Cardano.Wallet.TokenMetadata.html#metadataFromProperties"><span class="hs-identifier hs-var">metadataFromProperties</span></a></span><span> </span><span class="annot"><span class="annottext">SubjectProperties
</span><a href="#local-6989586621682440537"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>        </span><span class="annot"><span class="annottext">([SubjectProperties] -&gt; [(AssetId, AssetMetadata)])
-&gt; (BatchResponse -&gt; [SubjectProperties])
-&gt; BatchResponse
-&gt; [(AssetId, AssetMetadata)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BatchResponse -&gt; [SubjectProperties]
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AgetBatchResponse%3ABatchResponse"><span class="hs-identifier hs-var hs-var">getBatchResponse</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- | Creates a metadata server subject from an AssetId. The subject is the</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- policy id and asset name hex-encoded.</span><span>
</span><span id="line-498"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#assetIdToSubject"><span class="hs-identifier hs-type">assetIdToSubject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-type">Subject</span></a></span><span>
</span><span id="line-499"></span><span id="assetIdToSubject"><span class="annot"><span class="annottext">assetIdToSubject :: AssetId -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#assetIdToSubject"><span class="hs-identifier hs-var hs-var">assetIdToSubject</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.html#AssetId"><span class="hs-identifier hs-type">AssetId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#UnsafeTokenPolicyId"><span class="hs-identifier hs-type">UnsafeTokenPolicyId</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Hash.html#Hash"><span class="hs-identifier hs-type">Hash</span></a></span><span> </span><span id="local-6989586621682440532"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440532"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#UnsafeTokenName"><span class="hs-identifier hs-type">UnsafeTokenName</span></a></span><span> </span><span id="local-6989586621682440530"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440530"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="annottext">Text -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-var">Subject</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Subject) -&gt; Text -&gt; Subject
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.decodeLatin1</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Base -&gt; ByteString -&gt; ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convertToBase</span></a></span><span> </span><span class="annot"><span class="annottext">Base
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">Base16</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440532"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682440530"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">-- | Convert metadata server properties response into an 'AssetMetadata' record.</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- Only the values are taken. Signatures are ignored (for now).</span><span>
</span><span id="line-504"></span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#metadataFromProperties"><span class="hs-identifier hs-type">metadataFromProperties</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-type">SubjectProperties</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier hs-type">AssetMetadata</span></a></span><span>
</span><span id="line-505"></span><span id="metadataFromProperties"><span class="annot"><span class="annottext">metadataFromProperties :: SubjectProperties -&gt; Maybe AssetMetadata
</span><a href="Cardano.Wallet.TokenMetadata.html#metadataFromProperties"><span class="hs-identifier hs-var hs-var">metadataFromProperties</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-type">SubjectProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Subject
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Signature
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682440528"><span class="annot"><span class="annottext">(Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
 Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
 Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
</span><a href="#local-6989586621682440528"><span class="hs-identifier hs-var">properties</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><span class="annottext">Text
-&gt; Text
-&gt; Maybe Text
-&gt; Maybe AssetURL
-&gt; Maybe AssetLogo
-&gt; Maybe AssetDecimals
-&gt; AssetMetadata
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetMetadata"><span class="hs-identifier hs-var">AssetMetadata</span></a></span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><span class="annottext">(Text
 -&gt; Text
 -&gt; Maybe Text
 -&gt; Maybe AssetURL
 -&gt; Maybe AssetLogo
 -&gt; Maybe AssetDecimals
 -&gt; AssetMetadata)
-&gt; Maybe Text
-&gt; Maybe
     (Text
      -&gt; Maybe Text
      -&gt; Maybe AssetURL
      -&gt; Maybe AssetLogo
      -&gt; Maybe AssetDecimals
      -&gt; AssetMetadata)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;name&quot;) -&gt; Maybe (PropertyValue &quot;name&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;name&quot;)
</span><a href="#local-6989586621682440525"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (Text
   -&gt; Maybe Text
   -&gt; Maybe AssetURL
   -&gt; Maybe AssetLogo
   -&gt; Maybe AssetDecimals
   -&gt; AssetMetadata)
-&gt; Maybe Text
-&gt; Maybe
     (Maybe Text
      -&gt; Maybe AssetURL
      -&gt; Maybe AssetLogo
      -&gt; Maybe AssetDecimals
      -&gt; AssetMetadata)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;description&quot;)
-&gt; Maybe (PropertyValue &quot;description&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;description&quot;)
</span><a href="#local-6989586621682440524"><span class="hs-identifier hs-var">description</span></a></span><span>
</span><span id="line-509"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (Maybe Text
   -&gt; Maybe AssetURL
   -&gt; Maybe AssetLogo
   -&gt; Maybe AssetDecimals
   -&gt; AssetMetadata)
-&gt; Maybe (Maybe Text)
-&gt; Maybe
     (Maybe AssetURL
      -&gt; Maybe AssetLogo -&gt; Maybe AssetDecimals -&gt; AssetMetadata)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Text -&gt; Maybe (Maybe Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Property &quot;ticker&quot;) -&gt; Maybe (PropertyValue &quot;ticker&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;ticker&quot;)
</span><a href="#local-6989586621682440523"><span class="hs-identifier hs-var">ticker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>        </span><span class="annot"><span class="annottext">Maybe
  (Maybe AssetURL
   -&gt; Maybe AssetLogo -&gt; Maybe AssetDecimals -&gt; AssetMetadata)
-&gt; Maybe (Maybe AssetURL)
-&gt; Maybe (Maybe AssetLogo -&gt; Maybe AssetDecimals -&gt; AssetMetadata)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AssetURL -&gt; Maybe (Maybe AssetURL)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Property &quot;url&quot;) -&gt; Maybe (PropertyValue &quot;url&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;url&quot;)
</span><a href="#local-6989586621682440522"><span class="hs-identifier hs-var">url</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Maybe AssetLogo -&gt; Maybe AssetDecimals -&gt; AssetMetadata)
-&gt; Maybe (Maybe AssetLogo)
-&gt; Maybe (Maybe AssetDecimals -&gt; AssetMetadata)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AssetLogo -&gt; Maybe (Maybe AssetLogo)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Property &quot;logo&quot;) -&gt; Maybe (PropertyValue &quot;logo&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;logo&quot;)
</span><a href="#local-6989586621682440521"><span class="hs-identifier hs-var">logo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Maybe AssetDecimals -&gt; AssetMetadata)
-&gt; Maybe (Maybe AssetDecimals) -&gt; Maybe AssetMetadata
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe AssetDecimals -&gt; Maybe (Maybe AssetDecimals)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Property &quot;decimals&quot;) -&gt; Maybe (PropertyValue &quot;decimals&quot;)
forall (a :: Symbol). Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var">getValue</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property &quot;decimals&quot;)
</span><a href="#local-6989586621682440520"><span class="hs-identifier hs-var">decimals</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>    </span><span class="hs-special">(</span><span> </span><span id="local-6989586621682440525"><span class="annot"><span class="annottext">Maybe (Property &quot;name&quot;)
</span><a href="#local-6989586621682440525"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440524"><span class="annot"><span class="annottext">Maybe (Property &quot;description&quot;)
</span><a href="#local-6989586621682440524"><span class="hs-identifier hs-var">description</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440523"><span class="annot"><span class="annottext">Maybe (Property &quot;ticker&quot;)
</span><a href="#local-6989586621682440523"><span class="hs-identifier hs-var">ticker</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440522"><span class="annot"><span class="annottext">Maybe (Property &quot;url&quot;)
</span><a href="#local-6989586621682440522"><span class="hs-identifier hs-var">url</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440521"><span class="annot"><span class="annottext">Maybe (Property &quot;logo&quot;)
</span><a href="#local-6989586621682440521"><span class="hs-identifier hs-var">logo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440520"><span class="annot"><span class="annottext">Maybe (Property &quot;decimals&quot;)
</span><a href="#local-6989586621682440520"><span class="hs-identifier hs-var">decimals</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
 Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
 Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
</span><a href="#local-6989586621682440528"><span class="hs-identifier hs-var">properties</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span id="local-6989586621682440959"><span class="annot"><a href="#local-6989586621682440526"><span class="hs-identifier hs-type">getValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440959"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440959"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-516"></span><span>    </span><span id="local-6989586621682440526"><span class="annot"><span class="annottext">getValue :: Maybe (Property a) -&gt; Maybe (PropertyValue a)
</span><a href="#local-6989586621682440526"><span class="hs-identifier hs-var hs-var">getValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Property a)
-&gt; (Property a -&gt; Maybe (PropertyValue a))
-&gt; Maybe (PropertyValue a)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((String, Value) -&gt; Maybe (PropertyValue a))
-&gt; (PropertyValue a -&gt; Maybe (PropertyValue a))
-&gt; Either (String, Value) (PropertyValue a)
-&gt; Maybe (PropertyValue a)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (PropertyValue a)
-&gt; (String, Value) -&gt; Maybe (PropertyValue a)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (PropertyValue a)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PropertyValue a -&gt; Maybe (PropertyValue a)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Either (String, Value) (PropertyValue a)
 -&gt; Maybe (PropertyValue a))
-&gt; (Property a -&gt; Either (String, Value) (PropertyValue a))
-&gt; Property a
-&gt; Maybe (PropertyValue a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Property a -&gt; Either (String, Value) (PropertyValue a)
forall (name :: Symbol).
Property name -&gt; Either (String, Value) (PropertyValue name)
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Avalue%3AProperty"><span class="hs-identifier hs-var hs-var">value</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                      Aeson instances for metadata-server
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-521"></span><span>
</span><span id="line-522"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440511"><span id="local-6989586621682440513"><span id="local-6989586621682440515"><span id="local-6989586621682440517"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchRequest"><span class="hs-identifier hs-type">BatchRequest</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440503"><span id="local-6989586621682440505"><span id="local-6989586621682440507"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-type">PropertyName</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621682440502"><span class="annot"><span class="annottext">toJSON :: PropertyName -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (PropertyName -&gt; Text) -&gt; PropertyName -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">PropertyName -&gt; Text
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AunPropertyName%3APropertyName"><span class="hs-identifier hs-var hs-var">unPropertyName</span></a></span><span>
</span><span id="line-526"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440497"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-type">PropertyName</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621682440495"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser PropertyName
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser PropertyName) -&gt; Value -&gt; Parser PropertyName
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withText</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;PropertyName&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PropertyName -&gt; Parser PropertyName
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(PropertyName -&gt; Parser PropertyName)
-&gt; (Text -&gt; PropertyName) -&gt; Text -&gt; Parser PropertyName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; PropertyName
</span><a href="Cardano.Wallet.TokenMetadata.html#PropertyName"><span class="hs-identifier hs-var">PropertyName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>
</span><span id="line-529"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440491"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-type">BatchResponse</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621682440490"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser BatchResponse
</span><a href="#local-6989586621682440490"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser BatchResponse)
-&gt; Value
-&gt; Parser BatchResponse
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BatchResponse&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser BatchResponse) -&gt; Value -&gt; Parser BatchResponse)
-&gt; (Object -&gt; Parser BatchResponse)
-&gt; Value
-&gt; Parser BatchResponse
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682440489"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440489"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621682440488"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621682440488"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Value</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440489"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser [Value]
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;subjects&quot;</span></span><span>
</span><span id="line-532"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682440487"><span class="annot"><span class="annottext">maybeParseItem :: Value -&gt; Parser (Maybe a)
</span><a href="#local-6989586621682440487"><span class="hs-identifier hs-var hs-var">maybeParseItem</span></a></span></span><span> </span><span id="local-6989586621682440486"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440486"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; Parser a -&gt; Parser (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Parser a
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440486"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe a) -&gt; Parser (Maybe a) -&gt; Parser (Maybe a)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;|&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Parser (Maybe a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-533"></span><span>        </span><span class="annot"><span class="annottext">[SubjectProperties] -&gt; BatchResponse
</span><a href="Cardano.Wallet.TokenMetadata.html#BatchResponse"><span class="hs-identifier hs-var">BatchResponse</span></a></span><span> </span><span class="annot"><span class="annottext">([SubjectProperties] -&gt; BatchResponse)
-&gt; Parser [SubjectProperties] -&gt; Parser BatchResponse
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe SubjectProperties] -&gt; [SubjectProperties]
forall a. [Maybe a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">catMaybes</span></a></span><span> </span><span class="annot"><span class="annottext">([Maybe SubjectProperties] -&gt; [SubjectProperties])
-&gt; Parser [Maybe SubjectProperties] -&gt; Parser [SubjectProperties]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser (Maybe SubjectProperties))
-&gt; [Value] -&gt; Parser [Maybe SubjectProperties]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Maybe SubjectProperties)
forall a. FromJSON a =&gt; Value -&gt; Parser (Maybe a)
</span><a href="#local-6989586621682440487"><span class="hs-identifier hs-var">maybeParseItem</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621682440488"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440478"><span id="local-6989586621682440480"><span id="local-6989586621682440482"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-type">Subject</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621682440477"><span class="annot"><span class="annottext">toJSON :: Subject -&gt; Value
</span><a href="#local-6989586621682440477"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Value) -&gt; (Subject -&gt; Text) -&gt; Subject -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Subject -&gt; Text
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3AunSubject%3ASubject"><span class="hs-identifier hs-var hs-var">unSubject</span></a></span><span>
</span><span id="line-537"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440474"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-type">Subject</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621682440473"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Subject
</span><a href="#local-6989586621682440473"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Text -&gt; Parser Subject) -&gt; Value -&gt; Parser Subject
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withText</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Subject&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Subject -&gt; Parser Subject
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Subject -&gt; Parser Subject)
-&gt; (Text -&gt; Subject) -&gt; Text -&gt; Parser Subject
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Subject
</span><a href="Cardano.Wallet.TokenMetadata.html#Subject"><span class="hs-identifier hs-var">Subject</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440470"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-type">SubjectProperties</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-541"></span><span>    </span><span id="local-6989586621682440469"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser SubjectProperties
</span><a href="#local-6989586621682440469"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser SubjectProperties)
-&gt; Value
-&gt; Parser SubjectProperties
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SubjectProperties&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser SubjectProperties)
 -&gt; Value -&gt; Parser SubjectProperties)
-&gt; (Object -&gt; Parser SubjectProperties)
-&gt; Value
-&gt; Parser SubjectProperties
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682440468"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440468"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Subject
-&gt; Maybe Signature
-&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
    Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
    Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
-&gt; SubjectProperties
</span><a href="Cardano.Wallet.TokenMetadata.html#SubjectProperties"><span class="hs-identifier hs-var">SubjectProperties</span></a></span><span>
</span><span id="line-542"></span><span>        </span><span class="annot"><span class="annottext">(Subject
 -&gt; Maybe Signature
 -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
     Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
     Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
 -&gt; SubjectProperties)
-&gt; Parser Subject
-&gt; Parser
     (Maybe Signature
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
      -&gt; SubjectProperties)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440468"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Subject
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;subject&quot;</span></span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="annottext">Parser
  (Maybe Signature
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
   -&gt; SubjectProperties)
-&gt; Parser (Maybe Signature)
-&gt; Parser
     ((Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
      -&gt; SubjectProperties)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440468"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Signature)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:?</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;owner&quot;</span></span><span>
</span><span id="line-544"></span><span>        </span><span class="annot"><span class="annottext">Parser
  ((Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
    Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
    Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
   -&gt; SubjectProperties)
-&gt; Parser
     (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
      Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
      Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
-&gt; Parser SubjectProperties
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
-&gt; Parser
     (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
      Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
      Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
</span><a href="#local-6989586621682440467"><span class="hs-identifier hs-var">parseProperties</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440468"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-545"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-546"></span><span>        </span><span id="local-6989586621682440467"><span class="annot"><span class="annottext">parseProperties :: Object
-&gt; Parser
     (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
      Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
      Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
</span><a href="#local-6989586621682440467"><span class="hs-identifier hs-var hs-var">parseProperties</span></a></span></span><span> </span><span id="local-6989586621682440466"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>            </span><span class="annot"><span class="annottext">(Maybe (Property &quot;name&quot;)
 -&gt; Maybe (Property &quot;description&quot;)
 -&gt; Maybe (Property &quot;ticker&quot;)
 -&gt; Maybe (Property &quot;url&quot;)
 -&gt; Maybe (Property &quot;logo&quot;)
 -&gt; Maybe (Property &quot;decimals&quot;)
 -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
     Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
     Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;name&quot;))
-&gt; Parser
     (Maybe (Property &quot;description&quot;)
      -&gt; Maybe (Property &quot;ticker&quot;)
      -&gt; Maybe (Property &quot;url&quot;)
      -&gt; Maybe (Property &quot;logo&quot;)
      -&gt; Maybe (Property &quot;decimals&quot;)
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;name&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-548"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Maybe (Property &quot;description&quot;)
   -&gt; Maybe (Property &quot;ticker&quot;)
   -&gt; Maybe (Property &quot;url&quot;)
   -&gt; Maybe (Property &quot;logo&quot;)
   -&gt; Maybe (Property &quot;decimals&quot;)
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;description&quot;))
-&gt; Parser
     (Maybe (Property &quot;ticker&quot;)
      -&gt; Maybe (Property &quot;url&quot;)
      -&gt; Maybe (Property &quot;logo&quot;)
      -&gt; Maybe (Property &quot;decimals&quot;)
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;description&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;description&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-549"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Maybe (Property &quot;ticker&quot;)
   -&gt; Maybe (Property &quot;url&quot;)
   -&gt; Maybe (Property &quot;logo&quot;)
   -&gt; Maybe (Property &quot;decimals&quot;)
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;ticker&quot;))
-&gt; Parser
     (Maybe (Property &quot;url&quot;)
      -&gt; Maybe (Property &quot;logo&quot;)
      -&gt; Maybe (Property &quot;decimals&quot;)
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;ticker&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;ticker&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-550"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Maybe (Property &quot;url&quot;)
   -&gt; Maybe (Property &quot;logo&quot;)
   -&gt; Maybe (Property &quot;decimals&quot;)
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;url&quot;))
-&gt; Parser
     (Maybe (Property &quot;logo&quot;)
      -&gt; Maybe (Property &quot;decimals&quot;)
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;url&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;url&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-551"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Maybe (Property &quot;logo&quot;)
   -&gt; Maybe (Property &quot;decimals&quot;)
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;logo&quot;))
-&gt; Parser
     (Maybe (Property &quot;decimals&quot;)
      -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
          Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
          Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;logo&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;logo&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-552"></span><span>            </span><span class="annot"><span class="annottext">Parser
  (Maybe (Property &quot;decimals&quot;)
   -&gt; (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
       Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
       Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;)))
-&gt; Parser (Maybe (Property &quot;decimals&quot;))
-&gt; Parser
     (Maybe (Property &quot;name&quot;), Maybe (Property &quot;description&quot;),
      Maybe (Property &quot;ticker&quot;), Maybe (Property &quot;url&quot;),
      Maybe (Property &quot;logo&quot;), Maybe (Property &quot;decimals&quot;))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Parser (Maybe (Property &quot;decimals&quot;))
forall (name :: Symbol).
(KnownSymbol name, FromJSON (Property name)) =&gt;
Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;decimals&quot;</span></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440466"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>        </span><span class="annot"><a href="#local-6989586621682440465"><span class="hs-identifier hs-type">prop</span></a></span><span>
</span><span id="line-555"></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682440928"><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">KnownSymbol</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Object</span></a></span><span>
</span><span id="line-557"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>        </span><span id="local-6989586621682440465"><span class="annot"><span class="annottext">prop :: Object -&gt; Parser (Maybe (Property name))
</span><a href="#local-6989586621682440465"><span class="hs-identifier hs-var hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621682440464"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440464"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440464"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Value)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:?</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621682440463"><span class="hs-identifier hs-var">propName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Value)
-&gt; (Maybe Value -&gt; Parser (Maybe (Property name)))
-&gt; Parser (Maybe (Property name))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-559"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682440462"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440462"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Property name -&gt; Maybe (Property name)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Property name -&gt; Maybe (Property name))
-&gt; Parser (Property name) -&gt; Parser (Maybe (Property name))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Property name)
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440462"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-560"></span><span>            </span><span class="annot"><span class="annottext">Maybe Value
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Property name) -&gt; Parser (Maybe (Property name))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Property name)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-561"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-562"></span><span>            </span><span id="local-6989586621682440463"><span class="annot"><span class="annottext">propName :: Key
</span><a href="#local-6989586621682440463"><span class="hs-identifier hs-var hs-var">propName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Key
forall a. IsString a =&gt; String -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Key) -&gt; String -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Proxy name -&gt; String
forall (n :: Symbol) (proxy :: Symbol -&gt; *).
KnownSymbol n =&gt;
proxy n -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">symbolVal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy name
forall k (t :: k). Proxy t
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682440928"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span id="local-6989586621682440461"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440458"><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#HasValidator"><span class="hs-identifier hs-type">HasValidator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440461"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#PropertyValue"><span class="hs-identifier hs-type">PropertyValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440461"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440461"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-565"></span><span>    </span><span id="local-6989586621682440457"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Property name)
</span><a href="#local-6989586621682440457"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (Property name))
-&gt; Value
-&gt; Parser (Property name)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Property value&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (Property name))
 -&gt; Value -&gt; Parser (Property name))
-&gt; (Object -&gt; Parser (Property name))
-&gt; Value
-&gt; Parser (Property name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682440456"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440456"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either (String, Value) (PropertyValue name)
-&gt; [Signature] -&gt; Int -&gt; Property name
forall (name :: Symbol).
Either (String, Value) (PropertyValue name)
-&gt; [Signature] -&gt; Int -&gt; Property name
</span><a href="Cardano.Wallet.TokenMetadata.html#Property"><span class="hs-identifier hs-var">Property</span></a></span><span>
</span><span id="line-566"></span><span>            </span><span class="annot"><span class="annottext">(Either (String, Value) (PropertyValue name)
 -&gt; [Signature] -&gt; Int -&gt; Property name)
-&gt; Parser (Either (String, Value) (PropertyValue name))
-&gt; Parser ([Signature] -&gt; Int -&gt; Property name)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Either (String, Value) (PropertyValue name)
</span><a href="#local-6989586621682440455"><span class="hs-identifier hs-var">validate</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Either (String, Value) (PropertyValue name))
-&gt; Parser Value
-&gt; Parser (Either (String, Value) (PropertyValue name))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440456"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Value
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;value&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>            </span><span class="annot"><span class="annottext">Parser ([Signature] -&gt; Int -&gt; Property name)
-&gt; Parser [Signature] -&gt; Parser (Int -&gt; Property name)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440456"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe [Signature])
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:?</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signatures&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Maybe [Signature]) -&gt; [Signature] -&gt; Parser [Signature]
forall a. Parser (Maybe a) -&gt; a -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.!=</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-568"></span><span>            </span><span class="annot"><span class="annottext">Parser (Int -&gt; Property name)
-&gt; Parser Int -&gt; Parser (Property name)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440456"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Maybe Int)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser (Maybe a)
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:?</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;sequenceNumber&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Int) -&gt; Int -&gt; Parser Int
forall a. Parser (Maybe a) -&gt; a -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.!=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-569"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>        </span><span id="local-6989586621682440455"><span class="annot"><span class="annottext">validate :: Value -&gt; Either (String, Value) (PropertyValue name)
</span><a href="#local-6989586621682440455"><span class="hs-identifier hs-var hs-var">validate</span></a></span></span><span> </span><span id="local-6989586621682440454"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440454"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, Value))
-&gt; Either String (PropertyValue name)
-&gt; Either (String, Value) (PropertyValue name)
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-special">,</span></span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440454"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String (PropertyValue name)
 -&gt; Either (String, Value) (PropertyValue name))
-&gt; Either String (PropertyValue name)
-&gt; Either (String, Value) (PropertyValue name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either String (PropertyValue name)
-&gt; (PropertyValue name -&gt; Either String (PropertyValue name))
-&gt; Either String (PropertyValue name)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">HasValidator name =&gt;
PropertyValue name -&gt; Either String (PropertyValue name)
forall (name :: Symbol).
HasValidator name =&gt;
PropertyValue name -&gt; Either String (PropertyValue name)
</span><a href="Cardano.Wallet.TokenMetadata.html#validatePropertyValue"><span class="hs-identifier hs-var">validatePropertyValue</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621682440461"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String (PropertyValue name)
 -&gt; Either String (PropertyValue name))
-&gt; Either String (PropertyValue name)
-&gt; Either String (PropertyValue name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Either String (PropertyValue name)
</span><a href="#local-6989586621682440453"><span class="hs-identifier hs-var">tryParse</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621682440454"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-571"></span><span>        </span><span id="local-6989586621682440453"><span class="annot"><span class="annottext">tryParse :: Value -&gt; Either String (PropertyValue name)
</span><a href="#local-6989586621682440453"><span class="hs-identifier hs-var hs-var">tryParse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result (PropertyValue name) -&gt; Either String (PropertyValue name)
forall a. Result a -&gt; Either String a
</span><a href="Cardano.Wallet.TokenMetadata.html#resultToEither"><span class="hs-identifier hs-var">resultToEither</span></a></span><span> </span><span class="annot"><span class="annottext">(Result (PropertyValue name) -&gt; Either String (PropertyValue name))
-&gt; (Value -&gt; Result (PropertyValue name))
-&gt; Value
-&gt; Either String (PropertyValue name)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Result (PropertyValue name)
forall a. FromJSON a =&gt; Value -&gt; Result a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">fromJSON</span></a></span></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span id="local-6989586621682440923"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#resultToEither"><span class="hs-identifier hs-type">resultToEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Aeson.Result</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440923"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440923"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-574"></span><span id="resultToEither"><span class="annot"><span class="annottext">resultToEither :: Result a -&gt; Either String a
</span><a href="Cardano.Wallet.TokenMetadata.html#resultToEither"><span class="hs-identifier hs-var hs-var">resultToEither</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Aeson.Success</span></a></span><span> </span><span id="local-6989586621682440450"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682440450"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682440450"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Aeson.Error</span></a></span><span> </span><span id="local-6989586621682440448"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682440448"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621682440448"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span id="local-6989586621682440908"><span id="local-6989586621682440909"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#applyValidator"><span class="hs-identifier hs-type">applyValidator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682440909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440908"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682440909"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">Parser</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682440908"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-579"></span><span id="applyValidator"><span class="annot"><span class="annottext">applyValidator :: (a -&gt; Either String b) -&gt; a -&gt; Parser b
</span><a href="Cardano.Wallet.TokenMetadata.html#applyValidator"><span class="hs-identifier hs-var hs-var">applyValidator</span></a></span></span><span> </span><span id="local-6989586621682440446"><span class="annot"><span class="annottext">a -&gt; Either String b
</span><a href="#local-6989586621682440446"><span class="hs-identifier hs-var">validate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Parser b)
-&gt; (b -&gt; Parser b) -&gt; Either String b -&gt; Parser b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser b
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Parser b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String b -&gt; Parser b)
-&gt; (a -&gt; Either String b) -&gt; a -&gt; Parser b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String b
</span><a href="#local-6989586621682440446"><span class="hs-identifier hs-var">validate</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440443"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621682440442"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser Signature
</span><a href="#local-6989586621682440442"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Object -&gt; Parser Signature) -&gt; Value -&gt; Parser Signature
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Signature&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser Signature) -&gt; Value -&gt; Parser Signature)
-&gt; (Object -&gt; Parser Signature) -&gt; Value -&gt; Parser Signature
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682440441"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440441"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; Signature
</span><a href="Cardano.Wallet.TokenMetadata.html#Signature"><span class="hs-identifier hs-var">Signature</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString -&gt; Signature)
-&gt; Parser ByteString -&gt; Parser (ByteString -&gt; Signature)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Encoded 'Base16 -&gt; ByteString)
-&gt; Parser (Encoded 'Base16) -&gt; Parser ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Encoded 'Base16 -&gt; ByteString
forall (base :: Base). Encoded base -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Araw%3AEncoded"><span class="hs-identifier hs-var hs-var">raw</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440441"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Encoded 'Base16)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;signature&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><span class="annottext">Parser (ByteString -&gt; Signature)
-&gt; Parser ByteString -&gt; Parser Signature
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Encoded 'Base16 -&gt; ByteString)
-&gt; Parser (Encoded 'Base16) -&gt; Parser ByteString
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Encoded 'Base16 -&gt; ByteString
forall (base :: Base). Encoded base -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Araw%3AEncoded"><span class="hs-identifier hs-var hs-var">raw</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base16</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621682440441"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (Encoded 'Base16)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;publicKey&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440437"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetURL"><span class="hs-identifier hs-type">AssetURL</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621682440436"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AssetURL
</span><a href="#local-6989586621682440436"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser Text
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser Text)
-&gt; (Text -&gt; Parser AssetURL) -&gt; Value -&gt; Parser AssetURL
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Either String AssetURL) -&gt; Text -&gt; Parser AssetURL
forall a b. (a -&gt; Either String b) -&gt; a -&gt; Parser b
</span><a href="Cardano.Wallet.TokenMetadata.html#applyValidator"><span class="hs-identifier hs-var">applyValidator</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Either String AssetURL
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#validateMetadataURL"><span class="hs-identifier hs-var">validateMetadataURL</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440433"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetLogo"><span class="hs-identifier hs-type">AssetLogo</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621682440432"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AssetLogo
</span><a href="#local-6989586621682440432"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Encoded 'Base64 -&gt; AssetLogo)
-&gt; Parser (Encoded 'Base64) -&gt; Parser AssetLogo
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; AssetLogo
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetLogo"><span class="hs-identifier hs-var">AssetLogo</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; AssetLogo)
-&gt; (Encoded 'Base64 -&gt; ByteString) -&gt; Encoded 'Base64 -&gt; AssetLogo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Encoded 'Base64 -&gt; ByteString
forall (base :: Base). Encoded base -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Araw%3AEncoded"><span class="hs-identifier hs-var hs-var">raw</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">'</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Parser (Encoded 'Base64) -&gt; Parser AssetLogo)
-&gt; (Value -&gt; Parser (Encoded 'Base64)) -&gt; Value -&gt; Parser AssetLogo
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Encoded 'Base64)
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440428"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetDecimals"><span class="hs-identifier hs-type">AssetDecimals</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621682440427"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser AssetDecimals
</span><a href="#local-6989586621682440427"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; AssetDecimals) -&gt; Parser Int -&gt; Parser AssetDecimals
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; AssetDecimals
</span><a href="Cardano.Wallet.Primitive.Types.TokenPolicy.html#AssetDecimals"><span class="hs-identifier hs-var">AssetDecimals</span></a></span><span> </span><span class="annot"><span class="annottext">(Parser Int -&gt; Parser AssetDecimals)
-&gt; (Value -&gt; Parser Int) -&gt; Value -&gt; Parser AssetDecimals
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser Int
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">parseJSON</span></a></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">--</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span id="local-6989586621682440424"><span id="local-6989586621682440425"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="Encoded"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-var">Encoded</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682440914"><span class="annot"><a href="#local-6989586621682440914"><span class="hs-identifier hs-type">base</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Encoded"><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-var">Encoded</span></a></span></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Araw%3AEncoded"><span class="annot"><span class="annottext">Encoded base -&gt; ByteString
</span><a href="Cardano.Wallet.TokenMetadata.html#%24sel%3Araw%3AEncoded"><span class="hs-identifier hs-var hs-var">raw</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. Encoded base -&gt; Rep (Encoded base) x)
-&gt; (forall x. Rep (Encoded base) x -&gt; Encoded base)
-&gt; Generic (Encoded base)
forall x. Rep (Encoded base) x -&gt; Encoded base
forall x. Encoded base -&gt; Rep (Encoded base) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (base :: Base) x. Rep (Encoded base) x -&gt; Encoded base
forall (base :: Base) x. Encoded base -&gt; Rep (Encoded base) x
$cto :: forall (base :: Base) x. Rep (Encoded base) x -&gt; Encoded base
$cfrom :: forall (base :: Base) x. Encoded base -&gt; Rep (Encoded base) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440415"><span id="local-6989586621682440417"><span id="local-6989586621682440419"><span class="annot"><span class="annottext">Int -&gt; Encoded base -&gt; ShowS
[Encoded base] -&gt; ShowS
Encoded base -&gt; String
(Int -&gt; Encoded base -&gt; ShowS)
-&gt; (Encoded base -&gt; String)
-&gt; ([Encoded base] -&gt; ShowS)
-&gt; Show (Encoded base)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (base :: Base). Int -&gt; Encoded base -&gt; ShowS
forall (base :: Base). [Encoded base] -&gt; ShowS
forall (base :: Base). Encoded base -&gt; String
showList :: [Encoded base] -&gt; ShowS
$cshowList :: forall (base :: Base). [Encoded base] -&gt; ShowS
show :: Encoded base -&gt; String
$cshow :: forall (base :: Base). Encoded base -&gt; String
showsPrec :: Int -&gt; Encoded base -&gt; ShowS
$cshowsPrec :: forall (base :: Base). Int -&gt; Encoded base -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682440411"><span id="local-6989586621682440413"><span class="annot"><span class="annottext">Encoded base -&gt; Encoded base -&gt; Bool
(Encoded base -&gt; Encoded base -&gt; Bool)
-&gt; (Encoded base -&gt; Encoded base -&gt; Bool) -&gt; Eq (Encoded base)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall (base :: Base). Encoded base -&gt; Encoded base -&gt; Bool
/= :: Encoded base -&gt; Encoded base -&gt; Bool
$c/= :: forall (base :: Base). Encoded base -&gt; Encoded base -&gt; Bool
== :: Encoded base -&gt; Encoded base -&gt; Bool
$c== :: forall (base :: Base). Encoded base -&gt; Encoded base -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440408"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-type">Encoded</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base16</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621682440407"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Encoded 'Base16)
</span><a href="#local-6989586621682440407"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser (Encoded 'Base16))
-&gt; Value
-&gt; Parser (Encoded 'Base16)
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withText</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base16 bytestring&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Parser (Encoded 'Base16))
 -&gt; Value -&gt; Parser (Encoded 'Base16))
-&gt; (Text -&gt; Parser (Encoded 'Base16))
-&gt; Value
-&gt; Parser (Encoded 'Base16)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-605"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; Parser (Encoded 'Base16))
-&gt; (ByteString -&gt; Parser (Encoded 'Base16))
-&gt; Either String ByteString
-&gt; Parser (Encoded 'Base16)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser (Encoded 'Base16)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Encoded 'Base16 -&gt; Parser (Encoded 'Base16)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Encoded 'Base16 -&gt; Parser (Encoded 'Base16))
-&gt; (ByteString -&gt; Encoded 'Base16)
-&gt; ByteString
-&gt; Parser (Encoded 'Base16)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoded 'Base16
forall (base :: Base). ByteString -&gt; Encoded base
</span><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-var">Encoded</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String ByteString -&gt; Parser (Encoded 'Base16))
-&gt; (Text -&gt; Either String ByteString)
-&gt; Text
-&gt; Parser (Encoded 'Base16)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Base -&gt; ByteString -&gt; Either String ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; Either String bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convertFromBase</span></a></span><span> </span><span class="annot"><span class="annottext">Base
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">Base16</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Either String ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682440403"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">FromJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-type">Encoded</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">Base64</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621682440402"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Encoded 'Base64)
</span><a href="#local-6989586621682440402"><span class="hs-identifier hs-var hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Text -&gt; Parser (Encoded 'Base64))
-&gt; Value
-&gt; Parser (Encoded 'Base64)
forall a. String -&gt; (Text -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">withText</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;base64 bytestring&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Text -&gt; Parser (Encoded 'Base64))
 -&gt; Value -&gt; Parser (Encoded 'Base64))
-&gt; (Text -&gt; Parser (Encoded 'Base64))
-&gt; Value
-&gt; Parser (Encoded 'Base64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; Parser (Encoded 'Base64))
-&gt; (ByteString -&gt; Parser (Encoded 'Base64))
-&gt; Either String ByteString
-&gt; Parser (Encoded 'Base64)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser (Encoded 'Base64)
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Encoded 'Base64 -&gt; Parser (Encoded 'Base64)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Encoded 'Base64 -&gt; Parser (Encoded 'Base64))
-&gt; (ByteString -&gt; Encoded 'Base64)
-&gt; ByteString
-&gt; Parser (Encoded 'Base64)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoded 'Base64
forall (base :: Base). ByteString -&gt; Encoded base
</span><a href="Cardano.Wallet.TokenMetadata.html#Encoded"><span class="hs-identifier hs-var">Encoded</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String ByteString -&gt; Parser (Encoded 'Base64))
-&gt; (Text -&gt; Either String ByteString)
-&gt; Text
-&gt; Parser (Encoded 'Base64)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Base -&gt; ByteString -&gt; Either String ByteString
forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
Base -&gt; bin -&gt; Either String bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convertFromBase</span></a></span><span> </span><span class="annot"><span class="annottext">Base
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">Base64</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Either String ByteString)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; Either String ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span>
</span><span id="line-610"></span></pre></body></html>