<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BinaryLiterals #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- For a UTxO to be considered a suitable collateral input, it must:</span><span>
</span><span id="line-9"></span><span class="hs-comment">--    - Be a pure ADA UTxO (no tokens)</span><span>
</span><span id="line-10"></span><span class="hs-comment">--    - Require a verification key witness to be spent</span><span>
</span><span id="line-11"></span><span class="hs-comment">--    - Not be locked by a script</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- UTxOs of this kind are sometimes referred to as &quot;VK&quot; inputs.</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Primitive.Collateral</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Data types</span></span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier">AddressType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier">Credential</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Classifying address types</span></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#asCollateral"><span class="hs-identifier">asCollateral</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressSuitableForCollateral"><span class="hs-identifier">addressSuitableForCollateral</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeSuitableForCollateral"><span class="hs-identifier">addressTypeSuitableForCollateral</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Reading address types</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeFromHeaderNibble"><span class="hs-identifier">addressTypeFromHeaderNibble</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#getAddressType"><span class="hs-identifier">getAddressType</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressType"><span class="hs-identifier">addressType</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Writing address types</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeToHeaderNibble"><span class="hs-identifier">addressTypeToHeaderNibble</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#putAddressType"><span class="hs-identifier">putAddressType</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Address</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier">Address</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Coin</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Tx</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html#TxOut"><span class="hs-identifier">TxOut</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word8</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier">Data.Word.Odd</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier">Word4</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TokenBundle</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">Data.Binary.Get</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier">Data.Binary.Put</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Bits</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BL</span></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- In the realm of cardano-ledger-specs, we recognize the following types of</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- addresses:</span><span>
</span><span id="line-57"></span><span class="hs-comment">--   (see https://hydra.iohk.io/build/6752483/download/1/ledger-spec.pdf):</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | Address type       | Payment Credential | Stake Credential | Header, first nibble |</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- |--------------------+--------------------+------------------+----------------------|</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Base address       | keyhash            | keyhash          |                 0000 |</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- |                    | scripthash         | keyhash          |                 0001 |</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- |                    | keyhash            | scripthash       |                 0010 |</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- |                    | scripthash         | scripthash       |                 0011 |</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- | Pointer address    | keyhash            | ptr              |                 0100 |</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- |                    | scripthash         | ptr              |                 0101 |</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Enterprise address | keyhash            | -                |                 0110 |</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- |                    | scripthash         | 0                |                 0111 |</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | Bootstrap address  | keyhash            | -                |                 1000 |</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Stake address      | -                  | keyhash          |                 1110 |</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- |                    | -                  | scripthash       |                 1111 |</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Future formats     | ?                  | ?                |            1001-1101 |</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- We represent these types of addresses with the following data types:</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | The type of the address.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">data</span><span> </span><span id="AddressType"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-var">AddressType</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="BaseAddress"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-var">BaseAddress</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="PointerAddress"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-var">PointerAddress</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="EnterpriseAddress"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-var">EnterpriseAddress</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="StakeAddress"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-var">StakeAddress</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-type">Credential</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BootstrapAddress"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BootstrapAddress"><span class="hs-identifier hs-var">BootstrapAddress</span></a></span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-comment">-- ^ A Bootstrap (a.k.a. Byron) address</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682433369"><span id="local-6989586621682433371"><span class="annot"><span class="annottext">AddressType -&gt; AddressType -&gt; Bool
(AddressType -&gt; AddressType -&gt; Bool)
-&gt; (AddressType -&gt; AddressType -&gt; Bool) -&gt; Eq AddressType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: AddressType -&gt; AddressType -&gt; Bool
$c/= :: AddressType -&gt; AddressType -&gt; Bool
== :: AddressType -&gt; AddressType -&gt; Bool
$c== :: AddressType -&gt; AddressType -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682433362"><span id="local-6989586621682433364"><span id="local-6989586621682433366"><span class="annot"><span class="annottext">Int -&gt; AddressType -&gt; ShowS
[AddressType] -&gt; ShowS
AddressType -&gt; String
(Int -&gt; AddressType -&gt; ShowS)
-&gt; (AddressType -&gt; String)
-&gt; ([AddressType] -&gt; ShowS)
-&gt; Show AddressType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [AddressType] -&gt; ShowS
$cshowList :: [AddressType] -&gt; ShowS
show :: AddressType -&gt; String
$cshow :: AddressType -&gt; String
showsPrec :: Int -&gt; AddressType -&gt; ShowS
$cshowsPrec :: Int -&gt; AddressType -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | The type of the credential used in an address.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">data</span><span> </span><span id="Credential"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#Credential"><span class="hs-identifier hs-var">Credential</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="CredentialKeyHash"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CredentialScriptHash"><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621682433355"><span id="local-6989586621682433357"><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; Bool
(Credential -&gt; Credential -&gt; Bool)
-&gt; (Credential -&gt; Credential -&gt; Bool) -&gt; Eq Credential
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Credential -&gt; Credential -&gt; Bool
$c/= :: Credential -&gt; Credential -&gt; Bool
== :: Credential -&gt; Credential -&gt; Bool
$c== :: Credential -&gt; Credential -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682433349"><span id="local-6989586621682433351"><span id="local-6989586621682433353"><span class="annot"><span class="annottext">Int -&gt; Credential -&gt; ShowS
[Credential] -&gt; ShowS
Credential -&gt; String
(Int -&gt; Credential -&gt; ShowS)
-&gt; (Credential -&gt; String)
-&gt; ([Credential] -&gt; ShowS)
-&gt; Show Credential
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Credential] -&gt; ShowS
$cshowList :: [Credential] -&gt; ShowS
show :: Credential -&gt; String
$cshow :: Credential -&gt; String
showsPrec :: Int -&gt; Credential -&gt; ShowS
$cshowsPrec :: Int -&gt; Credential -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-comment">-- To parse the address type, we can inspect the first four bits (nibble) of the</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- address:</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Construct an @AddressType@ from the binary representation.</span><span>
</span><span id="line-96"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeFromHeaderNibble"><span class="hs-identifier hs-type">addressTypeFromHeaderNibble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier hs-type">Word4</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span>
</span><span id="line-97"></span><span id="addressTypeFromHeaderNibble"><span class="annot"><span class="annottext">addressTypeFromHeaderNibble :: Word4 -&gt; Maybe AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeFromHeaderNibble"><span class="hs-identifier hs-var hs-var">addressTypeFromHeaderNibble</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0000</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-var">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0001</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-var">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0010</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-var">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0011</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-var">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0100</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-var">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0101</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-var">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0110</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-var">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0111</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-var">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1000</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BootstrapAddress"><span class="hs-identifier hs-var">BootstrapAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1110</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-var">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1111</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Credential -&gt; AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-var">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe AddressType
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Get an AddressType from a binary stream.</span><span>
</span><span id="line-112"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#getAddressType"><span class="hs-identifier hs-type">getAddressType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier hs-type">B.Get</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span>
</span><span id="line-113"></span><span id="getAddressType"><span class="annot"><span class="annottext">getAddressType :: Get AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#getAddressType"><span class="hs-identifier hs-var hs-var">getAddressType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621682433348"><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682433348"><span class="hs-identifier hs-var">headerAndNetwork</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Get Word8
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">B.getWord8</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682433346"><span class="annot"><span class="annottext">headerNibble :: Word4
</span><a href="#local-6989586621682433346"><span class="hs-identifier hs-var hs-var">headerNibble</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>            </span><span class="annot"><span class="annottext">Word8 -&gt; Word4
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier hs-type">Word4</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word8
</span><a href="#local-6989586621682433348"><span class="hs-identifier hs-var">headerAndNetwork</span></a></span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`Bits.shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><span class="annottext">Get AddressType
-&gt; (AddressType -&gt; Get AddressType)
-&gt; Maybe AddressType
-&gt; Get AddressType
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Get AddressType
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unknown address type.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressType -&gt; Get AddressType
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word4 -&gt; Maybe AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeFromHeaderNibble"><span class="hs-identifier hs-var">addressTypeFromHeaderNibble</span></a></span><span> </span><span class="annot"><span class="annottext">Word4
</span><a href="#local-6989586621682433346"><span class="hs-identifier hs-var">headerNibble</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- For testing and other purposes, it is also helpful to have a way of writing</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- the AddressType back to a binary stream.</span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | Return the binary representation of an @AddressType@.</span><span>
</span><span id="line-126"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeToHeaderNibble"><span class="hs-identifier hs-type">addressTypeToHeaderNibble</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier hs-type">Word4</span></a></span><span>
</span><span id="line-127"></span><span id="addressTypeToHeaderNibble"><span class="annot"><span class="annottext">addressTypeToHeaderNibble :: AddressType -&gt; Word4
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeToHeaderNibble"><span class="hs-identifier hs-var hs-var">addressTypeToHeaderNibble</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0000</span></span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0001</span></span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0010</span></span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0011</span></span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-type">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0100</span></span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-type">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0101</span></span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-type">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0110</span></span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-type">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b0111</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><span class="annottext">AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BootstrapAddress"><span class="hs-identifier hs-var">BootstrapAddress</span></a></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1000</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1110</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word4
</span><span class="hs-number">0b1111</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Write an AddressType to a binary stream.</span><span>
</span><span id="line-141"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#putAddressType"><span class="hs-identifier hs-type">putAddressType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../binary/html/src"><span class="hs-identifier hs-type">B.Put</span></a></span><span>
</span><span id="line-142"></span><span id="putAddressType"><span class="annot"><span class="annottext">putAddressType :: AddressType -&gt; Put
</span><a href="Cardano.Wallet.Primitive.Collateral.html#putAddressType"><span class="hs-identifier hs-var hs-var">putAddressType</span></a></span></span><span> </span><span id="local-6989586621682433343"><span class="annot"><span class="annottext">AddressType
</span><a href="#local-6989586621682433343"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">Word8 -&gt; Put
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">B.putWord8</span></a></span><span> </span><span class="annot"><span class="annottext">(Word8 -&gt; Put) -&gt; Word8 -&gt; Put
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">Word4 -&gt; Word8
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../OddWord/html/src"><span class="hs-identifier hs-type">Word4</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddressType -&gt; Word4
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeToHeaderNibble"><span class="hs-identifier hs-var">addressTypeToHeaderNibble</span></a></span><span> </span><span class="annot"><span class="annottext">AddressType
</span><a href="#local-6989586621682433343"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word8 -&gt; Int -&gt; Word8
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`Bits.shiftL`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Indicates whether or not the given address is suitable for collateral.</span><span>
</span><span id="line-147"></span><span class="hs-comment">--</span><span>
</span><span id="line-148"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressSuitableForCollateral"><span class="hs-identifier hs-type">addressSuitableForCollateral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-149"></span><span id="addressSuitableForCollateral"><span class="annot"><span class="annottext">addressSuitableForCollateral :: Address -&gt; Bool
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressSuitableForCollateral"><span class="hs-identifier hs-var hs-var">addressSuitableForCollateral</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; (AddressType -&gt; Bool) -&gt; Maybe AddressType -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">AddressType -&gt; Bool
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeSuitableForCollateral"><span class="hs-identifier hs-var">addressTypeSuitableForCollateral</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe AddressType -&gt; Bool)
-&gt; (Address -&gt; Maybe AddressType) -&gt; Address -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Maybe AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressType"><span class="hs-identifier hs-var">addressType</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- By inspecting the bit pattern of an Address, we can determine its address</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- type.</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Get the address type of a given address.</span><span>
</span><span id="line-156"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressType"><span class="hs-identifier hs-type">addressType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span>
</span><span id="line-157"></span><span id="addressType"><span class="annot"><span class="annottext">addressType :: Address -&gt; Maybe AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressType"><span class="hs-identifier hs-var hs-var">addressType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Address.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621682433338"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682433338"><span class="hs-identifier hs-var">bytes</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Get AddressType
-&gt; ByteString
-&gt; Either
     (ByteString, ByteOffset, String)
     (ByteString, ByteOffset, AddressType)
forall a.
Get a
-&gt; ByteString
-&gt; Either
     (ByteString, ByteOffset, String) (ByteString, ByteOffset, a)
</span><a href="../../../../binary/html/src"><span class="hs-identifier hs-var">B.runGetOrFail</span></a></span><span> </span><span class="annot"><span class="annottext">Get AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#getAddressType"><span class="hs-identifier hs-var">getAddressType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">BL.fromStrict</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621682433338"><span class="hs-identifier hs-var">bytes</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString, ByteOffset, String)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>            </span><span class="annot"><span class="annottext">Maybe AddressType
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ByteOffset
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682433335"><span class="annot"><span class="annottext">AddressType
</span><a href="#local-6989586621682433335"><span class="hs-identifier hs-var">addrType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">AddressType -&gt; Maybe AddressType
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">AddressType
</span><a href="#local-6989586621682433335"><span class="hs-identifier hs-var">addrType</span></a></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- The funds associated with an address are considered suitable for use as</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- collateral iff the payment credential column of that address is &quot;key hash&quot;.</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | A simple function which determines if an @AddressType@ is suitable for use</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- as collateral. Only @AddressType@s with a &quot;key hash&quot; payment credential are</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- considered suitable for use as collateral.</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeSuitableForCollateral"><span class="hs-identifier hs-type">addressTypeSuitableForCollateral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#AddressType"><span class="hs-identifier hs-type">AddressType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-171"></span><span id="addressTypeSuitableForCollateral"><span class="annot"><span class="annottext">addressTypeSuitableForCollateral :: AddressType -&gt; Bool
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressTypeSuitableForCollateral"><span class="hs-identifier hs-var hs-var">addressTypeSuitableForCollateral</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#BaseAddress"><span class="hs-identifier hs-type">BaseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-type">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#PointerAddress"><span class="hs-identifier hs-type">PointerAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-type">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#EnterpriseAddress"><span class="hs-identifier hs-type">EnterpriseAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialKeyHash"><span class="hs-identifier hs-var">CredentialKeyHash</span></a></span><span>                        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#StakeAddress"><span class="hs-identifier hs-type">StakeAddress</span></a></span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="Cardano.Wallet.Primitive.Collateral.html#CredentialScriptHash"><span class="hs-identifier hs-var">CredentialScriptHash</span></a></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">AddressType
</span><a href="Cardano.Wallet.Primitive.Collateral.html#BootstrapAddress"><span class="hs-identifier hs-var">BootstrapAddress</span></a></span><span>                                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | If the given @TxOut@ represents a UTxO that is suitable for use as</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- a collateral input, returns @Just@ along with the total ADA value of the</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- UTxO. Otherwise returns @Nothing@ if it is not a suitable collateral value.</span><span>
</span><span id="line-187"></span><span class="annot"><a href="Cardano.Wallet.Primitive.Collateral.html#asCollateral"><span class="hs-identifier hs-type">asCollateral</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Tx.html#TxOut"><span class="hs-identifier hs-type">TxOut</span></a></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- ^ TxOut from a UTxO entry</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- ^ The total ADA value of that UTxO if it is suitable for collateral,</span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-comment">-- otherwise Nothing.</span><span>
</span><span id="line-193"></span><span id="asCollateral"><span class="annot"><span class="annottext">asCollateral :: TxOut -&gt; Maybe Coin
</span><a href="Cardano.Wallet.Primitive.Collateral.html#asCollateral"><span class="hs-identifier hs-var hs-var">asCollateral</span></a></span></span><span> </span><span id="local-6989586621682433334"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621682433334"><span class="hs-identifier hs-var">txOut</span></a></span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Bool
</span><a href="Cardano.Wallet.Primitive.Collateral.html#addressSuitableForCollateral"><span class="hs-identifier hs-var">addressSuitableForCollateral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#%24sel%3Aaddress%3ATxOut"><span class="hs-identifier hs-var hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621682433334"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">TokenBundle -&gt; Maybe Coin
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#toCoin"><span class="hs-identifier hs-var">TokenBundle.toCoin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; TokenBundle
</span><a href="Cardano.Wallet.Primitive.Types.Tx.html#%24sel%3Atokens%3ATxOut"><span class="hs-identifier hs-var hs-var">tokens</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621682433334"><span class="hs-identifier hs-var">txOut</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">Maybe Coin
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-198"></span></pre></body></html>