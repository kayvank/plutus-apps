<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Balance.Gen</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionLimit"><span class="hs-identifier">genSelectionLimit</span></a></span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionSkeleton"><span class="hs-identifier">genSelectionSkeleton</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionStrategy"><span class="hs-identifier">genSelectionStrategy</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionLimit"><span class="hs-identifier">shrinkSelectionLimit</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionSkeleton"><span class="hs-identifier">shrinkSelectionSkeleton</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionStrategy"><span class="hs-identifier">shrinkSelectionStrategy</span></a></span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Balance</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier">SelectionLimit</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimitOf"><span class="hs-identifier">SelectionLimitOf</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier">SelectionSkeleton</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier">SelectionStrategy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html"><span class="hs-identifier">Cardano.Wallet.CoinSelection.Internal.Context</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#SelectionContext"><span class="hs-identifier">SelectionContext</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.Coin</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier">TokenBundle</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.Gen.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle.Gen</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.Gen.html#genTokenBundleSmallRange"><span class="hs-identifier">genTokenBundleSmallRange</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.Gen.html#shrinkTokenBundleSmallRange"><span class="hs-identifier">shrinkTokenBundleSmallRange</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.Gen.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenMap.Gen</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.Gen.html#genAssetId"><span class="hs-identifier">genAssetId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenMap.Gen.html#shrinkAssetId"><span class="hs-identifier">shrinkAssetId</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../generics-sop/html/src"><span class="hs-identifier">Generics.SOP</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../sop-core/html/src"><span class="hs-identifier">NP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">Test.QuickCheck</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">Gen</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">NonNegative</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">arbitrary</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">arbitraryBoundedEnum</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">listOf</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">oneof</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">shrink</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">shrinkList</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">shrinkMapBy</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier">suchThat</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier">Test.QuickCheck.Extra</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier">genericRoundRobinShrink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator">(&lt;:&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator">(&lt;@&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html"><span class="hs-identifier">Cardano.Wallet.Primitive.Types.TokenBundle</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TokenBundle</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- Selection limits</span><span>
</span><span id="line-54"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionLimit"><span class="hs-identifier hs-type">genSelectionLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span>
</span><span id="line-57"></span><span id="genSelectionLimit"><span class="annot"><span class="annottext">genSelectionLimit :: Gen SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionLimit"><span class="hs-identifier hs-var hs-var">genSelectionLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Gen SelectionLimit] -&gt; Gen SelectionLimit
forall a. [Gen a] -&gt; Gen a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">oneof</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int -&gt; SelectionLimit
forall a. a -&gt; SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#MaximumInputLimit"><span class="hs-identifier hs-var">MaximumInputLimit</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SelectionLimit)
-&gt; (NonNegative Int -&gt; Int) -&gt; NonNegative Int -&gt; SelectionLimit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NonNegative Int -&gt; Int
forall a. NonNegative a -&gt; a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var hs-var">getNonNegative</span></a></span><span> </span><span class="annot"><span class="annottext">(NonNegative Int -&gt; SelectionLimit)
-&gt; Gen (NonNegative Int) -&gt; Gen SelectionLimit
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (NonNegative Int)
forall a. Arbitrary a =&gt; Gen a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SelectionLimit -&gt; Gen SelectionLimit
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SelectionLimit
forall a. SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#NoLimit"><span class="hs-identifier hs-var">NoLimit</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionLimit"><span class="hs-identifier hs-type">shrinkSelectionLimit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionLimit"><span class="hs-identifier hs-type">SelectionLimit</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-63"></span><span id="shrinkSelectionLimit"><span class="annot"><span class="annottext">shrinkSelectionLimit :: SelectionLimit -&gt; [SelectionLimit]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionLimit"><span class="hs-identifier hs-var hs-var">shrinkSelectionLimit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-64"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#MaximumInputLimit"><span class="hs-identifier hs-type">MaximumInputLimit</span></a></span><span> </span><span id="local-6989586621682435148"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435148"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-65"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; SelectionLimit
forall a. a -&gt; SelectionLimitOf a
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#MaximumInputLimit"><span class="hs-identifier hs-var">MaximumInputLimit</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; SelectionLimit)
-&gt; (NonNegative Int -&gt; Int) -&gt; NonNegative Int -&gt; SelectionLimit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">NonNegative Int -&gt; Int
forall a. NonNegative a -&gt; a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var hs-var">getNonNegative</span></a></span><span> </span><span class="annot"><span class="annottext">(NonNegative Int -&gt; SelectionLimit)
-&gt; [NonNegative Int] -&gt; [SelectionLimit]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonNegative Int -&gt; [NonNegative Int]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrink</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; NonNegative Int
forall a. a -&gt; NonNegative a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">NonNegative</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621682435148"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">SelectionLimit
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#NoLimit"><span class="hs-identifier hs-var">NoLimit</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-67"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Selection skeletons</span><span>
</span><span id="line-71"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621682435146"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionSkeleton"><span class="hs-identifier hs-type">genSelectionSkeleton</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435146"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435146"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-74"></span><span id="genSelectionSkeleton"><span class="annot"><span class="annottext">genSelectionSkeleton :: Gen (Address ctx) -&gt; Gen (SelectionSkeleton ctx)
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionSkeleton"><span class="hs-identifier hs-var hs-var">genSelectionSkeleton</span></a></span></span><span> </span><span id="local-6989586621682435145"><span class="annot"><span class="annottext">Gen (Address ctx)
</span><a href="#local-6989586621682435145"><span class="hs-identifier hs-var">genAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; [(Address ctx, TokenBundle)]
-&gt; [Set AssetId]
-&gt; SelectionSkeleton ctx
forall ctx.
Int
-&gt; [(Address ctx, TokenBundle)]
-&gt; [Set AssetId]
-&gt; SelectionSkeleton ctx
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-var">SelectionSkeleton</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><span class="annottext">(Int
 -&gt; [(Address ctx, TokenBundle)]
 -&gt; [Set AssetId]
 -&gt; SelectionSkeleton ctx)
-&gt; Gen Int
-&gt; Gen
     ([(Address ctx, TokenBundle)]
      -&gt; [Set AssetId] -&gt; SelectionSkeleton ctx)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen Int
</span><a href="#local-6989586621682435143"><span class="hs-identifier hs-var">genSkeletonInputCount</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="annottext">Gen
  ([(Address ctx, TokenBundle)]
   -&gt; [Set AssetId] -&gt; SelectionSkeleton ctx)
-&gt; Gen [(Address ctx, TokenBundle)]
-&gt; Gen ([Set AssetId] -&gt; SelectionSkeleton ctx)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435142"><span class="hs-identifier hs-var">genSkeletonOutputs</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">Gen ([Set AssetId] -&gt; SelectionSkeleton ctx)
-&gt; Gen [Set AssetId] -&gt; Gen (SelectionSkeleton ctx)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen [Set AssetId]
</span><a href="#local-6989586621682435141"><span class="hs-identifier hs-var">genSkeletonChange</span></a></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>    </span><span id="local-6989586621682435143"><span class="annot"><span class="annottext">genSkeletonInputCount :: Gen Int
</span><a href="#local-6989586621682435143"><span class="hs-identifier hs-var hs-var">genSkeletonInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">NonNegative Int -&gt; Int
forall a. NonNegative a -&gt; a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var hs-var">getNonNegative</span></a></span><span> </span><span class="annot"><span class="annottext">(NonNegative Int -&gt; Int) -&gt; Gen (NonNegative Int) -&gt; Gen Int
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Arbitrary (NonNegative Int) =&gt; Gen (NonNegative Int)
forall a. Arbitrary a =&gt; Gen a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">arbitrary</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">NonNegative</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span id="local-6989586621682435142"><span class="annot"><span class="annottext">genSkeletonOutputs :: Gen [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435142"><span class="hs-identifier hs-var hs-var">genSkeletonOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">Gen (Address ctx, TokenBundle) -&gt; Gen [(Address ctx, TokenBundle)]
forall a. Gen a -&gt; Gen [a]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">listOf</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435140"><span class="hs-identifier hs-var">genSkeletonOutput</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span id="local-6989586621682435140"><span class="annot"><span class="annottext">genSkeletonOutput :: Gen (Address ctx, TokenBundle)
</span><a href="#local-6989586621682435140"><span class="hs-identifier hs-var hs-var">genSkeletonOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">(Address ctx -&gt; TokenBundle -&gt; (Address ctx, TokenBundle))
-&gt; Gen (Address ctx)
-&gt; Gen (TokenBundle -&gt; (Address ctx, TokenBundle))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen (Address ctx)
</span><a href="#local-6989586621682435145"><span class="hs-identifier hs-var">genAddress</span></a></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">Gen (TokenBundle -&gt; (Address ctx, TokenBundle))
-&gt; Gen TokenBundle -&gt; Gen (Address ctx, TokenBundle)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen TokenBundle
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.Gen.html#genTokenBundleSmallRange"><span class="hs-identifier hs-var">genTokenBundleSmallRange</span></a></span><span> </span><span class="annot"><span class="annottext">Gen TokenBundle -&gt; (TokenBundle -&gt; Bool) -&gt; Gen TokenBundle
forall a. Gen a -&gt; (a -&gt; Bool) -&gt; Gen a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-operator hs-var">`suchThat`</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#tokenBundleHasNonZeroCoin"><span class="hs-identifier hs-var">tokenBundleHasNonZeroCoin</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span id="local-6989586621682435141"><span class="annot"><span class="annottext">genSkeletonChange :: Gen [Set AssetId]
</span><a href="#local-6989586621682435141"><span class="hs-identifier hs-var hs-var">genSkeletonChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">Gen (Set AssetId) -&gt; Gen [Set AssetId]
forall a. Gen a -&gt; Gen [a]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">listOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AssetId] -&gt; Set AssetId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([AssetId] -&gt; Set AssetId) -&gt; Gen [AssetId] -&gt; Gen (Set AssetId)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetId -&gt; Gen [AssetId]
forall a. Gen a -&gt; Gen [a]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">listOf</span></a></span><span> </span><span class="annot"><span class="annottext">Gen AssetId
</span><a href="Cardano.Wallet.Primitive.Types.TokenMap.Gen.html#genAssetId"><span class="hs-identifier hs-var">genAssetId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621682435137"><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionSkeleton"><span class="hs-identifier hs-type">shrinkSelectionSkeleton</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435137"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Context.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435137"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435137"><span class="hs-identifier hs-type">ctx</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionSkeleton"><span class="hs-identifier hs-type">SelectionSkeleton</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682435137"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-92"></span><span id="shrinkSelectionSkeleton"><span class="annot"><span class="annottext">shrinkSelectionSkeleton :: (Address ctx -&gt; [Address ctx])
-&gt; SelectionSkeleton ctx -&gt; [SelectionSkeleton ctx]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionSkeleton"><span class="hs-identifier hs-var hs-var">shrinkSelectionSkeleton</span></a></span></span><span> </span><span id="local-6989586621682435136"><span class="annot"><span class="annottext">Address ctx -&gt; [Address ctx]
</span><a href="#local-6989586621682435136"><span class="hs-identifier hs-var">shrinkAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NP (I -.-&gt; []) '[Int, [(Address ctx, TokenBundle)], [Set AssetId]]
-&gt; SelectionSkeleton ctx -&gt; [SelectionSkeleton ctx]
forall a (xs :: [*]).
(Generic a, GFrom a, GTo a, GCode a ~ '[xs]) =&gt;
NP (I -.-&gt; []) xs -&gt; a -&gt; [a]
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">genericRoundRobinShrink</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="annottext">(NP (I -.-&gt; []) '[Int, [(Address ctx, TokenBundle)], [Set AssetId]]
 -&gt; SelectionSkeleton ctx -&gt; [SelectionSkeleton ctx])
-&gt; NP
     (I -.-&gt; []) '[Int, [(Address ctx, TokenBundle)], [Set AssetId]]
-&gt; SelectionSkeleton ctx
-&gt; [SelectionSkeleton ctx]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;@&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
</span><a href="#local-6989586621682435135"><span class="hs-identifier hs-var">shrinkSkeletonInputCount</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">(Int -&gt; [Int])
-&gt; NP (I -.-&gt; []) '[[(Address ctx, TokenBundle)], [Set AssetId]]
-&gt; NP
     (I -.-&gt; []) '[Int, [(Address ctx, TokenBundle)], [Set AssetId]]
forall x (xs :: [*]).
(x -&gt; [x]) -&gt; NP (I -.-&gt; []) xs -&gt; NP (I -.-&gt; []) (x : xs)
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[(Address ctx, TokenBundle)] -&gt; [[(Address ctx, TokenBundle)]]
</span><a href="#local-6989586621682435134"><span class="hs-identifier hs-var">shrinkSkeletonOutputs</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="annottext">([(Address ctx, TokenBundle)] -&gt; [[(Address ctx, TokenBundle)]])
-&gt; NP (I -.-&gt; []) '[[Set AssetId]]
-&gt; NP (I -.-&gt; []) '[[(Address ctx, TokenBundle)], [Set AssetId]]
forall x (xs :: [*]).
(x -&gt; [x]) -&gt; NP (I -.-&gt; []) xs -&gt; NP (I -.-&gt; []) (x : xs)
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Set AssetId] -&gt; [[Set AssetId]]
</span><a href="#local-6989586621682435133"><span class="hs-identifier hs-var">shrinkSkeletonChange</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">([Set AssetId] -&gt; [[Set AssetId]])
-&gt; NP (I -.-&gt; []) '[] -&gt; NP (I -.-&gt; []) '[[Set AssetId]]
forall x (xs :: [*]).
(x -&gt; [x]) -&gt; NP (I -.-&gt; []) xs -&gt; NP (I -.-&gt; []) (x : xs)
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NP (I -.-&gt; []) '[]
forall k (a :: k -&gt; *). NP a '[]
</span><a href="../../../../sop-core/html/src"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621682435135"><span class="annot"><span class="annottext">shrinkSkeletonInputCount :: Int -&gt; [Int]
</span><a href="#local-6989586621682435135"><span class="hs-identifier hs-var hs-var">shrinkSkeletonInputCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-99"></span><span>        </span><span class="annot"><span class="annottext">Arbitrary Int =&gt; Int -&gt; [Int]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrink</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621682435134"><span class="annot"><span class="annottext">shrinkSkeletonOutputs :: [(Address ctx, TokenBundle)] -&gt; [[(Address ctx, TokenBundle)]]
</span><a href="#local-6989586621682435134"><span class="hs-identifier hs-var hs-var">shrinkSkeletonOutputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">((Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)])
-&gt; [(Address ctx, TokenBundle)] -&gt; [[(Address ctx, TokenBundle)]]
forall a. (a -&gt; [a]) -&gt; [a] -&gt; [[a]]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrinkList</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435131"><span class="hs-identifier hs-var">shrinkSkeletonOutput</span></a></span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621682435131"><span class="annot"><span class="annottext">shrinkSkeletonOutput :: (Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)]
</span><a href="#local-6989586621682435131"><span class="hs-identifier hs-var hs-var">shrinkSkeletonOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">NP (I -.-&gt; []) '[Address ctx, TokenBundle]
-&gt; (Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)]
forall a (xs :: [*]).
(Generic a, GFrom a, GTo a, GCode a ~ '[xs]) =&gt;
NP (I -.-&gt; []) xs -&gt; a -&gt; [a]
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-identifier hs-var">genericRoundRobinShrink</span></a></span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">(NP (I -.-&gt; []) '[Address ctx, TokenBundle]
 -&gt; (Address ctx, TokenBundle) -&gt; [(Address ctx, TokenBundle)])
-&gt; NP (I -.-&gt; []) '[Address ctx, TokenBundle]
-&gt; (Address ctx, TokenBundle)
-&gt; [(Address ctx, TokenBundle)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;@&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Address ctx -&gt; [Address ctx]
</span><a href="#local-6989586621682435136"><span class="hs-identifier hs-var">shrinkAddress</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="annot"><span class="annottext">(Address ctx -&gt; [Address ctx])
-&gt; NP (I -.-&gt; []) '[TokenBundle]
-&gt; NP (I -.-&gt; []) '[Address ctx, TokenBundle]
forall x (xs :: [*]).
(x -&gt; [x]) -&gt; NP (I -.-&gt; []) xs -&gt; NP (I -.-&gt; []) (x : xs)
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(TokenBundle -&gt; Bool) -&gt; [TokenBundle] -&gt; [TokenBundle]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#tokenBundleHasNonZeroCoin"><span class="hs-identifier hs-var">tokenBundleHasNonZeroCoin</span></a></span><span> </span><span class="annot"><span class="annottext">([TokenBundle] -&gt; [TokenBundle])
-&gt; (TokenBundle -&gt; [TokenBundle]) -&gt; TokenBundle -&gt; [TokenBundle]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; [TokenBundle]
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.Gen.html#shrinkTokenBundleSmallRange"><span class="hs-identifier hs-var">shrinkTokenBundleSmallRange</span></a></span><span>
</span><span id="line-106"></span><span>            </span><span class="annot"><span class="annottext">(TokenBundle -&gt; [TokenBundle])
-&gt; NP (I -.-&gt; []) '[] -&gt; NP (I -.-&gt; []) '[TokenBundle]
forall x (xs :: [*]).
(x -&gt; [x]) -&gt; NP (I -.-&gt; []) xs -&gt; NP (I -.-&gt; []) (x : xs)
</span><a href="../../../../cardano-wallet-test-utils/html/src"><span class="hs-operator hs-var">&lt;:&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NP (I -.-&gt; []) '[]
forall k (a :: k -&gt; *). NP a '[]
</span><a href="../../../../sop-core/html/src"><span class="hs-identifier hs-var">Nil</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621682435133"><span class="annot"><span class="annottext">shrinkSkeletonChange :: [Set AssetId] -&gt; [[Set AssetId]]
</span><a href="#local-6989586621682435133"><span class="hs-identifier hs-var hs-var">shrinkSkeletonChange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">(Set AssetId -&gt; [Set AssetId]) -&gt; [Set AssetId] -&gt; [[Set AssetId]]
forall a. (a -&gt; [a]) -&gt; [a] -&gt; [[a]]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrinkList</span></a></span><span> </span><span class="annot"><span class="annottext">((Set AssetId -&gt; [Set AssetId])
 -&gt; [Set AssetId] -&gt; [[Set AssetId]])
-&gt; (Set AssetId -&gt; [Set AssetId])
-&gt; [Set AssetId]
-&gt; [[Set AssetId]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="annottext">([AssetId] -&gt; Set AssetId)
-&gt; (Set AssetId -&gt; [AssetId])
-&gt; ([AssetId] -&gt; [[AssetId]])
-&gt; Set AssetId
-&gt; [Set AssetId]
forall a b. (a -&gt; b) -&gt; (b -&gt; a) -&gt; (a -&gt; [a]) -&gt; b -&gt; [b]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrinkMapBy</span></a></span><span> </span><span class="annot"><span class="annottext">[AssetId] -&gt; Set AssetId
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">Set AssetId -&gt; [AssetId]
forall a. Set a -&gt; [a]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(AssetId -&gt; [AssetId]) -&gt; [AssetId] -&gt; [[AssetId]]
forall a. (a -&gt; [a]) -&gt; [a] -&gt; [[a]]
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">shrinkList</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; [AssetId]
</span><a href="Cardano.Wallet.Primitive.Types.TokenMap.Gen.html#shrinkAssetId"><span class="hs-identifier hs-var">shrinkAssetId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#tokenBundleHasNonZeroCoin"><span class="hs-identifier hs-type">tokenBundleHasNonZeroCoin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#TokenBundle"><span class="hs-identifier hs-type">TokenBundle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-112"></span><span id="tokenBundleHasNonZeroCoin"><span class="annot"><span class="annottext">tokenBundleHasNonZeroCoin :: TokenBundle -&gt; Bool
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#tokenBundleHasNonZeroCoin"><span class="hs-identifier hs-var hs-var">tokenBundleHasNonZeroCoin</span></a></span></span><span> </span><span id="local-6989586621682435129"><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435129"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TokenBundle -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.TokenBundle.html#getCoin"><span class="hs-identifier hs-var">TokenBundle.getCoin</span></a></span><span> </span><span class="annot"><span class="annottext">TokenBundle
</span><a href="#local-6989586621682435129"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Coin -&gt; Coin -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Natural -&gt; Coin
</span><a href="Cardano.Wallet.Primitive.Types.Coin.html#Coin"><span class="hs-identifier hs-var">Coin</span></a></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- Selection strategies</span><span>
</span><span id="line-116"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionStrategy"><span class="hs-identifier hs-type">genSelectionStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-type">Gen</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier hs-type">SelectionStrategy</span></a></span><span>
</span><span id="line-119"></span><span id="genSelectionStrategy"><span class="annot"><span class="annottext">genSelectionStrategy :: Gen SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#genSelectionStrategy"><span class="hs-identifier hs-var hs-var">genSelectionStrategy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Gen SelectionStrategy
forall a. (Bounded a, Enum a) =&gt; Gen a
</span><a href="../../../../QuickCheck/html/src"><span class="hs-identifier hs-var">arbitraryBoundedEnum</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionStrategy"><span class="hs-identifier hs-type">shrinkSelectionStrategy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier hs-type">SelectionStrategy</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategy"><span class="hs-identifier hs-type">SelectionStrategy</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-122"></span><span id="shrinkSelectionStrategy"><span class="annot"><span class="annottext">shrinkSelectionStrategy :: SelectionStrategy -&gt; [SelectionStrategy]
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.Gen.html#shrinkSelectionStrategy"><span class="hs-identifier hs-var hs-var">shrinkSelectionStrategy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- Shrinking from &quot;optimal&quot; to &quot;minimal&quot; should increase the likelihood of</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">-- making a successful selection, as the &quot;minimal&quot; strategy is designed to</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-comment">-- generate smaller selections.</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="annottext">SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategyMinimal"><span class="hs-identifier hs-var">SelectionStrategyMinimal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><span class="annottext">SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategyOptimal"><span class="hs-identifier hs-var">SelectionStrategyOptimal</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">SelectionStrategy
</span><a href="Cardano.Wallet.CoinSelection.Internal.Balance.html#SelectionStrategyMinimal"><span class="hs-identifier hs-var">SelectionStrategyMinimal</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span></pre></body></html>