<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright: &#169; 2018-2020 IOHK</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License: Apache-2.0</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- This module contains utility functions for logging and mapping trace data.</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Wallet.Logging</span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Conversions from BM framework</span></span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Logging.html#trMessage"><span class="hs-identifier">trMessage</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#trMessageText"><span class="hs-identifier">trMessageText</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Formatting typed messages as plain text</span></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#transformTextTrace"><span class="hs-identifier">transformTextTrace</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#stdoutTextTracer"><span class="hs-identifier">stdoutTextTracer</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Logging helpers</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#traceWithExceptT"><span class="hs-identifier">traceWithExceptT</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#traceResult"><span class="hs-identifier">traceResult</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#formatResultMsg"><span class="hs-identifier">formatResultMsg</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#formatResultMsgWith"><span class="hs-identifier">formatResultMsgWith</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#resultSeverity"><span class="hs-identifier">resultSeverity</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Logging and timing IO actions</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier">BracketLog</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier">LoggedException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer"><span class="hs-identifier">bracketTracer</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer%27"><span class="hs-identifier">bracketTracer'</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#produceTimings"><span class="hs-identifier">produceTimings</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Tracer conversions</span></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#unliftIOTracer"><span class="hs-identifier">unliftIOTracer</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#flatContramapTracer"><span class="hs-identifier">flatContramapTracer</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.LogItem</span></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">LOContent</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LogObject</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">LoggerName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mkLOMeta</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Severity</span></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Severity</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Data.Tracer</span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">HasPrivacyAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">HasSeverityAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Transformable</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.BM.Trace</span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Trace</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">when</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../exceptions/html/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../exceptions/html/src"><span class="hs-identifier">MonadMask</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier">Control.Monad.IO.Unlift</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">MonadIO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier">MonadUnliftIO</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Control.Monad.Trans.Except</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">ExceptT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">runExceptT</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">Control.Tracer</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">Tracer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">contramap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">natTracer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">nullTracer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier">traceWith</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier">Control.Tracer.Transformers.ObserveOutcome</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier">Outcome</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier">OutcomeFidelity</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier">OutcomeProgressionStatus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier">mkOutcomeExtractor</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Data.Aeson</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Value</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">Null</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier">object</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-operator">(.=)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">($&gt;)</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Text</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">Data.Text.Class</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier">ToText</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">Data.Time.Clock</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">DiffTime</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">Data.Time.Clock.System</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">getSystemTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">systemToTAITime</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">Data.Time.Clock.TAI</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">AbsoluteTime</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier">diffAbsoluteTime</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../fmt/html/src"><span class="hs-identifier">Fmt</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier">Buildable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Builder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../fmt/html/src"><span class="hs-identifier">blockListF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../fmt/html/src"><span class="hs-identifier">blockMapF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../fmt/html/src"><span class="hs-identifier">nameF</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">IsList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Generic</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">UnliftIO.Exception</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">SomeException</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">displayException</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">isSyncException</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../unliftio/html/src"><span class="hs-identifier">withException</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B8</span></span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Converts a 'Text' trace into any other type of trace that has a 'ToText'</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- instance.</span><span>
</span><span id="line-112"></span><span id="local-6989586621682422664"><span class="annot"><a href="Cardano.Wallet.Logging.html#transformTextTrace"><span class="hs-identifier hs-type">transformTextTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422664"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422664"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-113"></span><span id="transformTextTrace"><span class="annot"><span class="annottext">transformTextTrace :: Trace IO Text -&gt; Trace IO a
</span><a href="Cardano.Wallet.Logging.html#transformTextTrace"><span class="hs-identifier hs-var hs-var">transformTextTrace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, LogObject a) -&gt; (Text, LogObject Text))
-&gt; Trace IO Text -&gt; Trace IO a
forall (f :: * -&gt; *) a b. Contravariant f =&gt; (a -&gt; b) -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">contramap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(LogObject a -&gt; LogObject Text)
-&gt; (Text, LogObject a) -&gt; (Text, LogObject Text)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">((LogObject a -&gt; LogObject Text)
 -&gt; (Text, LogObject a) -&gt; (Text, LogObject Text))
-&gt; ((a -&gt; Text) -&gt; LogObject a -&gt; LogObject Text)
-&gt; (a -&gt; Text)
-&gt; (Text, LogObject a)
-&gt; (Text, LogObject Text)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Text) -&gt; LogObject a -&gt; LogObject Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Text) -&gt; (Text, LogObject a) -&gt; (Text, LogObject Text))
-&gt; (a -&gt; Text) -&gt; (Text, LogObject a) -&gt; (Text, LogObject Text)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Trace IO Text -&gt; Trace IO a)
-&gt; (Trace IO Text -&gt; Trace IO Text) -&gt; Trace IO Text -&gt; Trace IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Trace IO Text -&gt; Trace IO Text
forall (m :: * -&gt; *) a.
(Monad m, Monoid a, Eq a) =&gt;
Trace m a -&gt; Trace m a
</span><a href="Cardano.Wallet.Logging.html#filterNonEmpty"><span class="hs-identifier hs-var">filterNonEmpty</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | Tracer transformer which transforms traced items to their 'ToText'</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- representation and further traces them as a 'LogObject'. If the 'ToText'</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- representation is empty, then no tracing happens.</span><span>
</span><span id="line-118"></span><span id="local-6989586621682422883"><span id="local-6989586621682422884"><span class="annot"><a href="Cardano.Wallet.Logging.html#trMessageText"><span class="hs-identifier hs-type">trMessageText</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422884"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422883"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422884"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LoggerName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogObject</span></span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422884"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422883"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-122"></span><span id="trMessageText"><span class="annot"><span class="annottext">trMessageText :: Tracer m (Text, LogObject Text) -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#trMessageText"><span class="hs-identifier hs-var hs-var">trMessageText</span></a></span></span><span> </span><span id="local-6989586621682422660"><span class="annot"><span class="annottext">Tracer m (Text, LogObject Text)
</span><a href="#local-6989586621682422660"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m ()) -&gt; Tracer m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m ()) -&gt; Tracer m a) -&gt; (a -&gt; m ()) -&gt; Tracer m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682422658"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422658"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682422657"><span class="annot"><span class="annottext">msg :: Text
</span><a href="#local-6989586621682422657"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422658"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-124"></span><span>       </span><span id="local-6989586621682422656"><span class="annot"><span class="annottext">tracer :: Tracer m (Text, LogObject Text)
</span><a href="#local-6989586621682422656"><span class="hs-identifier hs-var hs-var">tracer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682422657"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject Text)
forall (m :: * -&gt; *) a. Applicative m =&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">nullTracer</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject Text)
</span><a href="#local-6989586621682422660"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-125"></span><span>   </span><span id="local-6989586621682422655"><span class="annot"><span class="annottext">LOMeta
</span><a href="#local-6989586621682422655"><span class="hs-identifier hs-var">meta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; PrivacyAnnotation -&gt; m LOMeta
forall (m :: * -&gt; *).
MonadIO m =&gt;
Severity -&gt; PrivacyAnnotation -&gt; m LOMeta
</span><span class="hs-identifier hs-var">mkLOMeta</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Severity
forall a. HasSeverityAnnotation a =&gt; a -&gt; Severity
</span><span class="hs-identifier hs-var">getSeverityAnnotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422658"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; PrivacyAnnotation
forall a. HasPrivacyAnnotation a =&gt; a -&gt; PrivacyAnnotation
</span><span class="hs-identifier hs-var">getPrivacyAnnotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422658"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>   </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject Text) -&gt; (Text, LogObject Text) -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject Text)
</span><a href="#local-6989586621682422656"><span class="hs-identifier hs-var">tracer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; LOMeta -&gt; LOContent Text -&gt; LogObject Text
forall a. Text -&gt; LOMeta -&gt; LOContent a -&gt; LogObject a
</span><span class="hs-identifier hs-var">LogObject</span></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">LOMeta
</span><a href="#local-6989586621682422655"><span class="hs-identifier hs-var">meta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; LOContent Text
forall a. a -&gt; LOContent a
</span><span class="hs-identifier hs-var">LogMessage</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682422657"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | Tracer transformer which converts 'Trace m a' to 'Tracer m a' by wrapping</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- typed log messages into a 'LogObject'.</span><span>
</span><span id="line-130"></span><span id="local-6989586621682422649"><span id="local-6989586621682422650"><span class="annot"><a href="Cardano.Wallet.Logging.html#trMessage"><span class="hs-identifier hs-type">trMessage</span></a></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422650"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422649"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422649"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422650"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LoggerName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LogObject</span></span><span> </span><span class="annot"><a href="#local-6989586621682422649"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422650"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422649"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-134"></span><span id="trMessage"><span class="annot"><span class="annottext">trMessage :: Tracer m (Text, LogObject a) -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#trMessage"><span class="hs-identifier hs-var hs-var">trMessage</span></a></span></span><span> </span><span id="local-6989586621682422648"><span class="annot"><span class="annottext">Tracer m (Text, LogObject a)
</span><a href="#local-6989586621682422648"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m ()) -&gt; Tracer m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m ()) -&gt; Tracer m a) -&gt; (a -&gt; m ()) -&gt; Tracer m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682422647"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422647"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>   </span><span id="local-6989586621682422646"><span class="annot"><span class="annottext">LOMeta
</span><a href="#local-6989586621682422646"><span class="hs-identifier hs-var">meta</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Severity -&gt; PrivacyAnnotation -&gt; m LOMeta
forall (m :: * -&gt; *).
MonadIO m =&gt;
Severity -&gt; PrivacyAnnotation -&gt; m LOMeta
</span><span class="hs-identifier hs-var">mkLOMeta</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Severity
forall a. HasSeverityAnnotation a =&gt; a -&gt; Severity
</span><span class="hs-identifier hs-var">getSeverityAnnotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422647"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; PrivacyAnnotation
forall a. HasPrivacyAnnotation a =&gt; a -&gt; PrivacyAnnotation
</span><span class="hs-identifier hs-var">getPrivacyAnnotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422647"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>   </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject a) -&gt; (Text, LogObject a) -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (Text, LogObject a)
</span><a href="#local-6989586621682422648"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text -&gt; LOMeta -&gt; LOContent a -&gt; LogObject a
forall a. Text -&gt; LOMeta -&gt; LOContent a -&gt; LogObject a
</span><span class="hs-identifier hs-var">LogObject</span></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">LOMeta
</span><a href="#local-6989586621682422646"><span class="hs-identifier hs-var">meta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; LOContent a
forall a. a -&gt; LOContent a
</span><span class="hs-identifier hs-var">LogMessage</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422647"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682422640"><span class="annot"><a href="#local-6989586621682422640"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682422639"><span class="annot"><a href="#local-6989586621682422639"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422640"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="annot"><a href="#local-6989586621682422639"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Transformable</span></span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422640"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422639"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621682422638"><span class="annot"><span class="annottext">trTransformer :: TracingVerbosity -&gt; Trace m Text -&gt; Tracer m a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">trTransformer</span></span></span><span> </span><span id="local-6989586621682422636"><span class="annot"><span class="annottext">TracingVerbosity
</span><a href="#local-6989586621682422636"><span class="hs-identifier hs-var">_verb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m ()) -&gt; Tracer m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m ()) -&gt; Tracer m a)
-&gt; (Trace m Text -&gt; a -&gt; m ()) -&gt; Trace m Text -&gt; Tracer m a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m a -&gt; a -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Tracer m a -&gt; a -&gt; m ())
-&gt; (Trace m Text -&gt; Tracer m a) -&gt; Trace m Text -&gt; a -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Trace m Text -&gt; Tracer m a
forall (m :: * -&gt; *) a.
(MonadIO m, ToText a, HasPrivacyAnnotation a,
 HasSeverityAnnotation a) =&gt;
Tracer m (Text, LogObject Text) -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#trMessageText"><span class="hs-identifier hs-var">trMessageText</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Trace transformer which removes empty traces.</span><span>
</span><span id="line-142"></span><span class="annot"><a href="Cardano.Wallet.Logging.html#filterNonEmpty"><span class="hs-identifier hs-type">filterNonEmpty</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621682422918"><span class="annot"><a href="#local-6989586621682422918"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621682422917"><span class="annot"><a href="#local-6989586621682422917"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422918"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="#local-6989586621682422918"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422917"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Trace</span></span><span> </span><span class="annot"><a href="#local-6989586621682422918"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422917"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-146"></span><span id="filterNonEmpty"><span class="annot"><span class="annottext">filterNonEmpty :: Trace m a -&gt; Trace m a
</span><a href="Cardano.Wallet.Logging.html#filterNonEmpty"><span class="hs-identifier hs-var hs-var">filterNonEmpty</span></a></span></span><span> </span><span id="local-6989586621682422635"><span class="annot"><span class="annottext">Trace m a
</span><a href="#local-6989586621682422635"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Text, LogObject a) -&gt; m ()) -&gt; Trace m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">(((Text, LogObject a) -&gt; m ()) -&gt; Trace m a)
-&gt; ((Text, LogObject a) -&gt; m ()) -&gt; Trace m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682422634"><span class="annot"><span class="annottext">(Text, LogObject a)
</span><a href="#local-6989586621682422634"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; m () -&gt; m ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LOContent a -&gt; Bool
forall a. (Eq a, Monoid a) =&gt; LOContent a -&gt; Bool
</span><a href="#local-6989586621682422633"><span class="hs-identifier hs-var">nonEmptyMessage</span></a></span><span> </span><span class="annot"><span class="annottext">(LOContent a -&gt; Bool) -&gt; LOContent a -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">LogObject a -&gt; LOContent a
forall a. LogObject a -&gt; LOContent a
</span><span class="hs-identifier hs-var hs-var">loContent</span></span><span> </span><span class="annot"><span class="annottext">(LogObject a -&gt; LOContent a) -&gt; LogObject a -&gt; LOContent a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, LogObject a) -&gt; LogObject a
forall a b. (a, b) -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, LogObject a)
</span><a href="#local-6989586621682422634"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(m () -&gt; m ()) -&gt; m () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="annottext">Trace m a -&gt; (Text, LogObject a) -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Trace m a
</span><a href="#local-6989586621682422635"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(Text, LogObject a)
</span><a href="#local-6989586621682422634"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621682422633"><span class="annot"><span class="annottext">nonEmptyMessage :: LOContent a -&gt; Bool
</span><a href="#local-6989586621682422633"><span class="hs-identifier hs-var hs-var">nonEmptyMessage</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LogMessage</span></span><span> </span><span id="local-6989586621682422631"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422631"><span class="hs-identifier hs-var">msg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422631"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="#local-6989586621682422633"><span class="hs-identifier hs-var">nonEmptyMessage</span></a></span><span> </span><span class="annot"><span class="annottext">LOContent a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Creates a tracer that prints any 'ToText' log message. This is useful for</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- debugging functions in the REPL, when you need a 'Tracer' object.</span><span>
</span><span id="line-155"></span><span id="local-6989586621682422628"><span id="local-6989586621682422629"><span class="annot"><a href="Cardano.Wallet.Logging.html#stdoutTextTracer"><span class="hs-identifier hs-type">stdoutTextTracer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422629"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422628"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422629"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422628"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-156"></span><span id="stdoutTextTracer"><span class="annot"><span class="annottext">stdoutTextTracer :: Tracer m a
</span><a href="Cardano.Wallet.Logging.html#stdoutTextTracer"><span class="hs-identifier hs-var hs-var">stdoutTextTracer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m ()) -&gt; Tracer m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m ()) -&gt; Tracer m a) -&gt; (a -&gt; m ()) -&gt; Tracer m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; (a -&gt; IO ()) -&gt; a -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO ()
</span><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-var">B8.putStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO ()) -&gt; (a -&gt; ByteString) -&gt; a -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><a href="../../../../text/html/src"><span class="hs-identifier hs-var">T.encodeUtf8</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ByteString) -&gt; (a -&gt; Text) -&gt; a -&gt; ByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                                Logging helpers
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- | Run an 'ExceptT' action, then trace its result, all in one step.</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- This is a more basic version of 'resultTracer'.</span><span>
</span><span id="line-164"></span><span id="local-6989586621682422622"><span id="local-6989586621682422623"><span id="local-6989586621682422624"><span class="annot"><a href="Cardano.Wallet.Logging.html#traceWithExceptT"><span class="hs-identifier hs-type">traceWithExceptT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422624"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422624"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422623"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422623"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422624"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422623"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422624"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422622"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-165"></span><span id="traceWithExceptT"><span class="annot"><span class="annottext">traceWithExceptT :: Tracer m (Either e a) -&gt; ExceptT e m a -&gt; ExceptT e m a
</span><a href="Cardano.Wallet.Logging.html#traceWithExceptT"><span class="hs-identifier hs-var hs-var">traceWithExceptT</span></a></span></span><span> </span><span id="local-6989586621682422621"><span class="annot"><span class="annottext">Tracer m (Either e a)
</span><a href="#local-6989586621682422621"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span id="local-6989586621682422619"><span class="annot"><span class="annottext">m (Either e a)
</span><a href="#local-6989586621682422619"><span class="hs-identifier hs-var">action</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either e a) -&gt; ExceptT e m a
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either e a) -&gt; ExceptT e m a)
-&gt; m (Either e a) -&gt; ExceptT e m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621682422618"><span class="annot"><span class="annottext">Either e a
</span><a href="#local-6989586621682422618"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Either e a)
</span><a href="#local-6989586621682422619"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Tracer m (Either e a) -&gt; Either e a -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (Either e a)
</span><a href="#local-6989586621682422621"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Either e a
</span><a href="#local-6989586621682422618"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">Either e a -&gt; m (Either e a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Either e a
</span><a href="#local-6989586621682422618"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Log around an 'ExceptT' action. The result of the action is captured as an</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- 'Either' in the log message. Other unexpected exceptions are captured in the</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- 'BracketLog''.</span><span>
</span><span id="line-173"></span><span id="local-6989586621682422615"><span id="local-6989586621682422616"><span id="local-6989586621682422617"><span class="annot"><a href="Cardano.Wallet.Logging.html#traceResult"><span class="hs-identifier hs-type">traceResult</span></a></span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422617"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422616"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422615"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422616"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422615"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">ExceptT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422616"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422617"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422615"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-178"></span><span id="traceResult"><span class="annot"><span class="annottext">traceResult :: Tracer m (BracketLog' (Either e r))
-&gt; ExceptT e m r -&gt; ExceptT e m r
</span><a href="Cardano.Wallet.Logging.html#traceResult"><span class="hs-identifier hs-var hs-var">traceResult</span></a></span></span><span> </span><span id="local-6989586621682422614"><span class="annot"><span class="annottext">Tracer m (BracketLog' (Either e r))
</span><a href="#local-6989586621682422614"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Either e r) -&gt; ExceptT e m r
forall e (m :: * -&gt; *) a. m (Either e a) -&gt; ExceptT e m a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">ExceptT</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either e r) -&gt; ExceptT e m r)
-&gt; (ExceptT e m r -&gt; m (Either e r))
-&gt; ExceptT e m r
-&gt; ExceptT e m r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Either e r -&gt; Either e r)
-&gt; Tracer m (BracketLog' (Either e r))
-&gt; m (Either e r)
-&gt; m (Either e r)
forall (m :: * -&gt; *) r a.
MonadUnliftIO m =&gt;
(r -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m r -&gt; m r
</span><a href="Cardano.Wallet.Logging.html#bracketTracer%27"><span class="hs-identifier hs-var">bracketTracer'</span></a></span><span> </span><span class="annot"><span class="annottext">Either e r -&gt; Either e r
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (BracketLog' (Either e r))
</span><a href="#local-6989586621682422614"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Either e r) -&gt; m (Either e r))
-&gt; (ExceptT e m r -&gt; m (Either e r))
-&gt; ExceptT e m r
-&gt; m (Either e r)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ExceptT e m r -&gt; m (Either e r)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runExceptT</span></a></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Format a tracer message from 'traceResult' as multiline text.</span><span>
</span><span id="line-181"></span><span id="local-6989586621682422609"><span id="local-6989586621682422610"><span id="local-6989586621682422611"><span id="local-6989586621682422612"><span class="annot"><a href="Cardano.Wallet.Logging.html#formatResultMsg"><span class="hs-identifier hs-type">formatResultMsg</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422612"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">IsList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422611"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422611"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682422610"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422610"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422609"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- ^ Function name.</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422611"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- ^ Input parameters.</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422612"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422609"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- ^ Logging around function.</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span></span></span></span></span><span>
</span><span id="line-190"></span><span id="formatResultMsg"><span class="annot"><span class="annottext">formatResultMsg :: Text -&gt; t -&gt; BracketLog' (Either e r) -&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#formatResultMsg"><span class="hs-identifier hs-var hs-var">formatResultMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(e -&gt; Builder)
-&gt; (r -&gt; Builder)
-&gt; Text
-&gt; t
-&gt; BracketLog' (Either e r)
-&gt; Builder
forall t v e r.
(IsList t, Item t ~ (Text, v), Buildable v) =&gt;
(e -&gt; Builder)
-&gt; (r -&gt; Builder)
-&gt; Text
-&gt; t
-&gt; BracketLog' (Either e r)
-&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#formatResultMsgWith"><span class="hs-identifier hs-var">formatResultMsgWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
</span><a href="../../../../fmt/html/src"><span class="hs-identifier hs-var">nameF</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;ERROR&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder) -&gt; (e -&gt; Builder) -&gt; e -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Builder) -&gt; (e -&gt; String) -&gt; e -&gt; Builder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">r -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Same as 'formatResultMsg', but accepts result formatters as parameters.</span><span>
</span><span id="line-193"></span><span id="local-6989586621682422840"><span id="local-6989586621682422841"><span id="local-6989586621682422843"><span id="local-6989586621682422845"><span class="annot"><a href="Cardano.Wallet.Logging.html#formatResultMsgWith"><span class="hs-identifier hs-type">formatResultMsgWith</span></a></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">IsList</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422845"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Item</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422845"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621682422843"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422843"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422841"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- ^ Error message formatter</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422840"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">-- ^ Result formatter</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- ^ Function name.</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422845"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- ^ Input parameters.</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422841"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422840"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- ^ Logging around function.</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span></span></span></span></span><span>
</span><span id="line-206"></span><span id="formatResultMsgWith"><span class="annot"><span class="annottext">formatResultMsgWith :: (e -&gt; Builder)
-&gt; (r -&gt; Builder)
-&gt; Text
-&gt; t
-&gt; BracketLog' (Either e r)
-&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#formatResultMsgWith"><span class="hs-identifier hs-var hs-var">formatResultMsgWith</span></a></span></span><span> </span><span id="local-6989586621682422606"><span class="annot"><span class="annottext">e -&gt; Builder
</span><a href="#local-6989586621682422606"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621682422605"><span class="annot"><span class="annottext">r -&gt; Builder
</span><a href="#local-6989586621682422605"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span id="local-6989586621682422604"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682422604"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span id="local-6989586621682422603"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682422603"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621682422602"><span class="annot"><span class="annottext">BracketLog' (Either e r)
</span><a href="#local-6989586621682422602"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
</span><a href="../../../../fmt/html/src"><span class="hs-identifier hs-var">nameF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621682422604"><span class="hs-identifier hs-var">title</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Builder) -&gt; Builder -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Builder] -&gt; Builder
forall (f :: * -&gt; *) a. (Foldable f, Buildable a) =&gt; f a -&gt; Builder
</span><a href="../../../../fmt/html/src"><span class="hs-identifier hs-var">blockListF</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
</span><a href="../../../../fmt/html/src"><span class="hs-identifier hs-var">nameF</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;inputs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Builder
forall t k v.
(IsList t, Item t ~ (k, v), Buildable k, Buildable v) =&gt;
t -&gt; Builder
</span><a href="../../../../fmt/html/src"><span class="hs-identifier hs-var">blockMapF</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621682422603"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Either e r -&gt; Builder) -&gt; BracketLog' (Either e r) -&gt; Builder
forall t. (t -&gt; Builder) -&gt; BracketLog' t -&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#buildBracketLog"><span class="hs-identifier hs-var">buildBracketLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(e -&gt; Builder) -&gt; (r -&gt; Builder) -&gt; Either e r -&gt; Builder
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; Builder
</span><a href="#local-6989586621682422606"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Builder
</span><a href="#local-6989586621682422605"><span class="hs-identifier hs-var">fmt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BracketLog' (Either e r)
</span><a href="#local-6989586621682422602"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | A good default mapping of message severities for 'traceResult'.</span><span>
</span><span id="line-212"></span><span id="local-6989586621682422598"><span id="local-6989586621682422599"><span class="annot"><a href="Cardano.Wallet.Logging.html#resultSeverity"><span class="hs-identifier hs-type">resultSeverity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Severity</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422599"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422598"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Severity</span></span></span></span><span>
</span><span id="line-213"></span><span id="resultSeverity"><span class="annot"><span class="annottext">resultSeverity :: Severity -&gt; BracketLog' (Either e r) -&gt; Severity
</span><a href="Cardano.Wallet.Logging.html#resultSeverity"><span class="hs-identifier hs-var hs-var">resultSeverity</span></a></span></span><span> </span><span id="local-6989586621682422597"><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621682422597"><span class="hs-identifier hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">BracketLog' (Either e r)
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621682422597"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-type">BracketFinish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-type">BracketFinish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621682422597"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-type">BracketException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-type">BracketAsyncException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><a href="#local-6989586621682422597"><span class="hs-identifier hs-var">base</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                             Logging of Exceptions
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Exception wrapper with typeclass instances that exception types often don't</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- have.</span><span>
</span><span id="line-226"></span><span id="local-6989586621682422590"><span id="local-6989586621682422591"></span></span><span class="hs-keyword">newtype</span><span> </span><span id="LoggedException"><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-var">LoggedException</span></a></span></span><span> </span><span id="local-6989586621682422789"><span class="annot"><a href="#local-6989586621682422789"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="LoggedException"><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-var">LoggedException</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682422789"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. LoggedException e -&gt; Rep (LoggedException e) x)
-&gt; (forall x. Rep (LoggedException e) x -&gt; LoggedException e)
-&gt; Generic (LoggedException e)
forall x. Rep (LoggedException e) x -&gt; LoggedException e
forall x. LoggedException e -&gt; Rep (LoggedException e) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall e x. Rep (LoggedException e) x -&gt; LoggedException e
forall e x. LoggedException e -&gt; Rep (LoggedException e) x
$cto :: forall e x. Rep (LoggedException e) x -&gt; LoggedException e
$cfrom :: forall e x. LoggedException e -&gt; Rep (LoggedException e) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422580"><span id="local-6989586621682422582"><span id="local-6989586621682422584"><span class="annot"><span class="annottext">Int -&gt; LoggedException e -&gt; ShowS
[LoggedException e] -&gt; ShowS
LoggedException e -&gt; String
(Int -&gt; LoggedException e -&gt; ShowS)
-&gt; (LoggedException e -&gt; String)
-&gt; ([LoggedException e] -&gt; ShowS)
-&gt; Show (LoggedException e)
forall e. Show e =&gt; Int -&gt; LoggedException e -&gt; ShowS
forall e. Show e =&gt; [LoggedException e] -&gt; ShowS
forall e. Show e =&gt; LoggedException e -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LoggedException e] -&gt; ShowS
$cshowList :: forall e. Show e =&gt; [LoggedException e] -&gt; ShowS
show :: LoggedException e -&gt; String
$cshow :: forall e. Show e =&gt; LoggedException e -&gt; String
showsPrec :: Int -&gt; LoggedException e -&gt; ShowS
$cshowsPrec :: forall e. Show e =&gt; Int -&gt; LoggedException e -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422564"><span id="local-6989586621682422566"><span id="local-6989586621682422568"><span id="local-6989586621682422570"><span id="local-6989586621682422572"><span id="local-6989586621682422574"><span id="local-6989586621682422576"><span class="annot"><span class="annottext">Eq (LoggedException e)
Eq (LoggedException e)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; Ordering)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; Bool)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; Bool)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; Bool)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; Bool)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; LoggedException e)
-&gt; (LoggedException e -&gt; LoggedException e -&gt; LoggedException e)
-&gt; Ord (LoggedException e)
LoggedException e -&gt; LoggedException e -&gt; Bool
LoggedException e -&gt; LoggedException e -&gt; Ordering
LoggedException e -&gt; LoggedException e -&gt; LoggedException e
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall e. (Show e, Ord e) =&gt; Eq (LoggedException e)
forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Bool
forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Ordering
forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; LoggedException e
min :: LoggedException e -&gt; LoggedException e -&gt; LoggedException e
$cmin :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; LoggedException e
max :: LoggedException e -&gt; LoggedException e -&gt; LoggedException e
$cmax :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; LoggedException e
&gt;= :: LoggedException e -&gt; LoggedException e -&gt; Bool
$c&gt;= :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Bool
&gt; :: LoggedException e -&gt; LoggedException e -&gt; Bool
$c&gt; :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Bool
&lt;= :: LoggedException e -&gt; LoggedException e -&gt; Bool
$c&lt;= :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Bool
&lt; :: LoggedException e -&gt; LoggedException e -&gt; Bool
$c&lt; :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Bool
compare :: LoggedException e -&gt; LoggedException e -&gt; Ordering
$ccompare :: forall e.
(Show e, Ord e) =&gt;
LoggedException e -&gt; LoggedException e -&gt; Ordering
$cp1Ord :: forall e. (Show e, Ord e) =&gt; Eq (LoggedException e)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span id="local-6989586621682422562"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422560"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422562"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422562"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621682422557"><span class="annot"><span class="annottext">rnf :: LoggedException SomeException -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span id="local-6989586621682422555"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422555"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeException -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422555"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span id="local-6989586621682422554"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422552"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422554"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422554"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span id="local-6989586621682422550"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422550"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422550"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-237"></span><span>    </span><span id="local-6989586621682422547"><span class="annot"><span class="annottext">build :: LoggedException e -&gt; Builder
</span><a href="#local-6989586621682422547"><span class="hs-identifier hs-var hs-var hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span id="local-6989586621682422546"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682422546"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Builder) -&gt; String -&gt; Builder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">e -&gt; String
forall e. Exception e =&gt; e -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">displayException</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621682422546"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-238"></span><span>
</span><span id="line-239"></span><span id="local-6989586621682422545"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422542"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422545"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422545"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span id="local-6989586621682422540"><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422540"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621682422539"><span class="annot"><span class="annottext">== :: LoggedException e -&gt; LoggedException e -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621682422538"><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422538"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LoggedException e -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422540"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422538"><span class="hs-identifier hs-var">b</span></a></span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621682422537"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422530"><span id="local-6989586621682422532"><span id="local-6989586621682422534"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422537"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422537"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621682422528"><span class="annot"><span class="annottext">toJSON :: LoggedException e -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span id="local-6989586621682422526"><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422526"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">object</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;exception&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><a href="../../../../aeson/html/src"><span class="hs-operator hs-var">.=</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e -&gt; Text
forall a. ToText a =&gt; a -&gt; Text
</span><a href="../../../../text-class/html/src"><span class="hs-identifier hs-var">toText</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException e
</span><a href="#local-6989586621682422526"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span id="local-6989586621682422741"><span class="annot"><a href="Cardano.Wallet.Logging.html#exceptionMsg"><span class="hs-identifier hs-type">exceptionMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422741"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-246"></span><span id="exceptionMsg"><span class="annot"><span class="annottext">exceptionMsg :: SomeException -&gt; BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#exceptionMsg"><span class="hs-identifier hs-var hs-var">exceptionMsg</span></a></span></span><span> </span><span id="local-6989586621682422524"><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422524"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; Bool
forall e. Exception e =&gt; e -&gt; Bool
</span><a href="../../../../unliftio/html/src"><span class="hs-identifier hs-var">isSyncException</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422524"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; BracketLog' r
forall r. LoggedException SomeException -&gt; BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-var">BracketException</span></a></span><span> </span><span class="annot"><span class="annottext">(LoggedException SomeException -&gt; BracketLog' r)
-&gt; LoggedException SomeException -&gt; BracketLog' r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; LoggedException SomeException
forall e. e -&gt; LoggedException e
</span><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-var">LoggedException</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422524"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; BracketLog' r
forall r. LoggedException SomeException -&gt; BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-var">BracketAsyncException</span></a></span><span> </span><span class="annot"><span class="annottext">(LoggedException SomeException -&gt; BracketLog' r)
-&gt; LoggedException SomeException -&gt; BracketLog' r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; LoggedException SomeException
forall e. e -&gt; LoggedException e
</span><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-var">LoggedException</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException
</span><a href="#local-6989586621682422524"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                                Bracketed logging
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Used for tracing around an action.</span><span>
</span><span id="line-255"></span><span id="local-6989586621682422522"><span id="local-6989586621682422523"></span></span><span class="hs-keyword">data</span><span> </span><span id="BracketLog%27"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-var">BracketLog'</span></a></span></span><span> </span><span id="local-6989586621682422790"><span class="annot"><a href="#local-6989586621682422790"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="BracketStart"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- ^ Logged before the action starts.</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BracketFinish"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-var">BracketFinish</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621682422790"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- ^ Logged after the action finishes.</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BracketException"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-var">BracketException</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- ^ Logged when the action throws an exception.</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="BracketAsyncException"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-var">BracketAsyncException</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#LoggedException"><span class="hs-identifier hs-type">LoggedException</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeException</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- ^ Logged when the action receives an async exception.</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. BracketLog' r -&gt; Rep (BracketLog' r) x)
-&gt; (forall x. Rep (BracketLog' r) x -&gt; BracketLog' r)
-&gt; Generic (BracketLog' r)
forall x. Rep (BracketLog' r) x -&gt; BracketLog' r
forall x. BracketLog' r -&gt; Rep (BracketLog' r) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall r x. Rep (BracketLog' r) x -&gt; BracketLog' r
forall r x. BracketLog' r -&gt; Rep (BracketLog' r) x
$cto :: forall r x. Rep (BracketLog' r) x -&gt; BracketLog' r
$cfrom :: forall r x. BracketLog' r -&gt; Rep (BracketLog' r) x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422514"><span id="local-6989586621682422516"><span id="local-6989586621682422518"><span class="annot"><span class="annottext">Int -&gt; BracketLog' r -&gt; ShowS
[BracketLog' r] -&gt; ShowS
BracketLog' r -&gt; String
(Int -&gt; BracketLog' r -&gt; ShowS)
-&gt; (BracketLog' r -&gt; String)
-&gt; ([BracketLog' r] -&gt; ShowS)
-&gt; Show (BracketLog' r)
forall r. Show r =&gt; Int -&gt; BracketLog' r -&gt; ShowS
forall r. Show r =&gt; [BracketLog' r] -&gt; ShowS
forall r. Show r =&gt; BracketLog' r -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BracketLog' r] -&gt; ShowS
$cshowList :: forall r. Show r =&gt; [BracketLog' r] -&gt; ShowS
show :: BracketLog' r -&gt; String
$cshow :: forall r. Show r =&gt; BracketLog' r -&gt; String
showsPrec :: Int -&gt; BracketLog' r -&gt; ShowS
$cshowsPrec :: forall r. Show r =&gt; Int -&gt; BracketLog' r -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422510"><span id="local-6989586621682422512"><span class="annot"><span class="annottext">BracketLog' r -&gt; BracketLog' r -&gt; Bool
(BracketLog' r -&gt; BracketLog' r -&gt; Bool)
-&gt; (BracketLog' r -&gt; BracketLog' r -&gt; Bool) -&gt; Eq (BracketLog' r)
forall r. Eq r =&gt; BracketLog' r -&gt; BracketLog' r -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BracketLog' r -&gt; BracketLog' r -&gt; Bool
$c/= :: forall r. Eq r =&gt; BracketLog' r -&gt; BracketLog' r -&gt; Bool
== :: BracketLog' r -&gt; BracketLog' r -&gt; Bool
$c== :: forall r. Eq r =&gt; BracketLog' r -&gt; BracketLog' r -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422502"><span id="local-6989586621682422504"><span id="local-6989586621682422506"><span id="local-6989586621682422508"><span class="annot"><span class="annottext">[BracketLog' r] -&gt; Encoding
[BracketLog' r] -&gt; Value
BracketLog' r -&gt; Encoding
BracketLog' r -&gt; Value
(BracketLog' r -&gt; Value)
-&gt; (BracketLog' r -&gt; Encoding)
-&gt; ([BracketLog' r] -&gt; Value)
-&gt; ([BracketLog' r] -&gt; Encoding)
-&gt; ToJSON (BracketLog' r)
forall r. ToJSON r =&gt; [BracketLog' r] -&gt; Encoding
forall r. ToJSON r =&gt; [BracketLog' r] -&gt; Value
forall r. ToJSON r =&gt; BracketLog' r -&gt; Encoding
forall r. ToJSON r =&gt; BracketLog' r -&gt; Value
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [BracketLog' r] -&gt; Encoding
$ctoEncodingList :: forall r. ToJSON r =&gt; [BracketLog' r] -&gt; Encoding
toJSONList :: [BracketLog' r] -&gt; Value
$ctoJSONList :: forall r. ToJSON r =&gt; [BracketLog' r] -&gt; Value
toEncoding :: BracketLog' r -&gt; Encoding
$ctoEncoding :: forall r. ToJSON r =&gt; BracketLog' r -&gt; Encoding
toJSON :: BracketLog' r -&gt; Value
$ctoJSON :: forall r. ToJSON r =&gt; BracketLog' r -&gt; Value
</span><a href="#local-6989586621682422502"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422498"><span id="local-6989586621682422500"><span class="annot"><span class="annottext">a -&gt; BracketLog' b -&gt; BracketLog' a
(a -&gt; b) -&gt; BracketLog' a -&gt; BracketLog' b
(forall a b. (a -&gt; b) -&gt; BracketLog' a -&gt; BracketLog' b)
-&gt; (forall a b. a -&gt; BracketLog' b -&gt; BracketLog' a)
-&gt; Functor BracketLog'
forall a b. a -&gt; BracketLog' b -&gt; BracketLog' a
forall a b. (a -&gt; b) -&gt; BracketLog' a -&gt; BracketLog' b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; BracketLog' b -&gt; BracketLog' a
$c&lt;$ :: forall a b. a -&gt; BracketLog' b -&gt; BracketLog' a
fmap :: (a -&gt; b) -&gt; BracketLog' a -&gt; BracketLog' b
$cfmap :: forall a b. (a -&gt; b) -&gt; BracketLog' a -&gt; BracketLog' b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621682422496"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422494"><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422496"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../text-class/html/src"><span class="hs-identifier hs-type">ToText</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422496"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span id="local-6989586621682422493"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422493"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422493"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621682422491"><span class="annot"><span class="annottext">build :: BracketLog' r -&gt; Builder
</span><a href="#local-6989586621682422491"><span class="hs-identifier hs-var hs-var hs-var hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; Builder) -&gt; BracketLog' r -&gt; Builder
forall t. (t -&gt; Builder) -&gt; BracketLog' t -&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#buildBracketLog"><span class="hs-identifier hs-var">buildBracketLog</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span id="local-6989586621682422828"><span class="annot"><a href="Cardano.Wallet.Logging.html#buildBracketLog"><span class="hs-identifier hs-type">buildBracketLog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422828"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422828"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../text/html/src"><span class="hs-identifier hs-type">Builder</span></a></span></span><span>
</span><span id="line-272"></span><span id="buildBracketLog"><span class="annot"><span class="annottext">buildBracketLog :: (t -&gt; Builder) -&gt; BracketLog' t -&gt; Builder
</span><a href="Cardano.Wallet.Logging.html#buildBracketLog"><span class="hs-identifier hs-var hs-var">buildBracketLog</span></a></span></span><span> </span><span id="local-6989586621682422490"><span class="annot"><span class="annottext">t -&gt; Builder
</span><a href="#local-6989586621682422490"><span class="hs-identifier hs-var">toBuilder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="annottext">BracketLog' t
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;start&quot;</span></span><span>
</span><span id="line-274"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-type">BracketFinish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; Builder
</span><a href="#local-6989586621682422490"><span class="hs-identifier hs-var">toBuilder</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621682422489"><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621682422489"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621682422489"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;finish&quot;</span></span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;finish: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Builder
</span><a href="#local-6989586621682422489"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-type">BracketException</span></a></span><span> </span><span id="local-6989586621682422488"><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682422488"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;exception: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682422488"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-type">BracketAsyncException</span></a></span><span> </span><span id="local-6989586621682422487"><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682422487"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Builder
</span><span class="hs-string">&quot;cancelled: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException -&gt; Builder
forall p. Buildable p =&gt; p -&gt; Builder
</span><a href="../../../../formatting/html/src"><span class="hs-identifier hs-var">build</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><a href="#local-6989586621682422487"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span id="local-6989586621682422486"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422484"><span class="annot"><span class="hs-identifier hs-type">HasPrivacyAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422486"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-281"></span><span id="local-6989586621682422482"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasSeverityAnnotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422482"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- | Default severities for 'BracketLog' - the enclosing log message may of</span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-comment">-- course use different values.</span><span>
</span><span id="line-284"></span><span>    </span><span id="local-6989586621682422479"><span class="annot"><span class="annottext">getSeverityAnnotation :: BracketLog' r -&gt; Severity
</span><a href="#local-6989586621682422479"><span class="hs-identifier hs-var hs-var hs-var hs-var">getSeverityAnnotation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-285"></span><span>        </span><span class="annot"><span class="annottext">BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-286"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-type">BracketFinish</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span><span>
</span><span id="line-287"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-type">BracketException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Error</span></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-type">BracketAsyncException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Severity
</span><span class="hs-identifier hs-var">Debug</span></span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Placeholder for some unspecified result value in 'BracketLog' - it could be</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- @()@, or anything else.</span><span>
</span><span id="line-292"></span><span id="local-6989586621682422476"><span id="local-6989586621682422477"></span></span><span class="hs-keyword">data</span><span> </span><span id="SomeResult"><span class="annot"><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-var">SomeResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SomeResult"><span class="annot"><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-var">SomeResult</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(forall x. SomeResult -&gt; Rep SomeResult x)
-&gt; (forall x. Rep SomeResult x -&gt; SomeResult) -&gt; Generic SomeResult
forall x. Rep SomeResult x -&gt; SomeResult
forall x. SomeResult -&gt; Rep SomeResult x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep SomeResult x -&gt; SomeResult
$cfrom :: forall x. SomeResult -&gt; Rep SomeResult x
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422467"><span id="local-6989586621682422469"><span id="local-6989586621682422471"><span class="annot"><span class="annottext">Int -&gt; SomeResult -&gt; ShowS
[SomeResult] -&gt; ShowS
SomeResult -&gt; String
(Int -&gt; SomeResult -&gt; ShowS)
-&gt; (SomeResult -&gt; String)
-&gt; ([SomeResult] -&gt; ShowS)
-&gt; Show SomeResult
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SomeResult] -&gt; ShowS
$cshowList :: [SomeResult] -&gt; ShowS
show :: SomeResult -&gt; String
$cshow :: SomeResult -&gt; String
showsPrec :: Int -&gt; SomeResult -&gt; ShowS
$cshowsPrec :: Int -&gt; SomeResult -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422463"><span id="local-6989586621682422465"><span class="annot"><span class="annottext">SomeResult -&gt; SomeResult -&gt; Bool
(SomeResult -&gt; SomeResult -&gt; Bool)
-&gt; (SomeResult -&gt; SomeResult -&gt; Bool) -&gt; Eq SomeResult
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: SomeResult -&gt; SomeResult -&gt; Bool
$c/= :: SomeResult -&gt; SomeResult -&gt; Bool
== :: SomeResult -&gt; SomeResult -&gt; Bool
$c== :: SomeResult -&gt; SomeResult -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../formatting/html/src"><span class="hs-identifier hs-type">Buildable</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-type">SomeResult</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>    </span><span id="local-6989586621682422461"><span class="annot"><span class="annottext">build :: SomeResult -&gt; Builder
</span><a href="#local-6989586621682422461"><span class="hs-identifier hs-var hs-var hs-var hs-var">build</span></a></span></span><span> </span><span class="annot"><span class="annottext">SomeResult
</span><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-var">SomeResult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621682422454"><span id="local-6989586621682422456"><span id="local-6989586621682422458"><span class="annot"><a href="../../../../aeson/html/src"><span class="hs-identifier hs-type">ToJSON</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-type">SomeResult</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621682422453"><span class="annot"><span class="annottext">toJSON :: SomeResult -&gt; Value
</span><a href="#local-6989586621682422453"><span class="hs-identifier hs-var hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">SomeResult
</span><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-var">SomeResult</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="../../../../aeson/html/src"><span class="hs-identifier hs-var">Null</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span class="hs-comment">-- | Trace around an action, where the result doesn't matter.</span><span>
</span><span id="line-301"></span><span class="hs-keyword">type</span><span> </span><span id="BracketLog"><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-var">BracketLog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-type">SomeResult</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Run a monadic action with 'BracketLog' traced around it.</span><span>
</span><span id="line-304"></span><span id="local-6989586621682422451"><span id="local-6989586621682422452"><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer"><span class="hs-identifier hs-type">bracketTracer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422452"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422452"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422452"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422452"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422451"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-305"></span><span id="bracketTracer"><span class="annot"><span class="annottext">bracketTracer :: Tracer m BracketLog -&gt; m a -&gt; m a
</span><a href="Cardano.Wallet.Logging.html#bracketTracer"><span class="hs-identifier hs-var hs-var">bracketTracer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; a) -&gt; (a -&gt; SomeResult) -&gt; Tracer m BracketLog -&gt; m a -&gt; m a
forall (m :: * -&gt; *) b r a.
MonadUnliftIO m =&gt;
(b -&gt; r) -&gt; (b -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m b -&gt; m r
</span><a href="Cardano.Wallet.Logging.html#bracketTracer%27%27"><span class="hs-identifier hs-var">bracketTracer''</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeResult -&gt; a -&gt; SomeResult
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">SomeResult
</span><a href="Cardano.Wallet.Logging.html#SomeResult"><span class="hs-identifier hs-var">SomeResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- | Run a monadic action with 'BracketLog' traced around it.</span><span>
</span><span id="line-308"></span><span id="local-6989586621682422854"><span id="local-6989586621682422855"><span id="local-6989586621682422857"><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer%27"><span class="hs-identifier hs-type">bracketTracer'</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422857"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422855"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-comment">-- ^ Transform value into log message.</span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422854"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-comment">-- ^ Tracer.</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422855"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-comment">-- ^ Action.</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422857"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422855"><span class="hs-identifier hs-type">r</span></a></span></span></span></span><span>
</span><span id="line-317"></span><span id="bracketTracer%27"><span class="annot"><span class="annottext">bracketTracer' :: (r -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m r -&gt; m r
</span><a href="Cardano.Wallet.Logging.html#bracketTracer%27"><span class="hs-identifier hs-var hs-var">bracketTracer'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(r -&gt; r) -&gt; (r -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m r -&gt; m r
forall (m :: * -&gt; *) b r a.
MonadUnliftIO m =&gt;
(b -&gt; r) -&gt; (b -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m b -&gt; m r
</span><a href="Cardano.Wallet.Logging.html#bracketTracer%27%27"><span class="hs-identifier hs-var">bracketTracer''</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="hs-comment">-- | Run a monadic action with 'BracketLog' traced around it.</span><span>
</span><span id="line-320"></span><span id="local-6989586621682422761"><span id="local-6989586621682422762"><span id="local-6989586621682422763"><span id="local-6989586621682422764"><span class="annot"><a href="Cardano.Wallet.Logging.html#bracketTracer%27%27"><span class="hs-identifier hs-type">bracketTracer''</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422764"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422763"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422762"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-comment">-- ^ Transform value into result.</span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422763"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-comment">-- ^ Transform value into log message.</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422761"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">-- ^ Tracer.</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422763"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-comment">-- ^ Action to produce value.</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422764"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422762"><span class="hs-identifier hs-type">r</span></a></span></span></span></span></span><span>
</span><span id="line-331"></span><span id="bracketTracer%27%27"><span class="annot"><span class="annottext">bracketTracer'' :: (b -&gt; r) -&gt; (b -&gt; a) -&gt; Tracer m (BracketLog' a) -&gt; m b -&gt; m r
</span><a href="Cardano.Wallet.Logging.html#bracketTracer%27%27"><span class="hs-identifier hs-var hs-var">bracketTracer''</span></a></span></span><span> </span><span id="local-6989586621682422448"><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621682422448"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span id="local-6989586621682422447"><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621682422447"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621682422446"><span class="annot"><span class="annottext">Tracer m (BracketLog' a)
</span><a href="#local-6989586621682422446"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621682422445"><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621682422445"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">Tracer m (BracketLog' a) -&gt; BracketLog' a -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (BracketLog' a)
</span><a href="#local-6989586621682422446"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog' a
forall r. BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span>
</span><span id="line-333"></span><span>    </span><span class="annot"><span class="annottext">m r -&gt; (SomeException -&gt; m ()) -&gt; m r
forall (m :: * -&gt; *) e a b.
(MonadUnliftIO m, Exception e) =&gt;
m a -&gt; (e -&gt; m b) -&gt; m a
</span><a href="../../../../unliftio/html/src"><span class="hs-identifier hs-var">withException</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621682422445"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">m b -&gt; (b -&gt; m r) -&gt; m r
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682422444"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682422444"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tracer m (BracketLog' a) -&gt; BracketLog' a -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (BracketLog' a)
</span><a href="#local-6989586621682422446"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BracketLog' a
forall r. r -&gt; BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-var">BracketFinish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621682422447"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682422444"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m () -&gt; r -&gt; m r
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; r
</span><a href="#local-6989586621682422448"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682422444"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tracer m (BracketLog' a) -&gt; BracketLog' a -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">traceWith</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (BracketLog' a)
</span><a href="#local-6989586621682422446"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(BracketLog' a -&gt; m ())
-&gt; (SomeException -&gt; BracketLog' a) -&gt; SomeException -&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">SomeException -&gt; BracketLog' a
forall r. SomeException -&gt; BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#exceptionMsg"><span class="hs-identifier hs-var">exceptionMsg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span id="local-6989586621682422442"><span id="local-6989586621682422443"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422443"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">Outcome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422443"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422442"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="IntermediateValue"><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">IntermediateValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422442"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">AbsoluteTime</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OutcomeMetric"><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeMetric</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog%27"><span class="hs-identifier hs-type">BracketLog'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422442"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">DiffTime</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621682422436"><span class="annot"><span class="annottext">classifyObservable :: BracketLog' r -&gt; m OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">classifyObservable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutcomeProgressionStatus -&gt; m OutcomeProgressionStatus
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(OutcomeProgressionStatus -&gt; m OutcomeProgressionStatus)
-&gt; (BracketLog' r -&gt; OutcomeProgressionStatus)
-&gt; BracketLog' r
-&gt; m OutcomeProgressionStatus
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-342"></span><span>      </span><span class="annot"><span class="annottext">BracketLog' r
</span><a href="Cardano.Wallet.Logging.html#BracketStart"><span class="hs-identifier hs-var">BracketStart</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeStarts</span></a></span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketFinish"><span class="hs-identifier hs-type">BracketFinish</span></a></span><span> </span><span class="annot"><span class="annottext">r
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeEnds</span></a></span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketException"><span class="hs-identifier hs-type">BracketException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeEnds</span></a></span><span>
</span><span id="line-345"></span><span>      </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketAsyncException"><span class="hs-identifier hs-type">BracketAsyncException</span></a></span><span> </span><span class="annot"><span class="annottext">LoggedException SomeException
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeEnds</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-comment">-- NOTE: The AbsoluteTime functions are required so that measurements are</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-comment">-- correct at times when leap seconds are applied. This is following the</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-comment">-- tracer-transformers example.</span><span>
</span><span id="line-350"></span><span>  </span><span id="local-6989586621682422432"><span class="annot"><span class="annottext">captureObservableValue :: BracketLog' r -&gt; m (IntermediateValue (BracketLog' r))
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">captureObservableValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">BracketLog' r
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SystemTime -&gt; AbsoluteTime
</span><a href="../../../../time/html/src"><span class="hs-identifier hs-var">systemToTAITime</span></a></span><span> </span><span class="annot"><span class="annottext">(SystemTime -&gt; AbsoluteTime) -&gt; m SystemTime -&gt; m AbsoluteTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime -&gt; m SystemTime
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO SystemTime
</span><a href="../../../../time/html/src"><span class="hs-identifier hs-var">getSystemTime</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span id="local-6989586621682422429"><span class="annot"><span class="annottext">computeOutcomeMetric :: BracketLog' r
-&gt; IntermediateValue (BracketLog' r)
-&gt; IntermediateValue (BracketLog' r)
-&gt; m (OutcomeMetric (BracketLog' r))
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">computeOutcomeMetric</span></a></span></span><span> </span><span class="annot"><span class="annottext">BracketLog' r
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621682422427"><span class="annot"><span class="annottext">IntermediateValue (BracketLog' r)
</span><a href="#local-6989586621682422427"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621682422426"><span class="annot"><span class="annottext">IntermediateValue (BracketLog' r)
</span><a href="#local-6989586621682422426"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DiffTime -&gt; m DiffTime
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; m DiffTime) -&gt; DiffTime -&gt; m DiffTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AbsoluteTime -&gt; AbsoluteTime -&gt; DiffTime
</span><a href="../../../../time/html/src"><span class="hs-identifier hs-var">diffAbsoluteTime</span></a></span><span> </span><span class="annot"><span class="annottext">AbsoluteTime
IntermediateValue (BracketLog' r)
</span><a href="#local-6989586621682422426"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">AbsoluteTime
IntermediateValue (BracketLog' r)
</span><a href="#local-6989586621682422427"><span class="hs-identifier hs-var">x</span></a></span></span></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span class="hs-comment">-- Pair up bracketlogs with some context information</span><span>
</span><span id="line-354"></span><span id="local-6989586621682422424"><span id="local-6989586621682422425"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">Outcome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422424"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="IntermediateValue"><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">IntermediateValue</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422424"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422424"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">IntermediateValue</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OutcomeMetric"><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">OutcomeMetric</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422424"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422424"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">OutcomeMetric</span></a></span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span id="local-6989586621682422419"><span class="annot"><span class="annottext">classifyObservable :: (ctx, BracketLog) -&gt; m OutcomeProgressionStatus
</span><a href="#local-6989586621682422419"><span class="hs-identifier hs-var hs-var hs-var hs-var">classifyObservable</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682422418"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621682422418"><span class="hs-identifier hs-var">_ctx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422417"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422417"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BracketLog -&gt; m OutcomeProgressionStatus
forall (m :: * -&gt; *) a.
Outcome m a =&gt;
a -&gt; m OutcomeProgressionStatus
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">classifyObservable</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422417"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span id="local-6989586621682422416"><span class="annot"><span class="annottext">captureObservableValue :: (ctx, BracketLog) -&gt; m (IntermediateValue (ctx, BracketLog))
</span><a href="#local-6989586621682422416"><span class="hs-identifier hs-var hs-var hs-var hs-var">captureObservableValue</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682422415"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621682422415"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422414"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422414"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621682422415"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(AbsoluteTime -&gt; (ctx, AbsoluteTime))
-&gt; m AbsoluteTime -&gt; m (ctx, AbsoluteTime)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog -&gt; m (IntermediateValue BracketLog)
forall (m :: * -&gt; *) a. Outcome m a =&gt; a -&gt; m (IntermediateValue a)
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">captureObservableValue</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422414"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621682422413"><span class="annot"><span class="annottext">computeOutcomeMetric :: (ctx, BracketLog)
-&gt; IntermediateValue (ctx, BracketLog)
-&gt; IntermediateValue (ctx, BracketLog)
-&gt; m (OutcomeMetric (ctx, BracketLog))
</span><a href="#local-6989586621682422413"><span class="hs-identifier hs-var hs-var hs-var hs-var">computeOutcomeMetric</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621682422412"><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621682422412"><span class="hs-identifier hs-var">ctx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422411"><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422411"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422410"><span class="annot"><a href="#local-6989586621682422410"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621682422409"><span class="annot"><a href="#local-6989586621682422409"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ctx
</span><a href="#local-6989586621682422412"><span class="hs-identifier hs-var">ctx</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(DiffTime -&gt; (ctx, DiffTime)) -&gt; m DiffTime -&gt; m (ctx, DiffTime)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog
-&gt; IntermediateValue BracketLog
-&gt; IntermediateValue BracketLog
-&gt; m (OutcomeMetric BracketLog)
forall (m :: * -&gt; *) a.
Outcome m a =&gt;
a
-&gt; IntermediateValue a
-&gt; IntermediateValue a
-&gt; m (OutcomeMetric a)
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">computeOutcomeMetric</span></a></span><span> </span><span class="annot"><span class="annottext">BracketLog
</span><a href="#local-6989586621682422411"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">AbsoluteTime
IntermediateValue BracketLog
</span><a href="#local-6989586621682422410"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">AbsoluteTime
IntermediateValue BracketLog
</span><a href="#local-6989586621682422409"><span class="hs-identifier hs-var">y</span></a></span></span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Get metric results from 'mkOutcomeExtractor' and throw away the rest.</span><span>
</span><span id="line-364"></span><span id="local-6989586621682422713"><span id="local-6989586621682422714"><span class="annot"><a href="Cardano.Wallet.Logging.html#fiddleOutcome"><span class="hs-identifier hs-type">fiddleOutcome</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422714"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422713"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">DiffTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422714"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422713"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">OutcomeFidelity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422713"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">DiffTime</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-368"></span><span id="fiddleOutcome"><span class="annot"><span class="annottext">fiddleOutcome :: Tracer m (ctx, DiffTime)
-&gt; Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
</span><a href="Cardano.Wallet.Logging.html#fiddleOutcome"><span class="hs-identifier hs-var hs-var">fiddleOutcome</span></a></span></span><span> </span><span id="local-6989586621682422407"><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime)
</span><a href="#local-6989586621682422407"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime))
 -&gt; m ())
-&gt; Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime))
  -&gt; m ())
 -&gt; Tracer
      m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime))))
-&gt; (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime))
    -&gt; m ())
-&gt; Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-type">ProgressedNormally</span></a></span><span> </span><span id="local-6989586621682422405"><span class="annot"><span class="annottext">(ctx, DiffTime)
</span><a href="#local-6989586621682422405"><span class="hs-identifier hs-var">dt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime) -&gt; (ctx, DiffTime) -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var hs-var">runTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime)
</span><a href="#local-6989586621682422407"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(ctx, DiffTime)
</span><a href="#local-6989586621682422405"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | Simplified wrapper for 'mkOutcomeExtractor'. This produces a timings</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- 'Tracer' from a 'Tracer' of messages @a@, and a function which can extract</span><span>
</span><span id="line-374"></span><span class="hs-comment">-- the 'BracketLog' from @a@.</span><span>
</span><span id="line-375"></span><span class="hs-comment">--</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- The extractor function can provide @ctx@, which could be the name of the</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- timed operation for example.</span><span>
</span><span id="line-378"></span><span class="hs-comment">--</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- The produced tracer will make just one trace for each finished bracket.</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- It contains the @ctx@ from the extractor and the time difference.</span><span>
</span><span id="line-381"></span><span id="local-6989586621682422401"><span id="local-6989586621682422402"><span id="local-6989586621682422403"><span class="annot"><a href="Cardano.Wallet.Logging.html#produceTimings"><span class="hs-identifier hs-type">produceTimings</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../unliftio-core/html/src"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422403"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../exceptions/html/src"><span class="hs-identifier hs-type">MonadMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422403"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422402"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422401"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Wallet.Logging.html#BracketLog"><span class="hs-identifier hs-type">BracketLog</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-comment">-- ^ Function to extract BracketLog messages from @a@, paired with context.</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422403"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422401"><span class="hs-identifier hs-type">ctx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../time/html/src"><span class="hs-identifier hs-type">DiffTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-comment">-- ^ The timings tracer, has time deltas for each finished bracket.</span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621682422403"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422403"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422402"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-388"></span><span id="produceTimings"><span class="annot"><span class="annottext">produceTimings :: (a -&gt; Maybe (ctx, BracketLog))
-&gt; Tracer m (ctx, DiffTime) -&gt; m (Tracer m a)
</span><a href="Cardano.Wallet.Logging.html#produceTimings"><span class="hs-identifier hs-var hs-var">produceTimings</span></a></span></span><span> </span><span id="local-6989586621682422400"><span class="annot"><span class="annottext">a -&gt; Maybe (ctx, BracketLog)
</span><a href="#local-6989586621682422400"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621682422399"><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime)
</span><a href="#local-6989586621682422399"><span class="hs-identifier hs-var">trDiffTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621682422398"><span class="annot"><span class="annottext">Tracer
  m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
-&gt; Tracer m (ctx, BracketLog)
</span><a href="#local-6989586621682422398"><span class="hs-identifier hs-var">extractor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
   -&gt; Tracer m (ctx, BracketLog))
forall (m :: * -&gt; *) a.
(MonadIO m, MonadMask m, Outcome m a) =&gt;
m (OutcomeEnhancedTracer m a -&gt; Tracer m a)
</span><a href="../../../../tracer-transformers/html/src"><span class="hs-identifier hs-var">mkOutcomeExtractor</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621682422397"><span class="annot"><span class="annottext">trOutcome :: Tracer
  m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
</span><a href="#local-6989586621682422397"><span class="hs-identifier hs-var hs-var">trOutcome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime)
-&gt; Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
forall (m :: * -&gt; *) ctx.
Monad m =&gt;
Tracer m (ctx, DiffTime)
-&gt; Tracer
     m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
</span><a href="Cardano.Wallet.Logging.html#fiddleOutcome"><span class="hs-identifier hs-var">fiddleOutcome</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (ctx, DiffTime)
</span><a href="#local-6989586621682422399"><span class="hs-identifier hs-var">trDiffTime</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span id="local-6989586621682422396"><span class="annot"><span class="annottext">trBracket :: Tracer m (ctx, BracketLog)
</span><a href="#local-6989586621682422396"><span class="hs-identifier hs-var hs-var">trBracket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tracer
  m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
-&gt; Tracer m (ctx, BracketLog)
</span><a href="#local-6989586621682422398"><span class="hs-identifier hs-var">extractor</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer
  m (Either (ctx, BracketLog) (OutcomeFidelity (ctx, DiffTime)))
</span><a href="#local-6989586621682422397"><span class="hs-identifier hs-var">trOutcome</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span id="local-6989586621682422395"><span class="annot"><span class="annottext">tr :: Tracer m a
</span><a href="#local-6989586621682422395"><span class="hs-identifier hs-var hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe (ctx, BracketLog))
-&gt; Tracer m (ctx, BracketLog) -&gt; Tracer m a
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; Maybe b) -&gt; Tracer m b -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#flatContramapTracer"><span class="hs-identifier hs-var">flatContramapTracer</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (ctx, BracketLog)
</span><a href="#local-6989586621682422400"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m (ctx, BracketLog)
</span><a href="#local-6989586621682422396"><span class="hs-identifier hs-var">trBracket</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">Tracer m a -&gt; m (Tracer m a)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m a
</span><a href="#local-6989586621682422395"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">{-------------------------------------------------------------------------------
                               Tracer conversions
-------------------------------------------------------------------------------}</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | Convert an IO tracer to a 'm' tracer.</span><span>
</span><span id="line-400"></span><span id="local-6989586621682422393"><span id="local-6989586621682422394"><span class="annot"><a href="Cardano.Wallet.Logging.html#unliftIOTracer"><span class="hs-identifier hs-type">unliftIOTracer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422394"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422393"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422394"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422393"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-401"></span><span id="unliftIOTracer"><span class="annot"><span class="annottext">unliftIOTracer :: Tracer IO a -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#unliftIOTracer"><span class="hs-identifier hs-var hs-var">unliftIOTracer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall x. IO x -&gt; m x) -&gt; Tracer IO a -&gt; Tracer m a
forall (m :: * -&gt; *) (n :: * -&gt; *) s.
(forall x. m x -&gt; n x) -&gt; Tracer m s -&gt; Tracer n s
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">natTracer</span></a></span><span> </span><span class="annot"><span class="annottext">forall x. IO x -&gt; m x
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">liftIO</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Conditional mapping of a 'Tracer'.</span><span>
</span><span id="line-404"></span><span id="local-6989586621682422710"><span id="local-6989586621682422711"><span id="local-6989586621682422712"><span class="annot"><a href="Cardano.Wallet.Logging.html#flatContramapTracer"><span class="hs-identifier hs-type">flatContramapTracer</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422712"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621682422711"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422710"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422712"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422710"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-type">Tracer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422712"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621682422711"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-409"></span><span id="flatContramapTracer"><span class="annot"><span class="annottext">flatContramapTracer :: (a -&gt; Maybe b) -&gt; Tracer m b -&gt; Tracer m a
</span><a href="Cardano.Wallet.Logging.html#flatContramapTracer"><span class="hs-identifier hs-var hs-var">flatContramapTracer</span></a></span></span><span> </span><span id="local-6989586621682422392"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621682422392"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621682422391"><span class="annot"><span class="annottext">Tracer m b
</span><a href="#local-6989586621682422391"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; m ()) -&gt; Tracer m a
forall (m :: * -&gt; *) a. (a -&gt; m ()) -&gt; Tracer m a
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var">Tracer</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; m ()) -&gt; Tracer m a) -&gt; (a -&gt; m ()) -&gt; Tracer m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621682422390"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422390"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621682422392"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621682422390"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-410"></span><span>     </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621682422389"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682422389"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tracer m b -&gt; b -&gt; m ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><a href="../../../../contra-tracer/html/src"><span class="hs-identifier hs-var hs-var">runTracer</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer m b
</span><a href="#local-6989586621682422391"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621682422389"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-411"></span><span>     </span><span class="annot"><span class="annottext">Maybe b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span></pre></body></html>