<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cardano.Wallet.Primitive.Model</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cardano-wallet-core-2022.7.1: The Wallet Backend for a Cardano node.</span><ul class="links" id="page-menu"><li><a href="src/Cardano.Wallet.Primitive.Model.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>&#169; 2018-2020 IOHK</td></tr><tr><th>License</th><td>Apache-2.0</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cardano.Wallet.Primitive.Model</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Type</a></li><li><a href="#g:2">Construction &amp; Modification</a></li><li><a href="#g:3">Accessors</a></li><li><a href="#g:4">Delta Type</a></li><li><a href="#g:5">Internal</a><ul><li><a href="#g:6">Exported for testing</a></li></ul></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module implements the &quot;business logic&quot; to manage a Cardano wallet.
 It is a direct implementation of the model, with extensions, from the
 <a href="https://github.com/input-output-hk/cardano-wallet/blob/master/specifications/wallet/formal-specification-for-a-cardano-wallet.pdf">Formal Specification for a Cardano Wallet</a>.</p><p>In other words, this module is about how the wallet keeps track of its
 internal state, specifically the <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code> set and the address discovery state.
 This module is intentionally agnostic to specific address formats, and
 instead relies on the <code><a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a></code> abstraction.  It is also agnostic to issues
 such as how blocks are retrieved from the network, or how the state is
 serialized and cached in the local database.</p><p>All those functions are pure and there's no reason to shove in any sort of
 side-effects in here. &#128578;</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><span class="keyword">data</span> <a href="#t:Wallet">Wallet</a> s</li><li class="src short"><a href="#v:initWallet">initWallet</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> -&gt; s -&gt; ([(<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>)], <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</li><li class="src short"><a href="#v:updateState">updateState</a> :: s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s</li><li class="src short"><span class="keyword">data</span> <a href="#t:FilteredBlock">FilteredBlock</a> = <a href="#v:FilteredBlock">FilteredBlock</a> {<ul class="subs"><li><a href="#v:slot">slot</a> :: !<a href="Cardano-Wallet-Primitive-Types.html#t:Slot" title="Cardano.Wallet.Primitive.Types">Slot</a></li><li><a href="#v:transactions">transactions</a> :: ![(<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>)]</li><li><a href="#v:delegations">delegations</a> :: ![<a href="Cardano-Wallet-Primitive-Types.html#t:DelegationCertificate" title="Cardano.Wallet.Primitive.Types">DelegationCertificate</a>]</li></ul>}</li><li class="src short"><a href="#v:applyBlock">applyBlock</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; (<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>, (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s))</li><li class="src short"><a href="#v:applyBlocks">applyBlocks</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NonEmpty" title="Distribution.Compat.Prelude.Internal">NonEmpty</a> ([<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>], (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)))</li><li class="src short"><a href="#v:applyBlockData">applyBlockData</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; m ([<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>], (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s))</li><li class="src short"><span class="keyword">data</span> <a href="#t:BlockData">BlockData</a> m addr tx s<ul class="subs"><li>= <a href="#v:List">List</a> (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NonEmpty" title="Distribution.Compat.Prelude.Internal">NonEmpty</a> <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a>)</li><li>| <a href="#v:Summary">Summary</a> (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:DiscoverTxs" title="Cardano.Wallet.Primitive.AddressDiscovery">DiscoverTxs</a> addr tx s) (<a href="Cardano-Wallet-Primitive-BlockSummary.html#t:BlockSummary" title="Cardano.Wallet.Primitive.BlockSummary">BlockSummary</a> m addr tx)</li></ul></li><li class="src short"><a href="#v:firstHeader">firstHeader</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m addr txs s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></li><li class="src short"><a href="#v:lastHeader">lastHeader</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m addr txs s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></li><li class="src short"><a href="#v:-36-sel:currentTip:Wallet">$sel:currentTip:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></li><li class="src short"><a href="#v:-36-sel:getState:Wallet">$sel:getState:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; s</li><li class="src short"><a href="#v:availableBalance">availableBalance</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-TokenBundle.html#t:TokenBundle" title="Cardano.Wallet.Primitive.Types.TokenBundle">TokenBundle</a></li><li class="src short"><a href="#v:totalBalance">totalBalance</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-TokenBundle.html#t:TokenBundle" title="Cardano.Wallet.Primitive.Types.TokenBundle">TokenBundle</a></li><li class="src short"><a href="#v:totalUTxO">totalUTxO</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:availableUTxO">availableUTxO</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:-36-sel:utxo:Wallet">$sel:utxo:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:DeltaWallet">DeltaWallet</a> s</li><li class="src short"><a href="#v:unsafeInitWallet">unsafeInitWallet</a> :: <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s</li><li class="src short"><a href="#v:spendTx">spendTx</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:utxoFromTx">utxoFromTx</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:utxoFromTxOutputs">utxoFromTxOutputs</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:utxoFromTxCollateralOutputs">utxoFromTxCollateralOutputs</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:applyTxToUTxO">applyTxToUTxO</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:applyOurTxToUTxO">applyOurTxToUTxO</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Slot" title="Cardano.Wallet.Primitive.Types">Slot</a> -&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Word32" title="Distribution.Compat.Prelude.Internal">Word32</a> -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> ((<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:DeltaUTxO" title="Cardano.Wallet.Primitive.Types.UTxO">DeltaUTxO</a>, <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a>)</li><li class="src short"><a href="#v:changeUTxO">changeUTxO</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></li><li class="src short"><a href="#v:discoverAddressesBlock">discoverAddressesBlock</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> -&gt; s -&gt; (DeltaAddressBook s, s)</li><li class="src short"><a href="#v:discoverFromBlockData">discoverFromBlockData</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; s -&gt; m (<a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a>, s)</li><li class="src short"><a href="#v:updateOurs">updateOurs</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s addr =&gt; s -&gt; addr -&gt; s</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Type</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Wallet" class="def">Wallet</a> s <a href="src/Cardano.Wallet.Primitive.Model.html#Wallet" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></p><div class="doc"><p>Abstract data type representing a wallet state.</p><p>A <code><a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a></code> keeps track of transaction outputs and associated addresses that
 belong to <em>us</em> -- we are able to spend these outputs because we know the
 corresponding signing key belonging to the output. Hence, we are able to
 produce witness engaging those outputs as they become inputs in forthcoming
 transactions according to UTxO model.  This information is associated to a
 particular point on the blockchain.</p><p>Internally, a <code><a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a></code> keeps track of</p><ul><li>UTxOs</li><li>Known &amp; used addresses, via address discovery state</li><li>The associated <code><a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></code> indicating the point on the chain.</li></ul><p>The <code><a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a></code> is parameterized over a single type:</p><ul><li><code>s</code> is a <em>state</em> used to keep track of known addresses.
   Typically, this state will be an instance of the <code><a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a></code> class,
   e.g. <code><code><a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a></code> s <code><a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a></code></code>.</li></ul><p>A few examples to make it concrete:</p><pre>Wallet (RndState k n)
Wallet (SeqState n ShelleyKey)
</pre></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Wallet">Instances</h4><details id="i:Wallet" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> s =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-194" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> s =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-194" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Generic:3"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Generic" title="Distribution.Compat.Prelude.Internal">Generic</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-194" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Generic:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s) :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s) x <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s) x -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:NFData:4"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NFData" title="Distribution.Compat.Prelude.Internal">NFData</a> s =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NFData" title="Distribution.Compat.Prelude.Internal">NFData</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-196" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:NFData:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:rnf">rnf</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; () <a href="../../ghc/html/libraries/deepseq-1.4.4.0/src" class="link">Source</a> <a href="#v:rnf" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Buildable:5"></span> <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> s =&gt; <a href="../../fmt/html/Fmt.html#t:Buildable" title="Fmt">Buildable</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-203" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Buildable:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:build">build</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="../../fmt/html/Fmt.html#t:Builder" title="Fmt">Builder</a> <a href="../../formatting/html/src" class="link">Source</a> <a href="#v:build" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Wallet:Rep:6"></span> <span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-194" class="link">Source</a> <a href="#t:Wallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Wallet:Rep:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="src"><span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s) = <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;Wallet&quot; &quot;Cardano.Wallet.Primitive.Model&quot; &quot;cardano-wallet-core-2022.7.1-KAKkMGOljPka4gkPnYOdj&quot; '<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:False" title="Distribution.Compat.Prelude.Internal">False</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;Wallet&quot; '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> '<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:True" title="Distribution.Compat.Prelude.Internal">True</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;utxo&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a>) <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;currentTip&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a>) <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;getState&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceStrictness" title="GHC.Generics">NoSourceStrictness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedLazy" title="GHC.Generics">DecidedLazy</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> s))))</div></details></td></tr></table></details></div></div><a href="#g:2" id="g:2"><h1>Construction &amp; Modification</h1></a><div class="top"><p class="src"><a id="v:initWallet" class="def">initWallet</a> <a href="src/Cardano.Wallet.Primitive.Model.html#initWallet" class="link">Source</a> <a href="#v:initWallet" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a></td><td class="doc"><p>The genesis block</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc"><p>Initial address discovery state</p></td></tr><tr><td class="src">-&gt; ([(<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>)], <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create an empty wallet and apply the given genesis block.</p><p>The wallet tip will be the genesis block header.</p></div></div><div class="top"><p class="src"><a id="v:updateState" class="def">updateState</a> :: s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s <a href="src/Cardano.Wallet.Primitive.Model.html#updateState" class="link">Source</a> <a href="#v:updateState" class="selflink">#</a></p><div class="doc"><p>Update the address discovery state of a wallet.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:FilteredBlock" class="def">FilteredBlock</a> <a href="src/Cardano.Wallet.Primitive.Model.html#FilteredBlock" class="link">Source</a> <a href="#t:FilteredBlock" class="selflink">#</a></p><div class="doc"><p>Represents the subset of data from a single block that are relevant to a
 particular wallet, discovered when applying a block to that wallet.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:FilteredBlock" class="def">FilteredBlock</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:slot" class="def">slot</a> :: !<a href="Cardano-Wallet-Primitive-Types.html#t:Slot" title="Cardano.Wallet.Primitive.Types">Slot</a></dfn><div class="doc"><p>The slot of this block.</p></div></li><li><dfn class="src"><a id="v:transactions" class="def">transactions</a> :: ![(<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>)]</dfn><div class="doc"><p>The set of transactions that affect the wallet,
 list in the same order which they appeared in the block.</p></div></li><li><dfn class="src"><a id="v:delegations" class="def">delegations</a> :: ![<a href="Cardano-Wallet-Primitive-Types.html#t:DelegationCertificate" title="Cardano.Wallet.Primitive.Types">DelegationCertificate</a>]</dfn><div class="doc"><p>Stake delegations made on behalf of the wallet,
 listed in the order in which they appear on the chain.
 If the list contains more than element, those that appear
 later in the list supersede those that appear earlier on.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:FilteredBlock">Instances</h4><details id="i:FilteredBlock" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilteredBlock:Eq:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Eq" title="Distribution.Compat.Prelude.Internal">Eq</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a></span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-285" class="link">Source</a> <a href="#t:FilteredBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilteredBlock:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-61--61-" class="selflink">#</a></p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Bool" title="Distribution.Compat.Prelude.Internal">Bool</a> <a href="../../ghc/html/libraries/ghc-prim-0.6.1/src" class="link">Source</a> <a href="#v:-47--61-" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilteredBlock:Show:2"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a></span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-285" class="link">Source</a> <a href="#t:FilteredBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilteredBlock:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilteredBlock:Generic:3"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Generic" title="Distribution.Compat.Prelude.Internal">Generic</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a></span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-285" class="link">Source</a> <a href="#t:FilteredBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilteredBlock:Generic:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/Data-Kind.html#t:Type" title="Data.Kind">Type</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#t:Rep" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> -&gt; <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> x <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:from" class="selflink">#</a></p><p class="src"><a href="#v:to">to</a> :: <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> x -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:to" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:FilteredBlock:Rep:4"></span> <span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a></span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-285" class="link">Source</a> <a href="#t:FilteredBlock" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:FilteredBlock:Rep:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="src"><span class="keyword">type</span> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rep" title="GHC.Generics">Rep</a> <a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a> = <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:D1" title="GHC.Generics">D1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaData" title="GHC.Generics">MetaData</a> &quot;FilteredBlock&quot; &quot;Cardano.Wallet.Primitive.Model&quot; &quot;cardano-wallet-core-2022.7.1-KAKkMGOljPka4gkPnYOdj&quot; '<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:False" title="Distribution.Compat.Prelude.Internal">False</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:C1" title="GHC.Generics">C1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaCons" title="GHC.Generics">MetaCons</a> &quot;FilteredBlock&quot; '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:PrefixI" title="GHC.Generics">PrefixI</a> '<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:True" title="Distribution.Compat.Prelude.Internal">True</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;slot&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:SourceStrict" title="GHC.Generics">SourceStrict</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedStrict" title="GHC.Generics">DecidedStrict</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> <a href="Cardano-Wallet-Primitive-Types.html#t:Slot" title="Cardano.Wallet.Primitive.Types">Slot</a>) <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;transactions&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:SourceStrict" title="GHC.Generics">SourceStrict</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedStrict" title="GHC.Generics">DecidedStrict</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> [(<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>)]) <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t::-42-:" title="GHC.Generics">:*:</a> <a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:S1" title="GHC.Generics">S1</a> ('<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:MetaSel" title="GHC.Generics">MetaSel</a> ('<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a> &quot;delegations&quot;) '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:NoSourceUnpackedness" title="GHC.Generics">NoSourceUnpackedness</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:SourceStrict" title="GHC.Generics">SourceStrict</a> '<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#v:DecidedStrict" title="GHC.Generics">DecidedStrict</a>) (<a href="../../ghc/html/libraries/base-4.14.3.0/GHC-Generics.html#t:Rec0" title="GHC.Generics">Rec0</a> [<a href="Cardano-Wallet-Primitive-Types.html#t:DelegationCertificate" title="Cardano.Wallet.Primitive.Types">DelegationCertificate</a>]))))</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:applyBlock" class="def">applyBlock</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; (<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>, (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)) <a href="src/Cardano.Wallet.Primitive.Model.html#applyBlock" class="link">Source</a> <a href="#v:applyBlock" class="selflink">#</a></p><div class="doc"><p>Apply a single block to a wallet.</p><p>This is the most fundamental way of making a wallet evolve.</p><p>Returns an updated wallet, as well as the address data relevant to the wallet
 that were discovered while applying the block.</p></div></div><div class="top"><p class="src"><a id="v:applyBlocks" class="def">applyBlocks</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NonEmpty" title="Distribution.Compat.Prelude.Internal">NonEmpty</a> ([<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>], (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s))) <a href="src/Cardano.Wallet.Primitive.Model.html#applyBlocks" class="link">Source</a> <a href="#v:applyBlocks" class="selflink">#</a></p><div class="doc"><p>Apply multiple blocks in sequence to an existing wallet and
 return a list of intermediate wallet states.</p><p>If the input blocks are a <code><a href="Cardano-Wallet-Primitive-Model.html#v:List" title="Cardano.Wallet.Primitive.Model">List</a></code>, then one intermediate wallet
 state is returned for each block in the list.
 If the input blocks are a <code><a href="Cardano-Wallet-Primitive-Model.html#v:Summary" title="Cardano.Wallet.Primitive.Model">Summary</a></code>, then only one final wallet state
 is returned.</p><p>More specifically, for an initial wallet state <code>w0</code> and a <code><a href="Cardano-Wallet-Primitive-Model.html#v:List" title="Cardano.Wallet.Primitive.Model">List</a></code> of
 of blocks</p><pre>bs = [b1, b2, &#8230;, bn]@</pre><p>, the function returns</p><p>@
 [ (filtered b1, (delta w0 -&gt; w1 , w1 = w0 + b1))
 , (filtered b2, (delta w1 -&gt; w2 , w2 = w1 + b2))
 , &#8230;
 , (filtered bn, (delta w(n-1) -&gt; wn, wn = w(n-1)+bn))
 ]</p><p>Here:</p><ul><li><code>filtered bj</code> refers to the set of transactions contained in the
   block <code>bj</code> that were actually applied to the wallet state.</li><li><code>wi + bj</code> refers to the wallet state obtained after applying
   the block <code>bi</code> to the wallet <code>wj</code>.</li><li>delta wi -&gt; wj<code> refers to the delta that was applied in order
   to obtain </code>wj<code> from </code>wi@.</li></ul></div></div><div class="top"><p class="src"><a id="v:applyBlockData" class="def">applyBlockData</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; m ([<a href="Cardano-Wallet-Primitive-Model.html#t:FilteredBlock" title="Cardano.Wallet.Primitive.Model">FilteredBlock</a>], (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s, <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s)) <a href="src/Cardano.Wallet.Primitive.Model.html#applyBlockData" class="link">Source</a> <a href="#v:applyBlockData" class="selflink">#</a></p><div class="doc"><p>Apply multiple blocks in sequence to an existing wallet
 and return the final wallet state as well as the transactions
 that were applied.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BlockData" class="def">BlockData</a> m addr tx s <a href="src/Cardano.Wallet.Primitive.Model.html#BlockData" class="link">Source</a> <a href="#t:BlockData" class="selflink">#</a></p><div class="doc"><p>BlockData which has been paired with discovery facilities.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:List" class="def">List</a> (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:NonEmpty" title="Distribution.Compat.Prelude.Internal">NonEmpty</a> <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a id="v:Summary" class="def">Summary</a> (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:DiscoverTxs" title="Cardano.Wallet.Primitive.AddressDiscovery">DiscoverTxs</a> addr tx s) (<a href="Cardano-Wallet-Primitive-BlockSummary.html#t:BlockSummary" title="Cardano.Wallet.Primitive.BlockSummary">BlockSummary</a> m addr tx)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:firstHeader" class="def">firstHeader</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m addr txs s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> <a href="src/Cardano.Wallet.Primitive.Model.html#firstHeader" class="link">Source</a> <a href="#v:firstHeader" class="selflink">#</a></p><div class="doc"><p>First <code><a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></code> of the blocks represented
 by <code><a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:lastHeader" class="def">lastHeader</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m addr txs s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> <a href="src/Cardano.Wallet.Primitive.Model.html#lastHeader" class="link">Source</a> <a href="#v:lastHeader" class="selflink">#</a></p><div class="doc"><p>Last <code><a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></code> of the blocks represented
 by <code><a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a></code>.</p></div></div><a href="#g:3" id="g:3"><h1>Accessors</h1></a><div class="top"><p class="src"><a id="v:-36-sel:currentTip:Wallet" class="def">$sel:currentTip:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a> <a href="src/Cardano.Wallet.Primitive.Model.html#%24sel%3AcurrentTip%3AWallet" class="link">Source</a> <a href="#v:-36-sel:currentTip:Wallet" class="selflink">#</a></p><div class="doc"><p>Header of the latest applied block (current tip)</p></div></div><div class="top"><p class="src"><a id="v:-36-sel:getState:Wallet" class="def">$sel:getState:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; s <a href="src/Cardano.Wallet.Primitive.Model.html#%24sel%3AgetState%3AWallet" class="link">Source</a> <a href="#v:-36-sel:getState:Wallet" class="selflink">#</a></p><div class="doc"><p>Address discovery state</p></div></div><div class="top"><p class="src"><a id="v:availableBalance" class="def">availableBalance</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-TokenBundle.html#t:TokenBundle" title="Cardano.Wallet.Primitive.Types.TokenBundle">TokenBundle</a> <a href="src/Cardano.Wallet.Primitive.Model.html#availableBalance" class="link">Source</a> <a href="#v:availableBalance" class="selflink">#</a></p><div class="doc"><p>Available balance = <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#v:balance" title="Cardano.Wallet.Primitive.Types.UTxO">balance</a></code> . <code><a href="Cardano-Wallet-Primitive-Model.html#v:availableUTxO" title="Cardano.Wallet.Primitive.Model">availableUTxO</a></code></p></div></div><div class="top"><p class="src"><a id="v:totalBalance" class="def">totalBalance</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-Coin.html#t:Coin" title="Cardano.Wallet.Primitive.Types.Coin">Coin</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-TokenBundle.html#t:TokenBundle" title="Cardano.Wallet.Primitive.Types.TokenBundle">TokenBundle</a> <a href="src/Cardano.Wallet.Primitive.Model.html#totalBalance" class="link">Source</a> <a href="#v:totalBalance" class="selflink">#</a></p><div class="doc"><p>Total balance = <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#v:balance" title="Cardano.Wallet.Primitive.Types.UTxO">balance</a></code> . <code><a href="Cardano-Wallet-Primitive-Model.html#v:totalUTxO" title="Cardano.Wallet.Primitive.Model">totalUTxO</a></code> +? rewards</p></div></div><div class="top"><p class="src"><a id="v:totalUTxO" class="def">totalUTxO</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#totalUTxO" class="link">Source</a> <a href="#v:totalUTxO" class="selflink">#</a></p><div class="doc"><p>Computes the total <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code> set of a wallet.</p><p>This total <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code> set is a projection of how the wallet's UTxO set would look
 if all pending transactions were applied successfully.</p><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>totalUTxO pendingTxs wallet
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>= utxo wallet
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>&#8722; inputs pendingTxs
</code></strong><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>&#8746; change pendingTxs
</code></strong></pre></div></div><div class="top"><p class="src"><a id="v:availableUTxO" class="def">availableUTxO</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#availableUTxO" class="link">Source</a> <a href="#v:availableUTxO" class="selflink">#</a></p><div class="doc"><p>Available UTxO = <code>pending &#8938; utxo</code></p></div></div><div class="top"><p class="src"><a id="v:-36-sel:utxo:Wallet" class="def">$sel:utxo:Wallet</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#%24sel%3Autxo%3AWallet" class="link">Source</a> <a href="#v:-36-sel:utxo:Wallet" class="selflink">#</a></p><div class="doc"><p>Unspent tx outputs belonging to this wallet</p></div></div><a href="#g:4" id="g:4"><h1>Delta Type</h1></a><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:DeltaWallet" class="def">DeltaWallet</a> s <a href="src/Cardano.Wallet.Primitive.Model.html#DeltaWallet" class="link">Source</a> <a href="#t:DeltaWallet" class="selflink">#</a></p><div class="doc"><p>Delta encoding for <code><a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a></code>.</p></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:DeltaWallet">Instances</h4><details id="i:DeltaWallet" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DeltaWallet:Show:1"></span> <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> s =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-214" class="link">Source</a> <a href="#t:DeltaWallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DeltaWallet:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s] -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="../../ghc/html/libraries/base-4.14.3.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DeltaWallet:Delta:2"></span> <a href="../../dbvar/html/Data-Delta.html#t:Delta" title="Data.Delta">Delta</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-218" class="link">Source</a> <a href="#t:DeltaWallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DeltaWallet:Delta:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a href="../../dbvar/html/Data-Delta.html#t:Base" title="Data.Delta">Base</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s) <a href="../../dbvar/html/src" class="link">Source</a> <a href="#t:Base" class="selflink">#</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:apply">apply</a> :: <a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s -&gt; <a href="../../dbvar/html/Data-Delta.html#t:Base" title="Data.Delta">Base</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s) -&gt; <a href="../../dbvar/html/Data-Delta.html#t:Base" title="Data.Delta">Base</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s) <a href="../../dbvar/html/src" class="link">Source</a> <a href="#v:apply" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:DeltaWallet:Base:3"></span> <span class="keyword">type</span> <a href="../../dbvar/html/Data-Delta.html#t:Base" title="Data.Delta">Base</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s)</span> <a href="src/Cardano.Wallet.Primitive.Model.html#line-219" class="link">Source</a> <a href="#t:DeltaWallet" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:DeltaWallet:Base:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cardano-Wallet-Primitive-Model.html">Cardano.Wallet.Primitive.Model</a></p> <div class="src"><span class="keyword">type</span> <a href="../../dbvar/html/Data-Delta.html#t:Base" title="Data.Delta">Base</a> (<a href="Cardano-Wallet-Primitive-Model.html#t:DeltaWallet" title="Cardano.Wallet.Primitive.Model">DeltaWallet</a> s) = <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s</div></details></td></tr></table></details></div></div><a href="#g:5" id="g:5"><h1>Internal</h1></a><div class="top"><p class="src"><a id="v:unsafeInitWallet" class="def">unsafeInitWallet</a> <a href="src/Cardano.Wallet.Primitive.Model.html#unsafeInitWallet" class="link">Source</a> <a href="#v:unsafeInitWallet" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></td><td class="doc"><p>Unspent tx outputs belonging to this wallet</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:BlockHeader" title="Cardano.Wallet.Primitive.Types">BlockHeader</a></td><td class="doc"><p>Header of the latest applied block (current tip)</p></td></tr><tr><td class="src">-&gt; s</td><td class="doc"><p>Address discovery state</p></td></tr><tr><td class="src">-&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:Wallet" title="Cardano.Wallet.Primitive.Model">Wallet</a> s</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Construct a wallet from the exact given state.</p><p>Using this function instead of <code><a href="Cardano-Wallet-Primitive-Model.html#v:initWallet" title="Cardano.Wallet.Primitive.Model">initWallet</a></code> and <code><a href="Cardano-Wallet-Primitive-Model.html#v:applyBlock" title="Cardano.Wallet.Primitive.Model">applyBlock</a></code> allows the
 wallet invariants to be broken. Therefore it should only be used in the
 special case of loading wallet checkpoints from the database (where it is
 assumed a valid wallet was stored into the database).</p></div></div><a href="#g:6" id="g:6"><h2>Exported for testing</h2></a><div class="top"><p class="src"><a id="v:spendTx" class="def">spendTx</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#spendTx" class="link">Source</a> <a href="#v:spendTx" class="selflink">#</a></p><div class="doc"><p>Remove unspent outputs that are consumed by the given transaction.</p><pre>spendTx tx u <code>isSubsetOf</code> u
balance (spendTx tx u) &lt;= balance u
balance (spendTx tx u) = balance u - balance (u <code>restrictedBy</code> inputs tx)
spendTx tx u = u <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#v:excluding" title="Cardano.Wallet.Primitive.Types.UTxO">excluding</a></code> inputs tx
spendTx tx (filterByAddress f u) = filterByAddress f (spendTx tx u)
spendTx tx (u &lt;&gt; utxoFromTx tx) = spendTx tx u &lt;&gt; utxoFromTx tx
</pre></div></div><div class="top"><p class="src"><a id="v:utxoFromTx" class="def">utxoFromTx</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#utxoFromTx" class="link">Source</a> <a href="#v:utxoFromTx" class="selflink">#</a></p><div class="doc"><p>Generates a UTxO set from a transaction.</p><p>The generated UTxO set corresponds to the value provided by the transaction.</p><p>It is important for transaction outputs to be ordered correctly, as their
 indices within this ordering will determine how they are referenced as
 transaction inputs in subsequent blocks.</p><p>Assuming the transaction is not marked as having an invalid script, the
 following properties should hold:</p><pre>balance (utxoFromTx tx) == foldMap tokens (outputs tx)</pre><pre>size    (utxoFromTx tx) == length         (outputs tx)</pre><pre>toList  (utxoFromTx tx) == toList         (outputs tx)</pre><p>However, if the transaction is marked as having an invalid script, then the
 following properties should hold:</p><pre>balance (utxoFromTx tx) == foldMap tokens (collateralOutput tx)</pre><pre>size    (utxoFromTx tx) == length         (collateralOutput tx)</pre><pre>toList  (utxoFromTx tx) == toList         (collateralOutput tx)</pre></div></div><div class="top"><p class="src"><a id="v:utxoFromTxOutputs" class="def">utxoFromTxOutputs</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#utxoFromTxOutputs" class="link">Source</a> <a href="#v:utxoFromTxOutputs" class="selflink">#</a></p><div class="doc"><p>Generates a UTxO set from the ordinary outputs of a transaction.</p><p>This function ignores the transaction's script validity.</p></div></div><div class="top"><p class="src"><a id="v:utxoFromTxCollateralOutputs" class="def">utxoFromTxCollateralOutputs</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#utxoFromTxCollateralOutputs" class="link">Source</a> <a href="#v:utxoFromTxCollateralOutputs" class="selflink">#</a></p><div class="doc"><p>Generates a UTxO set from the collateral outputs of a transaction.</p><p>This function ignores the transaction's script validity.</p></div></div><div class="top"><p class="src"><a id="v:applyTxToUTxO" class="def">applyTxToUTxO</a> :: <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#applyTxToUTxO" class="link">Source</a> <a href="#v:applyTxToUTxO" class="selflink">#</a></p><div class="doc"><p>Applies a transaction to a UTxO, moving it from one state to another.</p><p>When applying a transaction to a UTxO:
   1. We need to remove any unspents that have been spent in the transaction.
   2. Add any unspents that we've received via the transaction.
      In this function, we assume that all outputs belong to us.</p><p>Properties:</p><pre>balance (applyTxToUTxO tx u) = balance u
                             + balance (utxoFromTx tx)
                             - balance (u <code>restrictedBy</code> inputs tx)
unUTxO (applyTxToUTxO tx u) = unUTxO u
    <code><a href="../../containers/html/Data-Map-Strict.html#v:union" title="Data.Map.Strict">union</a></code> unUTxO (utxoFromTx tx)
    <code><a href="../../containers/html/Data-Map-Strict.html#v:difference" title="Data.Map.Strict">difference</a></code> unUTxO (u <code>restrictedBy</code> inputs tx)
applyTxToUTxO tx u = spend tx u &lt;&gt; utxoFromTx tx
applyTxToUTxO tx u = spend tx (u &lt;&gt; utxoFromTx tx)
</pre></div></div><div class="top"><p class="src"><a id="v:applyOurTxToUTxO" class="def">applyOurTxToUTxO</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Slot" title="Cardano.Wallet.Primitive.Types">Slot</a> -&gt; <a href="Data-Quantity.html#t:Quantity" title="Data.Quantity">Quantity</a> &quot;block&quot; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Word32" title="Distribution.Compat.Prelude.Internal">Word32</a> -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> -&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> ((<a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a>, <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:TxMeta" title="Cardano.Wallet.Primitive.Types.Tx">TxMeta</a>), <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:DeltaUTxO" title="Cardano.Wallet.Primitive.Types.UTxO">DeltaUTxO</a>, <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a>) <a href="src/Cardano.Wallet.Primitive.Model.html#applyOurTxToUTxO" class="link">Source</a> <a href="#v:applyOurTxToUTxO" class="selflink">#</a></p><div class="doc"><p>Apply the given transaction to the <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code>.
 Return <code><a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#v:Just" title="Distribution.Compat.Prelude.Internal">Just</a></code> if and only if the transaction is relevant to the wallet
 (changes the <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code> set or makes a withdrawal).</p><p>It satisfies the following property:</p><pre>isJust (applyOurTxToUTxO slot bh state1 tx u) = b
  where (b, state1) = runState (isOurTx tx u) state0</pre></div></div><div class="top"><p class="src"><a id="v:changeUTxO" class="def">changeUTxO</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> =&gt; <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> <a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a> -&gt; s -&gt; <a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a> <a href="src/Cardano.Wallet.Primitive.Model.html#changeUTxO" class="link">Source</a> <a href="#v:changeUTxO" class="selflink">#</a></p><div class="doc"><p>Retrieve the change <code><a href="Cardano-Wallet-Primitive-Types-UTxO.html#t:UTxO" title="Cardano.Wallet.Primitive.Types.UTxO">UTxO</a></code> contained in a set of pending transactions.</p><p>We perform <em>some</em> address discovery within the list of pending addresses,
 but we do not store the result.
 Instead, we essentially assume that the address discovery state <code>s</code> contains
 enough information to collect the change addresses in the pending
 transactions.</p><p>Caveats:
 * Rollbacks can invalidate this assumption. &#128584;
 * The order of pending transactions is based on transaction hashes,
   and typically does not agree with the order in which we have submitted
   them onto the chain. Hence, the address discovery phase is not really
   very effective.
   TODO: Add slot to <code><a href="Cardano-Wallet-Primitive-Types-Tx.html#t:Tx" title="Cardano.Wallet.Primitive.Types.Tx">Tx</a></code> and sort the pending set by slot.</p></div></div><div class="top"><p class="src"><a id="v:discoverAddressesBlock" class="def">discoverAddressesBlock</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) =&gt; <a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a> -&gt; s -&gt; (DeltaAddressBook s, s) <a href="src/Cardano.Wallet.Primitive.Model.html#discoverAddressesBlock" class="link">Source</a> <a href="#v:discoverAddressesBlock" class="selflink">#</a></p><div class="doc"><p>Perform address discovery on a <code><a href="Cardano-Wallet-Primitive-Types.html#t:Block" title="Cardano.Wallet.Primitive.Types">Block</a></code> by going through all transactions
 and delegation certificates in the block.</p></div></div><div class="top"><p class="src"><a id="v:discoverFromBlockData" class="def">discoverFromBlockData</a> :: (<a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a>, <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>, <a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Monad" title="Distribution.Compat.Prelude.Internal">Monad</a> m) =&gt; <a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a> m (<a href="../../Cabal/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cardano-Wallet-Primitive-Types-Address.html#t:Address" title="Cardano.Wallet.Primitive.Types.Address">Address</a> <a href="Cardano-Wallet-Primitive-Types-RewardAccount.html#t:RewardAccount" title="Cardano.Wallet.Primitive.Types.RewardAccount">RewardAccount</a>) <a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a> s -&gt; s -&gt; m (<a href="Cardano-Wallet-Primitive-BlockSummary.html#t:ChainEvents" title="Cardano.Wallet.Primitive.BlockSummary">ChainEvents</a>, s) <a href="src/Cardano.Wallet.Primitive.Model.html#discoverFromBlockData" class="link">Source</a> <a href="#v:discoverFromBlockData" class="selflink">#</a></p><div class="doc"><p>Perform address and transaction discovery on <code><a href="Cardano-Wallet-Primitive-Model.html#t:BlockData" title="Cardano.Wallet.Primitive.Model">BlockData</a></code>,</p></div></div><div class="top"><p class="src"><a id="v:updateOurs" class="def">updateOurs</a> :: <a href="Cardano-Wallet-Primitive-AddressDiscovery.html#t:IsOurs" title="Cardano.Wallet.Primitive.AddressDiscovery">IsOurs</a> s addr =&gt; s -&gt; addr -&gt; s <a href="src/Cardano.Wallet.Primitive.Model.html#updateOurs" class="link">Source</a> <a href="#v:updateOurs" class="selflink">#</a></p><div class="doc"><p>Add an address to the address discovery state, iff it belongs to us.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>