<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE BangPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.BiMap</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">Cardano.Binary</span></a></span><span>
</span><span id="line-12"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">DecoderError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">DecoderErrorCustom</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">decodeListLen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">decodeMapSkel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier">dropMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">encodeListLen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">rnf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">void</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Data.Coders.html"><span class="hs-identifier">Data.Coders</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.Coders.html#cborError"><span class="hs-identifier">cborError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Data.Coders.html#invalidKey"><span class="hs-identifier">invalidKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../nothunks/html/src"><span class="hs-identifier">NoThunks.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../nothunks/html/src"><span class="hs-identifier">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-comment">-- =================== Basic BiMap =====================</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- For Bijections we define (BiMap v k v).  Reasons we can't use (Data.Bimap k v)</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- 1) We need to enforce that the second argument `v` is in the Ord class, when making it an Iter instance.</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- 2) The constructor for Data.BiMap is not exported, and it implements a Bijection</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- 3) Missing operation 'restrictkeys' and 'withoutkeys' make performant versions of operations  &#9665; &#8938; &#9655; &#8939; hard.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- 4) Missing operation 'union', make performant versions of &#8746; and &#10755; hard.</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- 5) So we roll our own which is really a (Data.Map k v) with an index that maps v to Set{k}</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="BiMap"><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-var">BiMap</span></a></span></span><span> </span><span id="local-6989586621679127699"><span class="annot"><a href="#local-6989586621679127699"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679127698"><span class="annot"><a href="#local-6989586621679127698"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679127697"><span class="annot"><a href="#local-6989586621679127697"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679127840"><span id="local-6989586621679127841"><span id="local-6989586621679127842"><span id="MkBiMap"><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127842"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127841"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127841"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127841"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127840"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127842"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127840"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127841"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">--  ^   the 1st and 3rd parameter must be the same:             ^   ^</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span id="local-6989586621679127693"><span id="local-6989586621679127694"><span id="local-6989586621679127695"><span class="annot"><a href="Data.BiMap.html#biMapToMap"><span class="hs-identifier hs-type">biMapToMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127695"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127693"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127693"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-42"></span><span id="biMapToMap"><span class="annot"><span class="annottext">biMapToMap :: BiMap v a b -&gt; Map a b
</span><a href="Data.BiMap.html#biMapToMap"><span class="hs-identifier hs-var hs-var">biMapToMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127691"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127691"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127691"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span id="local-6989586621679127689"><span id="local-6989586621679127690"><span class="annot"><a href="Data.BiMap.html#biMapFromMap"><span class="hs-identifier hs-type">biMapFromMap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127690"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127689"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127690"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127689"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127689"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127690"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127689"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-46"></span><span id="biMapFromMap"><span class="annot"><span class="annottext">biMapFromMap :: Map k v -&gt; BiMap v k v
</span><a href="Data.BiMap.html#biMapFromMap"><span class="hs-identifier hs-var hs-var">biMapFromMap</span></a></span></span><span> </span><span id="local-6989586621679127687"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">bmForward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">bmForward</span></a></span><span> </span><span class="annot"><span class="annottext">(Map v (Set k) -&gt; BiMap v k v) -&gt; Map v (Set k) -&gt; BiMap v k v
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; Map v (Set k) -&gt; [(k, v)] -&gt; Map v (Set k)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">((k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
 -&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v)
-&gt; Map v (Set k)
-&gt; Map v (Set k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">([(k, v)] -&gt; Map v (Set k)) -&gt; [(k, v)] -&gt; Map v (Set k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; [(k, v)]
forall k a. Map k a -&gt; [(k, a)]
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.toList</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127687"><span class="hs-identifier hs-var">bmForward</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- ============== begin necessary Cardano.Binary instances ===============</span><span>
</span><span id="line-50"></span><span id="local-6989586621679127679"><span id="local-6989586621679127680"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127673"><span id="local-6989586621679127675"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127679"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127679"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">ToCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127679"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127680"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127679"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-comment">-- The `toCBOR` instance encodes only the forward map. We wrap this in a</span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">-- length-one list because a _previous_ encoding wrote out both maps, and we</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-comment">-- can easily use the list length token to distinguish between them.</span><span>
</span><span id="line-54"></span><span>  </span><span id="local-6989586621679127671"><span class="annot"><span class="annottext">toCBOR :: BiMap b a b -&gt; Encoding
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCBOR</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127669"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127669"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">encodeListLen</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Encoding -&gt; Encoding -&gt; Encoding
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; Encoding
forall a. ToCBOR a =&gt; a -&gt; Encoding
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">toCBOR</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127669"><span class="hs-identifier hs-var">l</span></a></span></span></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-57"></span><span>  </span><span id="local-6989586621679127665"><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679127663"><span class="annot"><a href="#local-6989586621679127663"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679127662"><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127663"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679127661"><span class="annot"><span class="annottext">fromCBOR :: Decoder s (BiMap b a b)
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromCBOR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Decoder s Int
forall s. Decoder s Int
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">decodeListLen</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s Int
-&gt; (Int -&gt; Decoder s (BiMap b a b)) -&gt; Decoder s (BiMap b a b)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-63"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Decoder s (BiMap b a b)
forall a b s.
(FromCBOR a, FromCBOR b, Ord a, Ord b) =&gt;
Decoder s (BiMap b a b)
</span><a href="Data.BiMap.html#decodeMapAsBimap"><span class="hs-identifier hs-var">decodeMapAsBimap</span></a></span><span>
</span><span id="line-64"></span><span>      </span><span class="hs-comment">-- Previous encoding of 'BiMap' encoded both the forward and reverse</span><span>
</span><span id="line-65"></span><span>      </span><span class="hs-comment">-- directions. In this case we skip the reverse encoding. Note that,</span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-comment">-- further, the reverse encoding was from 'b' to 'a', not the current 'b'</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-comment">-- to 'Set a', and hence the dropper reflects that.</span><span>
</span><span id="line-68"></span><span>      </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679127658"><span class="annot"><span class="annottext">BiMap b a b
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Decoder s (BiMap b a b)
forall a b s.
(FromCBOR a, FromCBOR b, Ord a, Ord b) =&gt;
Decoder s (BiMap b a b)
</span><a href="Data.BiMap.html#decodeMapAsBimap"><span class="hs-identifier hs-var">decodeMapAsBimap</span></a></span><span>
</span><span id="line-70"></span><span>        </span><span class="annot"><span class="annottext">Dropper s -&gt; Dropper s -&gt; Dropper s
forall s. Dropper s -&gt; Dropper s -&gt; Dropper s
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">dropMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s b -&gt; Dropper s
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Decoder s b -&gt; Dropper s) -&gt; Decoder s b -&gt; Dropper s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. FromCBOR b =&gt; Decoder s b
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679127662"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Decoder s a -&gt; Dropper s
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">void</span></a></span><span> </span><span class="annot"><span class="annottext">(Decoder s a -&gt; Dropper s) -&gt; Decoder s a -&gt; Dropper s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. FromCBOR a =&gt; Decoder s a
forall a s. FromCBOR a =&gt; Decoder s a
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">fromCBOR</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679127663"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span>        </span><span class="annot"><span class="annottext">BiMap b a b -&gt; Decoder s (BiMap b a b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap b a b
</span><a href="#local-6989586621679127658"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-72"></span><span>      </span><span id="local-6989586621679127657"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127657"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Decoder s (BiMap b a b)
forall s a. Word -&gt; Decoder s a
</span><a href="Data.Coders.html#invalidKey"><span class="hs-identifier hs-var">invalidKey</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Word
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679127657"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | Decode a serialised CBOR Map as a Bimap</span><span>
</span><span id="line-75"></span><span id="local-6989586621679127798"><span id="local-6989586621679127799"><span id="local-6989586621679127800"><span class="annot"><a href="Data.BiMap.html#decodeMapAsBimap"><span class="hs-identifier hs-type">decodeMapAsBimap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-type">FromCBOR</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127800"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127798"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127799"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127800"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127799"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-78"></span><span id="decodeMapAsBimap"><span class="annot"><span class="annottext">decodeMapAsBimap :: Decoder s (BiMap b a b)
</span><a href="Data.BiMap.html#decodeMapAsBimap"><span class="hs-identifier hs-var hs-var">decodeMapAsBimap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>  </span><span id="local-6989586621679127656"><span class="annot"><span class="annottext">bimap :: BiMap b a b
</span><a href="#local-6989586621679127656"><span class="hs-identifier hs-var">bimap</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127655"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127655"><span class="hs-identifier hs-var">mf</span></a></span></span><span> </span><span id="local-6989586621679127654"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127654"><span class="hs-identifier hs-var">mb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">([(a, b)] -&gt; BiMap b a b) -&gt; Decoder s (BiMap b a b)
forall k v m s.
(Ord k, FromCBOR k, FromCBOR v) =&gt;
([(k, v)] -&gt; m) -&gt; Decoder s m
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">decodeMapSkel</span></a></span><span> </span><span class="annot"><span class="annottext">[(a, b)] -&gt; BiMap b a b
forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Data.BiMap.html#biMapFromAscDistinctList"><span class="hs-identifier hs-var">biMapFromAscDistinctList</span></a></span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Decoder s () -&gt; Decoder s ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map a b -&gt; Bool
forall k a. Ord k =&gt; Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.valid</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127655"><span class="hs-identifier hs-var">mf</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a) -&gt; Bool
forall k a. Ord k =&gt; Map k a -&gt; Bool
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.valid</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127654"><span class="hs-identifier hs-var">mb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Decoder s () -&gt; Decoder s ()) -&gt; Decoder s () -&gt; Decoder s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">DecoderError -&gt; Decoder s ()
forall e s a. Buildable e =&gt; e -&gt; Decoder s a
</span><a href="Data.Coders.html#cborError"><span class="hs-identifier hs-var">cborError</span></a></span><span> </span><span class="annot"><span class="annottext">(DecoderError -&gt; Decoder s ()) -&gt; DecoderError -&gt; Decoder s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; DecoderError
</span><a href="../../../../cardano-binary/html/src"><span class="hs-identifier hs-var">DecoderErrorCustom</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;BiMap&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Expected distinct keys in ascending order&quot;</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="annottext">BiMap b a b -&gt; Decoder s (BiMap b a b)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap b a b
</span><a href="#local-6989586621679127656"><span class="hs-identifier hs-var">bimap</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span id="local-6989586621679127648"><span id="local-6989586621679127649"><span id="local-6989586621679127650"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127646"><span class="hs-special">(</span><span class="annot"><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127650"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127649"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-type">NoThunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127648"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127650"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127649"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679127642"><span class="annot"><span class="annottext">showTypeOf :: Proxy (BiMap v a b) -&gt; String
</span><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">showTypeOf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy (BiMap v a b)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;BiMap&quot;</span></span><span>
</span><span id="line-86"></span><span>  </span><span id="local-6989586621679127640"><span class="annot"><span class="annottext">wNoThunks :: Context -&gt; BiMap v a b -&gt; IO (Maybe ThunkInfo)
</span><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">wNoThunks</span></a></span></span><span> </span><span id="local-6989586621679127638"><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679127638"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127637"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127636"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context -&gt; (Map a b, Map b (Set a)) -&gt; IO (Maybe ThunkInfo)
forall a. NoThunks a =&gt; Context -&gt; a -&gt; IO (Maybe ThunkInfo)
</span><a href="../../../../nothunks/html/src"><span class="hs-identifier hs-var">wNoThunks</span></a></span><span> </span><span class="annot"><span class="annottext">Context
</span><a href="#local-6989586621679127638"><span class="hs-identifier hs-var">ctxt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127637"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127636"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span id="local-6989586621679127633"><span id="local-6989586621679127634"><span id="local-6989586621679127635"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127635"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127634"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127633"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679127630"><span class="annot"><span class="annottext">rnf :: BiMap v a b -&gt; ()
</span><a href="#local-6989586621679127630"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127629"><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127628"><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127628"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map a b -&gt; () -&gt; ()
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">seq</span></a></span><span> </span><span class="annot"><span class="annottext">Map a b
</span><a href="#local-6989586621679127629"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map b (Set a) -&gt; () -&gt; ()
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">seq</span></a></span><span> </span><span class="annot"><span class="annottext">Map b (Set a)
</span><a href="#local-6989586621679127628"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- ============== end Necessary Cardano.Binary instances ===================</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679127625"><span id="local-6989586621679127626"><span id="local-6989586621679127627"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127622"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127627"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127625"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127627"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127626"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127620"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127620"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679127619"><span class="annot"><span class="annottext">== :: BiMap u k v -&gt; BiMap u k v -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127618"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127618"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127620"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map k v -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127618"><span class="hs-identifier hs-var">x</span></a></span></span></span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span id="local-6989586621679127615"><span id="local-6989586621679127616"><span id="local-6989586621679127617"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679127610"><span id="local-6989586621679127613"><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127617"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127616"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127615"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127617"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127616"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679127608"><span class="annot"><span class="annottext">show :: BiMap u k v -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127606"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127606"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679127605"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127605"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127606"><span class="hs-identifier hs-var">l</span></a></span></span></span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span id="local-6989586621679127826"><span id="local-6989586621679127827"><span class="annot"><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-type">addBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127827"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127826"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127827"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127826"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127827"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127826"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127827"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127826"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-100"></span><span id="addBack"><span class="annot"><span class="annottext">addBack :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-var hs-var">addBack</span></a></span></span><span> </span><span id="local-6989586621679127604"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127604"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679127603"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127603"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127602"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k -&gt; Set k)
-&gt; v -&gt; Set k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="annot"><span class="annottext">Set k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; Set a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.union</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127604"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k
forall a. a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.singleton</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127603"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127602"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679127597"><span id="local-6989586621679127598"><span class="annot"><a href="Data.BiMap.html#retract"><span class="hs-identifier hs-type">retract</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127598"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127597"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127597"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127597"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127598"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127597"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-103"></span><span id="retract"><span class="annot"><span class="annottext">retract :: v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#retract"><span class="hs-identifier hs-var hs-var">retract</span></a></span></span><span> </span><span id="local-6989586621679127595"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127595"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679127594"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127594"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127593"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127593"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set k -&gt; Set k) -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.adjust</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">k -&gt; Set k -&gt; Set k
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Set.delete</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127594"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127595"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127593"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679127727"><span id="local-6989586621679127728"><span class="annot"><a href="Data.BiMap.html#insertBackwards"><span class="hs-identifier hs-type">insertBackwards</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127728"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127727"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127727"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127727"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127728"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127727"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127728"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map.Map</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127727"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set.Set</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127728"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-106"></span><span id="insertBackwards"><span class="annot"><span class="annottext">insertBackwards :: v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#insertBackwards"><span class="hs-identifier hs-var hs-var">insertBackwards</span></a></span></span><span> </span><span id="local-6989586621679127589"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span id="local-6989586621679127588"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">newv</span></a></span></span><span> </span><span id="local-6989586621679127587"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127586"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127588"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#retract"><span class="hs-identifier hs-var">retract</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127589"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127587"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127586"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621679127584"><span id="local-6989586621679127585"><span class="annot"><a href="Data.BiMap.html#insertWithBiMap"><span class="hs-identifier hs-type">insertWithBiMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127585"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127584"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-109"></span><span id="insertWithBiMap"><span class="annot"><span class="annottext">insertWithBiMap :: (v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Data.BiMap.html#insertWithBiMap"><span class="hs-identifier hs-var hs-var">insertWithBiMap</span></a></span></span><span> </span><span id="local-6989586621679127582"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span id="local-6989586621679127581"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127581"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127580"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127580"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127579"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127579"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679127578"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127578"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Data.BiMap.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127581"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127580"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127579"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127576"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127575"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127581"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127578"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679127576"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127576"><span class="hs-identifier hs-var">oldv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127575"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127575"><span class="hs-identifier hs-var">newv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127581"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127579"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe v
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127580"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127580"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679127573"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127573"><span class="hs-identifier hs-var">v2</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127573"><span class="hs-identifier hs-var">v2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127582"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127573"><span class="hs-identifier hs-var">v2</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127580"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span id="local-6989586621679127719"><span id="local-6989586621679127720"><span class="annot"><a href="Data.BiMap.html#biMapEmpty"><span class="hs-identifier hs-type">biMapEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127720"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127719"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127720"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-114"></span><span id="biMapEmpty"><span class="annot"><span class="annottext">biMapEmpty :: BiMap v k v
</span><a href="Data.BiMap.html#biMapEmpty"><span class="hs-identifier hs-var hs-var">biMapEmpty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Make a BiMap from a list of pairs.</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- The combine function comb=(\ earlier later -&gt; later) will let elements</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- later in the list override ones earlier in the list, and comb =</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- (\ earlier later -&gt; earlier) will keep the vaue that appears first in the list</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span id="local-6989586621679127570"><span id="local-6989586621679127571"><span class="annot"><a href="Data.BiMap.html#biMapFromList"><span class="hs-identifier hs-type">biMapFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127571"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127571"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127571"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127570"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-122"></span><span id="biMapFromList"><span class="annot"><span class="annottext">biMapFromList :: (v -&gt; v -&gt; v) -&gt; [(k, v)] -&gt; BiMap v k v
</span><a href="Data.BiMap.html#biMapFromList"><span class="hs-identifier hs-var hs-var">biMapFromList</span></a></span></span><span> </span><span id="local-6989586621679127568"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127568"><span class="hs-identifier hs-var">comb</span></a></span></span><span> </span><span id="local-6989586621679127567"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127567"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; BiMap v k v -&gt; BiMap v k v)
-&gt; BiMap v k v -&gt; [(k, v)] -&gt; BiMap v k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="annot"><span class="annottext">(k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127566"><span class="hs-identifier hs-var">addEntry</span></a></span><span> </span><span class="annot"><span class="annottext">BiMap v k v
forall v k. BiMap v k v
</span><a href="Data.BiMap.html#biMapEmpty"><span class="hs-identifier hs-var">biMapEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127567"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679127566"><span class="annot"><span class="annottext">addEntry :: (k, v) -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="#local-6989586621679127566"><span class="hs-identifier hs-var hs-var">addEntry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127565"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679127564"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127563"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">forward</span></a></span></span><span> </span><span id="local-6989586621679127562"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127562"><span class="hs-identifier hs-var">backward</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Maybe v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-126"></span><span>        </span><span class="annot"><span class="annottext">Maybe v
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Data.BiMap.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127568"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">forward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127562"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>        </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679127561"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127561"><span class="hs-identifier hs-var">oldv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; k -&gt; v -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.insertWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
forall v. (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Data.BiMap.html#mapflip"><span class="hs-identifier hs-var">mapflip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127568"><span class="hs-identifier hs-var">comb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127563"><span class="hs-identifier hs-var">forward</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k v.
(Ord k, Ord v) =&gt;
v -&gt; v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#insertBackwards"><span class="hs-identifier hs-var">insertBackwards</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127561"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127560"><span class="hs-identifier hs-var">newv</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127565"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127562"><span class="hs-identifier hs-var">backward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>            </span><span id="local-6989586621679127560"><span class="annot"><span class="annottext">newv :: v
</span><a href="#local-6989586621679127560"><span class="hs-identifier hs-var hs-var">newv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127568"><span class="hs-identifier hs-var">comb</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127561"><span class="hs-identifier hs-var">oldv</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127564"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Data.Map uses(\ new old -&gt; ...) while our convention is (\ old new -&gt; ...)</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- We also use this in the Basic instance for BiMap, which uses Data.Map</span><span>
</span><span id="line-133"></span><span id="local-6989586621679127729"><span class="annot"><a href="Data.BiMap.html#mapflip"><span class="hs-identifier hs-type">mapflip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127729"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-134"></span><span id="mapflip"><span class="annot"><span class="annottext">mapflip :: (v -&gt; v -&gt; v) -&gt; v -&gt; v -&gt; v
</span><a href="Data.BiMap.html#mapflip"><span class="hs-identifier hs-var hs-var">mapflip</span></a></span></span><span> </span><span id="local-6989586621679127559"><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127559"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679127558"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127558"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679127557"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127557"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">v -&gt; v -&gt; v
</span><a href="#local-6989586621679127559"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127557"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127558"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | /Warning/ - invariant that keys are distinct and in ascending order is not</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- checked. Make sure it is not violated, otherwise crazy things will happen.</span><span>
</span><span id="line-138"></span><span id="local-6989586621679127780"><span id="local-6989586621679127781"><span class="annot"><a href="Data.BiMap.html#biMapFromAscDistinctList"><span class="hs-identifier hs-type">biMapFromAscDistinctList</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127781"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127780"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679127781"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679127780"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127780"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127781"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127780"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-140"></span><span id="biMapFromAscDistinctList"><span class="annot"><span class="annottext">biMapFromAscDistinctList :: [(k, v)] -&gt; BiMap v k v
</span><a href="Data.BiMap.html#biMapFromAscDistinctList"><span class="hs-identifier hs-var hs-var">biMapFromAscDistinctList</span></a></span></span><span> </span><span id="local-6989586621679127556"><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127556"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127555"><span class="hs-identifier hs-var">bmForward</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127554"><span class="hs-identifier hs-var">bmBackward</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>    </span><span id="local-6989586621679127555"><span class="annot"><span class="annottext">bmForward :: Map k v
</span><a href="#local-6989586621679127555"><span class="hs-identifier hs-var hs-var">bmForward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(k, v)] -&gt; Map k v
forall k a. [(k, a)] -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.fromDistinctAscList</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127556"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679127554"><span class="annot"><span class="annottext">bmBackward :: Map v (Set k)
</span><a href="#local-6989586621679127554"><span class="hs-identifier hs-var hs-var">bmBackward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; Map v (Set k) -&gt; [(k, v)] -&gt; Map v (Set k)
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">((k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
 -&gt; (k, v) -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; (k, v)
-&gt; Map v (Set k)
-&gt; Map v (Set k)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k))
-&gt; k -&gt; v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
forall v k.
(Ord v, Ord k) =&gt;
v -&gt; k -&gt; Map v (Set k) -&gt; Map v (Set k)
</span><a href="Data.BiMap.html#addBack"><span class="hs-identifier hs-var">addBack</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
forall k a. Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.empty</span></a></span><span> </span><span class="annot"><span class="annottext">[(k, v)]
</span><a href="#local-6989586621679127556"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- This synonym makes (BiMap v k v) appear as an ordinary Binary type contructor: (Bimap k v)</span><span>
</span><span id="line-146"></span><span class="hs-keyword">type</span><span> </span><span id="Bimap"><span class="annot"><a href="Data.BiMap.html#Bimap"><span class="hs-identifier hs-var">Bimap</span></a></span></span><span> </span><span id="local-6989586621679127551"><span class="annot"><a href="#local-6989586621679127551"><span class="hs-identifier hs-type">k</span></a></span></span><span> </span><span id="local-6989586621679127550"><span class="annot"><a href="#local-6989586621679127550"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127550"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127551"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127550"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- This operation is very fast (Log n) on BiMap, but extremely slow on other collections.</span><span>
</span><span id="line-149"></span><span id="local-6989586621679127548"><span id="local-6989586621679127549"><span class="annot"><a href="Data.BiMap.html#removeval"><span class="hs-identifier hs-type">removeval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127549"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127549"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.BiMap.html#BiMap"><span class="hs-identifier hs-type">BiMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127549"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679127548"><span class="hs-identifier hs-type">v</span></a></span></span></span><span>
</span><span id="line-150"></span><span id="removeval"><span class="annot"><span class="annottext">removeval :: v -&gt; BiMap v k v -&gt; BiMap v k v
</span><a href="Data.BiMap.html#removeval"><span class="hs-identifier hs-var hs-var">removeval</span></a></span></span><span> </span><span id="local-6989586621679127546"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127546"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679127545"><span class="annot"><span class="annottext">m :: BiMap v k v
</span><a href="#local-6989586621679127545"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-type">MkBiMap</span></a></span><span> </span><span id="local-6989586621679127544"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127544"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679127543"><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127543"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Maybe (Set k)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127546"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127543"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679127542"><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127542"><span class="hs-identifier hs-var">kset</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map k v -&gt; Map v (Set k) -&gt; BiMap v k v
forall v b a. (v ~ b) =&gt; Map a b -&gt; Map b (Set a) -&gt; BiMap v a b
</span><a href="Data.BiMap.html#MkBiMap"><span class="hs-identifier hs-var">MkBiMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(k -&gt; Map k v -&gt; Map k v) -&gt; Map k v -&gt; Set k -&gt; Map k v
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">foldr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679127541"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127541"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679127540"><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127540"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">k -&gt; Map k v -&gt; Map k v
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679127541"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127540"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map k v
</span><a href="#local-6989586621679127544"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">Set k
</span><a href="#local-6989586621679127542"><span class="hs-identifier hs-var">kset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v -&gt; Map v (Set k) -&gt; Map v (Set k)
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><a href="../../../../containers/html/src"><span class="hs-identifier hs-var">Map.delete</span></a></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679127546"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Map v (Set k)
</span><a href="#local-6989586621679127543"><span class="hs-identifier hs-var">m2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Set k)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BiMap v k v
</span><a href="#local-6989586621679127545"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-154"></span></pre></body></html>