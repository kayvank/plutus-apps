<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilyDependencies #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-- | Support for multiple (Shelley-based) eras in the ledger.</span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Ledger.Era</span><span>
</span><span id="line-13"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier">Era</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutBootstrapAddress"><span class="hs-identifier">getTxOutBootstrapAddress</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier">PreviousEra</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier">TranslationContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslateEra"><span class="hs-identifier">TranslateEra</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#translateEra%27"><span class="hs-identifier">translateEra'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#translateEraMaybe"><span class="hs-identifier">translateEraMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#WellFormed"><span class="hs-identifier">WellFormed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#ValidateScript"><span class="hs-identifier">ValidateScript</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- $segWit</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#SupportsSegWit"><span class="hs-identifier">SupportsSegWit</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">where</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cardano-crypto-class/html/src"><span class="hs-identifier">Cardano.Crypto.Hash</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Hash</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Address.html"><span class="hs-identifier">Cardano.Ledger.Address</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Address.html#Addr"><span class="hs-identifier">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Address.html#BootstrapAddress"><span class="hs-identifier">BootstrapAddress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.AuxiliaryData.html"><span class="hs-identifier">Cardano.Ledger.AuxiliaryData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.AuxiliaryData.html#AuxiliaryDataHash"><span class="hs-identifier">AuxiliaryDataHash</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Coin.html"><span class="hs-identifier">Cardano.Ledger.Coin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier">Coin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html"><span class="hs-identifier">Cardano.Ledger.CompactAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#CompactAddr"><span class="hs-identifier">CompactAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#compactAddr"><span class="hs-identifier">compactAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#decompactAddr"><span class="hs-identifier">decompactAddr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#isBootstrapCompactAddr"><span class="hs-identifier">isBootstrapCompactAddr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Compactible.html"><span class="hs-identifier">Cardano.Ledger.Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Compactible.html#Compactible"><span class="hs-identifier">Compactible</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html"><span class="hs-identifier">Cardano.Ledger.Core</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html"><span class="hs-identifier">Cardano.Ledger.Crypto</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CryptoClass</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html"><span class="hs-identifier">Cardano.Ledger.Hashes</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentAuxiliaryData"><span class="hs-identifier">EraIndependentAuxiliaryData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentBlockBody"><span class="hs-identifier">EraIndependentBlockBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier">EraIndependentTxBody</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html"><span class="hs-identifier">Cardano.Ledger.SafeHash</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html#HashAnnotated"><span class="hs-identifier">HashAnnotated</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html#SafeToHash"><span class="hs-identifier">SafeToHash</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.TxIn.html"><span class="hs-identifier">Cardano.Ledger.TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cardano.Ledger.Val.html"><span class="hs-identifier">Cardano.Ledger.Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Val.html#Val"><span class="hs-identifier">Val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../mtl/html/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">Except</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier">runExcept</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Coercible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">coerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier">Data.Maybe.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier">StrictMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier">Data.Sequence.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier">StrictSeq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Typeable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Void</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Void</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">absurd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Records</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">HasField</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- Era</span><span>
</span><span id="line-62"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">class</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Crypto.html#Crypto"><span class="hs-identifier hs-type">CryptoClass.Crypto</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#WellFormed"><span class="hs-identifier hs-type">WellFormed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-69"></span><span>  </span><span id="Era"><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-var">Era</span></a></span></span><span> </span><span id="local-6989586621679247160"><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Crypto"><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-var">Crypto</span></a></span></span><span> </span><span id="local-6989586621679247160"><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- | Extract from TxOut either an address or its compact version by doing the</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- least amount of work.</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- The utility of this function comes from the fact that TxOut usually stores</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- the address in either one of two forms: compacted or unpacked. In order to</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-comment">-- avoid extroneous conversions in `getTxOutAddr` and `getTxOutCompactAddr` we</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- can define just this functionality. Also sometimes it crutial to know at</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">-- the callsite which form of address we have readily available without any</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">-- conversions (eg. searching millions of TxOuts for a particular address)</span><span>
</span><span id="line-82"></span><span>  </span><span id="getTxOutEitherAddr"><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutEitherAddr"><span class="hs-identifier hs-type">getTxOutEitherAddr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#CompactAddr"><span class="hs-identifier hs-type">CompactAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>  </span><span id="getTxOutAddr"><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutAddr"><span class="hs-identifier hs-type">getTxOutAddr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Address.html#Addr"><span class="hs-identifier hs-type">Addr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span id="local-6989586621679247076"><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutAddr"><span class="hs-identifier hs-var hs-var">getTxOutAddr</span></a></span><span> </span><span id="local-6989586621679247075"><span class="annot"><span class="annottext">TxOut e
</span><a href="#local-6989586621679247075"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut e -&gt; Either (Addr (Crypto e)) (CompactAddr (Crypto e))
forall e.
Era e =&gt;
TxOut e -&gt; Either (Addr (Crypto e)) (CompactAddr (Crypto e))
</span><a href="Cardano.Ledger.Era.html#getTxOutEitherAddr"><span class="hs-identifier hs-var">getTxOutEitherAddr</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut e
</span><a href="#local-6989586621679247075"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-89"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679247074"><span class="annot"><span class="annottext">Addr (Crypto e)
</span><a href="#local-6989586621679247074"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Addr (Crypto e)
</span><a href="#local-6989586621679247074"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-90"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679247073"><span class="annot"><span class="annottext">CompactAddr (Crypto e)
</span><a href="#local-6989586621679247073"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto e) -&gt; Addr (Crypto e)
forall crypto. Crypto crypto =&gt; CompactAddr crypto -&gt; Addr crypto
</span><a href="Cardano.Ledger.CompactAddress.html#decompactAddr"><span class="hs-identifier hs-var">decompactAddr</span></a></span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto e)
</span><a href="#local-6989586621679247073"><span class="hs-identifier hs-var">ca</span></a></span></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>  </span><span id="getTxOutCompactAddr"><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutCompactAddr"><span class="hs-identifier hs-type">getTxOutCompactAddr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.CompactAddress.html#CompactAddr"><span class="hs-identifier hs-type">CompactAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679247071"><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutCompactAddr"><span class="hs-identifier hs-var hs-var">getTxOutCompactAddr</span></a></span><span> </span><span id="local-6989586621679247070"><span class="annot"><span class="annottext">TxOut e
</span><a href="#local-6989586621679247070"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut e -&gt; Either (Addr (Crypto e)) (CompactAddr (Crypto e))
forall e.
Era e =&gt;
TxOut e -&gt; Either (Addr (Crypto e)) (CompactAddr (Crypto e))
</span><a href="Cardano.Ledger.Era.html#getTxOutEitherAddr"><span class="hs-identifier hs-var">getTxOutEitherAddr</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut e
</span><a href="#local-6989586621679247070"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679247069"><span class="annot"><span class="annottext">Addr (Crypto e)
</span><a href="#local-6989586621679247069"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Addr (Crypto e) -&gt; CompactAddr (Crypto e)
forall crypto. Addr crypto -&gt; CompactAddr crypto
</span><a href="Cardano.Ledger.CompactAddress.html#compactAddr"><span class="hs-identifier hs-var">compactAddr</span></a></span><span> </span><span class="annot"><span class="annottext">Addr (Crypto e)
</span><a href="#local-6989586621679247069"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679247068"><span class="annot"><span class="annottext">CompactAddr (Crypto e)
</span><a href="#local-6989586621679247068"><span class="hs-identifier hs-var">ca</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto e)
</span><a href="#local-6989586621679247068"><span class="hs-identifier hs-var">ca</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- | The validity of any individual block depends only on a subset</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">-- of the UTxO stored in the ledger state. The consensus layer makes</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- use of this fact, and uses the function below to to retrieve the</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- needed UTxO from disk and present only those to the ledger.</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- It is therefore neccessary that this function account for all the</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">-- different types of inputs inside a transaction.</span></span><span>
</span><span id="line-104"></span><span>  </span><span id="getAllTxInputs"><span class="annot"><a href="Cardano.Ledger.Era.html#getAllTxInputs"><span class="hs-identifier hs-type">getAllTxInputs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.TxIn.html#TxIn"><span class="hs-identifier hs-type">TxIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247160"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- TODO - figure out a dedicated module for things that will create helper</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- functions from this module:</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Get the Bootsrap address from the TxOut. Returns `Nothing` if it is a</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- Shelley address or newer</span><span>
</span><span id="line-111"></span><span class="annot"><a href="Cardano.Ledger.Era.html#getTxOutBootstrapAddress"><span class="hs-identifier hs-type">getTxOutBootstrapAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679247065"><span class="annot"><a href="#local-6989586621679247065"><span class="hs-identifier hs-type">era</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247065"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247065"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Address.html#BootstrapAddress"><span class="hs-identifier hs-type">BootstrapAddress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247065"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span id="getTxOutBootstrapAddress"><span class="annot"><span class="annottext">getTxOutBootstrapAddress :: TxOut era -&gt; Maybe (BootstrapAddress (Crypto era))
</span><a href="Cardano.Ledger.Era.html#getTxOutBootstrapAddress"><span class="hs-identifier hs-var hs-var">getTxOutBootstrapAddress</span></a></span></span><span> </span><span id="local-6989586621679247064"><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679247064"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut era -&gt; Either (Addr (Crypto era)) (CompactAddr (Crypto era))
forall e.
Era e =&gt;
TxOut e -&gt; Either (Addr (Crypto e)) (CompactAddr (Crypto e))
</span><a href="Cardano.Ledger.Era.html#getTxOutEitherAddr"><span class="hs-identifier hs-var">getTxOutEitherAddr</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut era
</span><a href="#local-6989586621679247064"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Address.html#AddrBootstrap"><span class="hs-identifier hs-type">AddrBootstrap</span></a></span><span> </span><span id="local-6989586621679247062"><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
</span><a href="#local-6989586621679247062"><span class="hs-identifier hs-var">bootstrapAddr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
-&gt; Maybe (BootstrapAddress (Crypto era))
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
</span><a href="#local-6989586621679247062"><span class="hs-identifier hs-var">bootstrapAddr</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679247061"><span class="annot"><span class="annottext">CompactAddr (Crypto era)
</span><a href="#local-6989586621679247061"><span class="hs-identifier hs-var">cAddr</span></a></span></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto era) -&gt; Bool
forall crypto. CompactAddr crypto -&gt; Bool
</span><a href="Cardano.Ledger.CompactAddress.html#isBootstrapCompactAddr"><span class="hs-identifier hs-var">isBootstrapCompactAddr</span></a></span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto era)
</span><a href="#local-6989586621679247061"><span class="hs-identifier hs-var">cAddr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>          </span><span class="annot"><a href="Cardano.Ledger.Address.html#AddrBootstrap"><span class="hs-identifier hs-type">AddrBootstrap</span></a></span><span> </span><span id="local-6989586621679247060"><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
</span><a href="#local-6989586621679247060"><span class="hs-identifier hs-var">bootstrapAddr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Addr (Crypto era) -&gt; Maybe (Addr (Crypto era))
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CompactAddr (Crypto era) -&gt; Addr (Crypto era)
forall crypto. Crypto crypto =&gt; CompactAddr crypto -&gt; Addr crypto
</span><a href="Cardano.Ledger.CompactAddress.html#decompactAddr"><span class="hs-identifier hs-var">decompactAddr</span></a></span><span> </span><span class="annot"><span class="annottext">CompactAddr (Crypto era)
</span><a href="#local-6989586621679247061"><span class="hs-identifier hs-var">cAddr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
-&gt; Maybe (BootstrapAddress (Crypto era))
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">BootstrapAddress (Crypto era)
</span><a href="#local-6989586621679247060"><span class="hs-identifier hs-var">bootstrapAddr</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">Either (Addr (Crypto era)) (CompactAddr (Crypto era))
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (BootstrapAddress (Crypto era))
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Script Validation</span><span>
</span><span id="line-127"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- HasField &quot;scriptWits&quot; (ValidatedTx era) (Map.Map (ScriptHash c) script)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Typeclass for script data types. Allows for script validation and hashing.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--   You must understand the role of SafeToHash and scriptPrefixTag to make new</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   instances. 'scriptPrefixTag' is a magic number representing the tag of the</span><span>
</span><span id="line-134"></span><span class="hs-comment">--   script language. For each new script language defined, a new tag is chosen</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   and the tag is included in the script hash for a script. The safeToHash</span><span>
</span><span id="line-136"></span><span class="hs-comment">--   constraint ensures that Scripts are never reserialised.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">class</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html#SafeToHash"><span class="hs-identifier hs-type">SafeToHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span id="ValidateScript"><span class="annot"><a href="Cardano.Ledger.Era.html#ValidateScript"><span class="hs-identifier hs-var">ValidateScript</span></a></span></span><span> </span><span id="local-6989586621679247147"><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span id="scriptPrefixTag"><span class="annot"><a href="Cardano.Ledger.Era.html#scriptPrefixTag"><span class="hs-identifier hs-type">scriptPrefixTag</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../bytestring/html/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-145"></span><span>  </span><span id="validateScript"><span class="annot"><a href="Cardano.Ledger.Era.html#validateScript"><span class="hs-identifier hs-type">validateScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-146"></span><span>  </span><span id="hashScript"><span class="annot"><a href="Cardano.Ledger.Era.html#hashScript"><span class="hs-identifier hs-type">hashScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- ONE SHOULD NOT OVERIDE THE hashScript DEFAULT METHOD</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-comment">-- UNLESS YOU UNDERSTAND THE SafeToHash class, AND THE ROLE OF THE scriptPrefixTag</span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679247055"><span class="annot"><a href="Cardano.Ledger.Era.html#hashScript"><span class="hs-identifier hs-var hs-var">hashScript</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>    </span><span class="annot"><span class="annottext">Hash (ADDRHASH (Crypto era)) EraIndependentScript
-&gt; ScriptHash (Crypto era)
forall crypto.
Hash (ADDRHASH crypto) EraIndependentScript -&gt; ScriptHash crypto
</span><a href="Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-var">ScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Hash (ADDRHASH (Crypto era)) EraIndependentScript
 -&gt; ScriptHash (Crypto era))
-&gt; (Script era
    -&gt; Hash (ADDRHASH (Crypto era)) EraIndependentScript)
-&gt; Script era
-&gt; ScriptHash (Crypto era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Hash (ADDRHASH (Crypto era)) (Script era)
-&gt; Hash (ADDRHASH (Crypto era)) EraIndependentScript
forall h a b. Hash h a -&gt; Hash h b
</span><a href="../../../../cardano-crypto-class/html/src"><span class="hs-identifier hs-var">Hash.castHash</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">(Hash (ADDRHASH (Crypto era)) (Script era)
 -&gt; Hash (ADDRHASH (Crypto era)) EraIndependentScript)
-&gt; (Script era -&gt; Hash (ADDRHASH (Crypto era)) (Script era))
-&gt; Script era
-&gt; Hash (ADDRHASH (Crypto era)) EraIndependentScript
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Script era -&gt; ByteString)
-&gt; Script era -&gt; Hash (ADDRHASH (Crypto era)) (Script era)
forall h a. HashAlgorithm h =&gt; (a -&gt; ByteString) -&gt; a -&gt; Hash h a
</span><a href="../../../../cardano-crypto-class/html/src"><span class="hs-identifier hs-var">Hash.hashWith</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679247050"><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621679247050"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Script era -&gt; ByteString
forall era. ValidateScript era =&gt; Script era -&gt; ByteString
</span><a href="Cardano.Ledger.Era.html#scriptPrefixTag"><span class="hs-identifier hs-var">scriptPrefixTag</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621679247050"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString -&gt; ByteString
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Script era -&gt; ByteString
forall t. SafeToHash t =&gt; t -&gt; ByteString
</span><a href="Cardano.Ledger.SafeHash.html#originalBytes"><span class="hs-identifier hs-var">originalBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><a href="#local-6989586621679247050"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-153"></span><span>  </span><span id="isNativeScript"><span class="annot"><a href="Cardano.Ledger.Era.html#isNativeScript"><span class="hs-identifier hs-type">isNativeScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247147"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679247047"><span class="annot"><a href="Cardano.Ledger.Era.html#isNativeScript"><span class="hs-identifier hs-var hs-var">isNativeScript</span></a></span><span> </span><span class="annot"><span class="annottext">Script era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Segregated Witness</span><span>
</span><span id="line-158"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- $segWit</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- * Segregated Witness</span><span>
</span><span id="line-162"></span><span class="hs-comment">--</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- The idea of segretated witnessing is to alter the encoding of transactions in</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- a block such that the witnesses (the information needed to verify the</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- validity of the transactions) can be stored separately from the body (the</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- information needed to update the ledger state). In this way, a node which</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- only cares about replaying transactions need not even decode the witness</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- information.</span><span>
</span><span id="line-169"></span><span class="hs-comment">--</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- In order to do this, we introduce two concepts:</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- - A 'TxSeq`, which represents the decoded structure of a sequence of</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   transactions as represented in the encoded block; that is, with witnessing,</span><span>
</span><span id="line-173"></span><span class="hs-comment">--   metadata and other non-body parts split separately.</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Indicates that an era supports segregated witnessing.</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">--   This class is embodies an isomorphism between 'TxSeq era' and 'StrictSeq</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   (Tx era)', witnessed by 'fromTxSeq' and 'toTxSeq'.</span><span>
</span><span id="line-179"></span><span class="hs-keyword">class</span><span> </span><span id="SupportsSegWit"><span class="annot"><a href="Cardano.Ledger.Era.html#SupportsSegWit"><span class="hs-identifier hs-var">SupportsSegWit</span></a></span></span><span> </span><span id="local-6989586621679247046"><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TxSeq"><span class="annot"><a href="Cardano.Ledger.Era.html#TxSeq"><span class="hs-identifier hs-var">TxSeq</span></a></span></span><span> </span><span id="local-6989586621679247046"><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679247044"><span class="annot"><a href="#local-6989586621679247044"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679247044"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>  </span><span id="fromTxSeq"><span class="annot"><a href="Cardano.Ledger.Era.html#fromTxSeq"><span class="hs-identifier hs-type">fromTxSeq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>  </span><span id="toTxSeq"><span class="annot"><a href="Cardano.Ledger.Era.html#toTxSeq"><span class="hs-identifier hs-type">toTxSeq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-comment">-- | Get the block body hash from the TxSeq. Note that this is not a regular</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-comment">-- &quot;hash the stored bytes&quot; function since the block body hash forms a small</span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-comment">-- Merkle tree.</span><span>
</span><span id="line-188"></span><span>  </span><span id="hashTxSeq"><span class="annot"><a href="Cardano.Ledger.Era.html#hashTxSeq"><span class="hs-identifier hs-type">hashTxSeq</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#TxSeq"><span class="hs-identifier hs-type">TxSeq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><a href="../../../../cardano-crypto-class/html/src"><span class="hs-identifier hs-type">Hash.Hash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Crypto.html#HASH"><span class="hs-identifier hs-type">CryptoClass.HASH</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247046"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentBlockBody"><span class="hs-identifier hs-type">EraIndependentBlockBody</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-comment">-- | The number of segregated components</span><span>
</span><span id="line-193"></span><span>  </span><span id="numSegComponents"><span class="annot"><a href="Cardano.Ledger.Era.html#numSegComponents"><span class="hs-identifier hs-type">numSegComponents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- Era translation</span><span>
</span><span id="line-197"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Map an era to its predecessor.</span><span>
</span><span id="line-200"></span><span class="hs-comment">--</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- &gt; type instance PreviousEra (AllegraEra c) = ShelleyEra c</span><span>
</span><span id="line-204"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="PreviousEra"><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-var">PreviousEra</span></a></span></span><span> </span><span id="local-6989586621679247038"><span class="annot"><a href="#local-6989586621679247038"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | Per-era context used for 'TranslateEra'.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- This context will be passed to the translation instances of /all/ types of</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- that particular era. In practice, most instances won't need the context, but</span><span>
</span><span id="line-210"></span><span class="hs-comment">-- this approach makes the translation composable (as opposed to having a</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- separate context per type).</span><span>
</span><span id="line-212"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="TranslationContext"><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier hs-var">TranslationContext</span></a></span></span><span> </span><span id="local-6989586621679247037"><span class="annot"><a href="#local-6989586621679247037"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Translation of types between eras, e.g., from Shelley to Allegra.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- When @era@ is just a phantom type parameter, an empty standalone deriving can be used:</span><span>
</span><span id="line-217"></span><span class="hs-comment">--</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- &gt; newtype Foo era = Foo Int</span><span>
</span><span id="line-219"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- &gt; instance TranslateEra (Allegra c) Foo</span><span>
</span><span id="line-221"></span><span class="hs-comment">--</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- Note that one could use @DerivingAnyClass@ (@deriving (TranslateEra (Allegra</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- c))@), but this would introduce an undesired coupling between the</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- era-parametric type and (a) particular era(s). The intention is to have a</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- module with orphan instances per era.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- In most cases, the @era@ parameter won't be phantom, and a manual instance</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- will have to be written:</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- &gt; newtype Bar era = Bar (TxBody era)</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- &gt; instance CryptoClass.Crypto c =&gt; TranslateEra (Allegra c) Bar where</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- &gt;     translateEra ctxt = Bar &lt;$&gt; translateEra ctxt</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- &gt; -- With the following instance being in scope:</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- &gt; instance CryptoClass.Crypto c =&gt; TranslatEra (Allegra c) TxBody</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- Note: we use 'PreviousEra' instead of @NextEra@ as an era definitely knows</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- its predecessor, but not necessarily its successor. Moreover, one could argue</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- that it makes more sense to define the translation from era A to era B where</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- era B is defined, than where era A is defined.</span><span>
</span><span id="line-242"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#Era"><span class="hs-identifier hs-type">Era</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="TranslateEra"><span class="annot"><a href="Cardano.Ledger.Era.html#TranslateEra"><span class="hs-identifier hs-var">TranslateEra</span></a></span></span><span> </span><span id="local-6989586621679247126"><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679247124"><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- | Most translations should be infallible (default instance), but we leave</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-comment">-- the door open for partial translations.</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-comment">-- For a partial translation, override the default type to be '()' or a</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-comment">-- concrete error type.</span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TranslationError"><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-var">TranslationError</span></a></span></span><span> </span><span id="local-6989586621679247126"><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679247124"><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="TranslationError"><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-var">TranslationError</span></a></span></span><span> </span><span id="local-6989586621679247036"><span class="annot"><a href="#local-6989586621679247036"><span class="hs-identifier hs-type hs-type">era</span></a></span></span><span> </span><span id="local-6989586621679247035"><span class="annot"><a href="#local-6989586621679247035"><span class="hs-identifier hs-type hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span>  </span><span class="hs-comment">-- | Translate a type @f@ parameterised by the era from an era to the era</span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-comment">-- after it.</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-comment">-- The translation is a given the translation context of @era@.</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-comment">-- A default instance is provided for when the two types are 'Coercible'.</span><span>
</span><span id="line-258"></span><span>  </span><span id="translateEra"><span class="annot"><a href="Cardano.Ledger.Era.html#translateEra"><span class="hs-identifier hs-type">translateEra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-type">TranslationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">default</span><span> </span><span id="translateEra"><span class="annot"><a href="Cardano.Ledger.Era.html#translateEra"><span class="hs-identifier hs-type">translateEra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Coercible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="../../../../transformers/html/src"><span class="hs-identifier hs-type">Except</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-type">TranslationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247124"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247126"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679247033"><span class="annot"><a href="Cardano.Ledger.Era.html#translateEra"><span class="hs-identifier hs-var hs-var">translateEra</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f era -&gt; Except (TranslationError era f) (f era)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">(f era -&gt; Except (TranslationError era f) (f era))
-&gt; (f (PreviousEra era) -&gt; f era)
-&gt; f (PreviousEra era)
-&gt; Except (TranslationError era f) (f era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">f (PreviousEra era) -&gt; f era
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">coerce</span></a></span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Variant of 'translateEra' for when 'TranslationError' is 'Void' and the</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- translation thus cannot fail.</span><span>
</span><span id="line-268"></span><span id="local-6989586621679247031"><span id="local-6989586621679247032"><span class="annot"><a href="Cardano.Ledger.Era.html#translateEra%27"><span class="hs-identifier hs-type">translateEra'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslateEra"><span class="hs-identifier hs-type">TranslateEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247032"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247031"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-type">TranslationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247032"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247031"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Void</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247032"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="#local-6989586621679247031"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247032"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="#local-6989586621679247031"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247032"><span class="hs-identifier hs-type">era</span></a></span></span></span><span>
</span><span id="line-273"></span><span id="translateEra%27"><span class="annot"><span class="annottext">translateEra' :: TranslationContext era -&gt; f (PreviousEra era) -&gt; f era
</span><a href="Cardano.Ledger.Era.html#translateEra%27"><span class="hs-identifier hs-var hs-var">translateEra'</span></a></span></span><span> </span><span id="local-6989586621679247030"><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679247030"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Void -&gt; f era) -&gt; (f era -&gt; f era) -&gt; Either Void (f era) -&gt; f era
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">Void -&gt; f era
forall a. Void -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">absurd</span></a></span><span> </span><span class="annot"><span class="annottext">f era -&gt; f era
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Either Void (f era) -&gt; f era)
-&gt; (f (PreviousEra era) -&gt; Either Void (f era))
-&gt; f (PreviousEra era)
-&gt; f era
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except Void (f era) -&gt; Either Void (f era)
forall e a. Except e a -&gt; Either e a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except Void (f era) -&gt; Either Void (f era))
-&gt; (f (PreviousEra era) -&gt; Except Void (f era))
-&gt; f (PreviousEra era)
-&gt; Either Void (f era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><a href="Cardano.Ledger.Era.html#translateEra"><span class="hs-identifier hs-var">translateEra</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679247030"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-comment">-- | Variant of 'translateEra' for when 'TranslationError' is '()', converting</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- the result to a 'Maybe'.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679247026"><span id="local-6989586621679247027"><span class="annot"><a href="Cardano.Ledger.Era.html#translateEraMaybe"><span class="hs-identifier hs-type">translateEraMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslateEra"><span class="hs-identifier hs-type">TranslateEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247027"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247026"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationError"><span class="hs-identifier hs-type">TranslationError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247027"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247026"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="Cardano.Ledger.Era.html#TranslationContext"><span class="hs-identifier hs-type">TranslationContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247027"><span class="hs-identifier hs-type">era</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><a href="#local-6989586621679247026"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#PreviousEra"><span class="hs-identifier hs-type">PreviousEra</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247027"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679247026"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247027"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-282"></span><span id="translateEraMaybe"><span class="annot"><span class="annottext">translateEraMaybe :: TranslationContext era -&gt; f (PreviousEra era) -&gt; Maybe (f era)
</span><a href="Cardano.Ledger.Era.html#translateEraMaybe"><span class="hs-identifier hs-var hs-var">translateEraMaybe</span></a></span></span><span> </span><span id="local-6989586621679247025"><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679247025"><span class="hs-identifier hs-var">ctxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">(() -&gt; Maybe (f era))
-&gt; (f era -&gt; Maybe (f era)) -&gt; Either () (f era) -&gt; Maybe (f era)
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (f era) -&gt; () -&gt; Maybe (f era)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (f era)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">f era -&gt; Maybe (f era)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Either () (f era) -&gt; Maybe (f era))
-&gt; (f (PreviousEra era) -&gt; Either () (f era))
-&gt; f (PreviousEra era)
-&gt; Maybe (f era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Except () (f era) -&gt; Either () (f era)
forall e a. Except e a -&gt; Either e a
</span><a href="../../../../transformers/html/src"><span class="hs-identifier hs-var">runExcept</span></a></span><span> </span><span class="annot"><span class="annottext">(Except () (f era) -&gt; Either () (f era))
-&gt; (f (PreviousEra era) -&gt; Except () (f era))
-&gt; f (PreviousEra era)
-&gt; Either () (f era)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
forall era (f :: * -&gt; *).
TranslateEra era f =&gt;
TranslationContext era
-&gt; f (PreviousEra era) -&gt; Except (TranslationError era f) (f era)
</span><a href="Cardano.Ledger.Era.html#translateEra"><span class="hs-identifier hs-var">translateEra</span></a></span><span> </span><span class="annot"><span class="annottext">TranslationContext era
</span><a href="#local-6989586621679247025"><span class="hs-identifier hs-var">ctxt</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- ==========================================================</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- WellFormed-ness</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- ==========================================================</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | All Well Formed Eras have this minimal structure.</span><span>
</span><span id="line-290"></span><span class="hs-keyword">type</span><span> </span><span id="WellFormed"><span class="annot"><a href="Cardano.Ledger.Era.html#WellFormed"><span class="hs-identifier hs-var">WellFormed</span></a></span></span><span> </span><span id="local-6989586621679247023"><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- TxBody</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;outputs&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier hs-type">StrictSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;txfee&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Coin.html#Coin"><span class="hs-identifier hs-type">Coin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;minted&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;adHash&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.AuxiliaryData.html#AuxiliaryDataHash"><span class="hs-identifier hs-type">AuxiliaryDataHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-comment">-- Tx</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;wits&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Witnesses"><span class="hs-identifier hs-type">Core.Witnesses</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;auxiliaryData&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../strict-containers/html/src"><span class="hs-identifier hs-type">StrictMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#AuxiliaryData"><span class="hs-identifier hs-type">Core.AuxiliaryData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;txsize&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/integer-gmp-1.0.3.0/src"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;scriptWits&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Tx"><span class="hs-identifier hs-type">Core.Tx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../containers/html/src"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Hashes.html#ScriptHash"><span class="hs-identifier hs-type">ScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Script"><span class="hs-identifier hs-type">Core.Script</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- TxOut</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">HasField</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxOut"><span class="hs-identifier hs-type">Core.TxOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- HashAnnotated</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html#HashAnnotated"><span class="hs-identifier hs-type">HashAnnotated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#AuxiliaryData"><span class="hs-identifier hs-type">Core.AuxiliaryData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentAuxiliaryData"><span class="hs-identifier hs-type">EraIndependentAuxiliaryData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.SafeHash.html#HashAnnotated"><span class="hs-identifier hs-type">HashAnnotated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#TxBody"><span class="hs-identifier hs-type">Core.TxBody</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Cardano.Ledger.Hashes.html#EraIndependentTxBody"><span class="hs-identifier hs-type">EraIndependentTxBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Era.html#Crypto"><span class="hs-identifier hs-type">Crypto</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Era.html#SupportsSegWit"><span class="hs-identifier hs-type">SupportsSegWit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-308"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Val.html#Val"><span class="hs-identifier hs-type">Val</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><a href="Cardano.Ledger.Compactible.html#Compactible"><span class="hs-identifier hs-type">Compactible</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Ledger.Core.html#Value"><span class="hs-identifier hs-type">Core.Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679247023"><span class="hs-identifier hs-type">era</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TxOut stores a CompactForm(Core.Value)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="hs-comment">{-  TODO, there are a few other constraints which are WellFormed and we should add
them when time permits. Some are not added because the types they mentions reside
in files that cause circular import dependencies.
   -- import Cardano.Ledger.Shelley.TxBody(DCert,Wdrl,WitVKey)
   -- import Cardano.Ledger.Shelley.Tx(TxIn)
These would have to be moved into a module such as Cardano.Ledger.TxBase(TxIn,DCert,Wdrl)
   -- HasField &quot;inputs&quot; (Core.TxBody era) (Set (TxIn (Crypto era))),       -- all possible inputs
   -- HasField &quot;txinputs_fee&quot; (Core.TxBody era) (Set (TxIn (Crypto era)))  -- inputs that can be used to pay fees
   -- HasField &quot;certs&quot; (Core.TxBody era) (StrictSeq (DCert (Crypto era))),
   -- HasField &quot;wdrls&quot; (Core.TxBody era) (Wdrl (Crypto era)),
   -- HasField &quot;addrWits&quot; (Core.Tx era) (Set (WitVKey 'Witness (Crypto era)))
others where the concrete type (Update and WitnessSet) will have to be made into a type family
   -- import Cardano.Ledger.Shelley.PParams (Update)
   -- import Cardano.Ledger.Shelley.Tx(WitnessSet)
   -- import Cardano.Ledger.Alonzo.Scripts (ExUnits)
   -- HasField &quot;update&quot; (Core.TxBody era) (StrictMaybe (Update era)),
   -- HasField &quot;wits&quot; (Core.Tx era) (WitnessSet era),
   -- HasField &quot;exUnits&quot; (Core.Tx era) ExUnits,
-}</span><span>
</span><span id="line-331"></span></pre></body></html>