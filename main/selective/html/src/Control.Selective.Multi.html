<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveFunctor, GADTs, RankNTypes, TupleSections, TypeOperators #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables, LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module     : Control.Selective.Multi</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright  : (c) Andrey Mokhov 2018-2023</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License    : MIT (see the file LICENSE)</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer : andrey.mokhov@gmail.com</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability  : experimental</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- This is a library for /selective applicative functors/, or just</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- /selective functors/ for short, an abstraction between applicative functors</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- and monads, introduced in this paper:</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- https://www.staff.ncl.ac.uk/andrey.mokhov/selective-functors.pdf.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- This module defines /multi-way selective functors/, which are more efficient</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- when selecting from a large number of options. They also fully subsume the</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- 'Applicative' type class because they allow to express the notion of</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- independet effects.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- This definition is inspired by the following construction by Daniel Peebles,</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- with the main difference being the added @Enumerable@ constraint:</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- https://gist.github.com/copumpkin/d5bdbc7afda54ff04049b6bdbcffb67e</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control.Selective.Multi</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generalised sum types</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier">inject</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Zero"><span class="hs-identifier">Zero</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier">One</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier">Two</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier">Many</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#many"><span class="hs-identifier">many</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#matchPure"><span class="hs-identifier">matchPure</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#eitherToSigma"><span class="hs-identifier">eitherToSigma</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#sigmaToEither"><span class="hs-identifier">sigmaToEither</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Selective functors</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier">Enumerable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier">Over</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier">Under</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#select"><span class="hs-identifier">select</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#branch"><span class="hs-identifier">branch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#apS"><span class="hs-identifier">apS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#bindS"><span class="hs-identifier">bindS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Applicative functors</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#ApplicativeS"><span class="hs-identifier">ApplicativeS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#ap"><span class="hs-identifier">ap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#matchA"><span class="hs-identifier">matchA</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Monads</span></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#MonadS"><span class="hs-identifier">MonadS</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#bind"><span class="hs-identifier">bind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#matchM"><span class="hs-identifier">matchM</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Generalised products and various combinators</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator">(~&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier">Pi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#project"><span class="hs-identifier">project</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#identity"><span class="hs-identifier">identity</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#compose"><span class="hs-identifier">compose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#apply"><span class="hs-identifier">apply</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#toSigma"><span class="hs-identifier">toSigma</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#fromSigma"><span class="hs-identifier">fromSigma</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#toPi"><span class="hs-identifier">toPi</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#fromPi"><span class="hs-identifier">fromPi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#pairToPi"><span class="hs-identifier">pairToPi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#piToPair"><span class="hs-identifier">piToPair</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Case"><span class="hs-identifier">Case</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#matchCases"><span class="hs-identifier">matchCases</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(&lt;**&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Functor.Identity</span></a></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">------------------------ Meet two friends: Sigma and Pi ------------------------</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | A generalised sum type where @t@ stands for the type of constructor &quot;tags&quot;.</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- Each tag has a type parameter @x@ which determines the type of the payload.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- A 'Sigma' @t@ value therefore contains a payload whose type is not visible</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- externally but is revealed when pattern-matching on the tag.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- See 'Two', 'eitherToSigma' and 'sigmaToEither' for an example.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="Sigma"><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span></span><span> </span><span id="local-6989586621679061300"><span class="annot"><a href="#local-6989586621679061300"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>    </span><span id="local-6989586621679061299"><span id="local-6989586621679061557"><span id="Sigma"><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061557"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061299"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061299"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061557"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | An injection into a generalised sum. An alias for 'Sigma'.</span><span>
</span><span id="line-60"></span><span id="local-6989586621679061296"><span id="local-6989586621679061297"><span class="annot"><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-type">inject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061297"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061296"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061296"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061297"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-61"></span><span id="inject"><span class="annot"><span class="annottext">inject :: t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-var hs-var">inject</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t x -&gt; x -&gt; Sigma t
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">-- | A data type defining no tags. Similar to 'Data.Void.Void' but parameterised.</span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="Zero"><span class="annot"><a href="Control.Selective.Multi.html#Zero"><span class="hs-identifier hs-var">Zero</span></a></span></span><span> </span><span id="local-6989586621679061295"><span class="annot"><a href="#local-6989586621679061295"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | A data type with a single tag. This data type is commonly known as @Refl@,</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- see &quot;Data.Type.Equality&quot;.</span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="One"><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span></span><span> </span><span id="local-6989586621679061294"><span class="annot"><a href="#local-6989586621679061294"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679061293"><span class="annot"><a href="#local-6989586621679061293"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>    </span><span id="local-6989586621679061526"><span id="One"><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061526"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | A data type with two tags 'A' and 'B' that allows us to encode the good old</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- 'Either' as 'Sigma' 'Two', where the tags 'A' and 'B' correspond to 'Left'</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- and 'Right', respectively. See 'eitherToSigma' and 'sigmaToEither' that</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- witness the isomorphism between 'Either' @a b@ and 'Sigma' @(@'Two'@ a b)@.</span><span>
</span><span id="line-75"></span><span class="hs-keyword">data</span><span> </span><span id="Two"><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-var">Two</span></a></span></span><span> </span><span id="local-6989586621679061291"><span class="annot"><a href="#local-6989586621679061291"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679061290"><span class="annot"><a href="#local-6989586621679061290"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679061289"><span class="annot"><a href="#local-6989586621679061289"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>    </span><span id="local-6989586621679061551"><span id="local-6989586621679061552"><span id="A"><span class="annot"><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061551"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061552"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-77"></span><span>    </span><span id="local-6989586621679061549"><span id="local-6989586621679061550"><span id="B"><span class="annot"><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061550"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061549"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061549"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | Encode 'Either' into a generalised sum type.</span><span>
</span><span id="line-80"></span><span id="local-6989586621679061512"><span id="local-6989586621679061513"><span class="annot"><a href="Control.Selective.Multi.html#eitherToSigma"><span class="hs-identifier hs-type">eitherToSigma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061512"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061512"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-81"></span><span id="eitherToSigma"><span class="annot"><span class="annottext">eitherToSigma :: Either a b -&gt; Sigma (Two a b)
</span><a href="Control.Selective.Multi.html#eitherToSigma"><span class="hs-identifier hs-var hs-var">eitherToSigma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-82"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span>  </span><span id="local-6989586621679061286"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Two a b a -&gt; a -&gt; Sigma (Two a b)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b a
forall a b. Two a b a
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061286"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679061285"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Two a b b -&gt; b -&gt; Sigma (Two a b)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b b
forall a b. Two a b b
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061285"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Decode 'Either' from a generalised sum type.</span><span>
</span><span id="line-86"></span><span id="local-6989586621679061283"><span id="local-6989586621679061284"><span class="annot"><a href="Control.Selective.Multi.html#sigmaToEither"><span class="hs-identifier hs-type">sigmaToEither</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061284"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061283"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061284"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061283"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-87"></span><span id="sigmaToEither"><span class="annot"><span class="annottext">sigmaToEither :: Sigma (Two a b) -&gt; Either a b
</span><a href="Control.Selective.Multi.html#sigmaToEither"><span class="hs-identifier hs-var hs-var">sigmaToEither</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span id="local-6989586621679061282"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061282"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; Either x b
forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span>  </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061282"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span id="local-6989586621679061281"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061281"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; Either a x
forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061281"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | A potentially uncountable collection of tags for the same unit @()@ payload.</span><span>
</span><span id="line-92"></span><span class="hs-keyword">data</span><span> </span><span id="Many"><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-var">Many</span></a></span></span><span> </span><span id="local-6989586621679061280"><span class="annot"><a href="#local-6989586621679061280"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679061279"><span class="annot"><a href="#local-6989586621679061279"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>    </span><span id="local-6989586621679061540"><span id="Many"><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-var">Many</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621679061489"><span class="annot"><a href="Control.Selective.Multi.html#many"><span class="hs-identifier hs-type">many</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061489"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-96"></span><span id="many"><span class="annot"><span class="annottext">many :: a -&gt; Sigma (Many a)
</span><a href="Control.Selective.Multi.html#many"><span class="hs-identifier hs-var hs-var">many</span></a></span></span><span> </span><span id="local-6989586621679061277"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061277"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Many a () -&gt; () -&gt; Sigma (Many a)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Many a ()
forall a. a -&gt; Many a ()
</span><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061277"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Generalised pattern matching on a Sigma type using a Pi type to describe</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- how to handle each case.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- This is a specialisation of 'matchCases' for @f = Identity@. We could also</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- have also given it the following type:</span><span>
</span><span id="line-103"></span><span class="hs-comment">--</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- matchPure :: Sigma t -&gt; (t ~&gt; Case Identity a) -&gt; a</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- We chose to simplify it by inlining '~&gt;', 'Case' and 'Identity'.</span><span>
</span><span id="line-109"></span><span id="local-6989586621679061275"><span id="local-6989586621679061276"><span class="annot"><a href="Control.Selective.Multi.html#matchPure"><span class="hs-identifier hs-type">matchPure</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061276"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061538"><span class="annot"><a href="#local-6989586621679061538"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061276"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061538"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061538"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061275"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061275"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-110"></span><span id="matchPure"><span class="annot"><span class="annottext">matchPure :: Sigma t -&gt; (forall x. t x -&gt; x -&gt; a) -&gt; a
</span><a href="Control.Selective.Multi.html#matchPure"><span class="hs-identifier hs-var hs-var">matchPure</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span id="local-6989586621679061274"><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679061273"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061272"><span class="annot"><span class="annottext">forall x. t x -&gt; x -&gt; a
</span><a href="#local-6989586621679061272"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t x -&gt; x -&gt; a
forall x. t x -&gt; x -&gt; a
</span><a href="#local-6989586621679061272"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061274"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061273"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">------------------------- Mutli-way selective functors -------------------------</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Hide the type of the payload a tag.</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- There is a whole library dedicated to this nice little GADT:</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- http://hackage.haskell.org/package/some.</span><span>
</span><span id="line-117"></span><span class="hs-keyword">data</span><span> </span><span id="Some"><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span></span><span> </span><span id="local-6989586621679061271"><span class="annot"><a href="#local-6989586621679061271"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>    </span><span id="local-6989586621679061270"><span id="local-6989586621679061528"><span id="Some"><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061528"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061270"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061528"><span class="hs-identifier hs-type">t</span></a></span></span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | A class of tags that can be enumerated.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- A valid instance must list every tag in the resulting list exactly once.</span><span>
</span><span id="line-123"></span><span class="hs-keyword">class</span><span> </span><span id="Enumerable"><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-var">Enumerable</span></a></span></span><span> </span><span id="local-6989586621679061532"><span class="annot"><a href="#local-6989586621679061532"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>    </span><span id="enumerate"><span class="annot"><a href="Control.Selective.Multi.html#enumerate"><span class="hs-identifier hs-type">enumerate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061532"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-type">Enumerable</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Zero"><span class="hs-identifier hs-type">Zero</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679061265"><span class="annot"><span class="annottext">enumerate :: [Some Zero]
</span><a href="#local-6989586621679061265"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span id="local-6989586621679061264"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-type">Enumerable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061264"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679061262"><span class="annot"><span class="annottext">enumerate :: [Some (One a)]
</span><a href="#local-6989586621679061262"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">One a a -&gt; Some (One a)
forall (t :: * -&gt; *) a. t a -&gt; Some t
</span><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">One a a
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679061260"><span id="local-6989586621679061261"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-type">Enumerable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061261"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061260"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679061258"><span class="annot"><span class="annottext">enumerate :: [Some (Two a b)]
</span><a href="#local-6989586621679061258"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Two a b a -&gt; Some (Two a b)
forall (t :: * -&gt; *) a. t a -&gt; Some t
</span><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b a
forall a b. Two a b a
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Two a b b -&gt; Some (Two a b)
forall (t :: * -&gt; *) a. t a -&gt; Some t
</span><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b b
forall a b. Two a b b
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span id="local-6989586621679061257"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061257"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-type">Enumerable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061257"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-136"></span><span>    </span><span id="local-6989586621679061255"><span class="annot"><span class="annottext">enumerate :: [Some (Many a)]
</span><a href="#local-6989586621679061255"><span class="hs-identifier hs-var hs-var hs-var hs-var">enumerate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Many a () -&gt; Some (Many a)
forall (t :: * -&gt; *) a. t a -&gt; Some t
</span><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-var">Some</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Many a ()
forall a. a -&gt; Many a ()
</span><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-var">Many</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061254"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679061254"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061254"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Enum a =&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">enumFrom</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a
forall a. Enum a =&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toEnum</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Multi-way selective functors. Given a computation that produces a value of</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- a sum type, we can 'match' it to the corresponding computation in a given</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- product type.</span><span>
</span><span id="line-141"></span><span class="hs-comment">--</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- For greater similarity with 'matchCases', we could have given the following</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- type to 'match':</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- match :: f (Sigma t) -&gt; (t ~&gt; Case f a) -&gt; f a</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- We chose to simplify it by inlining '~&gt;' and 'Case'.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061517"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Selective"><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-var">Selective</span></a></span></span><span> </span><span id="local-6989586621679061517"><span class="annot"><a href="#local-6989586621679061517"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679061514"><span id="local-6989586621679061515"><span id="match"><span class="annot"><a href="Control.Selective.Multi.html#match"><span class="hs-identifier hs-type">match</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Enumerable"><span class="hs-identifier hs-type">Enumerable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061515"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061517"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061515"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061518"><span class="annot"><a href="#local-6989586621679061518"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061515"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061518"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061517"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061518"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061517"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061514"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | The basic &quot;if-then&quot; selection primitive from &quot;Control.Selective&quot;.</span><span>
</span><span id="line-154"></span><span id="local-6989586621679061249"><span id="local-6989586621679061250"><span id="local-6989586621679061251"><span class="annot"><a href="Control.Selective.Multi.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061249"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061250"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061249"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061251"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061249"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-155"></span><span id="select"><span class="annot"><span class="annottext">select :: f (Either a b) -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.Multi.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span id="local-6989586621679061248"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679061248"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061247"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679061247"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (Two a b)) -&gt; (forall x. Two a b x -&gt; f (x -&gt; b)) -&gt; f b
forall (f :: * -&gt; *) (t :: * -&gt; *) a.
(Selective f, Enumerable t) =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either a b -&gt; Sigma (Two a b)
forall a b. Either a b -&gt; Sigma (Two a b)
</span><a href="Control.Selective.Multi.html#eitherToSigma"><span class="hs-identifier hs-var">eitherToSigma</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Sigma (Two a b))
-&gt; f (Either a b) -&gt; f (Sigma (Two a b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679061248"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall x. Two a b x -&gt; f (x -&gt; b)) -&gt; f b)
-&gt; (forall x. Two a b x -&gt; f (x -&gt; b)) -&gt; f b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
f (x -&gt; b)
</span><a href="#local-6989586621679061247"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(x -&gt; x) -&gt; f (x -&gt; x)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Choose a matching effect with 'Either'.</span><span>
</span><span id="line-160"></span><span id="local-6989586621679061241"><span id="local-6989586621679061242"><span id="local-6989586621679061243"><span id="local-6989586621679061244"><span class="annot"><a href="Control.Selective.Multi.html#branch"><span class="hs-identifier hs-type">branch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061242"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061242"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061244"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061241"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-161"></span><span id="branch"><span class="annot"><span class="annottext">branch :: f (Either a b) -&gt; f (a -&gt; c) -&gt; f (b -&gt; c) -&gt; f c
</span><a href="Control.Selective.Multi.html#branch"><span class="hs-identifier hs-var hs-var">branch</span></a></span></span><span> </span><span id="local-6989586621679061240"><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679061240"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061239"><span class="annot"><span class="annottext">f (a -&gt; c)
</span><a href="#local-6989586621679061239"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061238"><span class="annot"><span class="annottext">f (b -&gt; c)
</span><a href="#local-6989586621679061238"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (Two a b)) -&gt; (forall x. Two a b x -&gt; f (x -&gt; c)) -&gt; f c
forall (f :: * -&gt; *) (t :: * -&gt; *) a.
(Selective f, Enumerable t) =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either a b -&gt; Sigma (Two a b)
forall a b. Either a b -&gt; Sigma (Two a b)
</span><a href="Control.Selective.Multi.html#eitherToSigma"><span class="hs-identifier hs-var">eitherToSigma</span></a></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Sigma (Two a b))
-&gt; f (Either a b) -&gt; f (Sigma (Two a b))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f (Either a b)
</span><a href="#local-6989586621679061240"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((forall x. Two a b x -&gt; f (x -&gt; c)) -&gt; f c)
-&gt; (forall x. Two a b x -&gt; f (x -&gt; c)) -&gt; f c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; c)
f (x -&gt; c)
</span><a href="#local-6989586621679061239"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (b -&gt; c)
f (x -&gt; c)
</span><a href="#local-6989586621679061238"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Recover the application operator '&lt;*&gt;' from 'match'.</span><span>
</span><span id="line-166"></span><span id="local-6989586621679061235"><span id="local-6989586621679061236"><span id="local-6989586621679061237"><span class="annot"><a href="Control.Selective.Multi.html#apS"><span class="hs-identifier hs-type">apS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061236"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061237"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061235"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-167"></span><span id="apS"><span class="annot"><span class="annottext">apS :: f a -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.Multi.html#apS"><span class="hs-identifier hs-var hs-var">apS</span></a></span></span><span> </span><span id="local-6989586621679061234"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061234"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061233"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679061233"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (One a)) -&gt; (forall x. One a x -&gt; f (x -&gt; b)) -&gt; f b
forall (f :: * -&gt; *) (t :: * -&gt; *) a.
(Selective f, Enumerable t) =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">One a a -&gt; a -&gt; Sigma (One a)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">One a a
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Sigma (One a)) -&gt; f a -&gt; f (Sigma (One a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061234"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">One a x
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
f (x -&gt; b)
</span><a href="#local-6989586621679061233"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | A restricted version of monadic bind.</span><span>
</span><span id="line-170"></span><span id="local-6989586621679061230"><span id="local-6989586621679061231"><span id="local-6989586621679061232"><span class="annot"><a href="Control.Selective.Multi.html#bindS"><span class="hs-identifier hs-type">bindS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Enum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061232"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061232"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061230"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061231"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061230"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-171"></span><span id="bindS"><span class="annot"><span class="annottext">bindS :: f a -&gt; (a -&gt; f b) -&gt; f b
</span><a href="Control.Selective.Multi.html#bindS"><span class="hs-identifier hs-var hs-var">bindS</span></a></span></span><span> </span><span id="local-6989586621679061229"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061229"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061228"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (Many a)) -&gt; (forall x. Many a x -&gt; f (x -&gt; b)) -&gt; f b
forall (f :: * -&gt; *) (t :: * -&gt; *) a.
(Selective f, Enumerable t) =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#match"><span class="hs-identifier hs-var">match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sigma (Many a)
forall a. a -&gt; Sigma (Many a)
</span><a href="Control.Selective.Multi.html#many"><span class="hs-identifier hs-var">many</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Sigma (Many a)) -&gt; f a -&gt; f (Sigma (Many a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061229"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679061227"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061227"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; x -&gt; b
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; x -&gt; b) -&gt; f b -&gt; f (x -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679061228"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061227"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Static analysis of selective functors with over-approximation.</span><span>
</span><span id="line-174"></span><span class="hs-keyword">newtype</span><span> </span><span id="Over"><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-var">Over</span></a></span></span><span> </span><span id="local-6989586621679061443"><span class="annot"><a href="#local-6989586621679061443"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679061442"><span class="annot"><a href="#local-6989586621679061442"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Over"><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-var">Over</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getOver"><span class="annot"><span class="annottext">Over m a -&gt; m
</span><a href="Control.Selective.Multi.html#getOver"><span class="hs-identifier hs-var hs-var">getOver</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061443"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061220"><span id="local-6989586621679061222"><span class="annot"><span class="annottext">Over m a -&gt; Over m a -&gt; Bool
(Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool) -&gt; Eq (Over m a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
/= :: Over m a -&gt; Over m a -&gt; Bool
$c/= :: forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
== :: Over m a -&gt; Over m a -&gt; Bool
$c== :: forall m a. Eq m =&gt; Over m a -&gt; Over m a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061215"><span id="local-6989586621679061217"><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Over m a -&gt; Over m b
(forall a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b)
-&gt; (forall a b. a -&gt; Over m b -&gt; Over m a) -&gt; Functor (Over m)
forall a b. a -&gt; Over m b -&gt; Over m a
forall a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall m a b. a -&gt; Over m b -&gt; Over m a
forall m a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Over m b -&gt; Over m a
$c&lt;$ :: forall m a b. a -&gt; Over m b -&gt; Over m a
fmap :: (a -&gt; b) -&gt; Over m a -&gt; Over m b
$cfmap :: forall m a b. (a -&gt; b) -&gt; Over m a -&gt; Over m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061199"><span id="local-6989586621679061201"><span id="local-6989586621679061203"><span id="local-6989586621679061205"><span id="local-6989586621679061207"><span id="local-6989586621679061209"><span id="local-6989586621679061211"><span class="annot"><span class="annottext">Eq (Over m a)
Eq (Over m a)
-&gt; (Over m a -&gt; Over m a -&gt; Ordering)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Bool)
-&gt; (Over m a -&gt; Over m a -&gt; Over m a)
-&gt; (Over m a -&gt; Over m a -&gt; Over m a)
-&gt; Ord (Over m a)
Over m a -&gt; Over m a -&gt; Bool
Over m a -&gt; Over m a -&gt; Ordering
Over m a -&gt; Over m a -&gt; Over m a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall m a. Ord m =&gt; Eq (Over m a)
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Ordering
forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
min :: Over m a -&gt; Over m a -&gt; Over m a
$cmin :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
max :: Over m a -&gt; Over m a -&gt; Over m a
$cmax :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Over m a
&gt;= :: Over m a -&gt; Over m a -&gt; Bool
$c&gt;= :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&gt; :: Over m a -&gt; Over m a -&gt; Bool
$c&gt; :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&lt;= :: Over m a -&gt; Over m a -&gt; Bool
$c&lt;= :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
&lt; :: Over m a -&gt; Over m a -&gt; Bool
$c&lt; :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Bool
compare :: Over m a -&gt; Over m a -&gt; Ordering
$ccompare :: forall m a. Ord m =&gt; Over m a -&gt; Over m a -&gt; Ordering
$cp1Ord :: forall m a. Ord m =&gt; Eq (Over m a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061192"><span id="local-6989586621679061194"><span id="local-6989586621679061196"><span class="annot"><span class="annottext">Int -&gt; Over m a -&gt; ShowS
[Over m a] -&gt; ShowS
Over m a -&gt; String
(Int -&gt; Over m a -&gt; ShowS)
-&gt; (Over m a -&gt; String) -&gt; ([Over m a] -&gt; ShowS) -&gt; Show (Over m a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall m a. Show m =&gt; Int -&gt; Over m a -&gt; ShowS
forall m a. Show m =&gt; [Over m a] -&gt; ShowS
forall m a. Show m =&gt; Over m a -&gt; String
showList :: [Over m a] -&gt; ShowS
$cshowList :: forall m a. Show m =&gt; [Over m a] -&gt; ShowS
show :: Over m a -&gt; String
$cshow :: forall m a. Show m =&gt; Over m a -&gt; String
showsPrec :: Int -&gt; Over m a -&gt; ShowS
$cshowsPrec :: forall m a. Show m =&gt; Int -&gt; Over m a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679061190"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061181"><span id="local-6989586621679061183"><span id="local-6989586621679061185"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061190"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061190"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679061179"><span class="annot"><span class="annottext">pure :: a -&gt; Over m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Over m a
forall m a. m -&gt; Over m a
</span><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-var">Over</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span id="local-6989586621679061178"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061178"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061177"><span class="annot"><span class="annottext">&lt;*&gt; :: Over m (a -&gt; b) -&gt; Over m a -&gt; Over m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></a></span></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span id="local-6989586621679061176"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061176"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Over m b
forall m a. m -&gt; Over m a
</span><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-var">Over</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061178"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061176"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span id="local-6989586621679061175"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061175"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061175"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679061171"><span class="annot"><span class="annottext">match :: Over m (Sigma t) -&gt; (forall x. t x -&gt; Over m (x -&gt; a)) -&gt; Over m a
</span><a href="#local-6989586621679061171"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-type">Over</span></a></span><span> </span><span id="local-6989586621679061170"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061170"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061169"><span class="annot"><span class="annottext">forall x. t x -&gt; Over m (x -&gt; a)
</span><a href="#local-6989586621679061169"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Over m a
forall m a. m -&gt; Over m a
</span><a href="Control.Selective.Multi.html#Over"><span class="hs-identifier hs-var">Over</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[m] -&gt; m
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061170"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">m -&gt; [m] -&gt; [m]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[m]
</span><a href="#local-6989586621679061168"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>        </span><span id="local-6989586621679061168"><span class="annot"><span class="annottext">ms :: [m]
</span><a href="#local-6989586621679061168"><span class="hs-identifier hs-var hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Over m (a -&gt; a) -&gt; m
forall m a. Over m a -&gt; m
</span><a href="Control.Selective.Multi.html#getOver"><span class="hs-identifier hs-var hs-var">getOver</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Over m (a -&gt; a)
forall x. t x -&gt; Over m (x -&gt; a)
</span><a href="#local-6989586621679061169"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679061167"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Some"><span class="hs-identifier hs-type">Some</span></a></span><span> </span><span id="local-6989586621679061167"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679061167"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Some t]
forall (t :: * -&gt; *). Enumerable t =&gt; [Some t]
</span><a href="Control.Selective.Multi.html#enumerate"><span class="hs-identifier hs-var">enumerate</span></a></span><span> </span><span class="hs-special">]</span></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- | Static analysis of selective functors with under-approximation.</span><span>
</span><span id="line-187"></span><span class="hs-keyword">newtype</span><span> </span><span id="Under"><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-var">Under</span></a></span></span><span> </span><span id="local-6989586621679061411"><span class="annot"><a href="#local-6989586621679061411"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679061410"><span class="annot"><a href="#local-6989586621679061410"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Under"><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-var">Under</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="getUnder"><span class="annot"><span class="annottext">Under m a -&gt; m
</span><a href="Control.Selective.Multi.html#getUnder"><span class="hs-identifier hs-var hs-var">getUnder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061411"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061161"><span id="local-6989586621679061163"><span class="annot"><span class="annottext">Under m a -&gt; Under m a -&gt; Bool
(Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool) -&gt; Eq (Under m a)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
/= :: Under m a -&gt; Under m a -&gt; Bool
$c/= :: forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
== :: Under m a -&gt; Under m a -&gt; Bool
$c== :: forall m a. Eq m =&gt; Under m a -&gt; Under m a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061157"><span id="local-6989586621679061159"><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Under m a -&gt; Under m b
(forall a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b)
-&gt; (forall a b. a -&gt; Under m b -&gt; Under m a) -&gt; Functor (Under m)
forall a b. a -&gt; Under m b -&gt; Under m a
forall a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall m a b. a -&gt; Under m b -&gt; Under m a
forall m a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: a -&gt; Under m b -&gt; Under m a
$c&lt;$ :: forall m a b. a -&gt; Under m b -&gt; Under m a
fmap :: (a -&gt; b) -&gt; Under m a -&gt; Under m b
$cfmap :: forall m a b. (a -&gt; b) -&gt; Under m a -&gt; Under m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061142"><span id="local-6989586621679061144"><span id="local-6989586621679061146"><span id="local-6989586621679061148"><span id="local-6989586621679061150"><span id="local-6989586621679061152"><span id="local-6989586621679061154"><span class="annot"><span class="annottext">Eq (Under m a)
Eq (Under m a)
-&gt; (Under m a -&gt; Under m a -&gt; Ordering)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Bool)
-&gt; (Under m a -&gt; Under m a -&gt; Under m a)
-&gt; (Under m a -&gt; Under m a -&gt; Under m a)
-&gt; Ord (Under m a)
Under m a -&gt; Under m a -&gt; Bool
Under m a -&gt; Under m a -&gt; Ordering
Under m a -&gt; Under m a -&gt; Under m a
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall m a. Ord m =&gt; Eq (Under m a)
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Ordering
forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
min :: Under m a -&gt; Under m a -&gt; Under m a
$cmin :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
max :: Under m a -&gt; Under m a -&gt; Under m a
$cmax :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Under m a
&gt;= :: Under m a -&gt; Under m a -&gt; Bool
$c&gt;= :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&gt; :: Under m a -&gt; Under m a -&gt; Bool
$c&gt; :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&lt;= :: Under m a -&gt; Under m a -&gt; Bool
$c&lt;= :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
&lt; :: Under m a -&gt; Under m a -&gt; Bool
$c&lt; :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Bool
compare :: Under m a -&gt; Under m a -&gt; Ordering
$ccompare :: forall m a. Ord m =&gt; Under m a -&gt; Under m a -&gt; Ordering
$cp1Ord :: forall m a. Ord m =&gt; Eq (Under m a)
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061136"><span id="local-6989586621679061138"><span id="local-6989586621679061140"><span class="annot"><span class="annottext">Int -&gt; Under m a -&gt; ShowS
[Under m a] -&gt; ShowS
Under m a -&gt; String
(Int -&gt; Under m a -&gt; ShowS)
-&gt; (Under m a -&gt; String)
-&gt; ([Under m a] -&gt; ShowS)
-&gt; Show (Under m a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall m a. Show m =&gt; Int -&gt; Under m a -&gt; ShowS
forall m a. Show m =&gt; [Under m a] -&gt; ShowS
forall m a. Show m =&gt; Under m a -&gt; String
showList :: [Under m a] -&gt; ShowS
$cshowList :: forall m a. Show m =&gt; [Under m a] -&gt; ShowS
show :: Under m a -&gt; String
$cshow :: forall m a. Show m =&gt; Under m a -&gt; String
showsPrec :: Int -&gt; Under m a -&gt; ShowS
$cshowsPrec :: forall m a. Show m =&gt; Int -&gt; Under m a -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679061135"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679061126"><span id="local-6989586621679061128"><span id="local-6989586621679061130"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061135"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061135"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679061125"><span class="annot"><span class="annottext">pure :: a -&gt; Under m a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pure</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Under m a
forall m a. m -&gt; Under m a
</span><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-var">Under</span></a></span><span> </span><span class="annot"><span class="annottext">m
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span id="local-6989586621679061124"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061124"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061123"><span class="annot"><span class="annottext">&lt;*&gt; :: Under m (a -&gt; b) -&gt; Under m a -&gt; Under m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;*&gt;</span></a></span></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span id="local-6989586621679061122"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061122"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Under m b
forall m a. m -&gt; Under m a
</span><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-var">Under</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; m -&gt; m
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061124"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061122"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span id="local-6989586621679061121"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061121"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Selective"><span class="hs-identifier hs-type">Selective</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061121"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span id="local-6989586621679061118"><span class="annot"><span class="annottext">match :: Under m (Sigma t)
-&gt; (forall x. t x -&gt; Under m (x -&gt; a)) -&gt; Under m a
</span><a href="#local-6989586621679061118"><span class="hs-identifier hs-var hs-var hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-type">Under</span></a></span><span> </span><span id="local-6989586621679061117"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061117"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall x. t x -&gt; Under m (x -&gt; a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m -&gt; Under m a
forall m a. m -&gt; Under m a
</span><a href="Control.Selective.Multi.html#Under"><span class="hs-identifier hs-var">Under</span></a></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679061117"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | An alternative definition of applicative functors, as witnessed by 'ap' and</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- 'matchOne'. This class is almost like 'Selective' but has a strict constraint</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- on @t@.</span><span>
</span><span id="line-200"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="ApplicativeS"><span class="annot"><a href="Control.Selective.Multi.html#ApplicativeS"><span class="hs-identifier hs-var">ApplicativeS</span></a></span></span><span> </span><span id="local-6989586621679061400"><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621679061116"><span id="pureA"><span class="annot"><a href="Control.Selective.Multi.html#pureA"><span class="hs-identifier hs-type">pureA</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061116"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061116"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679061396"><span id="local-6989586621679061397"><span id="local-6989586621679061398"><span id="matchOne"><span class="annot"><a href="Control.Selective.Multi.html#matchOne"><span class="hs-identifier hs-type">matchOne</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061398"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061397"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061398"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061401"><span class="annot"><a href="#local-6989586621679061401"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061398"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061401"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061401"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061396"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061400"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061396"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Recover the application operator '&lt;*&gt;' from 'matchOne'.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679061111"><span id="local-6989586621679061112"><span id="local-6989586621679061113"><span class="annot"><a href="Control.Selective.Multi.html#ap"><span class="hs-identifier hs-type">ap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#ApplicativeS"><span class="hs-identifier hs-type">ApplicativeS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061113"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061113"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061112"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061113"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061112"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061111"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061113"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061111"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-206"></span><span id="ap"><span class="annot"><span class="annottext">ap :: f a -&gt; f (a -&gt; b) -&gt; f b
</span><a href="Control.Selective.Multi.html#ap"><span class="hs-identifier hs-var hs-var">ap</span></a></span></span><span> </span><span id="local-6989586621679061110"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061110"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061109"><span class="annot"><span class="annottext">f (a -&gt; b)
</span><a href="#local-6989586621679061109"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (One a)) -&gt; (forall x. One a x -&gt; f (x -&gt; b)) -&gt; f b
forall (f :: * -&gt; *) (t :: * -&gt; *) x a.
(ApplicativeS f, t ~ One x) =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#matchOne"><span class="hs-identifier hs-var">matchOne</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">One a a -&gt; a -&gt; Sigma (One a)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span><span> </span><span class="annot"><span class="annottext">One a a
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Sigma (One a)) -&gt; f a -&gt; f (Sigma (One a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061110"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">One a x
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f (a -&gt; b)
f (x -&gt; b)
</span><a href="#local-6989586621679061109"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Every 'Applicative' is also an 'ApplicativeS'.</span><span>
</span><span id="line-209"></span><span id="local-6989586621679061105"><span id="local-6989586621679061106"><span id="local-6989586621679061107"><span id="local-6989586621679061108"><span class="annot"><a href="Control.Selective.Multi.html#matchA"><span class="hs-identifier hs-type">matchA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061108"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061107"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">~</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061106"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061108"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061107"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061392"><span class="annot"><a href="#local-6989586621679061392"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061107"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061392"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061108"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061392"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061105"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061108"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061105"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span>
</span><span id="line-210"></span><span id="matchA"><span class="annot"><span class="annottext">matchA :: f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#matchA"><span class="hs-identifier hs-var hs-var">matchA</span></a></span></span><span> </span><span id="local-6989586621679061104"><span class="annot"><span class="annottext">f (Sigma t)
</span><a href="#local-6989586621679061104"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061103"><span class="annot"><span class="annottext">forall x. t x -&gt; f (x -&gt; a)
</span><a href="#local-6989586621679061103"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><span class="annottext">t x
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span id="local-6989586621679061102"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061102"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x
x
</span><a href="#local-6989586621679061102"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Sigma t -&gt; x) -&gt; f (Sigma t) -&gt; f x
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f (Sigma t)
</span><a href="#local-6989586621679061104"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">f x -&gt; f (x -&gt; a) -&gt; f a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f (a -&gt; b) -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;**&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t x -&gt; f (x -&gt; a)
forall x. t x -&gt; f (x -&gt; a)
</span><a href="#local-6989586621679061103"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t x
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- | An alternative definition of monads, as witnessed by 'bind' and 'matchM'.</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- This class is almost like 'Selective' but has no the constraint on @t@.</span><span>
</span><span id="line-214"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061381"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="MonadS"><span class="annot"><a href="Control.Selective.Multi.html#MonadS"><span class="hs-identifier hs-var">MonadS</span></a></span></span><span> </span><span id="local-6989586621679061381"><span class="annot"><a href="#local-6989586621679061381"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-215"></span><span>    </span><span id="local-6989586621679061378"><span id="local-6989586621679061379"><span id="matchUnconstrained"><span class="annot"><a href="Control.Selective.Multi.html#matchUnconstrained"><span class="hs-identifier hs-type">matchUnconstrained</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061381"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061379"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061382"><span class="annot"><a href="#local-6989586621679061382"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061379"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061382"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061381"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061382"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061378"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061381"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061378"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- Adapted from the original implementation by Daniel Peebles:</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- https://gist.github.com/copumpkin/d5bdbc7afda54ff04049b6bdbcffb67e</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Monadic bind.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679061098"><span id="local-6989586621679061099"><span id="local-6989586621679061100"><span class="annot"><a href="Control.Selective.Multi.html#bind"><span class="hs-identifier hs-type">bind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#MonadS"><span class="hs-identifier hs-type">MonadS</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061100"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061100"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061099"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061100"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061098"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061100"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061098"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-222"></span><span id="bind"><span class="annot"><span class="annottext">bind :: f a -&gt; (a -&gt; f b) -&gt; f b
</span><a href="Control.Selective.Multi.html#bind"><span class="hs-identifier hs-var hs-var">bind</span></a></span></span><span> </span><span id="local-6989586621679061097"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061097"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679061096"><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679061096"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma (Many a)) -&gt; (forall x. Many a x -&gt; f (x -&gt; b)) -&gt; f b
forall (f :: * -&gt; *) (t :: * -&gt; *) a.
MonadS f =&gt;
f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#matchUnconstrained"><span class="hs-identifier hs-var">matchUnconstrained</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Sigma (Many a)
forall a. a -&gt; Sigma (Many a)
</span><a href="Control.Selective.Multi.html#many"><span class="hs-identifier hs-var">many</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Sigma (Many a)) -&gt; f a -&gt; f (Sigma (Many a))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679061097"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Many"><span class="hs-identifier hs-type">Many</span></a></span><span> </span><span id="local-6989586621679061095"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061095"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; x -&gt; b
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(b -&gt; x -&gt; b) -&gt; f b -&gt; f (x -&gt; b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; f b
</span><a href="#local-6989586621679061096"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061095"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Every monad is a multi-way selective functor.</span><span>
</span><span id="line-225"></span><span id="local-6989586621679061092"><span id="local-6989586621679061093"><span id="local-6989586621679061094"><span class="annot"><a href="Control.Selective.Multi.html#matchM"><span class="hs-identifier hs-type">matchM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monad</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061093"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061374"><span class="annot"><a href="#local-6989586621679061374"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061093"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061374"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061374"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061092"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061094"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061092"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-226"></span><span id="matchM"><span class="annot"><span class="annottext">matchM :: f (Sigma t) -&gt; (forall x. t x -&gt; f (x -&gt; a)) -&gt; f a
</span><a href="Control.Selective.Multi.html#matchM"><span class="hs-identifier hs-var hs-var">matchM</span></a></span></span><span> </span><span id="local-6989586621679061091"><span class="annot"><span class="annottext">f (Sigma t)
</span><a href="#local-6989586621679061091"><span class="hs-identifier hs-var">sigma</span></a></span></span><span> </span><span id="local-6989586621679061090"><span class="annot"><span class="annottext">forall x. t x -&gt; f (x -&gt; a)
</span><a href="#local-6989586621679061090"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f (Sigma t)
</span><a href="#local-6989586621679061091"><span class="hs-identifier hs-var">sigma</span></a></span><span> </span><span class="annot"><span class="annottext">f (Sigma t) -&gt; (Sigma t -&gt; f a) -&gt; f a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span id="local-6989586621679061089"><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061089"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679061088"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061088"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; a) -&gt; x -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061088"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((x -&gt; a) -&gt; a) -&gt; f (x -&gt; a) -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">t x -&gt; f (x -&gt; a)
forall x. t x -&gt; f (x -&gt; a)
</span><a href="#local-6989586621679061090"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061089"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | A generalised product type (Pi), which holds an appropriately tagged</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- payload @u x@ for every possible tag @t x@.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- Note that this looks different than the standard formulation of Pi types.</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- Maybe it's just all wrong!</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- See 'Two', 'pairToPi' and 'piToPair' for an example.</span><span>
</span><span id="line-235"></span><span class="hs-keyword">type</span><span> </span><span id="~%3E"><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-var">(~&gt;)</span></a></span></span><span> </span><span id="local-6989586621679061087"><span class="annot"><a href="#local-6989586621679061087"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span id="local-6989586621679061086"><span class="annot"><a href="#local-6989586621679061086"><span class="hs-identifier hs-type">u</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679061085"><span class="annot"><a href="#local-6989586621679061085"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679061087"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061085"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061086"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061085"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-236"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | A product type where the payload has the type specified with the tag.</span><span>
</span><span id="line-239"></span><span class="hs-keyword">type</span><span> </span><span id="Pi"><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-var">Pi</span></a></span></span><span> </span><span id="local-6989586621679061084"><span class="annot"><a href="#local-6989586621679061084"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679061084"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Identity</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | A projection from a generalised product.</span><span>
</span><span id="line-242"></span><span id="local-6989586621679061342"><span id="local-6989586621679061343"><span class="annot"><a href="Control.Selective.Multi.html#project"><span class="hs-identifier hs-type">project</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061343"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061342"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061343"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061342"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-243"></span><span id="project"><span class="annot"><span class="annottext">project :: t a -&gt; Pi t -&gt; a
</span><a href="Control.Selective.Multi.html#project"><span class="hs-identifier hs-var hs-var">project</span></a></span></span><span> </span><span id="local-6989586621679061083"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679061083"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679061082"><span class="annot"><span class="annottext">Pi t
</span><a href="#local-6989586621679061082"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Identity a -&gt; a
forall a. Identity a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">runIdentity</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Identity a
Pi t
</span><a href="#local-6989586621679061082"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679061083"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | A trivial product type that stores nothing and simply returns the given tag</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- as the result.</span><span>
</span><span id="line-247"></span><span id="local-6989586621679061080"><span class="annot"><a href="Control.Selective.Multi.html#identity"><span class="hs-identifier hs-type">identity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061080"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061080"><span class="hs-identifier hs-type">t</span></a></span></span><span>
</span><span id="line-248"></span><span id="identity"><span class="annot"><span class="annottext">identity :: t x -&gt; t x
</span><a href="Control.Selective.Multi.html#identity"><span class="hs-identifier hs-var hs-var">identity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t x -&gt; t x
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | As it turns out, one can compose such generalised products. Why not: given</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- a tag, get the payload of the first product and then pass it as input to the</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- second. This feels too trivial to be useful but is still somewhat cute.</span><span>
</span><span id="line-253"></span><span id="local-6989586621679061077"><span id="local-6989586621679061078"><span id="local-6989586621679061079"><span class="annot"><a href="Control.Selective.Multi.html#compose"><span class="hs-identifier hs-type">compose</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061079"><span class="hs-identifier hs-type">u</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061078"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061077"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061079"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061077"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061078"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-254"></span><span id="compose"><span class="annot"><span class="annottext">compose :: (u ~&gt; v) -&gt; (t ~&gt; u) -&gt; t ~&gt; v
</span><a href="Control.Selective.Multi.html#compose"><span class="hs-identifier hs-var hs-var">compose</span></a></span></span><span> </span><span id="local-6989586621679061076"><span class="annot"><span class="annottext">u ~&gt; v
</span><a href="#local-6989586621679061076"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679061075"><span class="annot"><span class="annottext">t ~&gt; u
</span><a href="#local-6989586621679061075"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">u x -&gt; v x
u ~&gt; v
</span><a href="#local-6989586621679061076"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(u x -&gt; v x) -&gt; (t x -&gt; u x) -&gt; t x -&gt; v x
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">t x -&gt; u x
t ~&gt; u
</span><a href="#local-6989586621679061075"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Update a generalised sum given a generalised product that takes care of all</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- possible cases.</span><span>
</span><span id="line-258"></span><span id="local-6989586621679061072"><span id="local-6989586621679061073"><span class="annot"><a href="Control.Selective.Multi.html#apply"><span class="hs-identifier hs-type">apply</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061073"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061072"><span class="hs-identifier hs-type">u</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061073"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061072"><span class="hs-identifier hs-type">u</span></a></span></span></span><span>
</span><span id="line-259"></span><span id="apply"><span class="annot"><span class="annottext">apply :: (t ~&gt; u) -&gt; Sigma t -&gt; Sigma u
</span><a href="Control.Selective.Multi.html#apply"><span class="hs-identifier hs-var hs-var">apply</span></a></span></span><span> </span><span id="local-6989586621679061071"><span class="annot"><span class="annottext">t ~&gt; u
</span><a href="#local-6989586621679061071"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span id="local-6989586621679061070"><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061070"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679061069"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061069"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">u x -&gt; x -&gt; Sigma u
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-var">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t x -&gt; u x
t ~&gt; u
</span><a href="#local-6989586621679061071"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061070"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061069"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span class="hs-comment">-- | Encode a value into a generalised sum type that has a single tag 'One'.</span><span>
</span><span id="line-262"></span><span id="local-6989586621679061068"><span class="annot"><a href="Control.Selective.Multi.html#toSigma"><span class="hs-identifier hs-type">toSigma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061068"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061068"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-263"></span><span id="toSigma"><span class="annot"><span class="annottext">toSigma :: a -&gt; Sigma (One a)
</span><a href="Control.Selective.Multi.html#toSigma"><span class="hs-identifier hs-var hs-var">toSigma</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">One a a -&gt; a -&gt; Sigma (One a)
forall (t :: * -&gt; *) x. t x -&gt; x -&gt; Sigma t
</span><a href="Control.Selective.Multi.html#inject"><span class="hs-identifier hs-var">inject</span></a></span><span> </span><span class="annot"><span class="annottext">One a a
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Decode a value from a generalised sum type that has a single tag 'One'.</span><span>
</span><span id="line-266"></span><span id="local-6989586621679061067"><span class="annot"><a href="Control.Selective.Multi.html#fromSigma"><span class="hs-identifier hs-type">fromSigma</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061067"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061067"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-267"></span><span id="fromSigma"><span class="annot"><span class="annottext">fromSigma :: Sigma (One a) -&gt; a
</span><a href="Control.Selective.Multi.html#fromSigma"><span class="hs-identifier hs-var hs-var">fromSigma</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><span class="annottext">One a x
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span id="local-6989586621679061066"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
x
</span><a href="#local-6989586621679061066"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Encode a value into a generalised product type that has a single tag 'One'.</span><span>
</span><span id="line-270"></span><span id="local-6989586621679061065"><span class="annot"><a href="Control.Selective.Multi.html#toPi"><span class="hs-identifier hs-type">toPi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061065"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061065"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-271"></span><span id="toPi"><span class="annot"><span class="annottext">toPi :: a -&gt; Pi (One a)
</span><a href="Control.Selective.Multi.html#toPi"><span class="hs-identifier hs-var hs-var">toPi</span></a></span></span><span> </span><span id="local-6989586621679061064"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">One a x
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061064"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | Decode a value from a generalised product type that has a single tag 'One'.</span><span>
</span><span id="line-274"></span><span id="local-6989586621679061062"><span class="annot"><a href="Control.Selective.Multi.html#fromPi"><span class="hs-identifier hs-type">fromPi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-type">One</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061062"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-275"></span><span id="fromPi"><span class="annot"><span class="annottext">fromPi :: Pi (One a) -&gt; a
</span><a href="Control.Selective.Multi.html#fromPi"><span class="hs-identifier hs-var hs-var">fromPi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">One a a -&gt; Pi (One a) -&gt; a
forall (t :: * -&gt; *) a. t a -&gt; Pi t -&gt; a
</span><a href="Control.Selective.Multi.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">One a a
forall a. One a a
</span><a href="Control.Selective.Multi.html#One"><span class="hs-identifier hs-var">One</span></a></span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span class="hs-comment">-- | Encode @(a, b)@ into a generalised product type.</span><span>
</span><span id="line-278"></span><span id="local-6989586621679061060"><span id="local-6989586621679061061"><span class="annot"><a href="Control.Selective.Multi.html#pairToPi"><span class="hs-identifier hs-type">pairToPi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061061"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061060"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061061"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061060"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-279"></span><span id="pairToPi"><span class="annot"><span class="annottext">pairToPi :: (a, b) -&gt; Pi (Two a b)
</span><a href="Control.Selective.Multi.html#pairToPi"><span class="hs-identifier hs-var hs-var">pairToPi</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679061059"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061059"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679061058"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061058"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679061059"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">Two a b x
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Identity b
forall a. a -&gt; Identity a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Identity</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679061058"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Decode @(a, b)@ from a generalised product type.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679061056"><span id="local-6989586621679061057"><span class="annot"><a href="Control.Selective.Multi.html#piToPair"><span class="hs-identifier hs-type">piToPair</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Pi"><span class="hs-identifier hs-type">Pi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Two"><span class="hs-identifier hs-type">Two</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061056"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679061056"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-285"></span><span id="piToPair"><span class="annot"><span class="annottext">piToPair :: Pi (Two a b) -&gt; (a, b)
</span><a href="Control.Selective.Multi.html#piToPair"><span class="hs-identifier hs-var hs-var">piToPair</span></a></span></span><span> </span><span id="local-6989586621679061055"><span class="annot"><span class="annottext">Pi (Two a b)
</span><a href="#local-6989586621679061055"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Two a b a -&gt; Pi (Two a b) -&gt; a
forall (t :: * -&gt; *) a. t a -&gt; Pi t -&gt; a
</span><a href="Control.Selective.Multi.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b a
forall a b. Two a b a
</span><a href="Control.Selective.Multi.html#A"><span class="hs-identifier hs-var">A</span></a></span><span> </span><span class="annot"><span class="annottext">Pi (Two a b)
</span><a href="#local-6989586621679061055"><span class="hs-identifier hs-var">pi</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Two a b b -&gt; Pi (Two a b) -&gt; b
forall (t :: * -&gt; *) a. t a -&gt; Pi t -&gt; a
</span><a href="Control.Selective.Multi.html#project"><span class="hs-identifier hs-var">project</span></a></span><span> </span><span class="annot"><span class="annottext">Two a b b
forall a b. Two a b b
</span><a href="Control.Selective.Multi.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="annot"><span class="annottext">Pi (Two a b)
</span><a href="#local-6989586621679061055"><span class="hs-identifier hs-var">pi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="hs-comment">-- | Handler of a single case in a generalised pattern matching 'matchCases'.</span><span>
</span><span id="line-288"></span><span class="hs-keyword">newtype</span><span> </span><span id="Case"><span class="annot"><a href="Control.Selective.Multi.html#Case"><span class="hs-identifier hs-var">Case</span></a></span></span><span> </span><span id="local-6989586621679061328"><span class="annot"><a href="#local-6989586621679061328"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679061327"><span class="annot"><a href="#local-6989586621679061327"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679061326"><span class="annot"><a href="#local-6989586621679061326"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Case"><span class="annot"><a href="Control.Selective.Multi.html#Case"><span class="hs-identifier hs-var">Case</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="handleCase"><span class="annot"><span class="annottext">Case f a x -&gt; f (x -&gt; a)
</span><a href="Control.Selective.Multi.html#handleCase"><span class="hs-identifier hs-var hs-var">handleCase</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679061328"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061326"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061327"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Generalised pattern matching on a Sigma type using a Pi type to describe</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- how to handle each case.</span><span>
</span><span id="line-292"></span><span id="local-6989586621679061050"><span id="local-6989586621679061051"><span id="local-6989586621679061052"><span class="annot"><a href="Control.Selective.Multi.html#matchCases"><span class="hs-identifier hs-type">matchCases</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Functor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061052"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061051"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679061051"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#~%3E"><span class="hs-operator hs-type">~&gt;</span></a></span><span> </span><span class="annot"><a href="Control.Selective.Multi.html#Case"><span class="hs-identifier hs-type">Case</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061052"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061050"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679061052"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679061050"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-293"></span><span id="matchCases"><span class="annot"><span class="annottext">matchCases :: Sigma t -&gt; (t ~&gt; Case f a) -&gt; f a
</span><a href="Control.Selective.Multi.html#matchCases"><span class="hs-identifier hs-var hs-var">matchCases</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Control.Selective.Multi.html#Sigma"><span class="hs-identifier hs-type">Sigma</span></a></span><span> </span><span id="local-6989586621679061049"><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679061048"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679061047"><span class="annot"><span class="annottext">t ~&gt; Case f a
</span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(x -&gt; a) -&gt; x -&gt; a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679061048"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((x -&gt; a) -&gt; a) -&gt; f (x -&gt; a) -&gt; f a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Case f a x -&gt; f (x -&gt; a)
forall (f :: * -&gt; *) a x. Case f a x -&gt; f (x -&gt; a)
</span><a href="Control.Selective.Multi.html#handleCase"><span class="hs-identifier hs-var hs-var">handleCase</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t x -&gt; Case f a x
t ~&gt; Case f a
</span><a href="#local-6989586621679061047"><span class="hs-identifier hs-var">pi</span></a></span><span> </span><span class="annot"><span class="annottext">t x
</span><a href="#local-6989586621679061049"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span></pre></body></html>