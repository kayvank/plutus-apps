<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-missing-export-lists #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns          #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE CPP                   #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GADTs                 #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE MagicHash             #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds             #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE Rank2Types            #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE RoleAnnotations       #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeInType            #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns          #-}</span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 806
</span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- {-# OPTIONS_GHC -ddump-simpl -dsuppress-idinfo -dsuppress-coercions -dsuppress-type-applications -dsuppress-uniques -dsuppress-module-prefixes #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-comment">{- |
Module                  : Data.TypeRepMap.Internal
Copyright               : (c) 2017-2022 Kowainik
SPDX-License-Identifier : MPL-2.0
Maintainer              : Kowainik &lt;xrom.xkov@gmail.com&gt;
Stability               : Stable
Portability             : Portable

Internal API for 'TypeRepMap' and operations on it. The functions here do
not have any stability guarantees and can change between minor versions.

If you need to use this module for purposes other than tests,
create an issue.
-}</span><span class="hs-cpp">

#include &quot;MachDeps.h&quot;
</span><span>
</span><span id="line-40"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data.TypeRepMap.Internal</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">lookup</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.ST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">ST</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">runST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Control.Monad.Zip</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">mzip</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Function</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">on</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">nubBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromMaybe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">Data.Primitive.Array</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">Array</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">MutableArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">indexArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">mapArray'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">sizeofArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">thawArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>                             </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">unsafeFreezeArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">writeArray</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">Data.Primitive.PrimArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">MutablePrimArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">PrimArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">indexPrimArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">newPrimArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>                                 </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">primArrayFromListN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">primArrayToList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">sizeofPrimArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>                                 </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">unsafeFreezePrimArray</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier">writePrimArray</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">All</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Type.Equality</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">TestEquality</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator">(:~:)</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Base</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Int</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">Int#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator">(*#)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator">(+#)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator">(&lt;#)</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#if MIN_VERSION_base(4,17,0)
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.Base</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToWord#</span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">IsList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">inline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">sortWith</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Fingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Fingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-cpp">
#if WORD_SIZE_IN_BITS &gt;= 64
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">GHC.Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">eqWord#</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier">ltWord#</span></a></span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC.IntWord64</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">eqWord64#</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ltWord64#</span><span class="hs-special">)</span><span class="hs-cpp">
#define eqWord eqWord64
</span><span class="hs-cpp">#define ltWord ltWord64
</span><span class="hs-cpp">#endif
</span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Word64</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Type.Reflection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">SomeTypeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">TypeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">typeRep</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">withTypeable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Type.Reflection.Unsafe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">typeRepFingerprint</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Unsafe.Coerce</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">unsafeCoerce</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">GHC.Exts</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">GHC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">fromList</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">toList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">{- |

'TypeRepMap' is a heterogeneous data structure similar in its essence to
'Data.Map.Map' with types as keys, where each value has the type of its key. In
addition to that, each value is wrapped in an interpretation @f@.

Here is an example of using 'Prelude.Maybe' as an interpretation, with a
comparison to 'Data.Map.Map':

@
 'Data.Map.Map' 'Prelude.String' ('Prelude.Maybe' 'Prelude.String')          'TypeRepMap' 'Prelude.Maybe'
---------------------------       ---------------------
 \&quot;Int\&quot;  -&gt; Just \&quot;5\&quot;                 'Prelude.Int'  -&gt; Just 5
 \&quot;Bool\&quot; -&gt; Just \&quot;True\&quot;              'Prelude.Bool' -&gt; Just 'Prelude.True'
 \&quot;Char\&quot; -&gt; Nothing                  'Prelude.Char' -&gt; Nothing
@

The runtime representation of 'TypeRepMap' is an array, not a tree. This makes
'lookup' significantly more efficient.

-}</span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">role</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><span class="hs-identifier">representational</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">data</span><span> </span><span id="TypeRepMap"><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051897"><span class="annot"><a href="#local-6989586621679051897"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679051898"><span class="annot"><a href="#local-6989586621679051898"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-101"></span><span>  </span><span id="TypeRepMap"><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="fingerprintAs"><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">PrimArray</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ first components of key fingerprints</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="fingerprintBs"><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintBs"><span class="hs-identifier hs-var hs-var">fingerprintBs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">PrimArray</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ second components of key fingerprints</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="trAnys"><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^ values stored in the map</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="trKeys"><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trKeys"><span class="hs-identifier hs-var hs-var">trKeys</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="hs-pragma">{-# UNPACK</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span>        </span><span class="hs-comment">-- ^ typerep keys</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">-- ^ an unsafe constructor for 'TypeRepMap'</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span id="local-6989586621679051569"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051569"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-110"></span><span>   </span><span id="local-6989586621679051566"><span class="annot"><span class="annottext">rnf :: TypeRepMap f -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">rnf</span></a></span></span><span> </span><span id="local-6989586621679051564"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051564"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[SomeTypeRep] -&gt; ()
forall a. NFData a =&gt; a -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.4.0/src"><span class="hs-identifier hs-var">rnf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [SomeTypeRep]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [SomeTypeRep]
</span><a href="Data.TypeRepMap.Internal.html#keys"><span class="hs-identifier hs-var">keys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051564"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; () -&gt; ()
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`seq`</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Shows only keys.</span><span>
</span><span id="line-113"></span><span id="local-6989586621679051562"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051557"><span id="local-6989586621679051560"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051562"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>    </span><span id="local-6989586621679051555"><span class="annot"><span class="annottext">show :: TypeRepMap f -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span class="hs-special">{</span><span id="local-6989586621679051550"><span id="local-6989586621679051551"><span id="local-6989586621679051552"><span id="local-6989586621679051553"><span class="annot"><span class="annottext">PrimArray Word64
Array Any
trKeys :: Array Any
trAnys :: Array Any
fingerprintBs :: PrimArray Word64
fingerprintAs :: PrimArray Word64
trKeys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
trAnys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
fingerprintBs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
fingerprintAs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="#local-6989586621679051550"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TypeRepMap [&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679051549"><span class="hs-identifier hs-var">showKeys</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>        </span><span class="annot"><a href="#local-6989586621679051549"><span class="hs-identifier hs-type">showKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-117"></span><span>        </span><span id="local-6989586621679051549"><span class="annot"><span class="annottext">showKeys :: String
</span><a href="#local-6989586621679051549"><span class="hs-identifier hs-var hs-var">showKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;, &quot;</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [String] -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Array String -&gt; [Item (Array String)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Array String -&gt; [Item (Array String)])
-&gt; Array String -&gt; [Item (Array String)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; String) -&gt; Array Any -&gt; Array String
forall a b. (a -&gt; b) -&gt; Array a -&gt; Array b
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">mapArray'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep Any -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep Any -&gt; String) -&gt; (Any -&gt; TypeRep Any) -&gt; Any -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall k (f :: k). Any -&gt; TypeRep f
</span><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-var">anyToTypeRep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051550"><span class="hs-identifier hs-var">trKeys</span></a></span></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Uses 'union' to combine 'TypeRepMap's.</span><span>
</span><span id="line-120"></span><span id="local-6989586621679051546"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051541"><span id="local-6989586621679051543"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051546"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-type">(&lt;&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051546"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051546"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679051539"><span class="annot"><span class="annottext">&lt;&gt; :: TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var hs-var hs-var hs-var">(&lt;&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#union"><span class="hs-identifier hs-var">union</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span id="local-6989586621679051537"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051532"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051537"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679051530"><span class="annot"><span class="annottext">mempty :: TypeRepMap f
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679051529"><span class="annot"><span class="annottext">mappend :: TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-pragma hs-type">mempty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-129"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-pragma hs-type">mappend</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span class="hs-cpp">

#if __GLASGOW_HASKELL__ &gt;= 806
</span><span id="local-6989586621679051528"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051525"><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051870"><span class="annot"><a href="#local-6989586621679051870"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051870"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051870"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051528"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679051523"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051523"><span class="hs-identifier hs-var">tm1</span></a></span></span><span> </span><span id="local-6989586621679051522"><span class="annot"><span class="annottext">== :: TypeRepMap f -&gt; TypeRepMap f -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679051521"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051521"><span class="hs-identifier hs-var">tm2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051523"><span class="hs-identifier hs-var">tm1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051521"><span class="hs-identifier hs-var">tm2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679051518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><a href="#local-6989586621679051518"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span id="local-6989586621679051518"><span class="annot"><span class="annottext">go :: Int -&gt; Bool
</span><a href="#local-6989586621679051518"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679051517"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051523"><span class="hs-identifier hs-var">tm1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-138"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; TypeRep Any -&gt; Maybe (Any :~: Any)
forall k (f :: k -&gt; *) (a :: k) (b :: k).
TestEquality f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">testEquality</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any
forall k (x :: k). TypeRep x
</span><a href="#local-6989586621679051515"><span class="hs-identifier hs-var">tr1i</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any
forall k (x :: k). TypeRep x
</span><a href="#local-6989586621679051514"><span class="hs-identifier hs-var">tr2i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-139"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (Any :~: Any)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-140"></span><span>                  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">Any :~: Any
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Refl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; f Any -&gt; f Any -&gt; Bool
forall (x :: k). TypeRep x -&gt; f x -&gt; f x -&gt; Bool
</span><a href="#local-6989586621679051512"><span class="hs-identifier hs-var">repEq</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any
forall k (x :: k). TypeRep x
</span><a href="#local-6989586621679051515"><span class="hs-identifier hs-var">tr1i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051510"><span class="hs-identifier hs-var">tv1i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051509"><span class="hs-identifier hs-var">tv2i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Bool
</span><a href="#local-6989586621679051518"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>            </span><span id="local-6989586621679051860"><span class="annot"><a href="#local-6989586621679051515"><span class="hs-identifier hs-type">tr1i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051860"><span class="hs-identifier hs-type">x</span></a></span></span><span>
</span><span id="line-143"></span><span>            </span><span id="local-6989586621679051515"><span class="annot"><span class="annottext">tr1i :: TypeRep x
</span><a href="#local-6989586621679051515"><span class="hs-identifier hs-var hs-var">tr1i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; TypeRep x
forall k (f :: k). Any -&gt; TypeRep f
</span><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-var">anyToTypeRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; TypeRep x) -&gt; Any -&gt; TypeRep x
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trKeys"><span class="hs-identifier hs-var hs-var">trKeys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051523"><span class="hs-identifier hs-var">tm1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>            </span><span id="local-6989586621679051507"><span class="annot"><a href="#local-6989586621679051514"><span class="hs-identifier hs-type">tr2i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051507"><span class="hs-identifier hs-type">y</span></a></span></span><span>
</span><span id="line-146"></span><span>            </span><span id="local-6989586621679051514"><span class="annot"><span class="annottext">tr2i :: TypeRep y
</span><a href="#local-6989586621679051514"><span class="hs-identifier hs-var hs-var">tr2i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; TypeRep y
forall k (f :: k). Any -&gt; TypeRep f
</span><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-var">anyToTypeRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; TypeRep y) -&gt; Any -&gt; TypeRep y
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trKeys"><span class="hs-identifier hs-var hs-var">trKeys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051521"><span class="hs-identifier hs-var">tm2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span>            </span><span class="annot"><a href="#local-6989586621679051510"><span class="hs-identifier hs-type">tv1i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051509"><span class="hs-identifier hs-type">tv2i</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-149"></span><span>            </span><span id="local-6989586621679051510"><span class="annot"><span class="annottext">tv1i :: Any
</span><a href="#local-6989586621679051510"><span class="hs-identifier hs-var hs-var">tv1i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051523"><span class="hs-identifier hs-var">tm1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-150"></span><span>            </span><span id="local-6989586621679051509"><span class="annot"><span class="annottext">tv2i :: Any
</span><a href="#local-6989586621679051509"><span class="hs-identifier hs-var hs-var">tv2i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051521"><span class="hs-identifier hs-var">tm2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051517"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>            </span><span id="local-6989586621679051859"><span class="annot"><a href="#local-6989586621679051512"><span class="hs-identifier hs-type">repEq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051859"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051859"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051528"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051859"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-153"></span><span>            </span><span id="local-6989586621679051512"><span class="annot"><span class="annottext">repEq :: TypeRep x -&gt; f x -&gt; f x -&gt; Bool
</span><a href="#local-6989586621679051512"><span class="hs-identifier hs-var hs-var">repEq</span></a></span></span><span> </span><span id="local-6989586621679051506"><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051506"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep x
-&gt; (Typeable x =&gt; f x -&gt; f x -&gt; Bool) -&gt; f x -&gt; f x -&gt; Bool
forall k (a :: k) r. TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">withTypeable</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051506"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable x =&gt; f x -&gt; f x -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Returns the list of 'Fingerprint's from 'TypeRepMap'.</span><span>
</span><span id="line-157"></span><span id="local-6989586621679051670"><span class="annot"><a href="Data.TypeRepMap.Internal.html#toFingerprints"><span class="hs-identifier hs-type">toFingerprints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051670"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-158"></span><span id="toFingerprints"><span class="annot"><span class="annottext">toFingerprints :: TypeRepMap f -&gt; [Fingerprint]
</span><a href="Data.TypeRepMap.Internal.html#toFingerprints"><span class="hs-identifier hs-var hs-var">toFingerprints</span></a></span></span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span class="hs-special">{</span><span id="local-6989586621679051501"><span id="local-6989586621679051502"><span id="local-6989586621679051503"><span id="local-6989586621679051504"><span class="annot"><span class="annottext">PrimArray Word64
Array Any
trKeys :: Array Any
trAnys :: Array Any
fingerprintBs :: PrimArray Word64
fingerprintAs :: PrimArray Word64
trKeys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
trAnys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
fingerprintBs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
fingerprintAs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="#local-6989586621679051501"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="annottext">(Word64 -&gt; Word64 -&gt; Fingerprint)
-&gt; [Word64] -&gt; [Word64] -&gt; [Fingerprint]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Fingerprint
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Fingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; [Item (PrimArray Word64)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.toList</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051504"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; [Item (PrimArray Word64)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.toList</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051503"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">{- |

A 'TypeRepMap' with no values stored in it.

prop&gt; size empty == 0
prop&gt; member @a empty == False

-}</span><span>
</span><span id="line-169"></span><span id="local-6989586621679051499"><span class="annot"><a href="Data.TypeRepMap.Internal.html#empty"><span class="hs-identifier hs-type">empty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051499"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-170"></span><span id="empty"><span class="annot"><span class="annottext">empty :: TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#empty"><span class="hs-identifier hs-var hs-var">empty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
forall a. Monoid a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-171"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#empty"><span class="hs-pragma hs-type">empty</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">{- |

Construct a 'TypeRepMap' with a single element.

prop&gt; size (one x) == 1
prop&gt; member @a (one (x :: f a)) == True

-}</span><span>
</span><span id="line-181"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#one"><span class="hs-identifier hs-type">one</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051816"><span class="annot"><a href="#local-6989586621679051816"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679051815"><span class="annot"><a href="#local-6989586621679051815"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051815"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051816"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051815"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-182"></span><span id="one"><span class="annot"><span class="annottext">one :: f a -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#one"><span class="hs-identifier hs-var hs-var">one</span></a></span></span><span> </span><span id="local-6989586621679051496"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051496"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Word64] -&gt; PrimArray Word64
forall a. Prim a =&gt; Int -&gt; [a] -&gt; PrimArray a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">primArrayFromListN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051495"><span class="hs-identifier hs-var">fa</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Word64] -&gt; PrimArray Word64
forall a. Prim a =&gt; Int -&gt; [a] -&gt; PrimArray a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">primArrayFromListN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051494"><span class="hs-identifier hs-var">fb</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; Array Any
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051493"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                   </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; Array Any
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051492"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span> </span><span id="local-6989586621679051495"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051495"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span id="local-6989586621679051494"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051494"><span class="hs-identifier hs-var">fb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051493"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051493"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051492"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051492"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#calcFp"><span class="hs-identifier hs-var">calcFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051816"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051496"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; Any
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep a -&gt; Any) -&gt; TypeRep a -&gt; Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; TypeRep a
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051816"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#one"><span class="hs-pragma hs-type">one</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">{- |

Insert a value into a 'TypeRepMap'.
TypeRepMap optimizes for fast reads rather than inserts, as a trade-off inserts are @O(n)@.

prop&gt; size (insert v tm) &gt;= size tm
prop&gt; member @a (insert (x :: f a) tm) == True

-}</span><span>
</span><span id="line-199"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#insert"><span class="hs-identifier hs-type">insert</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051771"><span class="annot"><a href="#local-6989586621679051771"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679051770"><span class="annot"><a href="#local-6989586621679051770"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051770"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051771"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051770"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051770"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-200"></span><span id="insert"><span class="annot"><span class="annottext">insert :: f a -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#insert"><span class="hs-identifier hs-var hs-var">insert</span></a></span></span><span> </span><span id="local-6989586621679051488"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051488"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679051487"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; TypeRepMap f
forall k (a :: k) (f :: k -&gt; *). Typeable a =&gt; f a -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051488"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; PrimArray Word64 -&gt; PrimArray Word64 -&gt; Maybe Int
</span><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-identifier hs-var">cachedBinarySearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-var">typeFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051771"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintBs"><span class="hs-identifier hs-var hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>      </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#union"><span class="hs-identifier hs-var">union</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRepMap f -&gt; TypeRepMap f) -&gt; TypeRepMap f -&gt; TypeRepMap f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; TypeRepMap f
forall k (a :: k) (f :: k -&gt; *). Typeable a =&gt; f a -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#one"><span class="hs-identifier hs-var">one</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051488"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-204"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679051484"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051484"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">trAnys :: Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var">trAnys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Array Any -&gt; Array Any
</span><a href="#local-6989586621679051483"><span class="hs-identifier hs-var">changeAnyArr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051484"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051487"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679051483"><span class="hs-identifier hs-type">changeAnyArr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679051483"><span class="annot"><span class="annottext">changeAnyArr :: Int -&gt; Array Any -&gt; Array Any
</span><a href="#local-6989586621679051483"><span class="hs-identifier hs-var hs-var">changeAnyArr</span></a></span></span><span> </span><span id="local-6989586621679051482"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051482"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679051481"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051481"><span class="hs-identifier hs-var">trAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Array Any)) -&gt; Array Any
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (Array Any)) -&gt; Array Any)
-&gt; (forall s. ST s (Array Any)) -&gt; Array Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-208"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051480"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679051480"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int
forall a. Array a -&gt; Int
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">sizeofArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051481"><span class="hs-identifier hs-var">trAs</span></a></span><span>
</span><span id="line-209"></span><span>      </span><span id="local-6989586621679051479"><span class="annot"><span class="annottext">MutableArray s Any
</span><a href="#local-6989586621679051479"><span class="hs-identifier hs-var">mutArr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array Any
-&gt; Int -&gt; Int -&gt; ST s (MutableArray (PrimState (ST s)) Any)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Array a -&gt; Int -&gt; Int -&gt; m (MutableArray (PrimState m) a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">thawArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051481"><span class="hs-identifier hs-var">trAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051480"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) Any -&gt; Int -&gt; Any -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s Any
MutableArray (PrimState (ST s)) Any
</span><a href="#local-6989586621679051479"><span class="hs-identifier hs-var">mutArr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051482"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; ST s ()) -&gt; Any -&gt; ST s ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051488"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) Any -&gt; ST s (Array Any)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; m (Array a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">unsafeFreezeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s Any
MutableArray (PrimState (ST s)) Any
</span><a href="#local-6989586621679051479"><span class="hs-identifier hs-var">mutArr</span></a></span><span>
</span><span id="line-212"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#insert"><span class="hs-pragma hs-type">insert</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- Extract the kind of a type. We use it to work around lack of syntax for</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- inferred type variables (which are not subject to type applications).</span><span>
</span><span id="line-216"></span><span class="hs-keyword">type</span><span> </span><span id="KindOf"><span class="annot"><a href="Data.TypeRepMap.Internal.html#KindOf"><span class="hs-identifier hs-var">KindOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051478"><span class="annot"><a href="#local-6989586621679051478"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679051477"><span class="annot"><a href="#local-6989586621679051477"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679051477"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">type</span><span> </span><span id="ArgKindOf"><span class="annot"><a href="Data.TypeRepMap.Internal.html#ArgKindOf"><span class="hs-identifier hs-var">ArgKindOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051476"><span class="annot"><a href="#local-6989586621679051476"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679051475"><span class="annot"><a href="#local-6989586621679051475"><span class="hs-identifier hs-type hs-type">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679051474"><span class="annot"><a href="#local-6989586621679051474"><span class="hs-identifier hs-type hs-type">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679051475"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">{- | Delete a value from a 'TypeRepMap'.

TypeRepMap optimizes for fast reads rather than modifications, as a trade-off deletes are
@O(n)@, with an @O(log(n))@ optimization for when the element is already missing.

prop&gt; size (delete @a tm) &lt;= size tm
prop&gt; member @a (delete @a tm) == False

&gt;&gt;&gt; tm = delete @Bool $ insert (Just True) $ one (Just 'a')
&gt;&gt;&gt; size tm
1
&gt;&gt;&gt; member @Bool tm
False
&gt;&gt;&gt; member @Char tm
True
-}</span><span>
</span><span id="line-236"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#delete"><span class="hs-identifier hs-type">delete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051768"><span class="annot"><a href="#local-6989586621679051768"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051767"><span class="annot"><a href="#local-6989586621679051767"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#KindOf"><span class="hs-identifier hs-type">KindOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051767"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051767"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-237"></span><span id="delete"><span class="annot"><span class="annottext">delete :: TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#delete"><span class="hs-identifier hs-var hs-var">delete</span></a></span></span><span> </span><span id="local-6989586621679051472"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051472"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-comment">-- Lookups are fast, so check if we even have the element first.</span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Bool
forall k (a :: k) (f :: k -&gt; *). Typeable a =&gt; TypeRepMap f -&gt; Bool
</span><a href="Data.TypeRepMap.Internal.html#member"><span class="hs-identifier hs-var">member</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051768"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051472"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051472"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- We know we have the element, If the map has exactly one element, we can return the empty map</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051472"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
forall k (f :: k -&gt; *). TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#empty"><span class="hs-identifier hs-var">empty</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-comment">-- Otherwise, filter out the element in linear time.</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall k (f :: k -&gt; *). [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-var">fromSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; TypeRepMap f)
-&gt; (TypeRepMap f -&gt; [(Fingerprint, Any, Any)])
-&gt; TypeRepMap f
-&gt; TypeRepMap f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Fingerprint, Any, Any) -&gt; Bool)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.TypeRepMap.Internal.html#deleteFirst"><span class="hs-identifier hs-var">deleteFirst</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint -&gt; Fingerprint -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-var">typeFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051768"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Fingerprint -&gt; Bool)
-&gt; ((Fingerprint, Any, Any) -&gt; Fingerprint)
-&gt; (Fingerprint, Any, Any)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any) -&gt; Fingerprint
forall a b c. (a, b, c) -&gt; a
</span><a href="Data.TypeRepMap.Internal.html#fst3"><span class="hs-identifier hs-var">fst3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)])
-&gt; (TypeRepMap f -&gt; [(Fingerprint, Any, Any)])
-&gt; TypeRepMap f
-&gt; [(Fingerprint, Any, Any)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var">toSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRepMap f -&gt; TypeRepMap f) -&gt; TypeRepMap f -&gt; TypeRepMap f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051472"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-244"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#delete"><span class="hs-pragma hs-type">delete</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span id="local-6989586621679051791"><span class="annot"><a href="Data.TypeRepMap.Internal.html#deleteFirst"><span class="hs-identifier hs-type">deleteFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051791"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051791"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-247"></span><span id="deleteFirst"><span class="annot"><span class="annottext">deleteFirst :: (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.TypeRepMap.Internal.html#deleteFirst"><span class="hs-identifier hs-var hs-var">deleteFirst</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-248"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#deleteFirst"><span class="hs-identifier hs-var">deleteFirst</span></a></span><span> </span><span id="local-6989586621679051465"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679051465"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051464"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051464"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679051463"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051463"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679051465"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051463"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051464"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="Data.TypeRepMap.Internal.html#deleteFirst"><span class="hs-identifier hs-var">deleteFirst</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679051465"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051463"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">{- |
Update a value at a specific key with the result of the provided function.
When the key is not a member of the map, the original map is returned.

&gt;&gt;&gt; trmap = fromList @(TypeRepMap Identity) [WrapTypeable $ Identity &quot;a&quot;]
&gt;&gt;&gt; lookup @String $ adjust (fmap (++ &quot;ww&quot;)) trmap
Just (Identity &quot;aww&quot;)
-}</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#adjust"><span class="hs-identifier hs-type">adjust</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051461"><span class="annot"><a href="#local-6989586621679051461"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679051460"><span class="annot"><a href="#local-6989586621679051460"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051460"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051461"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051460"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051461"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051460"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051460"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-259"></span><span id="adjust"><span class="annot"><span class="annottext">adjust :: (f a -&gt; f a) -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#adjust"><span class="hs-identifier hs-var hs-var">adjust</span></a></span></span><span> </span><span id="local-6989586621679051459"><span class="annot"><span class="annottext">f a -&gt; f a
</span><a href="#local-6989586621679051459"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (f a) -&gt; Maybe (f a)) -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (a :: k) (f :: k -&gt; *).
Typeable a =&gt;
(Maybe (f a) -&gt; Maybe (f a)) -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#alter"><span class="hs-identifier hs-var">alter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(f a -&gt; f a) -&gt; Maybe (f a) -&gt; Maybe (f a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f a
</span><a href="#local-6989586621679051459"><span class="hs-identifier hs-var">fun</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#adjust"><span class="hs-pragma hs-type">adjust</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">{- |
Updates a value at a specific key, whether or not it exists.
This can be used to insert, delete, or update a value of a given type in the map.

&gt;&gt;&gt; func = (\case Nothing -&gt; Just (Identity &quot;new&quot;); Just (Identity s) -&gt; Just (Identity (reverse s)))
&gt;&gt;&gt; lookup @String $ alter func empty
Just (Identity &quot;new&quot;)
&gt;&gt;&gt; trmap = fromList @(TypeRepMap Identity) [WrapTypeable $ Identity &quot;helllo&quot;]
&gt;&gt;&gt; lookup @String $ alter func trmap
&gt;&gt;&gt; Just (Identity &quot;olleh&quot;)
-}</span><span>
</span><span id="line-273"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#alter"><span class="hs-identifier hs-type">alter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051780"><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679051779"><span class="annot"><a href="#local-6989586621679051779"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051779"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051779"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-274"></span><span id="alter"><span class="annot"><span class="annottext">alter :: (Maybe (f a) -&gt; Maybe (f a)) -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#alter"><span class="hs-identifier hs-var hs-var">alter</span></a></span></span><span> </span><span id="local-6989586621679051457"><span class="annot"><span class="annottext">Maybe (f a) -&gt; Maybe (f a)
</span><a href="#local-6989586621679051457"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621679051456"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; PrimArray Word64 -&gt; PrimArray Word64 -&gt; Maybe Int
</span><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-identifier hs-var">cachedBinarySearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-var">typeFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintBs"><span class="hs-identifier hs-var hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (f a) -&gt; Maybe (f a)
</span><a href="#local-6989586621679051457"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (f a)
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">Maybe (f a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-278"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679051455"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051455"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f a -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (a :: k) (f :: k -&gt; *).
Typeable a =&gt;
f a -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#insert"><span class="hs-identifier hs-var">insert</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051455"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679051454"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051454"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-280"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (f a) -&gt; Maybe (f a)
</span><a href="#local-6989586621679051457"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Maybe (f a)
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(f a -&gt; Maybe (f a)) -&gt; (Any -&gt; f a) -&gt; Any -&gt; Maybe (f a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; f a
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; Maybe (f a)) -&gt; Any -&gt; Maybe (f a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051454"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">Maybe (f a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; TypeRepMap f
forall k (a :: k) (f :: k -&gt; *).
Typeable a =&gt;
TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#delete"><span class="hs-identifier hs-var">delete</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679051453"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051453"><span class="hs-identifier hs-var">v</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">trAnys :: Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var">trAnys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Any -&gt; Array Any -&gt; Array Any
</span><a href="#local-6989586621679051452"><span class="hs-identifier hs-var">replaceAnyAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051454"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f a -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051453"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051456"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621679051452"><span class="hs-identifier hs-type">replaceAnyAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span id="local-6989586621679051452"><span class="annot"><span class="annottext">replaceAnyAt :: Int -&gt; Any -&gt; Array Any -&gt; Array Any
</span><a href="#local-6989586621679051452"><span class="hs-identifier hs-var hs-var">replaceAnyAt</span></a></span></span><span> </span><span id="local-6989586621679051451"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051451"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679051450"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051450"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span id="local-6989586621679051449"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051449"><span class="hs-identifier hs-var">trAs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s (Array Any)) -&gt; Array Any
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s (Array Any)) -&gt; Array Any)
-&gt; (forall s. ST s (Array Any)) -&gt; Array Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051448"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679051448"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int
forall a. Array a -&gt; Int
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">sizeofArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051449"><span class="hs-identifier hs-var">trAs</span></a></span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679051447"><span class="annot"><span class="annottext">MutableArray s Any
</span><a href="#local-6989586621679051447"><span class="hs-identifier hs-var">mutArr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array Any
-&gt; Int -&gt; Int -&gt; ST s (MutableArray (PrimState (ST s)) Any)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Array a -&gt; Int -&gt; Int -&gt; m (MutableArray (PrimState m) a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">thawArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051449"><span class="hs-identifier hs-var">trAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051448"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-288"></span><span>        </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) Any -&gt; Int -&gt; Any -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s Any
MutableArray (PrimState (ST s)) Any
</span><a href="#local-6989586621679051447"><span class="hs-identifier hs-var">mutArr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051451"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051450"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) Any -&gt; ST s (Array Any)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; m (Array a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">unsafeFreezeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s Any
MutableArray (PrimState (ST s)) Any
</span><a href="#local-6989586621679051447"><span class="hs-identifier hs-var">mutArr</span></a></span><span>
</span><span id="line-290"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#alter"><span class="hs-pragma hs-type">alter</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="hs-comment">{- | Map over the elements of a 'TypeRepMap'.

&gt;&gt;&gt; tm = insert (Identity True) $ one (Identity 'a')
&gt;&gt;&gt; lookup @Bool tm
Just (Identity True)
&gt;&gt;&gt; lookup @Char tm
Just (Identity 'a')
&gt;&gt;&gt; tm2 = hoist ((:[]) . runIdentity) tm
&gt;&gt;&gt; lookup @Bool tm2
Just [True]
&gt;&gt;&gt; lookup @Char tm2
Just &quot;a&quot;
-}</span><span>
</span><span id="line-305"></span><span id="local-6989586621679051445"><span id="local-6989586621679051446"><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoist"><span class="hs-identifier hs-type">hoist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051763"><span class="annot"><a href="#local-6989586621679051763"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679051446"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051763"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051445"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051763"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051446"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051445"><span class="hs-identifier hs-type">g</span></a></span></span></span><span>
</span><span id="line-306"></span><span id="hoist"><span class="annot"><span class="annottext">hoist :: (forall (x :: k). f x -&gt; g x) -&gt; TypeRepMap f -&gt; TypeRepMap g
</span><a href="Data.TypeRepMap.Internal.html#hoist"><span class="hs-identifier hs-var hs-var">hoist</span></a></span></span><span> </span><span id="local-6989586621679051443"><span class="annot"><span class="annottext">forall (x :: k). f x -&gt; g x
</span><a href="#local-6989586621679051443"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span id="local-6989586621679051442"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051442"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679051441"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051441"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679051440"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051440"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679051439"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051439"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap g
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051442"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051441"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Any -&gt; Any) -&gt; Array Any -&gt; Array Any
forall a b. (a -&gt; b) -&gt; Array a -&gt; Array b
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">mapArray'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g Any -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">(g Any -&gt; Any) -&gt; (Any -&gt; g Any) -&gt; Any -&gt; Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">f Any -&gt; g Any
forall (x :: k). f x -&gt; g x
</span><a href="#local-6989586621679051443"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; g Any) -&gt; (Any -&gt; f Any) -&gt; Any -&gt; g Any
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051440"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051439"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-307"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoist"><span class="hs-pragma hs-type">hoist</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span id="local-6989586621679051436"><span id="local-6989586621679051437"><span id="local-6989586621679051438"><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoistA"><span class="hs-identifier hs-type">hoistA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Applicative</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051438"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051759"><span class="annot"><a href="#local-6989586621679051759"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679051437"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051759"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051438"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051436"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051759"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051437"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051438"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051436"><span class="hs-identifier hs-type">g</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-310"></span><span id="hoistA"><span class="annot"><span class="annottext">hoistA :: (forall (x :: k). f x -&gt; t (g x))
-&gt; TypeRepMap f -&gt; t (TypeRepMap g)
</span><a href="Data.TypeRepMap.Internal.html#hoistA"><span class="hs-identifier hs-var hs-var">hoistA</span></a></span></span><span> </span><span id="local-6989586621679051434"><span class="annot"><span class="annottext">forall (x :: k). f x -&gt; t (g x)
</span><a href="#local-6989586621679051434"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span id="local-6989586621679051433"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051433"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679051432"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051432"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Any -&gt; [Item (Array Any)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679051431"><span class="annot"><span class="annottext">[Item (Array Any)]
</span><a href="#local-6989586621679051431"><span class="hs-identifier hs-var">ans</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051430"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051430"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051429"><span class="annot"><span class="annottext">[g Any]
</span><a href="#local-6989586621679051429"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap g
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051433"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051432"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item (Array Any)] -&gt; Array Any
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromList</span></a></span><span> </span><span class="annot"><span class="annottext">([Item (Array Any)] -&gt; Array Any)
-&gt; [Item (Array Any)] -&gt; Array Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(g Any -&gt; Any) -&gt; [g Any] -&gt; [Any]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">g Any -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">[g Any]
</span><a href="#local-6989586621679051429"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051430"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">([g Any] -&gt; TypeRepMap g) -&gt; t [g Any] -&gt; t (TypeRepMap g)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; t (g Any)) -&gt; [Any] -&gt; t [g Any]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f Any -&gt; t (g Any)
forall (x :: k). f x -&gt; t (g x)
</span><a href="#local-6989586621679051434"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; t (g Any)) -&gt; (Any -&gt; f Any) -&gt; Any -&gt; t (g Any)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Any]
[Item (Array Any)]
</span><a href="#local-6989586621679051431"><span class="hs-identifier hs-var">ans</span></a></span><span>
</span><span id="line-312"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoistA"><span class="hs-pragma hs-type">hoistA</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoistWithKey"><span class="hs-identifier hs-type">hoistWithKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051425"><span class="annot"><a href="#local-6989586621679051425"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679051424"><span class="annot"><a href="#local-6989586621679051424"><span class="hs-identifier hs-type">g</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051746"><span class="annot"><a href="#local-6989586621679051746"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051746"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051746"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051424"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051746"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051424"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-315"></span><span id="hoistWithKey"><span class="annot"><span class="annottext">hoistWithKey :: (forall (x :: k). Typeable x =&gt; f x -&gt; g x)
-&gt; TypeRepMap f -&gt; TypeRepMap g
</span><a href="Data.TypeRepMap.Internal.html#hoistWithKey"><span class="hs-identifier hs-var hs-var">hoistWithKey</span></a></span></span><span> </span><span id="local-6989586621679051423"><span class="annot"><span class="annottext">forall (x :: k). Typeable x =&gt; f x -&gt; g x
</span><a href="#local-6989586621679051423"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span id="local-6989586621679051422"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051422"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679051421"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051421"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span id="local-6989586621679051420"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051420"><span class="hs-identifier hs-var">ans</span></a></span></span><span> </span><span id="local-6989586621679051419"><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051419"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap g
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051422"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051421"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051418"><span class="hs-identifier hs-var">newAns</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051419"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679051418"><span class="annot"><span class="annottext">newAns :: Array Any
</span><a href="#local-6989586621679051418"><span class="hs-identifier hs-var hs-var">newAns</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Any, Any) -&gt; Any) -&gt; Array (Any, Any) -&gt; Array Any
forall a b. (a -&gt; b) -&gt; Array a -&gt; Array b
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">mapArray'</span></a></span><span> </span><span class="annot"><span class="annottext">(Any, Any) -&gt; Any
</span><a href="#local-6989586621679051417"><span class="hs-identifier hs-var">mapAns</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Any -&gt; Array Any -&gt; Array (Any, Any)
forall (m :: * -&gt; *) a b. MonadZip m =&gt; m a -&gt; m b -&gt; m (a, b)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mzip</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051420"><span class="hs-identifier hs-var">ans</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051419"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679051417"><span class="annot"><span class="annottext">mapAns :: (Any, Any) -&gt; Any
</span><a href="#local-6989586621679051417"><span class="hs-identifier hs-var hs-var">mapAns</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051416"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051416"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051415"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051415"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">g Any -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">(g Any -&gt; Any) -&gt; g Any -&gt; Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; f Any -&gt; g Any
forall (x :: k). TypeRep x -&gt; f x -&gt; g x
</span><a href="#local-6989586621679051414"><span class="hs-identifier hs-var">withTr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051415"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; g Any) -&gt; f Any -&gt; g Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051416"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621679051414"><span class="hs-identifier hs-type">withTr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051739"><span class="annot"><a href="#local-6989586621679051739"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051739"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051739"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051424"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051739"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679051414"><span class="annot"><span class="annottext">withTr :: TypeRep x -&gt; f x -&gt; g x
</span><a href="#local-6989586621679051414"><span class="hs-identifier hs-var hs-var">withTr</span></a></span></span><span> </span><span id="local-6989586621679051413"><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051413"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep x -&gt; (Typeable x =&gt; f x -&gt; g x) -&gt; f x -&gt; g x
forall k (a :: k) r. TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">withTypeable</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051413"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable x =&gt; f x -&gt; g x
forall (x :: k). Typeable x =&gt; f x -&gt; g x
</span><a href="#local-6989586621679051423"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-322"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#hoistWithKey"><span class="hs-pragma hs-type">hoistWithKey</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-comment">-- | The union of two 'TypeRepMap's using a combining function for conflicting entries. @O(n + m)@</span><span>
</span><span id="line-325"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#unionWith"><span class="hs-identifier hs-type">unionWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051728"><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051736"><span class="annot"><a href="#local-6989586621679051736"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051736"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051736"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051736"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051736"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-326"></span><span id="unionWith"><span class="annot"><span class="annottext">unionWith :: (forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#unionWith"><span class="hs-identifier hs-var hs-var">unionWith</span></a></span></span><span> </span><span id="local-6989586621679051411"><span class="annot"><span class="annottext">forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051411"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679051410"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051410"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679051409"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051409"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall k (f :: k -&gt; *). [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-var">fromSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; TypeRepMap f)
-&gt; [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var">toSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051410"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var">toSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051409"><span class="hs-identifier hs-var">mb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>    </span><span class="annot"><a href="#local-6989586621679051407"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051733"><span class="annot"><a href="#local-6989586621679051733"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051733"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051733"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051733"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051728"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051733"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-330"></span><span>    </span><span id="local-6989586621679051407"><span class="annot"><span class="annottext">f' :: TypeRep x -&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051407"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679051406"><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051406"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep x -&gt; (Typeable x =&gt; f x -&gt; f x -&gt; f x) -&gt; f x -&gt; f x -&gt; f x
forall k (a :: k) r. TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">withTypeable</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051406"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable x =&gt; f x -&gt; f x -&gt; f x
forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051411"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><a href="#local-6989586621679051405"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679051405"><span class="annot"><span class="annottext">combine :: (Fingerprint, Any, Any)
-&gt; (Fingerprint, Any, Any) -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051405"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051404"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051404"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051403"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051403"><span class="hs-identifier hs-var">av</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051402"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051402"><span class="hs-identifier hs-var">ak</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051401"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051401"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051404"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f Any -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; Any) -&gt; f Any -&gt; Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; f Any -&gt; f Any -&gt; f Any
forall (x :: k). TypeRep x -&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051407"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051402"><span class="hs-identifier hs-var">ak</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051403"><span class="hs-identifier hs-var">av</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051401"><span class="hs-identifier hs-var">bv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051402"><span class="hs-identifier hs-var">ak</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-comment">-- Merges two typrepmaps into a sorted, dedup'd list of triples.</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-comment">-- Using 'toSortedTriples' allows us to assume the triples are sorted by fingerprint,</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-comment">-- Given O(n) performance from 'toSortedTriples', and given that we can merge-sort in</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- O(n + m) time, then can '.fromSortedTriples' back into cachedBinarySearch order in O(n + m)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">-- that gives a total of O(n + m).</span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621679051408"><span class="hs-identifier hs-type">mergeMaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- We've addressed all elements from both maps</span><span>
</span><span id="line-342"></span><span>    </span><span id="local-6989586621679051408"><span class="annot"><span class="annottext">mergeMaps :: [(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051408"><span class="hs-identifier hs-var hs-var">mergeMaps</span></a></span></span><span> </span><span id="local-6989586621679051400"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051400"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051400"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679051399"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051399"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051399"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- Merge</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051398"><span class="annot"><span class="annottext">a :: (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051398"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051397"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051397"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679051396"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051396"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051395"><span class="annot"><span class="annottext">b :: (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051395"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051394"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051394"><span class="hs-identifier hs-var">bf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679051393"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051393"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; Fingerprint -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051397"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051394"><span class="hs-identifier hs-var">bf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-347"></span><span>            </span><span class="hs-comment">-- Fingerprints are equal, union the elements using our function</span><span>
</span><span id="line-348"></span><span>            </span><span class="hs-comment">-- If the incoming maps were de-duped, there shouldn't be any other equivalent</span><span>
</span><span id="line-349"></span><span>            </span><span class="hs-comment">-- fingerprints</span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; (Fingerprint, Any, Any) -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051405"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051398"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051395"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051396"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051393"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-351"></span><span>            </span><span class="hs-comment">-- First fingerprint must not be in the second map or we would have seen it by now</span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-comment">-- Add it to the result as-is</span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051398"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051396"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051395"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051393"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-comment">-- Second fingerprint must not be in the first map or we would have seen it by now</span><span>
</span><span id="line-355"></span><span>            </span><span class="hs-comment">-- Add it to the result as-is</span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051395"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051408"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051398"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051396"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051393"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-357"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#unionWith"><span class="hs-pragma hs-type">unionWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">-- | The (left-biased) union of two 'TypeRepMap's in @O(n + m)@. It prefers the first map when</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- duplicate keys are encountered, i.e. @'union' == 'unionWith' const@.</span><span>
</span><span id="line-361"></span><span id="local-6989586621679051391"><span class="annot"><a href="Data.TypeRepMap.Internal.html#union"><span class="hs-identifier hs-type">union</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051391"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051391"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051391"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-362"></span><span id="union"><span class="annot"><span class="annottext">union :: TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#union"><span class="hs-identifier hs-var hs-var">union</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
(forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#unionWith"><span class="hs-identifier hs-var">unionWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span>
</span><span id="line-363"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#union"><span class="hs-pragma hs-type">union</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="hs-comment">-- | The 'intersection' of two 'TypeRepMap's using a combining function</span><span>
</span><span id="line-366"></span><span class="hs-comment">--</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- @O(n + m)@</span><span>
</span><span id="line-368"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#intersectionWith"><span class="hs-identifier hs-type">intersectionWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051388"><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051724"><span class="annot"><a href="#local-6989586621679051724"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051724"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051724"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051724"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051724"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-369"></span><span id="intersectionWith"><span class="annot"><span class="annottext">intersectionWith :: (forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#intersectionWith"><span class="hs-identifier hs-var hs-var">intersectionWith</span></a></span></span><span> </span><span id="local-6989586621679051387"><span class="annot"><span class="annottext">forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051387"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679051386"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051386"><span class="hs-identifier hs-var">ma</span></a></span></span><span> </span><span id="local-6989586621679051385"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051385"><span class="hs-identifier hs-var">mb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall k (f :: k -&gt; *). [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-var">fromSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; TypeRepMap f)
-&gt; [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var">toSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051386"><span class="hs-identifier hs-var">ma</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var">toSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051385"><span class="hs-identifier hs-var">mb</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="#local-6989586621679051383"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051721"><span class="annot"><a href="#local-6989586621679051721"><span class="hs-identifier hs-type">x</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051721"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051721"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051721"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051388"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051721"><span class="hs-identifier hs-type">x</span></a></span><span>
</span><span id="line-373"></span><span>    </span><span id="local-6989586621679051383"><span class="annot"><span class="annottext">f' :: TypeRep x -&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051383"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span id="local-6989586621679051382"><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051382"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep x -&gt; (Typeable x =&gt; f x -&gt; f x -&gt; f x) -&gt; f x -&gt; f x -&gt; f x
forall k (a :: k) r. TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">withTypeable</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep x
</span><a href="#local-6989586621679051382"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable x =&gt; f x -&gt; f x -&gt; f x
forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051387"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="#local-6989586621679051381"><span class="hs-identifier hs-type">combine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span id="local-6989586621679051381"><span class="annot"><span class="annottext">combine :: (Fingerprint, Any, Any)
-&gt; (Fingerprint, Any, Any) -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051381"><span class="hs-identifier hs-var hs-var">combine</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051380"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051380"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051379"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051379"><span class="hs-identifier hs-var">av</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051378"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051378"><span class="hs-identifier hs-var">ak</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051377"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051377"><span class="hs-identifier hs-var">bv</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051380"><span class="hs-identifier hs-var">fp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">f Any -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">(f Any -&gt; Any) -&gt; f Any -&gt; Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; f Any -&gt; f Any -&gt; f Any
forall (x :: k). TypeRep x -&gt; f x -&gt; f x -&gt; f x
</span><a href="#local-6989586621679051383"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051378"><span class="hs-identifier hs-var">ak</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051379"><span class="hs-identifier hs-var">av</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051377"><span class="hs-identifier hs-var">bv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051378"><span class="hs-identifier hs-var">ak</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span>    </span><span class="hs-comment">-- Merges two typrepmaps into a sorted, dedup'd list of triples.</span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><a href="#local-6989586621679051384"><span class="hs-identifier hs-type">mergeMaps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-comment">-- If either list is empty, the intersection must be finished.</span><span>
</span><span id="line-381"></span><span>    </span><span id="local-6989586621679051384"><span class="annot"><span class="annottext">mergeMaps :: [(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051384"><span class="hs-identifier hs-var hs-var">mergeMaps</span></a></span></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-comment">-- Merge the two maps considering one element at a time.</span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051376"><span class="annot"><span class="annottext">a :: (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051376"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051375"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051375"><span class="hs-identifier hs-var">af</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679051374"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051374"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051373"><span class="annot"><span class="annottext">b :: (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051373"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679051372"><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051372"><span class="hs-identifier hs-var">bf</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Any
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679051371"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051371"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; Fingerprint -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">compare</span></a></span><span> </span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051375"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">Fingerprint
</span><a href="#local-6989586621679051372"><span class="hs-identifier hs-var">bf</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-comment">-- Fingerprints are equal, union the elements using our function</span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-comment">-- If the incoming maps were de-duped, there shouldn't be any other equivalent</span><span>
</span><span id="line-388"></span><span>            </span><span class="hs-comment">-- fingerprints</span><span>
</span><span id="line-389"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; (Fingerprint, Any, Any) -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051381"><span class="hs-identifier hs-var">combine</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051376"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051373"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051374"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051371"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span class="hs-comment">-- First fingerprint must not be in the second map or we would have seen it by now</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-comment">-- Skip it an move on</span><span>
</span><span id="line-392"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051374"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051373"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051371"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-comment">-- Second fingerprint must not be in the first map or we would have seen it by now</span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-comment">-- Skip it an move on</span><span>
</span><span id="line-395"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051384"><span class="hs-identifier hs-var">mergeMaps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
</span><a href="#local-6989586621679051376"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">(Fingerprint, Any, Any)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051374"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051371"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-396"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#intersectionWith"><span class="hs-pragma hs-type">intersectionWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- | The intersection of two 'TypeRepMap's.</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- It keeps all values from the first map whose keys are present in the second.</span><span>
</span><span id="line-400"></span><span class="hs-comment">--</span><span>
</span><span id="line-401"></span><span class="hs-comment">-- @O(n + m)@</span><span>
</span><span id="line-402"></span><span id="local-6989586621679051370"><span class="annot"><a href="Data.TypeRepMap.Internal.html#intersection"><span class="hs-identifier hs-type">intersection</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051370"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051370"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051370"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-403"></span><span id="intersection"><span class="annot"><span class="annottext">intersection :: TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#intersection"><span class="hs-identifier hs-var hs-var">intersection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
(forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x)
-&gt; TypeRepMap f -&gt; TypeRepMap f -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#intersectionWith"><span class="hs-identifier hs-var">intersectionWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (x :: k). Typeable x =&gt; f x -&gt; f x -&gt; f x
forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">const</span></a></span><span>
</span><span id="line-404"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#intersection"><span class="hs-pragma hs-type">intersection</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">{- | Check if a value of the given type is present in a 'TypeRepMap'.

&gt;&gt;&gt; member @Char $ one (Identity 'a')
True
&gt;&gt;&gt; member @Bool $ one (Identity 'a')
False
-}</span><span>
</span><span id="line-414"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#member"><span class="hs-identifier hs-type">member</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051795"><span class="annot"><a href="#local-6989586621679051795"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051794"><span class="annot"><a href="#local-6989586621679051794"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#KindOf"><span class="hs-identifier hs-type">KindOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051795"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051795"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051794"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-415"></span><span id="member"><span class="annot"><span class="annottext">member :: TypeRepMap f -&gt; Bool
</span><a href="Data.TypeRepMap.Internal.html#member"><span class="hs-identifier hs-var hs-var">member</span></a></span></span><span> </span><span id="local-6989586621679051368"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051368"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Maybe (f a)
forall k (a :: k) (f :: k -&gt; *).
Typeable a =&gt;
TypeRepMap f -&gt; Maybe (f a)
</span><a href="Data.TypeRepMap.Internal.html#lookup"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051795"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051368"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-416"></span><span>    </span><span class="annot"><span class="annottext">Maybe (f a)
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-417"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-418"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#member"><span class="hs-pragma hs-type">member</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="hs-comment">{- | Lookup a value of the given type in a 'TypeRepMap'.

&gt;&gt;&gt; x = lookup $ insert (Identity (11 :: Int)) empty
&gt;&gt;&gt; x :: Maybe (Identity Int)
Just (Identity 11)
&gt;&gt;&gt; x :: Maybe (Identity ())
Nothing
-}</span><span>
</span><span id="line-428"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#lookup"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051714"><span class="annot"><a href="#local-6989586621679051714"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679051713"><span class="annot"><a href="#local-6989586621679051713"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051714"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051713"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051713"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span id="lookup"><span class="annot"><span class="annottext">lookup :: TypeRepMap f -&gt; Maybe (f a)
</span><a href="Data.TypeRepMap.Internal.html#lookup"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679051366"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051366"><span class="hs-identifier hs-var">tVect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; f a
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; f a) -&gt; (Int -&gt; Any) -&gt; Int -&gt; f a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051366"><span class="hs-identifier hs-var">tVect</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-operator hs-var">`indexArray`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>           </span><span class="annot"><span class="annottext">(Int -&gt; f a) -&gt; Maybe Int -&gt; Maybe (f a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; PrimArray Word64 -&gt; PrimArray Word64 -&gt; Maybe Int
</span><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-identifier hs-var">cachedBinarySearch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-var">typeFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051714"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051366"><span class="hs-identifier hs-var">tVect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>                                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintBs"><span class="hs-identifier hs-var hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051366"><span class="hs-identifier hs-var">tVect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#lookup"><span class="hs-pragma hs-type">lookup</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Get the amount of elements in a 'TypeRepMap'.</span><span>
</span><span id="line-436"></span><span id="local-6989586621679051868"><span class="annot"><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-type">size</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051868"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-437"></span><span id="size"><span class="annot"><span class="annottext">size :: TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int
forall a. Prim a =&gt; PrimArray a -&gt; Int
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">sizeofPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimArray Word64 -&gt; Int)
-&gt; (TypeRepMap f -&gt; PrimArray Word64) -&gt; TypeRepMap f -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span><span>
</span><span id="line-438"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-pragma hs-type">size</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span class="hs-comment">-- | Return the list of 'SomeTypeRep' from the keys.</span><span>
</span><span id="line-441"></span><span id="local-6989586621679051907"><span class="annot"><a href="Data.TypeRepMap.Internal.html#keys"><span class="hs-identifier hs-type">keys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051907"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">SomeTypeRep</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-442"></span><span id="keys"><span class="annot"><span class="annottext">keys :: TypeRepMap f -&gt; [SomeTypeRep]
</span><a href="Data.TypeRepMap.Internal.html#keys"><span class="hs-identifier hs-var hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). TypeRep a -&gt; SomeTypeRep)
-&gt; TypeRepMap f -&gt; [SomeTypeRep]
forall k (f :: k -&gt; *) r.
(forall (a :: k). TypeRep a -&gt; r) -&gt; TypeRepMap f -&gt; [r]
</span><a href="Data.TypeRepMap.Internal.html#keysWith"><span class="hs-identifier hs-var">keysWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). TypeRep a -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">SomeTypeRep</span></a></span><span>
</span><span id="line-443"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#keys"><span class="hs-pragma hs-type">keys</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Return the list of keys by wrapping them with a user-provided function.</span><span>
</span><span id="line-446"></span><span id="local-6989586621679051701"><span id="local-6989586621679051702"><span class="annot"><a href="Data.TypeRepMap.Internal.html#keysWith"><span class="hs-identifier hs-type">keysWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051704"><span class="annot"><a href="#local-6989586621679051704"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#ArgKindOf"><span class="hs-identifier hs-type">ArgKindOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051701"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051704"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051702"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051701"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051702"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-447"></span><span id="keysWith"><span class="annot"><span class="annottext">keysWith :: (forall (a :: ArgKindOf f). TypeRep a -&gt; r) -&gt; TypeRepMap f -&gt; [r]
</span><a href="Data.TypeRepMap.Internal.html#keysWith"><span class="hs-identifier hs-var hs-var">keysWith</span></a></span></span><span> </span><span id="local-6989586621679051364"><span class="annot"><span class="annottext">forall (a :: ArgKindOf f). TypeRep a -&gt; r
</span><a href="#local-6989586621679051364"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span class="hs-special">{</span><span id="local-6989586621679051360"><span id="local-6989586621679051361"><span id="local-6989586621679051362"><span id="local-6989586621679051363"><span class="annot"><span class="annottext">PrimArray Word64
Array Any
trKeys :: Array Any
trAnys :: Array Any
fingerprintBs :: PrimArray Word64
fingerprintAs :: PrimArray Word64
trKeys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
trAnys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
fingerprintBs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
fingerprintAs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="#local-6989586621679051360"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; r
forall (a :: ArgKindOf f). TypeRep a -&gt; r
</span><a href="#local-6989586621679051364"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep Any -&gt; r) -&gt; (Any -&gt; TypeRep Any) -&gt; Any -&gt; r
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall k (f :: k). Any -&gt; TypeRep f
</span><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-var">anyToTypeRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Any -&gt; r) -&gt; [Any] -&gt; [r]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; [Item (Array Any)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">Array Any
</span><a href="#local-6989586621679051360"><span class="hs-identifier hs-var">trKeys</span></a></span><span>
</span><span id="line-448"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#keysWith"><span class="hs-pragma hs-type">keysWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-449"></span><span>
</span><span id="line-450"></span><span class="hs-comment">-- | Return the list of key-value pairs by wrapping them with a user-provided function.</span><span>
</span><span id="line-451"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#toListWith"><span class="hs-identifier hs-type">toListWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051647"><span class="annot"><a href="#local-6989586621679051647"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679051646"><span class="annot"><a href="#local-6989586621679051646"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051692"><span class="annot"><a href="#local-6989586621679051692"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#ArgKindOf"><span class="hs-identifier hs-type">ArgKindOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051647"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051647"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051692"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051646"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051647"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051646"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-452"></span><span id="toListWith"><span class="annot"><span class="annottext">toListWith :: (forall (a :: ArgKindOf f). Typeable a =&gt; f a -&gt; r)
-&gt; TypeRepMap f -&gt; [r]
</span><a href="Data.TypeRepMap.Internal.html#toListWith"><span class="hs-identifier hs-var hs-var">toListWith</span></a></span></span><span> </span><span id="local-6989586621679051358"><span class="annot"><span class="annottext">forall (a :: ArgKindOf f). Typeable a =&gt; f a -&gt; r
</span><a href="#local-6989586621679051358"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Fingerprint, Any, Any) -&gt; r) -&gt; [(Fingerprint, Any, Any)] -&gt; [r]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any) -&gt; r
</span><a href="#local-6989586621679051357"><span class="hs-identifier hs-var">toF</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; [r])
-&gt; (TypeRepMap f -&gt; [(Fingerprint, Any, Any)])
-&gt; TypeRepMap f
-&gt; [r]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toTriples"><span class="hs-identifier hs-var">toTriples</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679051689"><span class="annot"><a href="#local-6989586621679051355"><span class="hs-identifier hs-type">withTypeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051647"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051646"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-455"></span><span>    </span><span id="local-6989586621679051355"><span class="annot"><span class="annottext">withTypeRep :: TypeRep a -&gt; f a -&gt; r
</span><a href="#local-6989586621679051355"><span class="hs-identifier hs-var hs-var">withTypeRep</span></a></span></span><span> </span><span id="local-6989586621679051354"><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621679051354"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679051353"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051353"><span class="hs-identifier hs-var">an</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
forall k (a :: k) r. TypeRep a -&gt; (Typeable a =&gt; r) -&gt; r
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">withTypeable</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep a
</span><a href="#local-6989586621679051354"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">((Typeable a =&gt; r) -&gt; r) -&gt; (Typeable a =&gt; r) -&gt; r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; r
forall (a :: ArgKindOf f). Typeable a =&gt; f a -&gt; r
</span><a href="#local-6989586621679051358"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051353"><span class="hs-identifier hs-var">an</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span id="local-6989586621679051357"><span class="annot"><span class="annottext">toF :: (Fingerprint, Any, Any) -&gt; r
</span><a href="#local-6989586621679051357"><span class="hs-identifier hs-var hs-var">toF</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fingerprint
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051352"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051352"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051351"><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051351"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep Any -&gt; f Any -&gt; r
forall (a :: ArgKindOf f). TypeRep a -&gt; f a -&gt; r
</span><a href="#local-6989586621679051355"><span class="hs-identifier hs-var">withTypeRep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; TypeRep Any
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051351"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Any -&gt; f Any
forall k (f :: k -&gt; *) (a :: k). Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var">fromAny</span></a></span><span> </span><span class="annot"><span class="annottext">Any
</span><a href="#local-6989586621679051352"><span class="hs-identifier hs-var">an</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Binary searched based on this article</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- http://bannalia.blogspot.com/2015/06/cache-friendly-binary-search.html</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- with modification for our two-vector search case.</span><span>
</span><span id="line-461"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-identifier hs-type">cachedBinarySearch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">PrimArray</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">PrimArray</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-462"></span><span id="cachedBinarySearch"><span class="annot"><span class="annottext">cachedBinarySearch :: Fingerprint -&gt; PrimArray Word64 -&gt; PrimArray Word64 -&gt; Maybe Int
</span><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-identifier hs-var hs-var">cachedBinarySearch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679051349"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051349"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679051348"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051348"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679051347"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051347"><span class="hs-identifier hs-var">fpAs</span></a></span></span><span> </span><span id="local-6989586621679051346"><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051346"><span class="hs-identifier hs-var">fpBs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int -&gt; Maybe Int
forall a. a -&gt; a
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">inline</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><a href="#local-6989586621679051345"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int#</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-cpp">
#if MIN_VERSION_base(4,17,0)
</span><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">&lt;#</span><span> </span><span class="hs-identifier">len</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-467"></span><span>        </span><span class="hs-number">0#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Nothing</span><span>
</span><span id="line-468"></span><span>        </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-469"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">W64#</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">valA</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">indexPrimArray</span><span> </span><span class="hs-identifier">fpAs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>                </span><span class="hs-glyph">!</span><span class="hs-identifier">a'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">a</span><span>
</span><span id="line-471"></span><span>                </span><span class="hs-glyph">!</span><span class="hs-identifier">b'</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">b</span><span>
</span><span id="line-472"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-473"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">ltWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">valA</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-474"></span><span>                    </span><span class="hs-number">0#</span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-475"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">a'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">valA</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>                            </span><span class="hs-number">0#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-number">2#</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">2#</span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>                            </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-478"></span><span>                                </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="hs-identifier">W64#</span><span> </span><span class="hs-identifier">valB</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">indexPrimArray</span><span> </span><span class="hs-identifier">fpBs</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>                                </span><span class="hs-keyword">in</span><span>
</span><span id="line-480"></span><span>                                    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">eqWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">valB</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-481"></span><span>                                        </span><span class="hs-number">0#</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-482"></span><span>                                            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier">b'</span><span> </span><span class="hs-special">`</span><span class="hs-identifier">ltWord#</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">word64ToWord#</span><span> </span><span class="hs-identifier">valB</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-483"></span><span>                                                </span><span class="hs-number">0#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-number">2#</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">2#</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>                                                </span><span class="hs-identifier">_</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-number">2#</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>                                        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">I#</span><span> </span><span class="hs-identifier">i</span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>                    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><span class="hs-number">2#</span><span> </span><span class="hs-operator">*#</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-operator">+#</span><span> </span><span class="hs-number">1#</span><span class="hs-special">)</span><span class="hs-cpp">
#else
</span><span>    </span><span id="local-6989586621679051345"><span class="annot"><span class="annottext">go :: Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679051344"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051343"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-489"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-491"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679051342"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051342"><span class="hs-identifier hs-var">valA</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051347"><span class="hs-identifier hs-var">fpAs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-493"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051349"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`ltWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051342"><span class="hs-identifier hs-var">valA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-494"></span><span>                    </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-495"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051349"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`eqWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051342"><span class="hs-identifier hs-var">valA</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-496"></span><span>                            </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>                            </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-498"></span><span>                                </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">W64#</span></a></span><span> </span><span id="local-6989586621679051341"><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051341"><span class="hs-identifier hs-var">valB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051346"><span class="hs-identifier hs-var">fpBs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>                                </span><span class="hs-keyword">in</span><span>
</span><span id="line-500"></span><span>                                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051348"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`eqWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051341"><span class="hs-identifier hs-var">valB</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-501"></span><span>                                        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-502"></span><span>                                            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051348"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Word# -&gt; Word# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`ltWord#`</span></a></span><span> </span><span class="annot"><span class="annottext">Word#
</span><a href="#local-6989586621679051341"><span class="hs-identifier hs-var">valB</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-503"></span><span>                                                </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">0#</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>                                                </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>                                        </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int# -&gt; Int
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">I#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>                    </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Maybe Int
</span><a href="#local-6989586621679051345"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">2#</span></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">*#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051344"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int# -&gt; Int# -&gt; Int#
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">+#</span></a></span><span> </span><span class="annot"><span class="annottext">Int#
</span><span class="hs-number">1#</span></span><span class="hs-special">)</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="#local-6989586621679051343"><span class="hs-identifier hs-type">len</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int#</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span id="local-6989586621679051343"><span class="annot"><span class="annottext">len :: Int#
</span><a href="#local-6989586621679051343"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">I#</span></a></span><span> </span><span id="local-6989586621679051340"><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051340"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int
forall a. Prim a =&gt; PrimArray a -&gt; Int
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">sizeofPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051347"><span class="hs-identifier hs-var">fpAs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Int#
</span><a href="#local-6989586621679051340"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-511"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#cachedBinarySearch"><span class="hs-pragma hs-type">cachedBinarySearch</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- Internal functions</span><span>
</span><span id="line-515"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span id="local-6989586621679051825"><span id="local-6989586621679051826"><span class="annot"><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-type">toAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679051826"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051825"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span></span></span><span>
</span><span id="line-518"></span><span id="toAny"><span class="annot"><span class="annottext">toAny :: f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var hs-var">toAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Any
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span id="local-6989586621679051856"><span id="local-6989586621679051857"><span class="annot"><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-type">fromAny</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051857"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051856"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-521"></span><span id="fromAny"><span class="annot"><span class="annottext">fromAny :: Any -&gt; f a
</span><a href="Data.TypeRepMap.Internal.html#fromAny"><span class="hs-identifier hs-var hs-var">fromAny</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; f a
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span id="local-6989586621679051883"><span class="annot"><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-type">anyToTypeRep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">TypeRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051883"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-524"></span><span id="anyToTypeRep"><span class="annot"><span class="annottext">anyToTypeRep :: Any -&gt; TypeRep f
</span><a href="Data.TypeRepMap.Internal.html#anyToTypeRep"><span class="hs-identifier hs-var hs-var">anyToTypeRep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Any -&gt; TypeRep f
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span>
</span><span id="line-525"></span><span>
</span><span id="line-526"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-type">typeFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051339"><span class="annot"><a href="#local-6989586621679051339"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051339"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span>
</span><span id="line-527"></span><span id="typeFp"><span class="annot"><span class="annottext">typeFp :: Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-identifier hs-var hs-var">typeFp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; Fingerprint
forall k (a :: k). TypeRep a -&gt; Fingerprint
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRepFingerprint</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep a -&gt; Fingerprint) -&gt; TypeRep a -&gt; Fingerprint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; TypeRep a
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051339"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-528"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#typeFp"><span class="hs-pragma hs-type">typeFp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span id="local-6989586621679051338"><span class="annot"><a href="Data.TypeRepMap.Internal.html#toTriples"><span class="hs-identifier hs-type">toTriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051338"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-531"></span><span id="toTriples"><span class="annot"><span class="annottext">toTriples :: TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toTriples"><span class="hs-identifier hs-var hs-var">toTriples</span></a></span></span><span> </span><span id="local-6989586621679051337"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051337"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Fingerprint] -&gt; [Any] -&gt; [Any] -&gt; [(Fingerprint, Any, Any)]
forall a b c. [a] -&gt; [b] -&gt; [c] -&gt; [(a, b, c)]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">zip3</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; [Fingerprint]
forall k (f :: k -&gt; *). TypeRepMap f -&gt; [Fingerprint]
</span><a href="Data.TypeRepMap.Internal.html#toFingerprints"><span class="hs-identifier hs-var">toFingerprints</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051337"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Any -&gt; [Item (Array Any)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Array Any -&gt; [Item (Array Any)])
-&gt; Array Any -&gt; [Item (Array Any)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051337"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array Any -&gt; [Item (Array Any)]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Array Any -&gt; [Item (Array Any)])
-&gt; Array Any -&gt; [Item (Array Any)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trKeys"><span class="hs-identifier hs-var hs-var">trKeys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051337"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="hs-comment">-- | Efficiently get sorted triples from a map in O(n) time</span><span>
</span><span id="line-534"></span><span class="hs-comment">--</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- We assume the incoming TypeRepMap is already sorted into 'cachedBinarySearch' order using fromSortedList.</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- Then we can construct the index mapping from the &quot;cached&quot; ordering into monotonically</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- increasing order using 'generateOrderMapping' with the length of the TRM. This takes @O(n).</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- We then pull those indexes from the source TRM to get the sorted triples in a total of @O(n).</span><span>
</span><span id="line-539"></span><span id="local-6989586621679051786"><span class="annot"><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-type">toSortedTriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051786"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-540"></span><span id="toSortedTriples"><span class="annot"><span class="annottext">toSortedTriples :: TypeRepMap f -&gt; [(Fingerprint, Any, Any)]
</span><a href="Data.TypeRepMap.Internal.html#toSortedTriples"><span class="hs-identifier hs-var hs-var">toSortedTriples</span></a></span></span><span> </span><span id="local-6989586621679051335"><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051334"><span class="hs-identifier hs-var">trip</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; (Fingerprint, Any, Any))
-&gt; [Int] -&gt; [(Fingerprint, Any, Any)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679051333"><span class="hs-identifier hs-var">ordering</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-542"></span><span>    </span><span id="local-6989586621679051334"><span class="annot"><span class="annottext">trip :: Int -&gt; (Fingerprint, Any, Any)
</span><a href="#local-6989586621679051334"><span class="hs-identifier hs-var hs-var">trip</span></a></span></span><span> </span><span id="local-6989586621679051332"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051332"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Fingerprint
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Fingerprint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintAs"><span class="hs-identifier hs-var hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051332"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; PrimArray Word64
forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="Data.TypeRepMap.Internal.html#fingerprintBs"><span class="hs-identifier hs-var hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051332"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trAnys"><span class="hs-identifier hs-var hs-var">trAnys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051332"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-544"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Array Any -&gt; Int -&gt; Any
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Array Any
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
</span><a href="Data.TypeRepMap.Internal.html#trKeys"><span class="hs-identifier hs-var hs-var">trKeys</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051332"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><a href="#local-6989586621679051333"><span class="hs-identifier hs-type">ordering</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-546"></span><span>    </span><span id="local-6989586621679051333"><span class="annot"><span class="annottext">ordering :: [Int]
</span><a href="#local-6989586621679051333"><span class="hs-identifier hs-var hs-var">ordering</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int]
</span><a href="Data.TypeRepMap.Internal.html#generateOrderMapping"><span class="hs-identifier hs-var">generateOrderMapping</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRepMap f -&gt; Int
forall k (f :: k -&gt; *). TypeRepMap f -&gt; Int
</span><a href="Data.TypeRepMap.Internal.html#size"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRepMap f
</span><a href="#local-6989586621679051335"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span id="local-6989586621679051634"><span id="local-6989586621679051635"><span id="local-6989586621679051636"><span class="annot"><a href="Data.TypeRepMap.Internal.html#nubByFst"><span class="hs-identifier hs-type">nubByFst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051635"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051634"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051636"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051635"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051634"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-549"></span><span id="nubByFst"><span class="annot"><span class="annottext">nubByFst :: [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="Data.TypeRepMap.Internal.html#nubByFst"><span class="hs-identifier hs-var hs-var">nubByFst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, b, c) -&gt; (a, b, c) -&gt; Bool) -&gt; [(a, b, c)] -&gt; [(a, b, c)]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">nubBy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(==)</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a -&gt; Bool)
-&gt; ((a, b, c) -&gt; a) -&gt; (a, b, c) -&gt; (a, b, c) -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">`on`</span></a></span><span> </span><span class="annot"><span class="annottext">(a, b, c) -&gt; a
forall a b c. (a, b, c) -&gt; a
</span><a href="Data.TypeRepMap.Internal.html#fst3"><span class="hs-identifier hs-var">fst3</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span id="local-6989586621679051788"><span id="local-6989586621679051789"><span id="local-6989586621679051790"><span class="annot"><a href="Data.TypeRepMap.Internal.html#fst3"><span class="hs-identifier hs-type">fst3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679051790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051789"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679051788"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051790"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-552"></span><span id="fst3"><span class="annot"><span class="annottext">fst3 :: (a, b, c) -&gt; a
</span><a href="Data.TypeRepMap.Internal.html#fst3"><span class="hs-identifier hs-var hs-var">fst3</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051329"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051329"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051329"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-555"></span><span class="hs-comment">-- Functions for testing and benchmarking</span><span>
</span><span id="line-556"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-557"></span><span>
</span><span id="line-558"></span><span class="hs-comment">-- | Existential wrapper around 'Typeable' indexed by @f@ type parameter.</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- Useful for 'TypeRepMap' structure creation form list of 'WrapTypeable's.</span><span>
</span><span id="line-560"></span><span class="hs-keyword">data</span><span> </span><span id="WrapTypeable"><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-var">WrapTypeable</span></a></span></span><span> </span><span id="local-6989586621679051328"><span class="annot"><a href="#local-6989586621679051328"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-561"></span><span>    </span><span id="local-6989586621679051327"><span id="local-6989586621679051643"><span id="WrapTypeable"><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-var">WrapTypeable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051327"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679051643"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051327"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051643"><span class="hs-identifier hs-type">f</span></a></span></span></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span id="local-6989586621679051325"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051320"><span id="local-6989586621679051323"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051325"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-564"></span><span>    </span><span id="local-6989586621679051319"><span class="annot"><span class="annottext">show :: WrapTypeable f -&gt; String
</span><a href="#local-6989586621679051319"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051318"><span class="annot"><span class="annottext">f a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679051325"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051318"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fingerprint -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint -&gt; String) -&gt; Fingerprint -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#calcFp"><span class="hs-identifier hs-var">calcFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051318"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-comment">{- |

prop&gt; fromList . toList == 'id'

Creates 'TypeRepMap' from a list of 'WrapTypeable's.

&gt;&gt;&gt; show $ fromList [WrapTypeable $ Identity True, WrapTypeable $ Identity 'a']
TypeRepMap [Bool, Char]


-}</span><span>
</span><span id="line-577"></span><span id="local-6989586621679051317"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679051314"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">IsList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Item"><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Item</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">fromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span id="local-6989586621679051311"><span class="annot"><span class="annottext">fromList :: [WrapTypeable f] -&gt; TypeRepMap f
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall k (f :: k -&gt; *). [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromTriples"><span class="hs-identifier hs-var">fromTriples</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; TypeRepMap f)
-&gt; ([WrapTypeable f] -&gt; [(Fingerprint, Any, Any)])
-&gt; [WrapTypeable f]
-&gt; TypeRepMap f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(WrapTypeable f -&gt; (Fingerprint, Any, Any))
-&gt; [WrapTypeable f] -&gt; [(Fingerprint, Any, Any)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051309"><span class="annot"><span class="annottext">WrapTypeable f
</span><a href="#local-6989586621679051309"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WrapTypeable f -&gt; Fingerprint
</span><a href="#local-6989586621679051308"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">WrapTypeable f
</span><a href="#local-6989586621679051309"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WrapTypeable f -&gt; Any
</span><a href="#local-6989586621679051307"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">WrapTypeable f
</span><a href="#local-6989586621679051309"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WrapTypeable f -&gt; Any
</span><a href="#local-6989586621679051306"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">WrapTypeable f
</span><a href="#local-6989586621679051309"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><a href="#local-6989586621679051308"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span>
</span><span id="line-584"></span><span>        </span><span id="local-6989586621679051308"><span class="annot"><span class="annottext">fp :: WrapTypeable f -&gt; Fingerprint
</span><a href="#local-6989586621679051308"><span class="hs-identifier hs-var hs-var">fp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051305"><span class="annot"><span class="annottext">f a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051305"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; Fingerprint
forall k (a :: k). Typeable a =&gt; Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#calcFp"><span class="hs-identifier hs-var">calcFp</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051305"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-585"></span><span>
</span><span id="line-586"></span><span>        </span><span class="annot"><a href="#local-6989586621679051307"><span class="hs-identifier hs-type">an</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-587"></span><span>        </span><span id="local-6989586621679051307"><span class="annot"><span class="annottext">an :: WrapTypeable f -&gt; Any
</span><a href="#local-6989586621679051307"><span class="hs-identifier hs-var hs-var">an</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span id="local-6989586621679051304"><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051304"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">f a -&gt; Any
forall k (f :: k -&gt; *) (a :: k). f a -&gt; Any
</span><a href="Data.TypeRepMap.Internal.html#toAny"><span class="hs-identifier hs-var">toAny</span></a></span><span> </span><span class="annot"><span class="annottext">f a
</span><a href="#local-6989586621679051304"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span>        </span><span class="annot"><a href="#local-6989586621679051306"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span>
</span><span id="line-590"></span><span>        </span><span id="local-6989586621679051306"><span class="annot"><span class="annottext">k :: WrapTypeable f -&gt; Any
</span><a href="#local-6989586621679051306"><span class="hs-identifier hs-var hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679051303"><span class="annot"><span class="annottext">f a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051303"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; Any
forall a b. a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unsafeCoerce</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep a -&gt; Any) -&gt; TypeRep a -&gt; Any
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; TypeRep a
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051303"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">toList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-type">WrapTypeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051317"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>    </span><span id="local-6989586621679051302"><span class="annot"><span class="annottext">toList :: TypeRepMap f -&gt; [WrapTypeable f]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">toList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall (a :: k). Typeable a =&gt; f a -&gt; WrapTypeable f)
-&gt; TypeRepMap f -&gt; [WrapTypeable f]
forall k (f :: k -&gt; *) r.
(forall (a :: k). Typeable a =&gt; f a -&gt; r) -&gt; TypeRepMap f -&gt; [r]
</span><a href="Data.TypeRepMap.Internal.html#toListWith"><span class="hs-identifier hs-var">toListWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: k). Typeable a =&gt; f a -&gt; WrapTypeable f
forall k (a :: k) (f :: k -&gt; *).
Typeable a =&gt;
f a -&gt; WrapTypeable f
</span><a href="Data.TypeRepMap.Internal.html#WrapTypeable"><span class="hs-identifier hs-var">WrapTypeable</span></a></span></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#calcFp"><span class="hs-identifier hs-type">calcFp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051828"><span class="annot"><a href="#local-6989586621679051828"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051828"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span>
</span><span id="line-596"></span><span id="calcFp"><span class="annot"><span class="annottext">calcFp :: Fingerprint
</span><a href="Data.TypeRepMap.Internal.html#calcFp"><span class="hs-identifier hs-var hs-var">calcFp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; Fingerprint
forall k (a :: k). TypeRep a -&gt; Fingerprint
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRepFingerprint</span></a></span><span> </span><span class="annot"><span class="annottext">(TypeRep a -&gt; Fingerprint) -&gt; TypeRep a -&gt; Fingerprint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Typeable a =&gt; TypeRep a
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">typeRep</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679051828"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-597"></span><span>
</span><span id="line-598"></span><span id="local-6989586621679051301"><span class="annot"><a href="Data.TypeRepMap.Internal.html#fromTriples"><span class="hs-identifier hs-type">fromTriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051301"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-599"></span><span id="fromTriples"><span class="annot"><span class="annottext">fromTriples :: [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromTriples"><span class="hs-identifier hs-var hs-var">fromTriples</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; TypeRepMap f
forall k (f :: k -&gt; *). [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-var">fromSortedTriples</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; TypeRepMap f)
-&gt; ([(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)])
-&gt; [(Fingerprint, Any, Any)]
-&gt; TypeRepMap f
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((Fingerprint, Any, Any) -&gt; Fingerprint)
-&gt; [(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">sortWith</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint, Any, Any) -&gt; Fingerprint
forall a b c. (a, b, c) -&gt; a
</span><a href="Data.TypeRepMap.Internal.html#fst3"><span class="hs-identifier hs-var">fst3</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)])
-&gt; ([(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)])
-&gt; [(Fingerprint, Any, Any)]
-&gt; [(Fingerprint, Any, Any)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a b c. Eq a =&gt; [(a, b, c)] -&gt; [(a, b, c)]
</span><a href="Data.TypeRepMap.Internal.html#nubByFst"><span class="hs-identifier hs-var">nubByFst</span></a></span><span>
</span><span id="line-600"></span><span>
</span><span id="line-601"></span><span id="local-6989586621679051792"><span class="annot"><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-type">fromSortedTriples</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051792"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-602"></span><span id="fromSortedTriples"><span class="annot"><span class="annottext">fromSortedTriples :: [(Fingerprint, Any, Any)] -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#fromSortedTriples"><span class="hs-identifier hs-var hs-var">fromSortedTriples</span></a></span></span><span> </span><span id="local-6989586621679051300"><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051300"><span class="hs-identifier hs-var">kvs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
forall k (f :: k -&gt; *).
PrimArray Word64
-&gt; PrimArray Word64 -&gt; Array Any -&gt; Array Any -&gt; TypeRepMap f
</span><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-var">TypeRepMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item (PrimArray Word64)] -&gt; PrimArray Word64
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Word64]
[Item (PrimArray Word64)]
</span><a href="#local-6989586621679051299"><span class="hs-identifier hs-var">fpAs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item (PrimArray Word64)] -&gt; PrimArray Word64
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Word64]
[Item (PrimArray Word64)]
</span><a href="#local-6989586621679051298"><span class="hs-identifier hs-var">fpBs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item (Array Any)] -&gt; Array Any
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Any]
[Item (Array Any)]
</span><a href="#local-6989586621679051297"><span class="hs-identifier hs-var">ans</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Item (Array Any)] -&gt; Array Any
forall l. IsList l =&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">GHC.fromList</span></a></span><span> </span><span class="annot"><span class="annottext">[Any]
[Item (Array Any)]
</span><a href="#local-6989586621679051296"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679051299"><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679051299"><span class="hs-identifier hs-var">fpAs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051298"><span class="annot"><span class="annottext">[Word64]
</span><a href="#local-6989586621679051298"><span class="hs-identifier hs-var">fpBs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Word64, Word64)] -&gt; ([Word64], [Word64])
forall a b. [(a, b)] -&gt; ([a], [b])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip</span></a></span><span> </span><span class="annot"><span class="annottext">([(Word64, Word64)] -&gt; ([Word64], [Word64]))
-&gt; [(Word64, Word64)] -&gt; ([Word64], [Word64])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Fingerprint -&gt; (Word64, Word64))
-&gt; [Fingerprint] -&gt; [(Word64, Word64)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Fingerprint</span></a></span><span> </span><span id="local-6989586621679051294"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051294"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679051293"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051293"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051294"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679051293"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Fingerprint]
</span><a href="#local-6989586621679051292"><span class="hs-identifier hs-var">fps</span></a></span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679051292"><span class="annot"><span class="annottext">[Fingerprint]
</span><a href="#local-6989586621679051292"><span class="hs-identifier hs-var">fps</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051297"><span class="annot"><span class="annottext">[Any]
</span><a href="#local-6989586621679051297"><span class="hs-identifier hs-var">ans</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679051296"><span class="annot"><span class="annottext">[Any]
</span><a href="#local-6989586621679051296"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; ([Fingerprint], [Any], [Any])
forall a b c. [(a, b, c)] -&gt; ([a], [b], [c])
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">unzip3</span></a></span><span> </span><span class="annot"><span class="annottext">([(Fingerprint, Any, Any)] -&gt; ([Fingerprint], [Any], [Any]))
-&gt; [(Fingerprint, Any, Any)] -&gt; ([Fingerprint], [Any], [Any])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)] -&gt; [(Fingerprint, Any, Any)]
forall a. [a] -&gt; [a]
</span><a href="Data.TypeRepMap.Internal.html#fromSortedList"><span class="hs-identifier hs-var">fromSortedList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Fingerprint, Any, Any)]
</span><a href="#local-6989586621679051300"><span class="hs-identifier hs-var">kvs</span></a></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- Tree-like conversion</span><span>
</span><span id="line-609"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#fromSortedList"><span class="hs-identifier hs-type">fromSortedList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051626"><span class="annot"><a href="#local-6989586621679051626"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679051626"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-612"></span><span id="fromSortedList"><span class="annot"><span class="annottext">fromSortedList :: [a] -&gt; [a]
</span><a href="Data.TypeRepMap.Internal.html#fromSortedList"><span class="hs-identifier hs-var hs-var">fromSortedList</span></a></span></span><span> </span><span id="local-6989586621679051289"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051289"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s [a]) -&gt; [a]
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s [a]) -&gt; [a]) -&gt; (forall s. ST s [a]) -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051288"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679051288"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051289"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051286"><span class="annot"><span class="annottext">arrOrigin :: Array a
</span><a href="#local-6989586621679051286"><span class="hs-identifier hs-var hs-var">arrOrigin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Item (Array a)] -&gt; Array a
forall l. IsList l =&gt; Int -&gt; [Item l] -&gt; l
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromListN</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051288"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
[Item (Array a)]
</span><a href="#local-6989586621679051289"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-615"></span><span>    </span><span id="local-6989586621679051285"><span class="annot"><span class="annottext">MutableArray s a
</span><a href="#local-6989586621679051285"><span class="hs-identifier hs-var">arrResult</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Array a -&gt; Int -&gt; Int -&gt; ST s (MutableArray (PrimState (ST s)) a)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
Array a -&gt; Int -&gt; Int -&gt; m (MutableArray (PrimState m) a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">thawArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array a
</span><a href="#local-6989586621679051286"><span class="hs-identifier hs-var">arrOrigin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051288"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; MutableArray s a -&gt; Array a -&gt; ST s ()
forall s. Int -&gt; MutableArray s a -&gt; Array a -&gt; ST s ()
</span><a href="#local-6989586621679051284"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051288"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s a
</span><a href="#local-6989586621679051285"><span class="hs-identifier hs-var">arrResult</span></a></span><span> </span><span class="annot"><span class="annottext">Array a
</span><a href="#local-6989586621679051286"><span class="hs-identifier hs-var">arrOrigin</span></a></span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><span class="annottext">Array a -&gt; [a]
forall l. IsList l =&gt; l -&gt; [Item l]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="annot"><span class="annottext">(Array a -&gt; [a]) -&gt; ST s (Array a) -&gt; ST s [a]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) a -&gt; ST s (Array a)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; m (Array a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">unsafeFreezeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s a
MutableArray (PrimState (ST s)) a
</span><a href="#local-6989586621679051285"><span class="hs-identifier hs-var">arrResult</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-comment">-- state monad could be used here, but it's another dependency</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="#local-6989586621679051284"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679051621"><span class="annot"><a href="#local-6989586621679051621"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">MutableArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051621"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">Array</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051626"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051621"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>    </span><span id="local-6989586621679051284"><span class="annot"><span class="annottext">go :: Int -&gt; MutableArray s a -&gt; Array a -&gt; ST s ()
</span><a href="#local-6989586621679051284"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679051283"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051283"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679051282"><span class="annot"><span class="annottext">MutableArray s a
</span><a href="#local-6989586621679051282"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679051281"><span class="annot"><span class="annottext">Array a
</span><a href="#local-6989586621679051281"><span class="hs-identifier hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">() -&gt; ST s Int -&gt; ST s ()
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051279"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-622"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>        </span><span class="annot"><a href="#local-6989586621679051279"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051621"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span id="local-6989586621679051279"><span class="annot"><span class="annottext">loop :: Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051279"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679051278"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051278"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679051277"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051277"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-625"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051278"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051283"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-626"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051277"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-627"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-628"></span><span>                </span><span id="local-6989586621679051276"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051276"><span class="hs-identifier hs-var">newFirst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051279"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051278"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051277"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-629"></span><span>                </span><span class="annot"><span class="annottext">MutableArray (PrimState (ST s)) a -&gt; Int -&gt; a -&gt; ST s ()
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutableArray (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">writeArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutableArray s a
MutableArray (PrimState (ST s)) a
</span><a href="#local-6989586621679051282"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051278"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Array a -&gt; Int -&gt; a
forall a. Array a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexArray</span></a></span><span> </span><span class="annot"><span class="annottext">Array a
</span><a href="#local-6989586621679051281"><span class="hs-identifier hs-var">origin</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051276"><span class="hs-identifier hs-var">newFirst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>                </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051279"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051278"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051276"><span class="hs-identifier hs-var">newFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>
</span><span id="line-632"></span><span class="hs-comment">-- Returns a list of indexes which represents the &quot;sorted&quot; order of an array generated by</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- fromSortedList of the provided length.</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- I.e. fmap (fromSortedList [1, 2, 3, 4, 5, 6] !!) (generateOrderMapping 6) == [1, 2, 3, 4, 5, 6]</span><span>
</span><span id="line-635"></span><span class="hs-comment">--</span><span>
</span><span id="line-636"></span><span class="hs-comment">--     &gt;&gt;&gt; generateOrderMapping 6</span><span>
</span><span id="line-637"></span><span class="hs-comment">--     [3,1,4,0,5,2]</span><span>
</span><span id="line-638"></span><span class="hs-comment">--</span><span>
</span><span id="line-639"></span><span class="hs-comment">--     &gt;&gt;&gt; generateOrderMapping 8</span><span>
</span><span id="line-640"></span><span class="hs-comment">--     [7,3,1,4,0,5,2,6]</span><span>
</span><span id="line-641"></span><span class="annot"><a href="Data.TypeRepMap.Internal.html#generateOrderMapping"><span class="hs-identifier hs-type">generateOrderMapping</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-642"></span><span id="generateOrderMapping"><span class="annot"><span class="annottext">generateOrderMapping :: Int -&gt; [Int]
</span><a href="Data.TypeRepMap.Internal.html#generateOrderMapping"><span class="hs-identifier hs-var hs-var">generateOrderMapping</span></a></span></span><span> </span><span id="local-6989586621679051274"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051274"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. ST s [Int]) -&gt; [Int]
forall a. (forall s. ST s a) -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">runST</span></a></span><span> </span><span class="annot"><span class="annottext">((forall s. ST s [Int]) -&gt; [Int])
-&gt; (forall s. ST s [Int]) -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679051273"><span class="annot"><span class="annottext">MutablePrimArray s Int
</span><a href="#local-6989586621679051273"><span class="hs-identifier hs-var">orderMappingArr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s (MutablePrimArray (PrimState (ST s)) Int)
forall (m :: * -&gt; *) a.
(PrimMonad m, Prim a) =&gt;
Int -&gt; m (MutablePrimArray (PrimState m) a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">newPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051274"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
forall s. MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051272"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int
</span><a href="#local-6989586621679051273"><span class="hs-identifier hs-var">orderMappingArr</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-645"></span><span>    </span><span class="annot"><span class="annottext">PrimArray Int -&gt; [Int]
forall a. Prim a =&gt; PrimArray a -&gt; [a]
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">primArrayToList</span></a></span><span> </span><span class="annot"><span class="annottext">(PrimArray Int -&gt; [Int]) -&gt; ST s (PrimArray Int) -&gt; ST s [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray (PrimState (ST s)) Int -&gt; ST s (PrimArray Int)
forall (m :: * -&gt; *) a.
PrimMonad m =&gt;
MutablePrimArray (PrimState m) a -&gt; m (PrimArray a)
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">unsafeFreezePrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int
MutablePrimArray (PrimState (ST s)) Int
</span><a href="#local-6989586621679051273"><span class="hs-identifier hs-var">orderMappingArr</span></a></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-647"></span><span>    </span><span id="local-6989586621679051613"><span class="annot"><a href="#local-6989586621679051272"><span class="hs-identifier hs-type">loop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../primitive/html/src"><span class="hs-identifier hs-type">MutablePrimArray</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051613"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051613"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span></span><span>
</span><span id="line-648"></span><span>    </span><span id="local-6989586621679051272"><span class="annot"><span class="annottext">loop :: MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051272"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679051271"><span class="annot"><span class="annottext">MutablePrimArray s Int
</span><a href="#local-6989586621679051271"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span id="local-6989586621679051270"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051270"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679051269"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051269"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-649"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051270"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051274"><span class="hs-identifier hs-var">len</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ST s Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051269"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-651"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-652"></span><span>            </span><span id="local-6989586621679051268"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051268"><span class="hs-identifier hs-var">newFirst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
forall s. MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051272"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int
</span><a href="#local-6989586621679051271"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051270"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051269"><span class="hs-identifier hs-var">first</span></a></span><span>
</span><span id="line-653"></span><span>            </span><span class="annot"><span class="annottext">MutablePrimArray (PrimState (ST s)) Int -&gt; Int -&gt; Int -&gt; ST s ()
forall a (m :: * -&gt; *).
(Prim a, PrimMonad m) =&gt;
MutablePrimArray (PrimState m) a -&gt; Int -&gt; a -&gt; m ()
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">writePrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int
MutablePrimArray (PrimState (ST s)) Int
</span><a href="#local-6989586621679051271"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051268"><span class="hs-identifier hs-var">newFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051270"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-654"></span><span>            </span><span class="annot"><span class="annottext">MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
forall s. MutablePrimArray s Int -&gt; Int -&gt; Int -&gt; ST s Int
</span><a href="#local-6989586621679051272"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">MutablePrimArray s Int
</span><a href="#local-6989586621679051271"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051270"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051268"><span class="hs-identifier hs-var">newFirst</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>
</span><span id="line-656"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-657"></span><span class="hs-comment">--  Helper functions.</span><span>
</span><span id="line-658"></span><span class="hs-comment">----------------------------------------------------------------------------</span><span>
</span><span id="line-659"></span><span>
</span><span id="line-660"></span><span class="hs-comment">-- | Check that invariant of the structure holds.</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- The structure maintains the following invariant.</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- For each element @A@ at index @i@:</span><span>
</span><span id="line-663"></span><span class="hs-comment">--</span><span>
</span><span id="line-664"></span><span class="hs-comment">--   1. if there is an element @B@ at index @2*i+1@,</span><span>
</span><span id="line-665"></span><span class="hs-comment">--      then @B &lt; A@.</span><span>
</span><span id="line-666"></span><span class="hs-comment">--</span><span>
</span><span id="line-667"></span><span class="hs-comment">--   2. if there is an element @C@ at index @2*i+2@,</span><span>
</span><span id="line-668"></span><span class="hs-comment">--      then @A &lt; C@.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span id="local-6989586621679051267"><span class="annot"><a href="Data.TypeRepMap.Internal.html#invariantCheck"><span class="hs-identifier hs-type">invariantCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679051267"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-671"></span><span id="invariantCheck"><span class="annot"><span class="annottext">invariantCheck :: TypeRepMap f -&gt; Bool
</span><a href="Data.TypeRepMap.Internal.html#invariantCheck"><span class="hs-identifier hs-var hs-var">invariantCheck</span></a></span></span><span> </span><span class="annot"><a href="Data.TypeRepMap.Internal.html#TypeRepMap"><span class="hs-identifier hs-type">TypeRepMap</span></a></span><span class="hs-special">{</span><span id="local-6989586621679051262"><span id="local-6989586621679051263"><span id="local-6989586621679051264"><span id="local-6989586621679051265"><span class="annot"><span class="annottext">PrimArray Word64
Array Any
trKeys :: Array Any
trAnys :: Array Any
fingerprintBs :: PrimArray Word64
fingerprintAs :: PrimArray Word64
trKeys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
trAnys :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; Array Any
fingerprintBs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
fingerprintAs :: forall k (f :: k -&gt; *). TypeRepMap f -&gt; PrimArray Word64
</span><a href="#local-6989586621679051262"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">All -&gt; Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var">getAll</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; All
</span><a href="#local-6989586621679051260"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>    </span><span id="local-6989586621679051259"><span class="annot"><span class="annottext">lastMay :: [a] -&gt; Maybe a
</span><a href="#local-6989586621679051259"><span class="hs-identifier hs-var hs-var">lastMay</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="annot"><a href="#local-6989586621679051259"><span class="hs-identifier hs-var">lastMay</span></a></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679051258"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051258"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679051258"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><a href="#local-6989586621679051259"><span class="hs-identifier hs-var">lastMay</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-type">:</span></a></span><span id="local-6989586621679051257"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051257"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe a
</span><a href="#local-6989586621679051259"><span class="hs-identifier hs-var">lastMay</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679051257"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679051256"><span class="annot"><span class="annottext">sz :: Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int
forall a. Prim a =&gt; PrimArray a -&gt; Int
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">sizeofPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span id="local-6989586621679051260"><span class="annot"><span class="annottext">check :: Int -&gt; All
</span><a href="#local-6989586621679051260"><span class="hs-identifier hs-var hs-var">check</span></a></span></span><span> </span><span id="local-6989586621679051255"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-678"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679051253"><span class="annot"><span class="annottext">left :: Int
</span><a href="#local-6989586621679051253"><span class="hs-identifier hs-var hs-var">left</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-680"></span><span>          </span><span id="local-6989586621679051252"><span class="annot"><span class="annottext">right :: Int
</span><a href="#local-6989586621679051252"><span class="hs-identifier hs-var hs-var">right</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-comment">-- maximum value in the left branch</span><span>
</span><span id="line-682"></span><span>          </span><span id="local-6989586621679051251"><span class="annot"><span class="annottext">leftMax :: Maybe (Word64, Word64)
</span><a href="#local-6989586621679051251"><span class="hs-identifier hs-var hs-var">leftMax</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-683"></span><span>               </span><span class="annot"><span class="annottext">(Int -&gt; (Word64, Word64)) -&gt; Maybe Int -&gt; Maybe (Word64, Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051250"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051250"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051250"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051250"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-684"></span><span>             </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Maybe (Word64, Word64))
-&gt; Maybe Int -&gt; Maybe (Word64, Word64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Maybe Int
forall a. [a] -&gt; Maybe a
</span><a href="#local-6989586621679051259"><span class="hs-identifier hs-var">lastMay</span></a></span><span>
</span><span id="line-685"></span><span>             </span><span class="annot"><span class="annottext">([Int] -&gt; Maybe Int) -&gt; [Int] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-686"></span><span>             </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; [Int]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">iterate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051246"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051246"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051246"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051253"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-687"></span><span>          </span><span class="hs-comment">-- minimum value in the right branch</span><span>
</span><span id="line-688"></span><span>          </span><span id="local-6989586621679051245"><span class="annot"><span class="annottext">rightMin :: Maybe (Word64, Word64)
</span><a href="#local-6989586621679051245"><span class="hs-identifier hs-var hs-var">rightMin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-689"></span><span>               </span><span class="annot"><span class="annottext">(Int -&gt; (Word64, Word64)) -&gt; Maybe Int -&gt; Maybe (Word64, Word64)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051244"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051244"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051244"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051244"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span>             </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Maybe (Word64, Word64))
-&gt; Maybe Int -&gt; Maybe (Word64, Word64)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Maybe Int
forall a. [a] -&gt; Maybe a
</span><a href="#local-6989586621679051259"><span class="hs-identifier hs-var">lastMay</span></a></span><span>
</span><span id="line-691"></span><span>             </span><span class="annot"><span class="annottext">([Int] -&gt; Maybe Int) -&gt; [Int] -&gt; Maybe Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Bool) -&gt; [Int] -&gt; [Int]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>             </span><span class="annot"><span class="annottext">([Int] -&gt; [Int]) -&gt; [Int] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; [Int]
forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">iterate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679051243"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051243"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051243"><span class="hs-identifier hs-var">j</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051252"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[All] -&gt; All
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-694"></span><span>          </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; Bool -&gt; All
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-695"></span><span>            </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051253"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-696"></span><span>            </span><span class="hs-keyword">then</span><span>
</span><span id="line-697"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`compare`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051253"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-698"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-699"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051253"><span class="hs-identifier hs-var">left</span></a></span><span>
</span><span id="line-700"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-701"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-702"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; Bool -&gt; All
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-703"></span><span>           </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051252"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051256"><span class="hs-identifier hs-var">sz</span></a></span><span>
</span><span id="line-704"></span><span>           </span><span class="hs-keyword">then</span><span>
</span><span id="line-705"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">`compare`</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051265"><span class="hs-identifier hs-var">fingerprintAs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051252"><span class="hs-identifier hs-var">right</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-706"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-707"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Word64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64 -&gt; Int -&gt; Word64
forall a. Prim a =&gt; PrimArray a -&gt; Int -&gt; a
</span><a href="../../../../primitive/html/src"><span class="hs-identifier hs-var">indexPrimArray</span></a></span><span> </span><span class="annot"><span class="annottext">PrimArray Word64
</span><a href="#local-6989586621679051264"><span class="hs-identifier hs-var">fingerprintBs</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051252"><span class="hs-identifier hs-var">right</span></a></span><span>
</span><span id="line-708"></span><span>                </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-709"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-710"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; All) -&gt; Bool -&gt; All
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool -&gt; Bool
forall a. a -&gt; Maybe a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Bool -&gt; Bool) -&gt; Maybe Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Word64, Word64) -&gt; (Word64, Word64) -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">(&lt;=)</span></a></span><span> </span><span class="annot"><span class="annottext">((Word64, Word64) -&gt; (Word64, Word64) -&gt; Bool)
-&gt; Maybe (Word64, Word64) -&gt; Maybe ((Word64, Word64) -&gt; Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Word64, Word64)
</span><a href="#local-6989586621679051251"><span class="hs-identifier hs-var">leftMax</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ((Word64, Word64) -&gt; Bool)
-&gt; Maybe (Word64, Word64) -&gt; Maybe Bool
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Word64, Word64)
</span><a href="#local-6989586621679051245"><span class="hs-identifier hs-var">rightMin</span></a></span><span>
</span><span id="line-711"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; All
</span><a href="#local-6989586621679051260"><span class="hs-identifier hs-var">check</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679051255"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-713"></span></pre></body></html>